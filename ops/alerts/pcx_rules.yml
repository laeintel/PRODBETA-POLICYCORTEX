groups:
- name: pcx
  rules:
  - alert: PCXAuthFailuresHigh
    expr: rate(pcx_auth_fail_total[5m]) > 0.05
    for: 10m
    labels: { severity: warning }
    annotations:
      summary: "Auth failures exceed 5% over 10m"
  - alert: PCXRateLimitedSpike
    expr: rate(pcx_rate_limited_total[5m]) > 5
    for: 5m
    labels: { severity: info }
    annotations:
      summary: "Clients hitting rate limits frequently"
  - alert: PCXSlowRequests95p
    expr: histogram_quantile(0.95, sum(rate(pcx_http_request_duration_seconds_bucket[5m])) by (le)) > 0.4
    for: 10m
    labels: { severity: warning }
    annotations:
      summary: "95th percentile request latency > 400ms"