# PolicyCortex Production Environment Configuration
# IMPORTANT: Update placeholder values with actual production values before deployment
# Store sensitive values in Azure Key Vault in production

# ============================================================
# ENVIRONMENT CONFIGURATION
# ============================================================
NODE_ENV=production
ENVIRONMENT=production
DEPLOYMENT_ENVIRONMENT=production

# ============================================================
# AZURE CONFIGURATION
# ============================================================

# Azure Tenant and Subscription (Production)
AZURE_TENANT_ID=9ef5b184-d371-462a-bc75-5024ce8baff7
AZURE_CLIENT_ID=8f0208b4-82b1-47cd-b02a-75e2f7afddb5
AZURE_SUBSCRIPTION_ID=9f16cc88-89ce-49ba-a96d-308ed3169595

# Azure Container Registry (Production)
ACR_NAME=crcortexprodvb9v2h
ACR_LOGIN_SERVER=crcortexprodvb9v2h.azurecr.io

# Azure Kubernetes Service (Production)
AKS_CLUSTER_NAME=policycortex-prod-aks
AKS_RESOURCE_GROUP=policycortex-prod-rg

# Azure Authentication (Use Managed Identity in production)
# AZURE_CLIENT_SECRET should be retrieved from Azure Key Vault
AZURE_CLIENT_SECRET=${AZURE_CLIENT_SECRET}
USE_MANAGED_IDENTITY=true

# ============================================================
# APPLICATION URLS (Production)
# ============================================================
NEXT_PUBLIC_APP_URL=https://policycortex.com
NEXT_PUBLIC_API_URL=https://api.policycortex.com
NEXT_PUBLIC_GRAPHQL_URL=https://graphql.policycortex.com/graphql
NEXT_PUBLIC_WEBSOCKET_URL=wss://ws.policycortex.com

# Internal service URLs (within Kubernetes)
BACKEND_SERVICE_URL=http://policycortex-backend:8080
GRAPHQL_SERVICE_URL=http://policycortex-graphql:4000
API_GATEWAY_URL=http://policycortex-api-gateway:8090

# ============================================================
# AZURE AD / MSAL CONFIGURATION (Production)
# ============================================================
NEXT_PUBLIC_AZURE_CLIENT_ID=8f0208b4-82b1-47cd-b02a-75e2f7afddb5
NEXT_PUBLIC_AZURE_TENANT_ID=9ef5b184-d371-462a-bc75-5024ce8baff7
NEXT_PUBLIC_AZURE_SUBSCRIPTION_ID=9f16cc88-89ce-49ba-a96d-308ed3169595

# MSAL Redirect URIs (Production)
NEXT_PUBLIC_MSAL_REDIRECT_URI=https://policycortex.com
NEXT_PUBLIC_MSAL_POST_LOGOUT_REDIRECT_URI=https://policycortex.com/logout
NEXT_PUBLIC_CORE_API_SCOPE=api://policycortex-prod/.default

# Authentication Configuration
REQUIRE_STRICT_AUDIENCE=true
REQUIRE_AUTH=true
JWT_ISSUER=https://login.microsoftonline.com/9ef5b184-d371-462a-bc75-5024ce8baff7/v2.0
JWT_AUDIENCE=api://policycortex-prod

# ============================================================
# DATABASE CONFIGURATION (Production)
# ============================================================

# PostgreSQL (Production - use Azure Database for PostgreSQL)
DATABASE_URL=postgresql://policycortex@policycortex-prod-db.postgres.database.azure.com:5432/policycortex?sslmode=require
DATABASE_HOST=policycortex-prod-db.postgres.database.azure.com
DATABASE_PORT=5432
DATABASE_NAME=policycortex
DATABASE_USER=policycortex
DATABASE_PASSWORD=${DATABASE_PASSWORD}
DATABASE_SSL_MODE=require
DATABASE_MAX_CONNECTIONS=20
DATABASE_IDLE_TIMEOUT=30000

# Connection pooling
DATABASE_POOL_MIN=5
DATABASE_POOL_MAX=20
DATABASE_POOL_IDLE_TIMEOUT_MS=30000
DATABASE_POOL_CONNECTION_TIMEOUT_MS=5000

# ============================================================
# CACHE CONFIGURATION (Production)
# ============================================================

# Redis/DragonflyDB (Production - use Azure Cache for Redis)
REDIS_URL=rediss://policycortex-prod-cache.redis.cache.windows.net:6380
REDIS_HOST=policycortex-prod-cache.redis.cache.windows.net
REDIS_PORT=6380
REDIS_PASSWORD=${REDIS_PASSWORD}
REDIS_TLS=true
REDIS_DB=0
REDIS_KEY_PREFIX=policycortex:prod:
REDIS_TTL_DEFAULT=3600
REDIS_MAX_RETRIES=3

# Cache settings
CACHE_DEFAULT_TTL=3600
CACHE_MAX_SIZE=1000000
ENABLE_REDIS_CLUSTER=true

# ============================================================
# EVENT SOURCING & MESSAGING (Production)
# ============================================================

# EventStore (Production cluster)
EVENTSTORE_URL=tcp://eventstore-cluster.policycortex.internal:1113
EVENTSTORE_USERNAME=admin
EVENTSTORE_PASSWORD=${EVENTSTORE_PASSWORD}
EVENTSTORE_USE_SSL=true
EVENTSTORE_VERIFY_CERTIFICATES=true

# NATS (Production cluster)
NATS_URL=nats://nats-cluster.policycortex.internal:4222
NATS_USERNAME=policycortex
NATS_PASSWORD=${NATS_PASSWORD}
NATS_MAX_RECONNECT_ATTEMPTS=10
NATS_RECONNECT_TIME_WAIT=2000

# ============================================================
# SECURITY CONFIGURATION
# ============================================================

# JWT Configuration (Production)
JWT_SECRET=${JWT_SECRET}
JWT_EXPIRES_IN=1h
JWT_REFRESH_EXPIRES_IN=7d
JWT_ALGORITHM=HS256

# Encryption keys (retrieve from Azure Key Vault)
ENCRYPTION_KEY=${ENCRYPTION_KEY}
SIGNING_KEY=${SIGNING_KEY}

# CORS Configuration
CORS_ORIGIN=https://policycortex.com,https://www.policycortex.com
CORS_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,X-Tenant-ID
CORS_CREDENTIALS=true

# Rate limiting
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=1000
RATE_LIMIT_SKIP_SUCCESSFUL_REQUESTS=false

# ============================================================
# AZURE OPENAI CONFIGURATION
# ============================================================

# Azure OpenAI Service (Production)
AOAI_ENDPOINT=https://policycortex-openai-prod.openai.azure.com/
AOAI_API_KEY=${AOAI_API_KEY}
AOAI_API_VERSION=2024-02-15-preview
AOAI_CHAT_DEPLOYMENT=gpt-4-turbo
AOAI_EMBEDDING_DEPLOYMENT=text-embedding-ada-002
AOAI_MAX_TOKENS=4000
AOAI_TEMPERATURE=0.7

# OpenAI Configuration
OPENAI_MODEL=gpt-4-turbo
OPENAI_MAX_TOKENS=4000
OPENAI_TEMPERATURE=0.3

# ============================================================
# MONITORING & OBSERVABILITY
# ============================================================

# Application Insights
APPLICATIONINSIGHTS_CONNECTION_STRING=${APPLICATIONINSIGHTS_CONNECTION_STRING}
APPINSIGHTS_INSTRUMENTATIONKEY=${APPINSIGHTS_INSTRUMENTATIONKEY}

# Logging configuration
LOG_LEVEL=info
LOG_FORMAT=json
LOG_TIMESTAMP=true
ENABLE_REQUEST_LOGGING=true
ENABLE_ERROR_TRACKING=true

# Metrics and telemetry
ENABLE_METRICS=true
METRICS_PORT=9090
TELEMETRY_ENDPOINT=https://telemetry.policycortex.com

# Health check configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_PATH=/health
HEALTH_CHECK_INTERVAL=30000

# ============================================================
# ML & AI CONFIGURATION
# ============================================================

# ML Model Configuration
ML_MODEL_REGISTRY_URL=https://mlregistry.policycortex.com
ML_PREDICTION_ENDPOINT=https://ml.policycortex.com/predict
ML_TRAINING_ENDPOINT=https://ml.policycortex.com/train
ML_MODEL_VERSION=2.0.0

# Feature store
FEATURE_STORE_URL=https://features.policycortex.com
FEATURE_STORE_OFFLINE_STORE=azureml
FEATURE_STORE_ONLINE_STORE=redis

# MLflow Configuration
MLFLOW_TRACKING_URI=https://mlflow.policycortex.com
MLFLOW_EXPERIMENT_NAME=policycortex-production
MLFLOW_MODEL_REGISTRY=production

# AI Service Configuration
AI_SERVICE_ENABLED=true
AI_MAX_CONCURRENT_REQUESTS=100
AI_TIMEOUT_MS=30000
AI_RETRY_ATTEMPTS=3

# ============================================================
# FEATURE FLAGS
# ============================================================

# Core features
ENABLE_LIVE_DATA=true
ENABLE_AZURE_INTEGRATION=true
ENABLE_WEBSOCKET=true
ENABLE_REALTIME_UPDATES=true

# Patent features
ENABLE_CROSS_DOMAIN_CORRELATION=true
ENABLE_CONVERSATIONAL_AI=true
ENABLE_UNIFIED_PLATFORM=true
ENABLE_PREDICTIVE_COMPLIANCE=true

# Advanced features
ENABLE_ML_FEATURES=true
ENABLE_AUTO_REMEDIATION=false
ENABLE_ADVANCED_ANALYTICS=true
ENABLE_CUSTOM_POLICIES=true

# UI features
ENABLE_DARK_MODE=true
ENABLE_THEME_TOGGLE=true
ENABLE_ACCESSIBILITY_MODE=true
ENABLE_PWA=true

# ============================================================
# PERFORMANCE CONFIGURATION
# ============================================================

# Node.js performance
NODE_OPTIONS=--max-old-space-size=4096
UV_THREADPOOL_SIZE=16

# Application performance
REQUEST_TIMEOUT=30000
MAX_REQUEST_SIZE=10mb
KEEP_ALIVE_TIMEOUT=65000
HEADERS_TIMEOUT=66000

# Caching
ENABLE_RESPONSE_CACHING=true
CACHE_CONTROL_MAX_AGE=3600
STATIC_CACHE_MAX_AGE=31536000

# Compression
ENABLE_COMPRESSION=true
COMPRESSION_THRESHOLD=1024

# ============================================================
# BUSINESS CONFIGURATION
# ============================================================

# Tenant configuration
DEFAULT_TENANT=production
MULTI_TENANT_ENABLED=true
TENANT_ISOLATION_MODE=strict

# Subscription limits
MAX_RESOURCES_PER_TENANT=100000
MAX_POLICIES_PER_TENANT=10000
MAX_USERS_PER_TENANT=1000
API_RATE_LIMIT_PER_TENANT=10000

# Business rules
COMPLIANCE_THRESHOLD=70
RISK_THRESHOLD=80
COST_ANOMALY_THRESHOLD=20
PREDICTION_CONFIDENCE_THRESHOLD=0.8

# ============================================================
# INTEGRATION CONFIGURATION
# ============================================================

# External service integrations
ENABLE_AZURE_MONITOR=true
ENABLE_AZURE_SECURITY_CENTER=true
ENABLE_AZURE_COST_MANAGEMENT=true
ENABLE_AZURE_POLICY=true

# Webhook endpoints
WEBHOOK_SECRET=${WEBHOOK_SECRET}
WEBHOOK_TIMEOUT=10000
WEBHOOK_RETRY_ATTEMPTS=3

# Third-party integrations
SLACK_WEBHOOK_URL=${SLACK_WEBHOOK_URL}
TEAMS_WEBHOOK_URL=${TEAMS_WEBHOOK_URL}
PAGERDUTY_API_KEY=${PAGERDUTY_API_KEY}

# ============================================================
# BACKUP & DISASTER RECOVERY
# ============================================================

# Backup configuration
ENABLE_AUTOMATED_BACKUPS=true
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_ACCOUNT=policycortexprodbackups
BACKUP_CONTAINER=database-backups

# Disaster recovery
DR_ENABLED=true
DR_REGION=westus2
DR_RTO_MINUTES=60
DR_RPO_MINUTES=15

# ============================================================
# CONTAINER & KUBERNETES CONFIGURATION
# ============================================================

# Docker configuration
DOCKER_REGISTRY=crcortexprodvb9v2h.azurecr.io
DOCKER_IMAGE_TAG=latest
PULL_POLICY=Always

# Kubernetes configuration
KUBERNETES_NAMESPACE=policycortex-prod
KUBERNETES_SERVICE_ACCOUNT=policycortex-sa
KUBERNETES_SECRET_NAME=policycortex-secrets

# Resource limits
MEMORY_LIMIT=4Gi
MEMORY_REQUEST=2Gi
CPU_LIMIT=2000m
CPU_REQUEST=1000m

# Scaling configuration
MIN_REPLICAS=3
MAX_REPLICAS=20
TARGET_CPU_UTILIZATION=70
TARGET_MEMORY_UTILIZATION=80

# ============================================================
# DEVELOPMENT & DEBUG (Disabled in production)
# ============================================================

# Debug settings (should be false in production)
DEBUG=false
VERBOSE_LOGGING=false
ENABLE_DEBUG_ENDPOINTS=false
ENABLE_PROFILING=false

# Development features (disabled in production)
ENABLE_HOT_RELOAD=false
ENABLE_DEV_TOOLS=false
ENABLE_MOCK_DATA=false
ENABLE_TEST_ROUTES=false

# ============================================================
# REAL DATA MODE CONFIGURATION
# ============================================================
# Turn OFF demo mode
NEXT_PUBLIC_DEMO_MODE=false
USE_REAL_DATA=true

# Backend base (if your Next app proxies to the same host, leave blank)
NEXT_PUBLIC_BASE_URL=

# ============================================================
# RUNTIME CONFIGURATION
# ============================================================

# Server configuration
PORT=8080
HOST=0.0.0.0
BIND_ADDRESS=0.0.0.0

# Process configuration
WORKER_PROCESSES=auto
MAX_CONNECTIONS=1000
KEEP_ALIVE=2

# Graceful shutdown
SHUTDOWN_TIMEOUT=30000
SIGTERM_TIMEOUT=15000

# ============================================================
# PLACEHOLDER SECRETS (Replace with actual values)
# ============================================================

# IMPORTANT: Replace these placeholder values with actual secrets
# These should be retrieved from Azure Key Vault in production

# Database credentials
# DATABASE_PASSWORD=retrieve-from-key-vault

# Cache credentials  
# REDIS_PASSWORD=retrieve-from-key-vault

# Event store credentials
# EVENTSTORE_PASSWORD=retrieve-from-key-vault

# NATS credentials
# NATS_PASSWORD=retrieve-from-key-vault

# JWT secrets
# JWT_SECRET=retrieve-from-key-vault

# Encryption keys
# ENCRYPTION_KEY=retrieve-from-key-vault
# SIGNING_KEY=retrieve-from-key-vault

# Azure OpenAI API key
# AOAI_API_KEY=retrieve-from-key-vault

# Application Insights
# APPLICATIONINSIGHTS_CONNECTION_STRING=retrieve-from-key-vault
# APPINSIGHTS_INSTRUMENTATIONKEY=retrieve-from-key-vault

# Webhook secrets
# WEBHOOK_SECRET=retrieve-from-key-vault

# Integration API keys
# SLACK_WEBHOOK_URL=retrieve-from-key-vault
# TEAMS_WEBHOOK_URL=retrieve-from-key-vault
# PAGERDUTY_API_KEY=retrieve-from-key-vault