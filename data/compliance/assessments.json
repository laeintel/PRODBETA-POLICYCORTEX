[
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute",
      "Networking"
    ],
    "description": "Microsoft Defender for Cloud has identified some overly-permissive inbound rules for management ports in your network. Enable just-in-time access control to protect your Instances from internet-based brute-force attacks. <a target=\"_blank\" href=\"/azure/defender-for-cloud/just-in-time-access-usage?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Learn more.</a>",
    "displayName": "Management ports of EC2 instances should be protected with just-in-time network access control",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9b26b102-ccde-4697-aa30-f0621f865f99",
    "implementationEffort": "Moderate",
    "name": "9b26b102-ccde-4697-aa30-f0621f865f99",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "11/01/2021"
    },
    "remediationDescription": "To enable just-in-time instance access:<br><ul><li>Select one or more Instances from the list below and click \"Remediate\", or click \"Take action\" if you've arrived from a recommendation for a specific instance.</li><li>On the \"JIT instance access configuration\" page, define the ports for which the just-in-time instance access will be applicable.<ul><li>To add additional ports, click the \"Add\" button on the top left, or click an existing port and edit it.</li><li>On the \"Add port configuration\" blade, enter the required parameters.</li></ul></li><li>Click \"Save\".</li></ul>",
    "severity": "High",
    "tactics": [
      "Lateral Movement"
    ],
    "techniques": [
      "Remote Services"
    ],
    "threats": [
      "MaliciousInsider",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "<p>This control checks whether all stages of an Amazon API Gateway REST or WebSocket API have logging enabled. The control fails if the <code>loggingLevel</code> isn't <code>ERROR</code> or <code>INFO</code> for all stages of the API. Unless you provide custom parameter values to indicate that a specific log type should be enabled, Security Hub produces a passed finding if the logging level is either <code>ERROR</code> or <code>INFO</code>.</p><p>API Gateway REST or WebSocket API stages should have relevant logs enabled. API Gateway REST and WebSocket API execution logging provides detailed records of requests made to API Gateway REST and WebSocket API stages. The stages include API integration backend responses, Lambda authorizer responses, and the <code>requestId</code> for AWS integration endpoints.</p>",
    "displayName": "API Gateway REST and WebSocket API logging should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2cac0072-6f56-46f0-9518-ddec3660ee56",
    "implementationEffort": null,
    "name": "2cac0072-6f56-46f0-9518-ddec3660ee56",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable logging for REST and WebSocket API operations, <a href='https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-logging.html#set-up-access-logging-using-console'>Set up CloudWatch API logging using the API Gateway console</a> in the API Gateway Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Amazon API Gateway REST API stages have SSL certificates configured. <br> Backend systems use these certificates to authenticate that incoming requests are from API Gateway. <br> API Gateway REST API stages should be configured with SSL certificates to allow backend systems to authenticate that requests originate from API Gateway.",
    "displayName": "API Gateway REST API stages should be configured to use SSL certificates for backend authentication",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ec268d38-c94b-4df3-8b4e-5248fcaaf3fc",
    "implementationEffort": null,
    "name": "ec268d38-c94b-4df3-8b4e-5248fcaaf3fc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on how to generate and configure API Gateway REST API SSL certificates, see <a href='https://docs.aws.amazon.com/apigateway/latest/developerguide/getting-started-client-side-ssl-authentication.html'>Generate and configure an SSL certificate for backend authentication</a> in the API Gateway Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether AWS X-Ray active tracing is enabled for your Amazon API Gateway REST API stages. <br> X-Ray active tracing enables a more rapid response to performance changes in the underlying infrastructure. Changes in performance could result in a lack of availability of the API. <br> X-Ray active tracing provides real-time metrics of user requests that flow through your API Gateway REST API operations and connected services.",
    "displayName": "API Gateway REST API stages should have AWS X-Ray tracing enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5cbaff4f-f8d5-49fe-9fdc-63c4507ac670",
    "implementationEffort": null,
    "name": "5cbaff4f-f8d5-49fe-9fdc-63c4507ac670",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on how to enable X-Ray active tracing for API Gateway REST API operations, see <a href='https://docs.aws.amazon.com/xray/latest/devguide/xray-services-apigateway.html'> Amazon API Gateway active tracing support for AWS X-Ray</a> in the AWS X-Ray Developer Guide.",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Opening SSH port 22 to the public network exposes your system to the risk of being susceptible to brute-force attacks, where attackers use automated tools to repeatedly guess usernames and passwords. This can also lead to unauthorized access if weak credentials are used and provide more opportunities for malicious actors to exploit vulnerabilities in the SSH implementation or configuration. Per M365 Certification Requirements, VM internal logs should be collected. In AWS, Session Manager can collect these logs by connecting to the instance from Session Manager Console. To ensure that these logs are collected, other login methods should be blocked. This recommendation checks if port 22 is closed on EC2 instances to ensure that Session Manager is the only method to login to EC2 instances.",
    "displayName": "SSH port should be closed on EC2 machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ad758f18-69df-4844-bd94-0b53ed4eac51",
    "implementationEffort": null,
    "name": "ad758f18-69df-4844-bd94-0b53ed4eac51",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "09/28/2024",
      "public": "09/15/2024"
    },
    "remediationDescription": " From AWS Console, go to the unhealthy EC2 instance. Remove any security group rule that allows connection to port 22.",
    "severity": "Low",
    "tactics": [
      "Reconnaissance",
      "Initial Access"
    ],
    "techniques": [
      "Active Scanning",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an API Gateway stage uses an AWS WAF web access control list (ACL). <br> This control fails if an AWS WAF web ACL is not attached to a REST API Gateway stage. <br> AWS WAF is a web application firewall that helps protect web applications and APIs from attacks. It enables you to configure an ACL, which is a set of rules that allow, block, or count web requests based on customizable web security rules and conditions that you define. <br> Ensure that your API Gateway stage is associated with an AWS WAF web ACL to help protect it from malicious attacks.",
    "displayName": "API Gateway should be associated with an AWS WAF web ACL",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d69eb8b0-79ba-4963-a683-a96a8ea787e2",
    "implementationEffort": null,
    "name": "d69eb8b0-79ba-4963-a683-a96a8ea787e2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to use the API Gateway console to associate an AWS WAF Regional web ACL with an existing API Gateway API stage, see <a href='https://docs.aws.amazon.com/apigateway/latest/developerguide/apigateway-control-access-aws-waf.html'>  Using AWS WAF to protect your APIs </a> in the API Gateway Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether all methods in API Gateway REST API stages that have cache enabled are encrypted. The control fails if any method in an API Gateway REST API stage is configured to cache and the cache is not encrypted. <br> Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. It adds another set of access controls to limit unauthorized users ability access the data. For example, API permissions are required to decrypt the data before it can be read. <br> API Gateway REST API caches should be encrypted at rest for an added layer of security.",
    "displayName": "API Gateway REST API cache data should be encrypted at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a0ce4e0-b61e-4ec7-ab65-aeaff3893bd3",
    "implementationEffort": null,
    "name": "1a0ce4e0-b61e-4ec7-ab65-aeaff3893bd3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this control, configure the stage to encrypt the cache data.<br>To configure API caching for a given stage<br>1. Open the <a href='https://console.aws.amazon.com/apigateway/'>API Gateway console</a>.<br>2. Choose the API.<br>3. Choose \"Stages\".<br>4. In the \"Stages\" list for the API, choose the stage to add caching to.<br>5. Choose \"Settings\".<br>6. Choose \"Enable API cache\".<br>7. Update the desired settings, then select \"Encrypt cache data\".<br>Choose \"Save Changes\".",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Amazon EKS cluster endpoint is publicly accessible. The control fails if an EKS cluster has an endpoint that is publicly accessible.",
    "displayName": "EKS cluster endpoints should not be publicly accessible",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ba71e5ba-2ad7-4512-84e2-1301f4a45ae7",
    "implementationEffort": null,
    "name": "ba71e5ba-2ad7-4512-84e2-1301f4a45ae7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "To modify endpoint access for an existing EKS cluster, see <a href='https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html#modify-endpoint-access'>Modifying cluster endpoint access</a> in the Amazon EKS User Guide. You can set up endpoint access for a new EKS cluster when creating it. For instructions on creating a new Amazon EKS cluster, see <a href='https://docs.aws.amazon.com/eks/latest/userguide/create-cluster.html'>Creating an Amazon EKS cluster</a> in the Amazon EKS User Guide.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Container and Resource Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that audit logs are not enabled for the control plane in your Amazon EKS clusters. This poses a risk of not being able to track activity, detect misconfigurations, or identify abuse of Kubernetes resources, potentially leading to compromised confidential data. We recommend enabling audit logs to maintain oversight and enhance the security of the Amazon EKS cluster's control plane. <br>Please note this may incur additional charges for data ingestion and archival. <a target=\"_blank\" href=\"https://docs.aws.amazon.com/eks/latest/userguide/control-plane-logs.html\">Learn more.</a>",
    "displayName": "Audit logging should be enabled for the control plane in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/97b24cf8-c4f1-4f77-bd56-792c0a4e70ad",
    "implementationEffort": null,
    "name": "97b24cf8-c4f1-4f77-bd56-792c0a4e70ad",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "To enable audit logs in the control plane of your Amazon EKS clusters: 1. In the AWS portal, navigate to \"Elastic Kubernetes Service\". 2. From \"Clusters\", select a cluster you want to update and navigate to the \"Observability\" tab. 3. In the \"Control plane logging\" section, click on the \"Manage logging\" button. 4. Toggle the \"Audit\" log type to enable. By default, logs are turned off. 5. Click on \"Save changes\".<br>Note: Enabling audit logs will result in additional charges. For information on pricing, refer to <a target=\"_blank\" href=\"https://aws.amazon.com/cloudwatch/pricing/\">Amazon CloudWatch pricing details</a>.",
    "severity": "Medium",
    "tactics": [
      "Persistence",
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Create or Modify System Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether an Amazon CloudFront distribution is configured to return a specific object that is the default root object. The control fails if the CloudFront distribution does not have a default root object configured.<br>A user might sometimes request the distributions root URL instead of an object in the distribution. When this happens, specifying a default root object can help you to avoid exposing the contents of your web distribution.",
    "displayName": "CloudFront distributions should have a default root object configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/186509dc-f326-415f-b085-4d27f1342849",
    "implementationEffort": null,
    "name": "186509dc-f326-415f-b085-4d27f1342849",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on how to specify a default root object for your distribution, see <a href='https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/DefaultRootObject.html#DefaultRootObjectHowToDefine'>How to specify a default root object </a>  in the Amazon CloudFront Developer Guide.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether an Amazon CloudFront distribution with Amazon S3 Origin type has Origin Access Identity (OAI) configured. The control fails if OAI is not configured.<br>CloudFront OAI prevents users from accessing S3 bucket content directly. When users access an S3 bucket directly, they effectively bypass the CloudFront distribution and any permissions that are applied to the underlying S3 bucket content.",
    "displayName": "CloudFront distributions should have origin access identity enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a0ab1f4e-bafb-4947-a7d1-13a9c35c7d82",
    "implementationEffort": null,
    "name": "a0ab1f4e-bafb-4947-a7d1-13a9c35c7d82",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed remediation instructions, see <a href='https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/private-content-restricting-access-to-s3.html#private-content-creating-oai'>Creating a CloudFront OAI and adding it to your distribution</a> in the Amazon CloudFront Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Amazon CloudFront distribution requires viewers to use HTTPS directly or whether it uses redirection. The control fails if ViewerProtocolPolicy is set to allow-all for defaultCacheBehavior or for cacheBehaviors.<br>HTTPS (TLS) can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. Only encrypted connections over HTTPS (TLS) should be allowed. Encrypting data in transit can affect performance. You should test your application with this feature to understand the performance profile and the impact of TLS.",
    "displayName": "CloudFront distributions should require encryption in transit",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a67adff8-625f-4891-9f61-43f837d18ad2",
    "implementationEffort": null,
    "name": "a67adff8-625f-4891-9f61-43f837d18ad2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed remediation instructions, see <a href='https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/using-https-viewers-to-cloudfront.html'>Requiring HTTPS for communication between viewers and CloudFront</a> in the Amazon CloudFront Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Credential Access",
      "Impact"
    ],
    "techniques": [
      "Network Sniffing",
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether an Amazon CloudFront distribution is configured with an origin group that has two or more origins.<br>CloudFront origin failover can increase availability. Origin failover automatically redirects traffic to a secondary origin if the primary origin is unavailable or if it returns specific HTTP response status codes.",
    "displayName": "CloudFront distributions should have origin failover configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4779e962-2ea3-4126-aa76-379ea271887c",
    "implementationEffort": null,
    "name": "4779e962-2ea3-4126-aa76-379ea271887c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed remediation instructions, see <a href='https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/high_availability_origin_failover.html#concept_origin_groups.creating'>Creating an origin group</a> in the Amazon CloudFront Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether server access logging is enabled on CloudFront distributions. The control fails if access logging is not enabled for a distribution.<br> CloudFront access logs provide detailed information about every user request that CloudFront receives. Each log contains information such as the date and time the request was received, the IP address of the viewer that made the request, the source of the request, and the port number of the request from the viewer.<br>These logs are useful for applications such as security and access audits and forensics investigation. For additional guidance on how to analyze access logs, see Querying Amazon CloudFront logs in the Amazon Athena User Guide.",
    "displayName": "CloudFront distributions should have logging enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/88114970-36db-42b3-9549-20608b1ab8ad",
    "implementationEffort": null,
    "name": "88114970-36db-42b3-9549-20608b1ab8ad",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to configure access logging for a CloudFront distribution, see <a href='https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/AccessLogs.html'> Configuring and using standard logs (access logs)</a> in the Amazon CloudFront Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether CloudFront distributions are associated with either AWS WAF or AWS WAFv2 web ACLs. The control fails if the distribution is not associated with a web ACL.<br>AWS WAF is a web application firewall that helps protect web applications and APIs from attacks. It allows you to configure a set of rules, called a web access control list (web ACL), that allow, block, or count web requests based on customizable web security rules and conditions that you define. Ensure your CloudFront distribution is associated with an AWS WAF web ACL to help protect it from malicious attacks.",
    "displayName": "CloudFront distributions should have AWS WAF enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0e0d5964-2895-45b1-b646-fcded8d567be",
    "implementationEffort": null,
    "name": "0e0d5964-2895-45b1-b646-fcded8d567be",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to associate a web ACL with a CloudFront distribution, see <a href='https://docs.aws.amazon.com/AmazonCloudFront/latest/DeveloperGuide/distribution-web-awswaf.html'>Using AWS WAF to control access to your content </a>  in the Amazon CloudFront Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks if Kinesis Data Streams are encrypted at rest with server-side encryption. This control fails if a Kinesis stream is not encrypted at rest with server-side encryption.",
    "displayName": "Kinesis streams should be encrypted at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a9062544-da66-4d94-bfe1-ffcf94e43a42",
    "implementationEffort": null,
    "name": "a9062544-da66-4d94-bfe1-ffcf94e43a42",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/03/2024"
    },
    "remediationDescription": "For information about enabling server-side encryption for Kinesis streams, see <a href='https://docs.aws.amazon.com/streams/latest/dev/getting-started-with-sse.html'>How do I get started with server-side encryption?</a> in the Amazon Kinesis Developer Guide.",
    "severity": "Medium",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Checks whether the default version of IAM customer managed policies allow principals to use the AWS KMS decryption actions on all resources. This control uses <a href='http://aws.amazon.com/blogs/security/protect-sensitive-data-in-the-cloud-with-automated-reasoning-zelkova'>Zelkova</a>, an automated reasoning engine, to validate and warn you about policies that may grant broad access to your secrets across AWS accounts.This control fails if the \"kms:Decrypt\" or \"kms:ReEncryptFrom\" actions are allowed on all KMS keys. The control evaluates both attached and unattached customer managed policies. It does not check inline policies or AWS managed policies.<br />With AWS KMS, you control who can use your KMS keys and gain access to your encrypted data. IAM policies define which actions an identity (user, group, or role) can perform on which resources. Following security best practices, AWS recommends that you allow least privilege. In other words, you should grant to identities only the \"kms:Decrypt\" or \"kms:ReEncryptFrom\" permissions and only for the keys that are required to perform a task. Otherwise, the user might use keys that are not appropriate for your data.<br />Instead of granting permissions for all keys, determine the minimum set of keys that users need to access encrypted data. Then design policies that allow users to use only those keys. For example, do not allow \"kms:Decrypt\" permission on all KMS keys. Instead, allow \"kms:Decrypt\" only on keys in a particular Region for your account. By adopting the principle of least privilege, you can reduce the risk of unintended disclosure of your data.",
    "displayName": "IAM customer managed policies should not allow decryption actions on all KMS keys",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d088fb9f-11dc-451e-8f79-393916e42bb2",
    "implementationEffort": null,
    "name": "d088fb9f-11dc-451e-8f79-393916e42bb2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, you modify the IAM customer managed policies to restrict access to the keys.<br><br><b>To modify an IAM customer managed policy</b><br><br>1. Open the IAM console at <a href='https://console.aws.amazon.com/iam/'>https://console.aws.amazon.com/iam/</a><br>2. In the IAM navigation pane, choose \"Policies\".<br>3. Choose the arrow next to the policy you want to modify.<br>4. Choose \"Edit policy\".<br>5. Choose the \"JSON\" tab.<br>6. Change the \"Resource\" value to the specific key or keys that you want to allow.<br>7. After you modify the policy, choose \"Review policy\".<br>8. Choose \"Save changes\".<br><br>For more information, see <a href='https://docs.aws.amazon.com/kms/latest/developerguide/iam-policies.html'>Using IAM policies with AWS KMS</a> in the AWS Key Management Service Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact",
      "Privilege Escalation",
      "Discovery"
    ],
    "techniques": [
      "Data Encrypted for Impact",
      "Exploitation for Privilege Escalation",
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Checks whether the inline policies that are embedded in your IAM identities (role, user, or group) allow the AWS KMS decryption actions on all KMS keys. This control uses <a href='http://aws.amazon.com/blogs/security/protect-sensitive-data-in-the-cloud-with-automated-reasoning-zelkova'>Zelkova</a>, an automated reasoning engine, to validate and warn you about policies that may grant broad access to your secrets across AWS accounts. <br>This control fails if \"kms:Decrypt\" or \"kms:ReEncryptFrom\" actions are allowed on all KMS keys in an inline policy.<br>With AWS KMS, you control who can use your KMS keys and gain access to your encrypted data. IAM policies define which actions an identity (user, group, or role) can perform on which resources. Following security best practices, AWS recommends that you allow least privilege. In other words, you should grant to identities only the permissions they need and only for keys that are required to perform a task. Otherwise, the user might use keys that are not appropriate for your data.<br>Instead of granting permission for all keys, determine the minimum set of keys that users need to access encrypted data. Then design policies that allow the users to use only those keys. For example, do not allow \"kms:Decrypt\" permission on all KMS keys. Instead, allow them only on keys in a particular Region for your account. By adopting the principle of least privilege, you can reduce the risk of unintended disclosure of your data.",
    "displayName": "IAM principals should not have IAM inline policies that allow decryption actions on all KMS keys",
    "id": "/providers/Microsoft.Security/assessmentMetadata/18be55d0-b681-4693-af8d-b8815518d758",
    "implementationEffort": null,
    "name": "18be55d0-b681-4693-af8d-b8815518d758",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, you modify the inline policy to restrict access to the keys.<br><br><b>To modify an IAM inline policy</b><br><br>1. Open the IAM console at <a href='https://console.aws.amazon.com/iam/'>https://console.aws.amazon.com/iam/</a><br>2. In the IAM navigation pane, choose \"Users, Groups\", or \"Roles\".<br>3. Choose the name of the user, group or role for which to modify IAM inline policies.<br>4. Choose the arrow next to the policy to modify.<br>5. Choose \"Edit policy\".<br>6. Choose the \"JSON\" tab.<br>7. Change the \"Resource\" value to the specific keys you want to allow.<br>8. After you modify the policy, choose \"Review policy\".<br>9. Choose \"Save changes\".<br><br>For more information, see <a href='https://docs.aws.amazon.com/kms/latest/developerguide/iam-policies.html'>Using IAM policies with AWS KMS</a> in the AWS Key Management Service Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact",
      "Privilege Escalation",
      "Discovery"
    ],
    "techniques": [
      "Data Encrypted for Impact",
      "Exploitation for Privilege Escalation",
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether KMS keys are scheduled for deletion. The control fails if a KMS key is scheduled for deletion.<br>KMS keys cannot be recovered once deleted. Data encrypted under a KMS key is also permanently unrecoverable if the KMS key is deleted. If meaningful data has been encrypted under a KMS key scheduled for deletion, consider decrypting the data or re-encrypting the data under a new KMS key unless you are intentionally performing a cryptographic erasure.<br>When a KMS key is scheduled for deletion, a mandatory waiting period is enforced to allow time to reverse the deletion, if it was scheduled in error. The default waiting period is 30 days, but it can be reduced to as short as 7 days when the KMS key is scheduled for deletion. During the waiting period, the scheduled deletion can be canceled and the KMS key will not be deleted.<br>For additional information regarding deleting KMS keys, see <a href='https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html'>Deleting KMS keys</a> in the AWS Key Management Service Developer Guide.",
    "displayName": "AWS KMS keys should not be unintentionally deleted",
    "id": "/providers/Microsoft.Security/assessmentMetadata/10c59743-84c4-4711-adb7-ba895dc57339",
    "implementationEffort": null,
    "name": "10c59743-84c4-4711-adb7-ba895dc57339",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed remediation instructions to cancel a scheduled KMS key deletion, see \"To cancel key deletion\" under <a href='https://docs.aws.amazon.com/kms/latest/developerguide/deleting-keys.html#deleting-keys-scheduling-key-deletion'> Scheduling and canceling key deletion (console)</a> in the AWS Key Management Service Developer Guide.",
    "severity": "High",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Encrypted for Impact"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether master nodes on Amazon EMR clusters have public IP addresses.<br>The control fails if the master node has public IP addresses that are associated with any of its instances. Public IP addresses are designated in the PublicIp field of the NetworkInterfaces configuration for the instance.<br> This control only checks Amazon EMR clusters that are in a RUNNING or WAITING state.",
    "displayName": "Amazon EMR cluster master nodes should not have public IP addresses",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fe770214-7b47-48f7-a78c-1279c35d8279",
    "implementationEffort": null,
    "name": "fe770214-7b47-48f7-a78c-1279c35d8279",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "During launch, you can control whether your instance in a default or nondefault subnet is assigned a public IPv4 address.<br>By default, default subnets have this attribute set to true. Nondefault subnets have the IPv4 public addressing attribute set to false, unless it was created by the Amazon EC2 launch instance wizard. In that case, the wizard sets the attribute to true.<br>You need to launch your cluster in a VPC with a private subnet that has the IPv4 public addressing attribute set to false.<br>After launch, you cannot manually disassociate a public IPv4 address from your instance.<br>To remediate this finding, you need to create a new cluster in VPC private subnet. For information on how to launch a cluster in into a VPC private subnet, see <a href='https://docs.aws.amazon.com/emr/latest/ManagementGuide/emr-vpc-launching-job-flows.html'>Launch clusters into a VPC</a> in the Amazon EMR Management Guide.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether the IAM identity-based policies that you create have Allow statements that use the * wildcard to  grant permissions for all actions on any service. The control fails if any policy statement includes 'Effect': 'Allow' with 'Action': 'Service:*'. <br> For example, the following statement in a policy results in a failed finding.<br><code>'Statement': [<br>{<br>  'Sid': 'EC2-Wildcard',<br>  'Effect': 'Allow',<br>  'Action': 'ec2:*',<br>  'Resource': '*'<br>}</code><br> The control also fails if you use 'Effect': 'Allow' with 'NotAction': 'service:*'. In that case, the NotAction element provides access to all of the actions in an AWS service, except for the actions specified in NotAction.<br>This control only applies to customer managed IAM policies. It does not apply to IAM policies that are managed by AWS.<br> When you assign permissions to AWS services, it is important to scope the allowed IAM actions in your IAM policies. You should restrict IAM actions to only those actions that are needed. This helps you to provision least privilege permissions. Overly permissive policies might lead to privilege escalation if the policies are attached to an IAM principal that might not require the permission.<br>In some cases, you might want to allow IAM actions that have a similar prefix, such as DescribeFlowLogs and DescribeAvailabilityZones. In these authorized cases, you can add a suffixed wildcard to the common prefix. For example, ec2:Describe*.<br><br>This control passes if you use a prefixed IAM action with a suffixed wildcard. For example, the following statement in a policy results in a passed finding.<br><code> 'Statement': [<br>{<br>  'Sid': 'EC2-Wildcard',<br>  'Effect': 'Allow',<br>  'Action': 'ec2:Describe*',<br>  'Resource': '*'<br>}</code><br>When you group related IAM actions in this way, you can also avoid exceeding the IAM policy size limits.",
    "displayName": "IAM customer managed policies that you create should not allow wildcard actions for services",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5a0476c5-a14b-4195-8c31-633511234b38",
    "implementationEffort": null,
    "name": "5a0476c5-a14b-4195-8c31-633511234b38",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update your IAM policies so that they do not allow full '*' administrative privileges. <br> For details on how to edit an IAM policy, see <a href='https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage-edit.html'>Editing IAM policies</a> in the IAM User Guide.",
    "severity": "Low",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether the EBS volumes that are in an attached state are encrypted. To pass this check, EBS volumes must be in use and encrypted. If the EBS volume is not attached, then it is not subject to this check. <br>For an added layer of security of your sensitive data in EBS volumes, you should enable EBS encryption at rest. Amazon EBS encryption offers a straightforward encryption solution for your EBS resources that doesn't require you to build, maintain, and secure your own key management infrastructure. It uses AWS KMS customer master keys (CMK) when creating encrypted volumes and snapshots. <br>To learn more about Amazon EBS encryption, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html'>Amazon EBS encryption</a> in the Amazon EC2 User Guide for Linux Instances.",
    "displayName": "Attached EBS volumes should be encrypted at-rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0bde343a-0681-4ee2-883a-027cc1e655b8",
    "implementationEffort": null,
    "name": "0bde343a-0681-4ee2-883a-027cc1e655b8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "There is no direct way to encrypt an existing unencrypted volume or snapshot. You can only encrypt a new volume or snapshot when you create it. <br>If you enabled encryption by default, Amazon EBS encrypts the resulting new volume or snapshot using your default key for Amazon EBS encryption. Even if you have not enabled encryption by default, you can enable encryption when you create an individual volume or snapshot. In both cases, you can override the default key for Amazon EBS encryption and choose a symmetric customer managed CMK. <br>For more information, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-creating-volume.html'>Creating an Amazon EBS volume</a> and <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-copy-snapshot.html'>Copying an Amazon EBS snapshot</a> in the Amazon EC2 User Guide for Linux Instances.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether any EC2 instances have been stopped for more than the allowed number of days. An EC2 instance fails this check if it is stopped for longer than the maximum allowed time period, which by default is 30 days. <br> A failed finding indicates that an EC2 instance has not run for a significant period of time. This creates a security risk because the EC2 instance is not being actively maintained (analyzed, patched, updated). If it is later launched, the lack of proper maintenance could result in unexpected issues in your AWS environment. To safely maintain an EC2 instance over time in a nonrunning state, start it periodically for maintenance and then stop it after maintenance. Ideally this is an automated process.",
    "displayName": "Stopped EC2 instances should be removed after a specified time period",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a3340b3-8916-40fe-942d-a937e60f5d4c",
    "implementationEffort": null,
    "name": "1a3340b3-8916-40fe-942d-a937e60f5d4c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can terminate an EC2 instance using either the console or the command line. <br>Before you terminate the EC2 instance, verify that you won't lose any data: <br>* Check that your Amazon EBS volumes will not be deleted on termination. <br>* Copy any data that you need from your EC2 instance store volumes to Amazon EBS or Amazon S3. <br><b>To terminate an EC2 instance (console)</b><br>1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a>.<br>2. In the navigation pane, under <b>Instances</b>, choose \"Instances\". <br>3. Select the instance, and then choose \"Actions\", \"Instance State\", \"Terminate\". <br>4. When prompted for confirmation, choose \"Yes, Terminate\". <br><b>To terminate an EC2 instance (AWS CLI, Tools for Windows PowerShell)</b><br>Use one of the following commands. For more information about the command line interface, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html#access-ec2'>Accessing Amazon EC2</a> in the Amazon EC2 User Guide for Linux Instances.<br>- From the AWS CLI, use <a href='https://docs.aws.amazon.com/cli/latest/reference/ec2/terminate-instances.html'>terminate-instances</a><br>- From the Tools for Windows PowerShell, use <a href='https://docs.aws.amazon.com/powershell/latest/reference/items/Stop-EC2Instance.html'>Stop-EC2Instance</a>.<br>To learn more about terminating instances, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/terminating-instances.html#terminating-instances-console'>Terminating an instance</a>in the Amazon EC2 User Guide for Linux Instances.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether account-level encryption is enabled by default for Amazon Elastic Block Store(Amazon EBS).<br> The control fails if the account level encryption is not enabled.<br>When encryption is enabled for your account, Amazon EBS volumes and snapshot copies are encrypted at rest. This adds an additional layer of protection for your data.<br>For more information, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html#encryption-by-default'>Encryption by default</a> in the Amazon EC2 User Guide for Linux Instances.<br>Note that following instance types do not support encryption: R1, C1, and M1.",
    "displayName": "EBS default encryption should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/56406d4c-87b4-4aeb-b1cc-7f6312d78e0a",
    "implementationEffort": null,
    "name": "56406d4c-87b4-4aeb-b1cc-7f6312d78e0a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can use the Amazon EC2 console to enable default encryption for Amazon EBS volumes.<br><br><b>To configure the default encryption for Amazon EBS encryption for a Region</b><br>1. Open the Amazon EC2 console at <a href='https://console.aws.amazon.com/ec2/'> https://console.aws.amazon.com/ec2/</a><br>2. From the navigation pane, select \"EC2 Dashboard\".<br>3. In the upper-right corner of the page, choose \"Account Attributes\", \"EBS encryption\".<br>4. Choose \"Manage\".<br>5. Select \"Enable\". You can keep the AWS managed key with the alias alias/aws/ebs created on your behalf as the default encryption key, or choose a symmetric customer managed key.<br>6. Choose \"Update EBS encryption\".",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether your EC2 instance metadata version is configured with Instance Metadata Service Version 2 (IMDSv2). The control passes if \"HttpTokens\" is set to \"required\" for IMDSv2. The control fails if \"HttpTokens\" is set to \"optional\".  <br>You use instance metadata to configure or manage the running instance. The IMDS provides access to temporary, frequently rotated credentials. These credentials remove the need to hard code or distribute sensitive credentials to instances manually or programmatically. The IMDS is attached locally to every EC2 instance. It runs on a special 'link local' IP address of 169.254.169.254. This IP address is only accessible by software that runs on the instance.  <br>Version 2 of the IMDS adds new protections for the following types of vulnerabilities. These vulnerabilities could be used to try to access the IMDS.<br>* Open website application firewalls <br>* Open reverse proxies <br>* Server-side request forgery (SSRF) vulnerabilities <br>* Open Layer 3 firewalls and network address translation (NAT) <br>Security Hub recommends that you configure your EC2 instances with IMDSv2.",
    "displayName": "EC2 instances should use IMDSv2",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5ea3248a-8af5-4df3-8e08-f7d1925ea147",
    "implementationEffort": null,
    "name": "5ea3248a-8af5-4df3-8e08-f7d1925ea147",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate an EC2 instance that is not configured with IMDSv2, you can require the use of IMDSv2.<br>To require IMDSv2 on an existing instance, when you request instance metadata, modify the Amazon EC2 metadata options. Follow the instructions in <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html'>Configuring instance metadata options for existing instances</a> in the Amazon EC2 User Guide for Linux Instances.<br>To require the use of IMDSv2 on a new instance when you launch it, follow the instructions in <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html'>Configuring instance metadata options for new instances</a> in the Amazon EC2 User Guide for Linux Instances.<br><b>To configure your new EC2 instance with IMDSv2 from the console</b><br>1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a>.<br>2. Choose \"Launch instance\" and then choose \"Launch instance\".<br>3. In the \"Configure Instance Details\" step, under \"Advanced Details\", for \"Metadata version\", choose \"V2 (token required)\".<br>4. Choose \"Review and Launch\".<br>If your software uses IMDSv1, you can reconfigure your software to use IMDSv2. For details, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/configuring-instance-metadata-service.html#instance-metadata-transition-to-version-2'>Transitioning to using Instance Metadata Service Version 2</a> in the Amazon EC2 User Guide for Linux Instances.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether EC2 instances have a public IP address. The control fails if the \"publicIp\" field is present in the EC2 instance configuration item. This control applies to IPv4 addresses only. <br> A public IPv4 address is an IP address that is reachable from the internet. If you launch your instance with a public IP address, then your EC2 instance is reachable from the internet. A private IPv4 address is an IP address that is not reachable from the internet. You can use private IPv4 addresses for communication between EC2 instances in the same VPC or in your connected private network. <br> IPv6 addresses are globally unique, and therefore are reachable from the internet. However, by default all subnets have the IPv6 addressing attribute set to false. For more information about IPv6, see <a href='https://docs.aws.amazon.com/vpc/latest/userguide/vpc-ip-addressing.html'>IP addressing in your VPC</a> in the Amazon VPC User Guide. <br> If you have a legitimate use case to maintain EC2 instances with public IP addresses, then you can suppress the findings from this control. For more information about front-end architecture options, see the <a href='http://aws.amazon.com/blogs/architecture/'>AWS Architecture Blog</a> or the <a href='http://aws.amazon.com/blogs/architecture/'>This Is My Architecture series</a>.",
    "displayName": "EC2 instances should not have a public IP address",
    "id": "/providers/Microsoft.Security/assessmentMetadata/63afb20c-4e8e-42ad-bc6d-dc48d4bebc5f",
    "implementationEffort": null,
    "name": "63afb20c-4e8e-42ad-bc6d-dc48d4bebc5f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Use a non-default VPC so that your instance is not assigned a public IP address by default. <br> When you launch an EC2 instance into a default VPC, it is assigned a public IP address. When you launch an EC2 instance into a non-default VPC, the subnet configuration determines whether it receives a public IP address. The subnet has an attribute to determine if new EC2 instances in the subnet receive a public IP address from the public IPv4 address pool. <br> You cannot manually associate or disassociate an automatically-assigned public IP address from your EC2 instance. To control whether your EC2 instance receives a public IP address, do one of the following: <br> - Modify the public IP addressing attribute of your subnet. For more information, see <a href='https://docs.aws.amazon.com/vpc/latest/userguide/vpc-ip-addressing.html#subnet-public-ip'>Modifying the public IPv4 addressing attribute for your subnet</a> in the Amazon VPC User Guide. <br> - Enable or disable the public IP addressing feature during launch. This overrides the subnet's public IP addressing attribute. For more information, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#public-ip-addresses'>Assign a public IPv4 address during instance launch</a> in the Amazon EC2 User Guide for Linux Instances. <br> For more information, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-instance-addressing.html#concepts-public-addresses'>Public IPv4 addresses and external DNS hostnames</a> in the Amazon EC2 User Guide for Linux Instances. <br> If your EC2 instance is associated with an Elastic IP address, then your EC2 instance is reachable from the internet. You can disassociate an Elastic IP address from an instance or network interface at any time. <br> <b>To disassociate an Elastic IP address</b> <br> 1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a> <br> 2. In the navigation pane, choose \"Elastic IPs\". <br> 3. Select the Elastic IP address to disassociate. <br> 4. From \"Actions\", choose \"Disassociate Elastic IP address\". <br> 5. Choose \"Disassociate\".",
    "severity": "High",
    "tactics": [
      "Discovery",
      "Reconnaissance"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery",
      "Active Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether a service endpoint for Amazon EC2 is created for each VPC. The control fails if a VPC does not have a VPC endpoint created for the Amazon EC2 service. <br> To improve the security posture of your VPC, you can configure Amazon EC2 to use an interface VPC endpoint. Interface endpoints are powered by AWS PrivateLink, a technology that enables you to access Amazon EC2 API operations privately. It restricts all network traffic between your VPC and Amazon EC2 to the Amazon network. Because endpoints are supported within the same Region only, you cannot create an endpoint between a VPC and a service in a different Region. This prevents unintended Amazon EC2 API calls to other Regions. <br> To learn more about creating VPC endpoints for Amazon EC2, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/interface-vpc-endpoints.html'>Amazon EC2 and interface VPC endpoints</a> in the Amazon EC2 User Guide for Linux Instances.",
    "displayName": "Amazon EC2 should be configured to use VPC endpoints",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e700ddd4-bb55-4602-b93a-d75895fbf7c6",
    "implementationEffort": null,
    "name": "e700ddd4-bb55-4602-b93a-d75895fbf7c6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, you can create an interface VPC endpoint to Amazon EC2. <br><b>To create an interface endpoint to Amazon EC2 from the Amazon VPC console</b> <br>1. Open the <a href='https://console.aws.amazon.com/vpc/'>Amazon VPC console</a> <br>2. In the navigation pane, choose \"Endpoints\". <br>3. Choose \"Create Endpoint\". <br>4. For \"Service category\", choose \"AWS services\". <br>5. For \"Service Name\", choose \"com.amazonaws.&lt;region&gt;.ec2\". <br>6. For \"Type\", choose \"Interface\". <br>7. Complete the following information.<ol style='list-style-type: lower-alpha;'><li>For \"VPC\", select a VPC in which to create the endpoint.</li><li>For \"Subnets\", select the subnets (Availability Zones) in which to create the endpoint network interfaces. Not all Availability Zones are supported for all AWS services.</li><li>To enable private DNS for the interface endpoint, select the check box for \"Enable DNS Name\". This option is enabled by default. <br>To use the private DNS option, the following attributes of your VPC must be set to true: <br>- \"enableDnsHostnames\" <br>- \"enableDnsSupport\" <br>For more information, see <a href='https://docs.aws.amazon.com/vpc/latest/userguide/vpc-dns.html#vpc-dns-updating'>Viewing and updating DNS support for your VPC</a> in the Amazon VPC User Guide.</li><li>For \"Security group\", select the security groups to associate with the endpoint network interfaces.</li><li>(Optional) Add or remove a tag. To add a tag, choose \"Add tag\" and do the following: <br>- For \"Key\", enter the tag name. <br>- For \"Value\", enter the tag value.</li><li>&nbsp;To remove a tag, choose the delete button (x) to the right of the tag <b>Key</b> and <b>Value</b>.</li></ol>8. Choose \"Create endpoint\". <br><b>To create an interface VPC endpoint policy</b> <br>You can attach a policy to your VPC endpoint to control access to the Amazon EC2 API. The policy specifies the following: <br>- The principal that can perform actions <br>- The actions that can be performed <br>- The resource on which the actions can be performed <br>For more details on creating a VPC endpoint policy, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/interface-vpc-endpoints.html'>Amazon EC2 and interface VPC endpoints</a> In the Amazon EC2 User Guide for Linux Instances.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether the assignment of public IPs in Amazon Virtual Private Cloud (Amazon VPC) subnets have \"MapPublicIpOnLaunch\" set to \"FALSE\". The control passes if the flag is set to \"FALSE\". <br> All subnets have an attribute that determines whether a network interface created in the subnet automatically receives a public IPv4 address. Instances that are launched into subnets that have this attribute enabled have a public IP address assigned to their primary network interface.",
    "displayName": "EC2 subnets should not automatically assign public IP addresses",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ace790eb-39b9-4b4f-b53d-26d0f77d4ab8",
    "implementationEffort": null,
    "name": "ace790eb-39b9-4b4f-b53d-26d0f77d4ab8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can configure a subnet from the Amazon VPC console. <br><b>To configure a subnet to not assign public IP addresses</b> <br>1. Open the <a href='https://console.aws.amazon.com/vpc/'>Amazon VPC console</a>. <br>2. In the navigation pane, choose \"Subnets\". <br>3. Select your subnet and then choose \"Subnet Actions\", \"Modify auto-assign IP settings\". <br>4. Clear the \"Enable auto-assign public IPv4 address\" check box and then choose \"Save\".",
    "severity": "Medium",
    "tactics": [
      "Reconnaissance",
      "Discovery"
    ],
    "techniques": [
      "Active Scanning",
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether there are any unused network access control lists (ACLs).<br> The control checks the item configuration of the resource \"AWS::EC2::NetworkAcl\" and determines the relationships of the network ACL.<br> If the only relationship is the VPC of the network ACL, then the control fails. <br>If other relationships are listed, then the control passes.",
    "displayName": "Unused network access control lists should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5f9a7d87-ec2e-409a-991a-48c29484d6b5",
    "implementationEffort": null,
    "name": "5f9a7d87-ec2e-409a-991a-48c29484d6b5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For instructions on how to delete an unused network ACL, see <a href='https://docs.aws.amazon.com/vpc/latest/userguide/vpc-network-acls.html#DeleteNetworkACL'>Deleting a network ACL</a> in the Amazon VPC User Guide.",
    "severity": "Low",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Network Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether an EC2 instance uses multiple Elastic Network Interfaces (ENIs) or Elastic Fabric Adapters (EFAs).This control passes if a single network adapter is used. The control includes an optional parameter list to identify the allowed ENIs. <br>Multiple ENIs can cause dual-homed instances, meaning instances that have multiple subnets. This can add network security complexity and introduce unintended network paths and access.",
    "displayName": "EC2 instances should not use multiple ENIs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fead4128-7325-4b82-beda-3fd42de36920",
    "implementationEffort": null,
    "name": "fead4128-7325-4b82-beda-3fd42de36920",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, detach the additional ENIs. <br>  <b>To detach a network interface</b> <br> 1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a>. <br> 2. Under \"Network &amp; Security\", choose \"Network Interfaces\". <br> 3. Filter the list by the noncompliant instance IDs to see the associated ENIs. <br> 4. Select the ENIs that you want to remove. <br> 5. From the \"Actions\" menu, choose \"Detach\". <br> 6. If you see the prompt \"Are you sure that you want to detach the following network interface?\", choose \"Detach\".",
    "severity": "Low",
    "tactics": [
      "Reconnaissance",
      "Discovery"
    ],
    "techniques": [
      "Active Scanning",
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether the security groups that are in use allow unrestricted incoming traffic. Optionally the rule checks whether the port numbers are listed in the \"authorizedTcpPorts\" parameter.<br>- If the security group rule port number allows unrestricted incoming traffic, but the port number is specified in \"authorizedTcpPorts\", then the control passes. The default value for \"authorizedTcpPorts\" is <b>80, 443</b>.<br>- If the security group rule port number allows unrestricted incoming traffic, but the port number is not specified in authorizedTcpPorts input parameter, then the control fails.<br>- If the parameter is not used, then the control fails for any security group that has an unrestricted inbound rule.<br>Security groups provide stateful filtering of ingress and egress network traffic to AWS. Security group rules should follow the principal of least privileged access. Unrestricted access (IP address with a /0 suffix) increases the opportunity for malicious activity such as hacking, denial-of-service attacks, and loss of data.<br>Unless a port is specifically allowed, the port should deny unrestricted access.",
    "displayName": "Security groups should only allow unrestricted incoming traffic for authorized ports",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8b328664-f3f1-45ab-976d-f6c66647b3b8",
    "implementationEffort": null,
    "name": "8b328664-f3f1-45ab-976d-f6c66647b3b8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to modify a security group, see <a href='https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html#AddRemoveRules'>Add, remove, or update rules</a> in the Amazon VPC User Guide.",
    "severity": "High",
    "tactics": [
      "Reconnaissance",
      "Lateral Movement"
    ],
    "techniques": [
      "Active Scanning",
      "Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether unrestricted incoming traffic for the security groups is accessible to the specified ports that have the highest risk. This control passes when none of the rules in a security group allow ingress traffic from 0.0.0.0/0 for those ports.<br>Unrestricted access (0.0.0.0/0) increases opportunities for malicious activity, such as hacking, denial-of-service attacks, and loss of data.<br>Security groups provide stateful filtering of ingress and egress network traffic to AWS resources. No security group should allow unrestricted ingress access to the following ports:<br>- 3389 (RDP)<br>- 20, 21 (FTP)<br>- 22 (SSH)<br>- 23 (Telnet)<br>- 110 (POP3)<br>- 143 (IMAP)<br>- 3306 (mySQL)<br>- 8080 (proxy)<br>- 1433, 1434 (MSSQL)<br>- 9200 or 9300 (Elasticsearch)<br>- 5601 (Kibana)<br>- 25 (SMTP)<br>- 445 (CIFS)<br>- 135 (RPC)<br>- 4333 (ahsp)<br>- 5432 (postgresql)<br>- 5500 (fcp-addr-srvr1)",
    "displayName": "Security groups should not allow unrestricted access to ports with high risk",
    "id": "/providers/Microsoft.Security/assessmentMetadata/194fd099-90fa-43e1-8d06-6b4f5138e952",
    "implementationEffort": null,
    "name": "194fd099-90fa-43e1-8d06-6b4f5138e952",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to delete rules from a security group, see <a href='https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/working-with-security-groups.html#deleting-security-group-rule'>Delete rules from a security group</a> in the Amazon EC2 User Guide for Linux Instances.",
    "severity": "Medium",
    "tactics": [
      "Reconnaissance",
      "Lateral Movement"
    ],
    "techniques": [
      "Active Scanning",
      "Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether storage encryption is enabled for your Amazon RDS DB instances.<br>This control is intended for RDS DB instances. However, it can also generate findings for Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them.<br> For an added layer of security for your sensitive data in RDS DB instances, you should configure your RDS DB instances to be encrypted at rest. To encrypt your RDS DB instances and snapshots at rest, enable the encryption option for your RDS DB instances. Data that is encrypted at rest includes the underlying storage for DB instances, its automated backups, read replicas, and snapshots.<br>RDS encrypted DB instances use the open standard AES-256 encryption algorithm to encrypt your data on the server that hosts your RDS DB instances. After your data is encrypted, Amazon RDS handles authentication of access and decryption of your data transparently with a minimal impact on performance. You do not need to modify your database client applications to use encryption.<br>Amazon RDS encryption is currently available for all database engines and storage types. Amazon RDS encryption is available for most DB instance classes. To learn about DB instance classes that do not support Amazon RDS encryption, see&nbsp;<a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html'>Encrypting Amazon RDS resources</a>&nbsp;in the&nbsp;<em>Amazon RDS User Guide</em>.<br>",
    "displayName": "RDS DB instances should have encryption at rest enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bfa7d2aa-f362-11eb-9a03-0242ac130003",
    "implementationEffort": null,
    "name": "bfa7d2aa-f362-11eb-9a03-0242ac130003",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information about encrypting DB instances in Amazon RDS, see&nbsp;<a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.Encryption.html'>Encrypting Amazon RDS resources</a>&nbsp;in the&nbsp;<em>Amazon RDS User Guide</em>.",
    "severity": "Medium",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Data from Cloud Storage Object"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether RDS DB snapshots are encrypted.<br>This control is intended for RDS DB instances. However, it can also generate findings for snapshots of Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them.<br>Encrypting data at rest reduces the risk that an unauthenticated user gets access to data that is stored on disk. Data in RDS snapshots should be encrypted at rest for an added layer of security.",
    "displayName": "RDS cluster snapshots and database snapshots should be encrypted at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4f4fbc5e-0b10-4208-b52f-1f47f1c73b6a",
    "implementationEffort": null,
    "name": "4f4fbc5e-0b10-4208-b52f-1f47f1c73b6a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To encrypt an unencrypted RDS snapshot: 1. Open the &nbsp;<a href='https://console.aws.amazon.com/rds/' target='_blank' rel='noopener noreferrer'>Amazon RDS console</a>. 2. In the navigation pane, choose \"Snapshots\". 3. Find the snapshot to encrypt under \"Manual\" or \"System\". 4. Select the check box next to the snapshot to encrypt. 5. Choose \"Actions\", then choose \"Copy Snapshot\". 6. Under \"New DB Snapshot Identifier\", type a name for the new snapshot.7. Under \"Encryption\", select \"Enable Encryption\". 8. Choose the KMS key to use to encrypt the snapshot. 9. Choose \"Copy Snapshot\". 10. After the new snapshot is created, delete the original snapshot. 11. For \"Backup Retention Period\", choose a positive nonzero value. For example, 30 days.",
    "severity": "Medium",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Data from Cloud Storage Object"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether high availability is enabled for your RDS DB instances. <br> RDS DB instances should be configured for multiple Availability Zones (AZs). This ensures the availability of the data stored. Multi-AZ deployments allow for automated failover if there is an issue with Availability Zone availability and during regular RDS maintenance.",
    "displayName": "RDS DB instances should be configured with multiple Availability Zones",
    "id": "/providers/Microsoft.Security/assessmentMetadata/70ebbd01-cd79-4bc8-ae85-49f47ccdd5ad",
    "implementationEffort": null,
    "name": "70ebbd01-cd79-4bc8-ae85-49f47ccdd5ad",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To enable multiple Availability Zones for a DB instance:</b> 1. Open the Amazon RDS console at&nbsp;<a href='https://console.aws.amazon.com/rds/' target='_blank' rel='noopener noreferrer'>Amazon RDS console</a>. 2. In the navigation pane, choose \"Databases\", and then choose the DB instance that you want to modify.3. Choose \"Modify\". The \"Modify DB Instance\" page appears.4. Under&nbsp;<b>Instance Specifications</b>, set \"Multi-AZ deployment \" to \"Yes\" .5. Choose \"Continue\" and then check the summary of modifications. 6. (Optional) Choose \"Apply immediately\" to apply the changes immediately. Choosing this option can cause an outage in some cases. For more information, see&nbsp;<a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.ApplyImmediately'>Using the Apply Immediately setting</a>&nbsp;in the&nbsp;<em>Amazon RDS User Guide</em>. 7. On the confirmation page, review your changes. If they are correct, choose \"Modify DB Instance\" to save your changes.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether enhanced monitoring is enabled for your RDS DB instances.<br>In Amazon RDS, Enhanced Monitoring enables a more rapid response to performance changes in underlying infrastructure. These performance changes could result in a lack of availability of the data. Enhanced Monitoring provides real-time metrics of the operating system that your RDS DB instance runs on. An agent is installed on the instance. The agent can obtain metrics more accurately than is possible from the hypervisor layer.<br>Enhanced Monitoring metrics are useful when you want to see how different processes or threads on a DB instance use the CPU. For more information, see&nbsp;<a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html'>Enhanced Monitoring</a>&nbsp;in the&nbsp;<em>Amazon RDS User Guide</em>.",
    "displayName": "Enhanced monitoring should be configured for RDS DB instances and clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/93e5a579-dd2f-4a56-b827-ebbfe7376b16",
    "implementationEffort": null,
    "name": "93e5a579-dd2f-4a56-b827-ebbfe7376b16",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on how to enable Enhanced Monitoring for your DB instance, see&nbsp;<a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Monitoring.OS.html#USER_Monitoring.OS.Enabling'>Setting up for and enabling Enhanced Monitoring</a>&nbsp;in the&nbsp;<em>Amazon RDS User Guide</em>.",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether RDS clusters have deletion protection enabled.<br>This control is intended for RDS DB instances. However, it can also generate findings for Aurora DB instances, Neptune DB instances, and Amazon DocumentDB clusters. If these findings are not useful, then you can suppress them.<br>Enabling cluster deletion protection is an additional layer of protection against accidental database deletion or deletion by an unauthorized entity.<br>When deletion protection is enabled, an RDS cluster cannot be deleted. Before a deletion request can succeed, deletion protection must be disabled.",
    "displayName": "RDS clusters should have deletion protection enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9e769650-868c-46f5-b8c0-1a8ba12a4c92",
    "implementationEffort": null,
    "name": "9e769650-868c-46f5-b8c0-1a8ba12a4c92",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To enable deletion protection for an RDS DB cluster:</b><br> 1. Open the Amazon RDS console at&nbsp;<a href='https://console.aws.amazon.com/rds/' target='_blank' rel='noopener noreferrer'>https://console.aws.amazon.com/rds/</a>. 2. In the navigation pane, choose \"Databases\", then choose the DB cluster that you want to modify. 3. Choose \"Modify\". 4. Under \"Deletion protection\", choose \"Enable deletion protection\".5. Choose \"Continue\" 6. Under \"Scheduling of modifications\", choose when to apply modifications. The options are \"Apply during the next scheduled maintenance window\" or \"Apply immediately\". 7. Choose \"Modify Cluster\".",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether your RDS DB instances that use one of the listed database engines have deletion protection enabled.<br>Enabling instance deletion protection is an additional layer of protection against accidental database deletion or deletion by an unauthorized entity.<br>While deletion protection is enabled, an RDS DB instance cannot be deleted. Before a deletion request can succeed, deletion protection must be disabled.",
    "displayName": "RDS DB instances should have deletion protection enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8e1f7933-faa9-4379-a9bd-697740dedac8",
    "implementationEffort": null,
    "name": "8e1f7933-faa9-4379-a9bd-697740dedac8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To enable deletion protection for an RDS DB instance:</b> 1. Open the Amazon RDS console at&nbsp;<a href='https://console.aws.amazon.com/rds/' target='_blank' rel='noopener noreferrer'>https://console.aws.amazon.com/rds/</a>. 2. In the navigation pane, choose \"Databases\", then choose the DB instance that you want to modify. 3. Choose \"Modify\". 4. Under \"Deletion protection\", choose \"Enable deletion protection\". 5. Choose \"Continue\". 6. Under \"Scheduling of modifications\", choose when to apply modifications. The options are \"Apply during the next scheduled maintenance window\" or \"Apply immediately\". 7. Choose \"Modify DB Instance\"",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "<p>This control checks whether high availability is enabled for your RDS DB clusters. The control fails if an RDS DB cluster isn't deployed in multiple Availability Zones (AZs).</p><p>RDS DB clusters should be configured for multiple AZs to ensure availability of stored data. Deployment to multiple AZs allows for automated failover in the event of an AZ availability issue and during regular RDS maintenance events.</p>",
    "displayName": "RDS DB clusters should be configured for multiple Availability Zones",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cdf441dd-0ab7-4ef2-a643-de12725e5d5d",
    "implementationEffort": null,
    "name": "cdf441dd-0ab7-4ef2-a643-de12725e5d5d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To enable multi-AZ for a DB cluster (console)</b><br>1. Open the Amazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a>.<br>2. In the navigation pane, choose \"Databases\", and then choose the DB instance to modify. <br>3. choose \"Modify\", The \"Modify DB Instance\" page appears. <br> 4. Under \"Instance Specifications\", set \"Multi-AZ deploymen\" to \"Yes\".<br>5. Choose \"Continue\" and check the summary of modifications.<br> 6. (Optional) Choose \"Apply immediately\" to apply the changes immediately. Choosing this option can cause an outage in some cases. For more information, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.ApplyImmediately'>Using the Apply Immediately setting </a> in the Amazon RDS User Guide. <br>On the confirmation page, review your changes. If they are correct, choose \"Modify DB Instance\".",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Identification and inventory of your IT assets is a crucial aspect of governance and security.<br> You need to have visibility of all your RDS DB clusters so that you can assess their security posture and act on potential areas of weakness.<br> Snapshots should be tagged in the same way as their parent RDS database clusters.<br> Enabling this setting ensures that snapshots inherit the tags of their parent database clusters.",
    "displayName": "Aurora DB clusters should be configured to copy tags to DB snapshots",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b9ed02d0-afca-4bed-838d-70bf31ecf19a",
    "implementationEffort": null,
    "name": "b9ed02d0-afca-4bed-838d-70bf31ecf19a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To enable automatic tag copying to snapshots for a DB cluster</b><br>1. Open theAmazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a>.<br>2. Choose \"Databases\" <br>3. Select the DB cluster to modify.<br>4. choose \"Modify\". <br> 5. Under \"Backup\", select \"Copy tags to snapshots\".<br>6. Choose \"Continue\".<br>7. Under \"Scheduling of modifications\", choose when to apply modifications. You can choose either \"Apply during the next scheduled maintenance window\" or \"Apply immediately\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether RDS DB instances are configured to copy all tags to snapshots when the snapshots are created.<br>Identification and inventory of your IT assets is a crucial aspect of governance and security.<br> You need to have visibility of all your RDS DB instances so that you can assess their security posture and take action on potential areas of weakness.<br> Snapshots should be tagged in the same way as their parent RDS database instances. Enabling this setting ensures that snapshots inherit the tags of their parent database instances.",
    "displayName": "RDS DB instances should be configured to copy tags to snapshots",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fcd891e5-c6a2-41ce-bca6-f49ec582f3ce",
    "implementationEffort": null,
    "name": "fcd891e5-c6a2-41ce-bca6-f49ec582f3ce",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To enable automatic tag copying to snapshots for a DB instance</b><br>1. Open the Amazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a>.<br>2. In the navigation pane, choose \"Databases\". <br>3. Select the DB instance to modify. <br> 4. Under \"Backup\", select \"Copy tags to snapshots\".<br>5. Choose \"Continue\".<br>6. Under \"Scheduling of modifications\", choose when to apply modifications. You can choose either \"Apply during the next scheduled maintenance window\" or \"Apply immediately\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "VPCs provide a number of network controls to secure access to RDS resources.<br> These controls include VPC Endpoints, network ACLs, and security groups.<br> To take advantage of these controls, we recommend that you move EC2-Classic RDS instances to EC2-VPC.",
    "displayName": "RDS instances should be deployed in a VPC",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9a84b879-8aab-4b82-80f2-22e637a26813",
    "implementationEffort": null,
    "name": "9a84b879-8aab-4b82-80f2-22e637a26813",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on how to move RDS instances to VPC, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_VPC.html#USER_VPC.VPC2VPC'>Updating the VPC for a DB instance</a> in the Amazon RDS User Guide.",
    "severity": "Low",
    "tactics": [
      "Discovery",
      "Lateral Movement"
    ],
    "techniques": [
      "Cloud Service Discovery",
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Amazon RDS event subscription exists that has notifications enabled for the following source type,<br> event category key-value pairs. DBCluster: [\"maintenance\" and \"failure\"].<br> RDS event notifications uses Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for rapid response.<br> For additional information about RDS event notifications, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html'>Using Amazon RDS event notification in the Amazon RDS User Guide.",
    "displayName": "An RDS event notifications subscription should be configured for critical cluster events",
    "id": "/providers/Microsoft.Security/assessmentMetadata/65659c22-6588-405b-b118-614c2b4ead5b",
    "implementationEffort": null,
    "name": "65659c22-6588-405b-b118-614c2b4ead5b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": " To subscribe to RDS cluster event notifications. <br>1. Open the Amazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a>.<br>2. In the navigation pane, choose \"Event subscriptions\". <br>3. Under \"Event subscriptions\" choose \"Create event subscription\". <br> 4. In the \"Create event subscription\" dialog, do the following: <br>&nbsp;&nbsp;a. For \"Name\", enter a name for the event notification subscription. <br>&nbsp;&nbsp;b. For \"Send notifications to\", choose an existing Amazon SNS ARN for an SNS topic, To use a new topic, choose \"create topic\" to enter the name of a topic and a list of recipients. <br>&nbsp;&nbsp;c. For \"Source type\", choose \"Clusters\".<br>&nbsp;&nbsp;d. Under \"Instances to include\", select \"All Clusters\".<br>&nbsp;&nbsp;e. Under \"Event categories to include\", select \"Specific event categories\".The control also passes if you select \"All event categories\".<br>&nbsp;&nbsp;f.  Select \"maintenance\" and \"failure\".<br>&nbsp;&nbsp;g. Choose \"Create\".",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type.<br> event category key-value pairs. DBInstance: [\"maintenance\", \"configuration change\" and \"failure\"].<br>RDS event notifications use Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for rapid response.<br> For additional information about RDS event notifications, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html'>Using Amazon RDS event notification</a> in the Amazon RDS User Guide.",
    "displayName": "An RDS event notifications subscription should be configured for critical database instance events",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ff4f3ab3-8ed7-4b4f-a721-4c3b66a59140",
    "implementationEffort": null,
    "name": "ff4f3ab3-8ed7-4b4f-a721-4c3b66a59140",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To subscribe to RDS cluster event notifications (console)</b><br>1. Open the Amazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a>.<br>2. In the navigation pane, choose \"Event subscriptions\". <br>3. Under \"Event subscriptions\" choose \"Create event subscription\". <br> 4. In the \"Create event subscription\" dialog, do the following: <br>&nbsp;&nbsp;a. For \"Name\", enter a name for the event notification subscription. <br>&nbsp;&nbsp;b. For \"Send notifications to\", choose an existing Amazon SNS ARN for an SNS topic, To use a new topic, choose \"create topic\" to enter the name of a topic and a list of recipients. <br>&nbsp;&nbsp;c. For \"Source type\", choose \"Instances\".<br>&nbsp;&nbsp;d. Under \"Instances to include\", select \"All Instances\".<br>&nbsp;&nbsp;e. Under \"Event categories to include\", select \"Specific event categories\".The control also passes if you select \"All event categories\".<br>&nbsp;&nbsp;f.  Select \"maintenance\", \"configuration change\" and \"failure\".<br>&nbsp;&nbsp;g. Choose \"Create\".",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type.<br> event category key-value pairs. DBParameterGroup: [\"configuration\",\"change\"].<br> RDS event notifications use Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for rapid response.<br> For additional information about RDS event notifications, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html'>Using Amazon RDS event notification</a> in the Amazon RDS User Guide.",
    "displayName": "An RDS event notifications subscription should be configured for critical database parameter group events",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c6f24bb0-b696-451c-a26e-0cc9ea8e97e3",
    "implementationEffort": null,
    "name": "c6f24bb0-b696-451c-a26e-0cc9ea8e97e3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To subscribe to RDS cluster event notifications (console)</b><br>1. Open the Amazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a>.<br>2. In the navigation pane, choose \"Event subscriptions\". <br>3. Under \"Event subscriptions\" choose \"Create event subscription\". <br> 4. In the \"Create event subscription\" dialog, do the following: <br>&nbsp;&nbsp;a. For \"Name\", enter a name for the event notification subscription. <br>&nbsp;&nbsp;b. For \"Send notifications to\", choose an existing Amazon SNS ARN for an SNS topic, To use a new topic, choose \"create \" to enter the name of a topic and a list of recipients. <br>&nbsp;&nbsp;c. For \"Source type\", choose \"Parameter groups\".<br>&nbsp;&nbsp;d. Under \"Instances to include\", select \"All parameter groups\".<br>&nbsp;&nbsp;e. Under \"Event categories to include\", select \"Specific event categories\".The control also passes if you select \"All event categories\".<br>&nbsp;&nbsp;f.  Select \"configuration change\".<br>&nbsp;&nbsp;g. Choose \"Create\".",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Amazon RDS event subscription exists with notifications enabled for the following source type, event category key-value pairs.DBSecurityGroup: [\"configuration\",\"change\",\"failure\"].<br> RDS event notifications use Amazon SNS to make you aware of changes in the availability or configuration of your RDS resources. These notifications allow for a rapid response.<br> For additional information about RDS event notifications , see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/USER_Events.html'>Using Amazon RDS event notification</a> in the Amazon RDS User Guide.",
    "displayName": "An RDS event notifications subscription should be configured for critical database security group events",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ab5c51fb-ecdb-46de-b8df-c28ae46ce5bc",
    "implementationEffort": null,
    "name": "ab5c51fb-ecdb-46de-b8df-c28ae46ce5bc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To subscribe to RDS cluster event notifications (console)</b><br>1. Open the Amazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a>.<br>2. In the navigation pane, choose \"Event\",\"subscriptions\". <br>3. Under \"Event subscriptions\" choose \"Create event subscription\". <br> 4. In the \"Create event subscription\" dialog, do the following: <br>&nbsp;&nbsp;a. For \"Name\", enter a name for the event notification subscription. <br>&nbsp;&nbsp;b. For \"Send notifications to\", choose an existing Amazon SNS ARN for an SNS topic, To use a new topic, choose \"create topic\" to enter the name of a topic and a list of recipients. <br>&nbsp;&nbsp;c. For \"Source type\", choose \"Security groups\".<br>&nbsp;&nbsp;d. Under \"Instances to include\", select \"All security groups\".<br>&nbsp;&nbsp;e. Under \"Event categories to include\", select \"Specific event categories\".The control also passes if you select \"All event categories\".<br>&nbsp;&nbsp;f.  Select \"configuration change\" and \"failure\".<br>&nbsp;&nbsp;g. Choose \"Create\".",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether an Amazon DynamoDB table can scale its read and write capacity as needed. This control passes if the table uses either on-demand capacity mode or provisioned mode with auto scaling configured. <br> Scaling capacity with demand avoids throttling exceptions, which helps to maintain availability of your applications.",
    "displayName": "DynamoDB tables should automatically scale capacity with demand",
    "id": "/providers/Microsoft.Security/assessmentMetadata/47476790-2527-4bdb-b839-3b48ed18dccf",
    "implementationEffort": null,
    "name": "47476790-2527-4bdb-b839-3b48ed18dccf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on enabling DynamoDB automatic scaling on existing tables in capacity mode, see <a href='https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/AutoScaling.Console.html#AutoScaling.Console.ExistingTable'>Enabling DynamoDB auto scaling on existing tables.</a> in the Amazon DynamoDB Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether point-in-time recovery (PITR) is enabled for an Amazon DynamoDB table. <br> Backups help you to recover more quickly from a security incident. They also strengthen the resilience of your systems. DynamoDB point-in-time recovery automates backups for DynamoDB tables. It reduces the time to recover from accidental delete or write operations. <br> DynamoDB tables that have PITR enabled can be restored to any point in time in the last 35 days.",
    "displayName": "DynamoDB tables should have point-in-time recovery enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cc873508-40c1-41b6-8507-8a431d74f831",
    "implementationEffort": null,
    "name": "cc873508-40c1-41b6-8507-8a431d74f831",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, add point-in-time recovery to your DynamoDB table.<br> To enable DynamoDB \"point-in-time recovery\" for an existing table: <br> 1. Open the DynamoDB console at https://console.aws.amazon.com/dynamodb/. 2. Choose the table that you want to work with, and then choose \"Backups\". 3. In the Point-in-time Recovery section, under Status, choose \"Enable\". 4. Choose \"Enable\" again to confirm the change.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether a DAX cluster is encrypted at rest. <br> Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. The encryption adds another set of access controls to limit the ability of unauthorized users to access to the data. <br> For example, API permissions are required to decrypt the data before it can be read.",
    "displayName": "DynamoDB Accelerator (DAX) clusters should be encrypted at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/58e67d3d-8b17-4c1c-9bc4-550b10f0328a",
    "implementationEffort": null,
    "name": "58e67d3d-8b17-4c1c-9bc4-550b10f0328a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You cannot enable or disable encryption at rest after a cluster is created. You must recreate the cluster in order to enable encryption at rest. <br> For detailed instructions on how to create a DAX cluster with encryption at rest enabled, see <a href='https://docs.aws.amazon.com/amazondynamodb/latest/developerguide/DAXEncryptionAtRest.html#dax.encryption.tutorial-console'>Enabling encryption at rest using the AWS Management Console</a> in the Amazon DynamoDB Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Data from Cloud Storage Object"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether Amazon Elastic File System is configured to encrypt the file data using AWS KMS. The check fails in the following cases: <br> *\"Encrypted\" is set to \"false\" in the <a href='https://docs.aws.amazon.com/efs/latest/ug/API_DescribeFileSystems.html'>DescribeFileSystems</a> response. <br> The \"KmsKeyId\" key in the <a href='https://docs.aws.amazon.com/efs/latest/ug/API_DescribeFileSystems.html'>DescribeFileSystems</a> response does not match the KmsKeyId parameter for <a href='https://docs.aws.amazon.com/config/latest/developerguide/efs-encrypted-check.html'>efs-encrypted-check</a>. <br> Note that this control does not use the \"KmsKeyId\" parameter for <a href='https://docs.aws.amazon.com/config/latest/developerguide/efs-encrypted-check.html'>efs-encrypted-check</a>. It only checks the value of \"Encrypted\". For an added layer of security for your sensitive data in Amazon EFS, you should create encrypted file systems. <br> Amazon EFS supports encryption for file systems at-rest. You can enable encryption of data at rest when you create an Amazon EFS file system. <br> To learn more about Amazon EFS encryption, see <a href='https://docs.aws.amazon.com/efs/latest/ug/encryption.html'>Data encryption in Amazon EFS</a> in the Amazon Elastic File System User Guide.",
    "displayName": "Amazon EFS should be configured to encrypt file data at rest using AWS KMS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4e482075-311f-401e-adc7-f8a8affc5635",
    "implementationEffort": null,
    "name": "4e482075-311f-401e-adc7-f8a8affc5635",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For details on how to encrypt a new Amazon EFS file system, see <a href='https://docs.aws.amazon.com/efs/latest/ug/encryption-at-rest.html'>Encrypting data at rest</a> in the Amazon Elastic File System User Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether Amazon Elastic File System (Amazon EFS) file systems are added to the backup plans in AWS Backup. The control fails if Amazon EFS file systems are not included in the backup plans. <br> Including EFS file systems in the backup plans helps you to protect your data from deletion and data loss.",
    "displayName": "Amazon EFS volumes should be in backup plans",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e864e460-158b-4a4a-beb9-16ebc25c1240",
    "implementationEffort": null,
    "name": "e864e460-158b-4a4a-beb9-16ebc25c1240",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update your file system to enable automatic backups.<br> <b>To enable automatic backups for an existing file system:<b> <br> 1.Open the <a href='https://console.aws.amazon.com/efs/'>Amazon Elastic File System console</a>. 2. On the \"File systems\" page, choose the file system for which to enable automatic backups. The \"File system details\" page is displayed. 3. Under \"General\", choose \"Edit\". 4. To enable automatic backups, select \"Enable automatic backups\". 5. Choose \"Save changes\". <br> To learn more, visit <a href='https://docs.aws.amazon.com/efs/latest/ug/awsbackup.html'>Using AWS Backup with Amazon EFS </a> in the Amazon Elastic File System User Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud identified that the Lambda function is using an outdated layer version. This poses a risk of exposure to known vulnerabilities. Keeping layers up to date ensures the function benefits from the latest security patches and improvements.",
    "displayName": "Lambda functions should use supported runtimes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e656e5b7-130c-4fb4-be90-9bdd4f82fdfb",
    "implementationEffort": null,
    "name": "e656e5b7-130c-4fb4-be90-9bdd4f82fdfb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For more information on supported runtimes and deprecation schedules, see the <a href='https://docs.aws.amazon.com/lambda/latest/dg/runtime-support-policy.html'>Runtime support policy</a> section of the AWS Lambda Developer Guide. <br> When you migrate your runtimes to the latest version, follow the syntax and guidance from the publishers of the language.",
    "severity": "Medium",
    "tactics": [
      "Command and Control",
      "Persistence",
      "Execution"
    ],
    "techniques": [
      "Proxy",
      "Account Manipulation",
      "Scheduled Task/Job"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an SNS topic is encrypted at rest using AWS KMS.<br>Encrypting data at rest reduces the risk of data stored on disk being accessed by a user not authenticated to AWS. It also adds another set of access controls to limit the ability of unauthorized users to access the data. <br> For example, API permissions are required to decrypt the data before it can be read. SNS topics should be encrypted at-rest for an added layer of security. For more information, see <a href='https://docs.aws.amazon.com/sns/latest/dg/sns-server-side-encryption.html'>Encryption at rest</a> in the Amazon Simple Notification Service Developer Guide.",
    "displayName": "SNS topics should be encrypted at rest using AWS KMS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/90917e06-2781-4857-9d74-9043c6475d03",
    "implementationEffort": null,
    "name": "90917e06-2781-4857-9d74-9043c6475d03",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update your SNS topic to enable encryption.<br><b>To encrypt an unencrypted SNS topic</b><br>1. Open the <a href='https://console.aws.amazon.com/sns/v3/home'>Amazon SNS console</a>.<br>2. In the navigation pane, choose \"Topics\".<br>4. Choose the name of the topic to encrypt.<br>5. Choose \"Edit\".<br>6. Under \"Encryption\", choose Enable Encryption.<br>7. Choose the KMS key to use to encrypt the topic.<br>8. Choose \"Save changes\".",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "File and Directory Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether your Classic Load Balancer listeners are configured with HTTPS or TLS protocol for front-end (client to load balancer) connections. The control is applicable if a Classic Load Balancer has listeners. If your Classic Load Balancer does not have a listener configured, then the control does not report any findings.<br>The control passes if the Classic Load Balancer listeners are configured with TLS or HTTPS for front-end connections.<br>The control fails if the listener is not configured with TLS or HTTPS for front-end connections.<br>Before you start to use a load balancer, you must add one or more listeners. A listener is a process that uses the configured protocol and port to check for connection requests. Listeners can support both HTTP and HTTPS/TLS protocols. You should always use an HTTPS or TLS listener, so that the load balancer does the work of encryption and decryption in transit.",
    "displayName": "Classic Load Balancer listeners should be configured with HTTPS or TLS termination",
    "id": "/providers/Microsoft.Security/assessmentMetadata/773667f7-6511-4aec-ae9c-e3286c56a254",
    "implementationEffort": null,
    "name": "773667f7-6511-4aec-ae9c-e3286c56a254",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update your listeners to use the TLS or HTTPS protocol. <br>To change all noncompliant listeners to TLS/HTTPS listeners <br>1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a>. <br>2. In the navigation pane, choose <b>Load Balancers</b>. Then choose your Classic Load Balancer. <br>3. Choose the <b>Listeners</b> tab, and then choose <b>Edit</b>. <br>4. For all listeners where Load Balancer Protocol is not set to HTTPS or SSL, change the setting to HTTPS or SSL. <br>5. For all modified listeners, under <b>SSL Certificate</b>, choose <b>Change</b>. <br>6. For all modified listeners, select <b>Choose a certificate from ACM</b>. <br>7. Select the certificate from the <b>Certificates</b> drop-down list. Then choose <b>Saveb</b>. <br>8. After you update all of the listeners, choose <b>Save</b>.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control evaluates AWS Application Load Balancers (ALB) to ensure they are configured to drop invalid HTTP headers. The control fails if the value of routing.http.drop_invalid_header_fields.enabled is set to false.<br>By default, ALBs are not configured to drop invalid HTTP header values. Removing these header values prevents HTTP desync attacks.",
    "displayName": "Application load balancers should be configured to drop HTTP headers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ca924610-5a8e-4c5e-9f17-8dff1ab1757b",
    "implementationEffort": null,
    "name": "ca924610-5a8e-4c5e-9f17-8dff1ab1757b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, configure your load balancer to drop invalid header fields. <br>To configure the load balancer to drop invalid header fields <br>1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a>. <br>2. In the navigation pane, choose <b>Load balancers</b>. <br>3. Choose an Application Load Balancer. <br>4. From <b>Actions</b>, choose <b>Edit attributes</b>. <br>5. Under <b>Drop Invalid Header Fields</b>, choose <b>Enable</b>. <br>6. Choose <b>Save</b>",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Credential Access"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether the Application Load Balancer and the Classic Load Balancer have logging enabled. The control fails if access_logs.s3.enabled is false. <br>Elastic Load Balancing provides access logs that capture detailed information about requests sent to your load balancer. Each log contains information such as the time the request was received, the client's IP address, latencies, request paths, and server responses. You can use these access logs to analyze traffic patterns and to troubleshoot issues. <br>To learn more, see <a href='https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/access-log-collection.html'>Access logs for your Classic Load Balancer</a> in User Guide for Classic Load Balancers. <br>",
    "displayName": "Application and Classic Load Balancers logging should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4ba5c359-495f-4ba6-9897-7fdbc0aed675",
    "implementationEffort": null,
    "name": "4ba5c359-495f-4ba6-9897-7fdbc0aed675",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, configure your load balancer to drop invalid header fields. <br>To configure the load balancer to drop invalid header fields <br>1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a>. <br>2. In the navigation pane, choose <b>Load balancers</b>. <br>3. Choose an Application Load Balancer. <br>4. From <b>Actions</b>, choose <b>Edit attributes</b>. <br>5. Under <b>Access logs</b>, choose <b>Enable</b>. <br>6. Enter your S3 location. This location can exist or it can be created for you. If you do not specify a prefix, the access logs are stored in the root of the S3 bucket. <br>7. Choose <b>Save</b>",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether an Application Load Balancer has deletion protection enabled. The control fails if deletion protection is not configured. <br>Enable deletion protection to protect your Application Load Balancer from deletion.",
    "displayName": "Application Load Balancer deletion protection should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5c508bf1-26f9-4696-bb61-8341d395e3de",
    "implementationEffort": null,
    "name": "5c508bf1-26f9-4696-bb61-8341d395e3de",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To prevent your load balancer from being deleted accidentally, you can enable deletion protection. By default, deletion protection is disabled for your load balancer. <br>If you enable deletion protection for your load balancer, you must disable delete protection before you can delete the load balancer. <br>To enable deletion protection from the console <br>1. Open the <a href='https://console.aws.amazon.com/ec2/'>Amazon EC2 console</a>. <br>2. On the navigation pane, under <b>LOAD BALANCING</b>, choose <b>Load Balancers</b>. <br>3. Choose the load balancer. <br>4. On the <b>Description</b> tab, choose <b>Edit attributes</b>. <br>5. On the <b>Edit load balancer attributes</b> page, select <b>Enable for Delete Protection</b>, and then choose <b>Save</b>. <br>6. Choose <b>Save</b>. <br>To learn more, see <a href='https://docs.aws.amazon.com/elasticloadbalancing/latest/application/application-load-balancers.html#deletion-protection'>Deletion protection</a> in User Guide for Application Load Balancers.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Classic Load Balancers have connection draining enabled.<br>Enabling connection draining on Classic Load Balancers ensures that the load balancer stops sending requests to instances that are de-registering or unhealthy. It keeps the existing connections open. This is particularly useful for instances in Auto Scaling groups, to ensure that connections aren't severed abruptly.",
    "displayName": "Classic Load Balancers should have connection draining enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dd60e31e-073a-42b6-9b23-db7ca86fd5e0",
    "implementationEffort": null,
    "name": "dd60e31e-073a-42b6-9b23-db7ca86fd5e0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable connection draining on Classic Load Balancers, following the steps in <a href='https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/config-conn-drain.html'>Configure connection draining for your Classic Load Balancer</a> in User Guide for Classic Load Balancers.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Amazon ES domains have node-to-node encryption enabled. HTTPS (TLS) can be used to help prevent potential attackers from eavesdropping on or manipulating network traffic using person-in-the-middle or similar attacks. Only encrypted connections over HTTPS (TLS) should be allowed. Enabling node-to-node encryption for Amazon ES domains ensures that intra-cluster communications are encrypted in transit. There can be a performance penalty associated with this configuration. You should be aware of and test the performance trade-off before enabling this option.",
    "displayName": "Amazon Elasticsearch Service domains should encrypt data sent between nodes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9b63a099-6c0c-4354-848b-17de1f3c8ae3",
    "implementationEffort": null,
    "name": "9b63a099-6c0c-4354-848b-17de1f3c8ae3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Node-to-node encryption can only be enabled on a new domain. To remediate this finding, first <a href=\"https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-createupdatedomains.html#es-createdomains\">create a new domain</a> with the <b>Node-to-node encryption</b> check box selected. Then follow <a href=\"https://docs.aws.amazon.com/elasticsearch-service/latest/developerguide/es-version-migration.html#snapshot-based-migration\">Using a snapshot to migrate data</a> to migrate your data to the new domain.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Implementing least privilege access is fundamental to reducing security risk and the impact of errors or malicious intent. If an S3 bucket policy allows access from external accounts, it could result in data exfiltration by an insider threat or an attacker. The 'blacklistedactionpatterns' parameter allows for successful evaluation of the rule for S3 buckets. The parameter grants access to external accounts for action patterns that are not included in the 'blacklistedactionpatterns' list.",
    "displayName": "Amazon S3 permissions granted to other AWS accounts in bucket policies should be restricted",
    "id": "/providers/Microsoft.Security/assessmentMetadata/de8ae504-ec39-4ffb-b3ef-6e36fdcbb455",
    "implementationEffort": null,
    "name": "de8ae504-ec39-4ffb-b3ef-6e36fdcbb455",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, edit the S3 bucket policy to remove the permissions.<br /><br /><b>To edit an S3 bucket policy<br /></b><br />1. Open the <a href=\"https://console.aws.amazon.com/s3/\">Amazon S3 console</a>.<b><br /></b>2. In the <b>Bucket name</b>&nbsp;list, choose the name of the S3 bucket for which you want to edit the policy.<br />3. Choose <b>Permissions</b>, and then choose&nbsp;<b>Bucket Policy</b>.<br />4. In the <b>Bucket policy editor</b> text box, do one of the following:<br />* Remove the statements that grant access to denied actions to other AWS accounts<br />* Remove the permitted denied actions from the statements<br />5. Choose <b>Save</b>.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Microsoft Defender for Containers provides real-time threat protection for containerized environments and generates alerts about suspicious activities.<br>Use this information to harden the security of Kubernetes clusters and remediate security issues.<br><br>Important: When you've enabled Microsoft Defender for Containers and deployed Azure Arc to your EKS clusters, the protections - and charges - will begin. If you don't deploy Azure Arc on a cluster, Defender for Containers will not protect it and no charges will be incurred for this Microsoft Defender plan for that cluster.",
    "displayName": "Microsoft Defender for Containers should be enabled on AWS connectors",
    "id": "/providers/Microsoft.Security/assessmentMetadata/11d0f4af-6924-4a2e-8b66-781a4553c828",
    "implementationEffort": null,
    "name": "11d0f4af-6924-4a2e-8b66-781a4553c828",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/30/2021"
    },
    "remediationDescription": "To enable Defender for Containers on all EKS clusters in an AWS account connected to Microsoft Defender for Cloud:<br>1. From the Azure portal, open Microsoft Defender for Cloud.<br>2. Open the \"Environment settings\" page and select the relevant AWS account.<br>3. Under \"Select plans\", set \"Containers\" to \"On\".<br>4. Select \"Next: Configure access\" and follow the instructions.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Microsoft Defender's <a href=\"https://docs.microsoft.com/azure/azure-arc/kubernetes/extensions\">cluster extension</a> provides security capabilities for your EKS clusters. The extension collects data from a cluster and its nodes to identify security vulnerabilities and threats. <br> The extension works with <a href=\"https://docs.microsoft.com/azure/azure-arc/kubernetes/overview\">Azure Arc-enabled Kubernetes</a>. <br>Learn more about <a href=\"https://docs.microsoft.com/en-us/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks\">Microsoft Defender for Cloud's security features for containerized environments</a>.",
    "displayName": "EKS clusters should have Microsoft Defender's extension for Azure Arc installed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/38307993-84fb-4636-8ce7-3a64466bb5cc",
    "implementationEffort": null,
    "name": "38307993-84fb-4636-8ce7-3a64466bb5cc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/30/2021"
    },
    "remediationDescription": "<ol><li> Go to Microsoft Defender for Cloud <a href=\"https://ms.portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/EnvironmentSettings\">Environment settings</a>. <br></li> <li> Select the AWS environment which represents the cluster. <br> </li> <li> Enable <b>Auto provision Defender's sensor for Azure Arc</b> toggle in the <b>Containers</b> plan settings <br> </li> <li> Follow the onboarding steps to grant the necessary permissions for provisioning the defender sensor on the EKS cluster. </li> </ol> Note: When the process completes, it may take up to 6 hours until your resource moves to the 'healthy resources' tab.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Microsoft Defender for Containers provides protections for your EKS clusters. <br> To monitor your cluster for security vulnerabilities and threats, Defender for Containers needs permissions for your AWS account. These permissions will be used to enable Kubernetes control plane logging on your cluster and establish a reliable pipeline between your cluster and Defender for Cloud's backend in the cloud. <br> Learn more about <a href=\"https://docs.microsoft.com/azure/security-center/defender-for-kubernetes-introduction\">Microsoft Defender for Cloud's security features for containerized environments</a>.",
    "displayName": "EKS clusters should grant the required AWS permissions to Microsoft Defender for Cloud",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7d3a977e-46f1-419a-9046-4bd44db80aac",
    "implementationEffort": null,
    "name": "7d3a977e-46f1-419a-9046-4bd44db80aac",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/30/2021"
    },
    "remediationDescription": "To grant the required permissions: <br> <ol><li>From the Azure portal, open Microsoft Defender for Cloud.</li><li>2. Open the \"Environment settings\" page and select the relevant AWS account.</li><li>In the edit connector wizard, skip to step 3, \"Configure access\".</li><li>Download the CloudFormation template.</li><li>Open the template and copy the ARNs for the following roles: <br> AzureDefenderKubernetesRole <br> AzureDefenderKubernetesScubaReaderRole <br> AzureDefenderCloudWatchToKinesisRole <br> AzureDefenderKinesisToS3Role</li><li>Folow the steps in \"Create Stack in AWS\" for those roles.</li><li>In the connector wizard, update the role ARNs with the ARNs copied from the template.</li><li>Save the changes.</li></ol>",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether a secret stored in AWS Secrets Manager is configured with automatic rotation.<br>Secrets Manager helps you improve the security posture of your organization. Secrets include database credentials, passwords, and third-party API keys. You can use Secrets Manager to store secrets centrally, encrypt secrets automatically, control access to secrets, and rotate secrets safely and automatically.<br>Secrets Manager can rotate secrets. You can use rotation to replace long-term secrets with short-term ones. Rotating your secrets limits how long an unauthorized user can use a compromised secret. For this reason, you should rotate your secrets frequently. To learn more about rotation, see <a href='https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html'>Rotating your AWS Secrets Manager secrets</a> in the AWS Secrets Manager User Guide.",
    "displayName": "Secrets Manager secrets should have automatic rotation enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4aa0f6dc-40be-43b2-92f1-3a52ad9d68d1",
    "implementationEffort": null,
    "name": "4aa0f6dc-40be-43b2-92f1-3a52ad9d68d1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, you enable automatic rotation for your secrets.<br><b>To enable automatic rotation for secrets</b><br>1. Open the <a href='https://console.aws.amazon.com/secretsmanager/'>Secrets Manager console</a>.<br>2. To find the secret that requires rotating, enter the secret name in the search field.<br>3. Choose the secret you want to rotate, which displays the secrets details page.<br>4. Under <b>Rotation configuration</b>, choose <b>Edit rotation</b>.<br>5. From <b>Edit rotation configuration</b>, choose <b>Enable automatic rotation</b>.<br>6. For <b>Select Rotation Interval</b>, choose a rotation interval.<br>7. Choose a Lambda function for rotation. For information about customizing your Lambda rotation function, see <a href='https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets-lambda-function-customizing.html'>Understanding and customizing your Lambda rotation function</a> in the AWS Secrets Manager User Guide.<br>8. To configure the secret for rotation, choose <b>Next</b>.<br>To learn more about Secrets Manager rotation, see Rotating your AWS Secrets Manager secrets in the AWS Secrets Manager User Guide.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an AWS Secrets Manager secret rotated successfully based on the rotation schedule. The control fails if <b>RotationOccurringAsScheduled</b> is <b>false</b>. The control does not evaluate secrets that do not have rotation configured.<br>Secrets Manager helps you improve the security posture of your organization. Secrets include database credentials, passwords, and third-party API keys. You can use Secrets Manager to store secrets centrally, encrypt secrets automatically, control access to secrets, and rotate secrets safely and automatically.<br>Secrets Manager can rotate secrets. You can use rotation to replace long-term secrets with short-term ones. Rotating your secrets limits how long an unauthorized user can use a compromised secret. For this reason, you should rotate your secrets frequently.<br>In addition to configuring secrets to rotate automatically, you should ensure that those secrets rotate successfully based on the rotation schedule.<br>To learn more about rotation, see <a href='https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html'>Rotating your AWS Secrets Manager secrets</a> in the AWS Secrets Manager User Guide.",
    "displayName": "Secrets Manager secrets configured with automatic rotation should rotate successfully",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bec42e2d-956b-4940-a37d-7c1b1e8c525f",
    "implementationEffort": null,
    "name": "bec42e2d-956b-4940-a37d-7c1b1e8c525f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "If the automatic rotation fails, then Secrets Manager might have encountered errors with the configuration.<br>To rotate secrets in Secrets Manager, you use a Lambda function that defines how to interact with the database or service that owns the secret.<br>For help on how to diagnose and fix common errors related to secrets rotation, see <a href='https://docs.aws.amazon.com/secretsmanager/latest/userguide/troubleshoot_rotation.html'>Troubleshooting AWS Secrets Manager rotation of secrets</a> in the AWS Secrets Manager User Guide.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether your secrets have been accessed within a specified number of days. The default value is 90 days. If a secret was not accessed within the defined number of days, this control fails.<br>Deleting unused secrets is as important as rotating secrets. Unused secrets can be abused by their former users, who no longer need access to these secrets. Also, as more users get access to a secret, someone might have mishandled and leaked it to an unauthorized entity, which increases the risk of abuse. Deleting unused secrets helps revoke secret access from users who no longer need it. It also helps to reduce the cost of using Secrets Manager. Therefore, it is essential to routinely delete unused secrets.",
    "displayName": "Remove unused Secrets Manager secrets",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bfa82db5-c112-44f0-89e6-a9adfb9a4028",
    "implementationEffort": null,
    "name": "bfa82db5-c112-44f0-89e6-a9adfb9a4028",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can delete inactive secrets from the Secrets Manager console.<br><b>To delete inactive secrets</b><br>1. Open the <a href='https://console.aws.amazon.com/secretsmanager/.'>Secrets Manager console</a><br>2. To locate the secret, enter the secret name in the search box.<br>3. Choose the secret to delete.<br>4. Under <b>Secret details</b>, from <b>Actions</b>, choose <b>Delete secret</b>.<br>5. Under <b>Schedule secret deletion</b>, enter the number of days to wait before the secret is deleted.<br>6. Choose <b>Schedule deletion</b>.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether your secrets have been rotated at least once within 90 days.<br>Rotating secrets can help you to reduce the risk of an unauthorized use of your secrets in your AWS account. Examples include database credentials, passwords, third-party API keys, and even arbitrary text. If you do not change your secrets for a long period of time, the secrets are more likely to be compromised.<br>As more users get access to a secret, it can become more likely that someone mishandled and leaked it to an unauthorized entity. Secrets can be leaked through logs and cache data. They can be shared for debugging purposes and not changed or revoked once the debugging completes. For all these reasons, secrets should be rotated frequently.<br>You can configure your secrets for automatic rotation in AWS Secrets Manager. With automatic rotation, you can replace long-term secrets with short-term ones, significantly reducing the risk of compromise.<br>Security Hub recommends that you enable rotation for your Secrets Manager secrets. To learn more about rotation, see <a href='https://docs.aws.amazon.com/secretsmanager/latest/userguide/rotating-secrets.html'>Rotating your AWS Secrets Manager secrets</a> in the AWS Secrets Manager User Guide.",
    "displayName": "Secrets Manager secrets should be rotated within a specified number of days",
    "id": "/providers/Microsoft.Security/assessmentMetadata/323f0eb4-ea19-4b55-83e9-d104009616b4",
    "implementationEffort": null,
    "name": "323f0eb4-ea19-4b55-83e9-d104009616b4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can enable automatic secret rotation in the Secrets Manager console.<br><b>To enable secret rotation</b><br>1. Open the <a href='https://console.aws.amazon.com/secretsmanager/'>Secrets Manager console</a>.<br>2. To locate the secret, enter the secret name in the search box.<br>3. Choose the secret to display.<br>4. Under <b>Rotation configuration</b>, choose <b>Edit rotation</b>.<br>5. From <b>Edit rotation configuration</b>, choose <b>Enable automatic rotation</b>.<br>6. From Select Rotation Interval, choose the rotation interval.<br>7. Choose a Lambda function to use for rotation.<br>8. Choose <b>Next</b>.<br>After you configure the secret for automatic rotation, under <b>Rotation Configuration</b>, choose <b>Rotate secret immediately</b>.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether logging is enabled for an AWS WAF global Web ACL. This control fails if logging is not enabled for the web ACL.<br>Logging is an important part of maintaining the reliability, availability, and performance of AWS WAF globally. It is a business and compliance requirement in many organizations, and allows you to troubleshoot application behavior. It also provides detailed information about the traffic that is analyzed by the web ACL that is attached to AWS WAF.",
    "displayName": "AWS WAF Classic global web ACL logging should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ad593449-a095-47b5-91b8-894396a1aa7f",
    "implementationEffort": null,
    "name": "ad593449-a095-47b5-91b8-894396a1aa7f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can enable logging for a web ACL from the Kinesis Data Firehose console.<br><b>To enable logging for a web ACL</b><br>1. Open the <a href='https://console.aws.amazon.com/firehose/'>Kinesis Data Firehose console</a>.<br>2. Create a Kinesis Data Firehose delivery stream.<br>The name must start with the prefix aws-waf-logs-. For example, aws-waf-logs-us-east-2-analytics.<br>Create the Kinesis Data Firehose delivery stream with a PUT source and in the Region where you operate. If you capture logs for Amazon CloudFront, create the delivery stream in US East (N. Virginia). For more information, see <a href='https://docs.aws.amazon.com/firehose/latest/dev/basic-create.html'>Creating an Amazon Kinesis Data Firehose delivery stream</a> in the Amazon Kinesis Data Firehose Developer Guide.<br>3. From \"Services\", choose \"WAF & Shield\". Then choose \"Switch to AWS WAF Classic\".<br>4. From \"Filter\", choose \"Global (CloudFront)\".<br>5. Choose the web ACL to enable logging for.<br>6. Under \"Logging\", choose \"Enable logging\".<br>7. Choose the Kinesis Data Firehose delivery stream that you created earlier. You must choose a delivery stream that has a name that begins with aws-waf-logs-.<br>8. Choose \"Enable logging\".",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether the following logs of Amazon RDS are enabled and sent to CloudWatch Logs:<br>- Oracle: (Alert, Audit, Trace, Listener)<br>- PostgreSQL: (Postgresql, Upgrade)<br>- MySQL: (Audit, Error, General, SlowQuery)<br>- MariaDB: (Audit, Error, General, SlowQuery)<br>- SQL Server: (Error, Agent)<br>- Aurora: (Audit, Error, General, SlowQuery)<br>- Aurora-MySQL: (Audit, Error, General, SlowQuery)<br>- Aurora-PostgreSQL: (Postgresql, Upgrade).<br>RDS databases should have relevant logs enabled. Database logging provides detailed records of requests made to RDS. Database logs can assist with security and access audits and can help to diagnose availability issues.",
    "displayName": "Database logging should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/678b2afa-7fc7-45e5-ad4e-2c49efb57ac8",
    "implementationEffort": null,
    "name": "678b2afa-7fc7-45e5-ad4e-2c49efb57ac8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Logging options are contained in the DB parameter group associated with the RDS DB cluster or instance. To enable logging when the default parameter group for the database engine is used, you must create a new DB parameter group that has the required parameter values. You must then associate the customer DB parameter group with the DB cluster or instance.<br>To enable and publish MariaDB, MySQL, or PostgreSQL logs to CloudWatch Logs from the AWS Management Console, set the following parameters in a custom DB Parameter Group:<br><br><table style='border-collapse: collapse; width: 100%;' border='1'><tbody><tr><td style='width: 50%;'><strong>Database engine</strong></td><td style='width: 50%;'><strong>Parameters</strong></td></tr><tr><td style='width: 50%;'>MariaDB</td><td style='width: 50%;'>general_log=1<br>slow_query_log=1<br>log_output = FILE<br>- MariaDB also requires a custom options group, explained below.</td></tr><tr><td style='width: 50%;'>MySQL</td><td style='width: 50%;'>general_log=1<br>slow_query_log=1<br>log_output = FILE</td></tr><tr><td style='width: 50%;'>PostgreSQL</td><td style='width: 50%;'>log_statement=all<br>log_min_duration_statement=<b>minimum query duration (ms) to log</b></td></tr></tbody></table><br><b>To create a custom DB parameter group</b><br>1. Open the <a href='https://console.aws.amazon.com/rds/'>Amazon RDS console</a>.<br>2. In the navigation pane, choose \"Parameter groups\".<br>3. Choose \"Create parameter group\". The \"Create parameter group\" window appears.<br>4. In the \"Parameter group\" family list, choose a DB parameter group family.<br>5. In the \"Type\" list, choose \"DB Parameter Group\".<br>6. In \"Group name\", enter the name of the new DB parameter group.<br>7. In \"Description\", enter a description for the new DB parameter group.<br>8. Choose \"Create\".<br><br><b>To create a new option group for MariaDB logging by using the console</b><br>1. Open the <a href='https://console.aws.amazon.com/rds/'>Amazon RDS console</a>.<br>2. In the navigation pane, choose \"Option groups\".<br>3. Choose \"Create group\".<br>4. In the \"Create option group\" window, do the following:<ul><li>For \"Name\", type a name for the option group that is unique within your AWS account. The name can contain only letters, digits, and hyphens.</li><li>For \"Description\", type a brief description of the option group. The description is used for display purposes.</li><li>For \"Engine\", choose the DB engine that you want.</li><li>For \"Major engine version\", choose the major version of the DB engine that you want.</li></ul>5. To continue, choose \"Create\".<br>6. Choose the name of the option group you just created.<br>7. Choose \"Add option\".<br>8. Choose \"MARIADB_AUDIT_PLUGIN\" from the \"Option name\" list.<br>9. Set \"SERVER_AUDIT_EVENTS\" to \"CONNECT\", \"QUERY\", \"TABLE\", \"QUERY_DDL\", \"QUERY_DML\", \"QUERY_DCL\".<br>10. Choose Add option.<br><br><b>To publish SQL Server DB, Oracle DB, or PostgreSQL logs to CloudWatch Logs from the AWS Management Console</b><br>1. Open the <a href='https://console.aws.amazon.com/rds/'>Amazon RDS console</a>.<br>2. In the navigation pane, choose \"Databases\".<br>3. Choose the DB instance that you want to modify.<br>4. Choose \"Modify\".<br>5. Under \"Log exports\", choose all of the log files to start publishing to CloudWatch Logs.<br>\"Log exports\" is available only for database engine versions that support publishing to CloudWatch Logs.<br>6. Choose \"Continue\". Then on the summary page, choose \"Modify DB Instance\".<br><br><b>To apply a new DB parameter group or DB options group to an RDS DB instance</b><br>1. Open the <a href='https://console.aws.amazon.com/rds/'>Amazon RDS console</a>.<br>2. In the navigation pane, choose \"Databases\".<br>3. Choose the DB instance that you want to modify.<br>4. Choose \"Modify\". The \"Modify DB Instance\" page appears.<br>5. Under \"Database options\", change the DB parameter group and DB options group as needed.<br>6. When you finish you changes, choose \"Continue\". Check the summary of modifications.<br>7. (Optional) Choose \"Apply immediately\" to apply the changes immediately. Choosing this option can cause an outage in some cases. For more information, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/UserGuide/Overview.DBInstance.Modifying.html#USER_ModifyInstance.ApplyImmediately'>Using the Apply Immediately setting</a> in the Amazon RDS User Guide.<br>8. Choose \"Modify DB Instance\" to save your changes.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether an RDS DB instance has IAM database authentication enabled.<br>IAM database authentication allows authentication to database instances with an authentication token instead of a password. Network traffic to and from the database is encrypted using SSL. For more information, see IAM database authentication in the Amazon Aurora User Guide.",
    "displayName": "IAM authentication should be configured for RDS instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cd307f02-2ca7-44b4-8c1b-b580251d613c",
    "implementationEffort": null,
    "name": "cd307f02-2ca7-44b4-8c1b-b580251d613c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update your DB instance to enable IAM authentication.<br><b>To enable IAM authentication for an existing DB instance</b><br>1. Open the <a href='https://console.aws.amazon.com/rds/'>Amazon RDS console</a>.<br>2. Choose \"Databases\".<br>3. Select the DB instance to modify.<br>4. Choose \"Modify\".<br>5. Under \"Database options\", choose \"Enable IAM DB authentication\".<br>6. Choose \"Continue\".<br>7. Under \"Scheduling of modifications\", choose when to apply modifications. The options are \"Apply during the next scheduled maintenance window\" or \"Apply immediately\".<br>8. For clusters, choose \"Modify DB Instance\".",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether an RDS DB cluster has IAM database authentication enabled.<br>IAM database authentication allows for password-free authentication to database instances. The authentication uses an authentication token. Network traffic to and from the database is encrypted using SSL. For more information, see IAM database authentication in the Amazon Aurora User Guide.",
    "displayName": "IAM authentication should be configured for RDS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3ac30502-52e5-4fc6-af40-095dddfbc8b9",
    "implementationEffort": null,
    "name": "3ac30502-52e5-4fc6-af40-095dddfbc8b9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update your DB instance to enable IAM authentication.<br><b>To enable IAM authentication for an existing DB instance</b><br>1. Open the <a href='https://console.aws.amazon.com/rds/'>Amazon RDS console</a>.<br>2. Choose \"Databases\".<br>3. Select the DB cluster to modify.<br>4. Choose \"Modify\".<br>5. Under \"Database options\", choose \"Enable IAM DB authentication\".<br>6. Choose \"Continue\".<br>7. Under \"Scheduling of modifications\", choose when to apply modifications. The options are \"Apply during the next scheduled maintenance window\" or \"Apply immediately\".<br>8. For clusters, choose \"Modify Cluster\".",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether automatic minor version upgrades are enabled for the RDS database instance.<br>Enabling automatic minor version upgrades ensures that the latest minor version updates to the relational database management system (RDBMS) are installed. These upgrades might include security patches and bug fixes. Keeping up to date with patch installation is an important step in securing systems.",
    "displayName": "RDS automatic minor version upgrades should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d352afac-cebc-4e02-b474-7ef402fb1d65",
    "implementationEffort": null,
    "name": "d352afac-cebc-4e02-b474-7ef402fb1d65",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can enable minor version upgrades for a DB instance from the Amazon RDS console.<br><b>To enable automatic minor version upgrades for an existing DB instance</b><br>1. Open the <a href='https://console.aws.amazon.com/rds/'>Amazon RDS console</a>.<br>2. Choose \"Databases\".<br>3. Choose the DB instance to modify.<br>4. Choose \"Modify\".<br>5. Under \"Maintenance\", select \"Yes\" for \"Auto minor version upgrade\".<br>6. Choose \"Continue\".<br>7. Under \"Scheduling of modifications\", choose when to apply modifications: \"Apply during the next scheduled maintenance window\" or \"Apply immediately\".<br>8. Choose \"Modify DB Instance\".",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Amazon Aurora clusters have backtracking enabled.<br>Backups help you to recover more quickly from a security incident. They also strengthens the resilience of your systems. Aurora backtracking reduces the time to recover a database to a point in time. It does not require a database restore to do so.<br>For more information about backtracking in Aurora, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Managing.Backtrack.html'>Backtracking an Aurora DB cluster</a> in the Amazon Aurora User Guide.",
    "displayName": "Amazon Aurora clusters should have backtracking enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d0ef47dc-95aa-4765-a075-72c07df8acff",
    "implementationEffort": null,
    "name": "d0ef47dc-95aa-4765-a075-72c07df8acff",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on how to enable Aurora backtracking, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Managing.Backtrack.html#AuroraMySQL.Managing.Backtrack.Configuring'>Configuring backtracking</a> in the Amazon Aurora User Guide.<br>Note that you cannot enable backtracking on an existing cluster. Instead, you can create a clone that has backtracking enabled. For more information about the limitations of Aurora backtracking, see the list of limitations in <a href='https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/AuroraMySQL.Managing.Backtrack.html'>Overview of backtracking</a>.For information about pricing for backtracking, see the <a href='http://aws.amazon.com/rds/aurora/pricing/'>Aurora pricing page</a>.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks if an RDS DB cluster is encrypted at rest. The control fails if an RDS DB cluster isn't encrypted at rest.",
    "displayName": "Amazon RDS DB clusters should be encrypted at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c5e0f46d-0b11-4c0c-9ce0-dcfb162a9bf8",
    "implementationEffort": null,
    "name": "c5e0f46d-0b11-4c0c-9ce0-dcfb162a9bf8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "You can enable encryption at rest when you create an RDS DB cluster. You can't change encryption settings after creating a cluster. For more information, see <a href='https://docs.aws.amazon.com/AmazonRDS/latest/AuroraUserGuide/Overview.Encryption.html#Overview.Encryption.Enabling'>Encrypting an Amazon Aurora DB cluster</a> in the Amazon Aurora User Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether automatic major version upgrades are enabled for the Amazon Redshift cluster.<br>Enabling automatic major version upgrades ensures that the latest major version updates to Amazon Redshift clusters are installed during the maintenance window.<br> These updates might include security patches and bug fixes. Keeping up to date with patch installation is an important step in securing systems.",
    "displayName": "Amazon Redshift should have automatic upgrades to major versions enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/176f9062-64d0-4edd-bb0f-915012a6ef16",
    "implementationEffort": null,
    "name": "176f9062-64d0-4edd-bb0f-915012a6ef16",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue from the AWS CLI, use the Amazon Redshift <code>modify-cluster</code> command to set the <code>--allow-version-upgrade</code> attribute.<br>Copy the following command <code>aws redshift modify-cluster --cluster-identifier clustername --allow-version-upgrade</code> Where <code>clustername</code> is the name of your Amazon Redshift cluster.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether an Amazon Redshift cluster has EnhancedVpcRouting enabled.<br>Enhanced VPC routing forces all COPY and UNLOAD traffic between the cluster and data repositories to go through your VPC. You can then use VPC features such as security groups and network access control lists to secure network traffic. You can also use VPC Flow Logs to monitor network traffic.",
    "displayName": "Amazon Redshift clusters should use enhanced VPC routing",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1ee72ceb-2cb7-4686-84e6-0e1ac1c27241",
    "implementationEffort": null,
    "name": "1ee72ceb-2cb7-4686-84e6-0e1ac1c27241",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed remediation instructions, see <a href='https://docs.aws.amazon.com/redshift/latest/mgmt/enhanced-vpc-enabling-cluster.html'>Enabling enhanced VPC routing</a> in the <em>Amazon Redshift Cluster Management Guide</em>.",
    "severity": "High",
    "tactics": [
      "Lateral Movement"
    ],
    "techniques": [
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether connections to Amazon Redshift clusters are required to use encryption in transit. The check fails if the Amazon Redshift cluster parameter require_SSL is not set to '1'.<br>TLS can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. Only encrypted connections over TLS should be allowed. Encrypting data in transit can affect performance. You should test your application with this feature to understand the performance profile and the impact of TLS.",
    "displayName": "Connections to Amazon Redshift clusters should be encrypted in transit",
    "id": "/providers/Microsoft.Security/assessmentMetadata/036bb56b-c442-4352-bb4c-5bd0353ad314",
    "implementationEffort": null,
    "name": "036bb56b-c442-4352-bb4c-5bd0353ad314",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update the parameter group to require encryption.<br>To modify a parameter group<br>1. Open the Amazon Redshift console at https://console.aws.amazon.com/redshift/.<br>2. In the navigation menu, choose Config, then choose Workload management to display the Workload management page.<br>3. Choose the parameter group that you want to modify.<br>4. Choose Parameters.<br>5. Choose Edit parameters then set require_ssl to '1'.<br>6. Enter your changes and then choose Save.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Credential Access"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Amazon Redshift clusters have automated snapshots enabled. It also checks whether the snapshot retention period is greater than or equal to seven.<br>Backups help you to recover more quickly from a security incident. They strengthen the resilience of your systems. Amazon Redshift takes periodic snapshots by default. This control checks whether automatic snapshots are enabled and retained for at least seven days. For more details on Amazon Redshift automated snapshots, see <a href='https://docs.aws.amazon.com/redshift/latest/mgmt/working-with-snapshots.html#about-automated-snapshots'>Automated snapshots</a> in the <em>Amazon Redshift Cluster Management Guide</em>.",
    "displayName": "Amazon Redshift clusters should have automatic snapshots enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7a152832-6600-49d1-89be-82e474190e13",
    "implementationEffort": null,
    "name": "7a152832-6600-49d1-89be-82e474190e13",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update the snapshot retention period to at least 7.<br><b>To modify the snapshot retention period</b><br>1. Open the Amazon Redshift console at <a href='https://console.aws.amazon.com/redshift/'>https://console.aws.amazon.com/redshift/</a>.<br>2. In the navigation menu, choose \"Clusters\", then choose the name of the cluster to modify.<br>3. Choose  \"Edit\".<br>4. Under  \"Backup\", set  \"Snapshot retention\" to a value of 7 or greater.<br>5. Choose  \"Modify Cluster\".",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Amazon Redshift cluster has audit logging enabled.<br>Amazon Redshift audit logging provides additional information about connections and user activities in your cluster. This data can be stored and secured in Amazon S3 and can be helpful in security audits and investigations. For more information, see <a href='https://docs.aws.amazon.com/redshift/latest/mgmt/db-auditing.html'>Database audit logging</a> in the <em>Amazon Redshift Cluster Management Guide</em>.",
    "displayName": "Amazon Redshift clusters should have audit logging enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e2a0ec17-447b-44b6-8646-c0b5584b6b0a",
    "implementationEffort": null,
    "name": "e2a0ec17-447b-44b6-8646-c0b5584b6b0a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable cluster audit logging<br>1. Open the Amazon Redshift console at <a href='https://console.aws.amazon.com/redshift/'>https://console.aws.amazon.com/redshift/</a>.<br>2. In the navigation menu, choose \"Clusters\", then choose the name of the cluster to modify.<br>3. Choose \"Maintenance and monitoring\"<br>4. Under \"Audit logging\", choose \"Edit\".<br>5. Set \"Enable audit logging\" to \"yes\", then enter the log destination bucket details.<br>6. Choose \"Confirm\".",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether enhanced health reporting is enabled for your AWS Elastic Beanstalk environments.<br>Elastic Beanstalk enhanced health reporting enables a more rapid response to changes in the health of the underlying infrastructure. These changes could result in a lack of availability of the application.<br>Elastic Beanstalk enhanced health reporting provides a status descriptor to gauge the severity of the identified issues and identify possible causes to investigate. The Elastic Beanstalk health agent, included in supported Amazon Machine Images (AMIs), evaluates logs and metrics of environment EC2 instances.",
    "displayName": "Elastic Beanstalk environments should have enhanced health reporting enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4170067b-345d-47ed-ab4a-c6b6046881f1",
    "implementationEffort": null,
    "name": "4170067b-345d-47ed-ab4a-c6b6046881f1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "10/04/2021"
    },
    "remediationDescription": "For instructions on how to enable enhanced health reporting, see <a href='https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/health-enhanced-enable.html#health-enhanced-enable-console'>Enabling enhanced health reporting using the Elastic Beanstalk console</a> in the AWS Elastic Beanstalk Developer Guide.",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "his control checks whether managed platform updates are enabled for the Elastic Beanstalk environment.<br>Enabling managed platform updates ensures that the latest available platform fixes, updates, and features for the environment are installed. Keeping up to date with patch installation is an important step in securing systems.",
    "displayName": "Elastic Beanstalk managed platform updates should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/820f6c6e-f73f-432c-8c60-cae1794ea150",
    "implementationEffort": null,
    "name": "820f6c6e-f73f-432c-8c60-cae1794ea150",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "10/04/2021"
    },
    "remediationDescription": "For instructions on how to enable managed platform updates, see <a href='https://docs.aws.amazon.com/elasticbeanstalk/latest/dg/environment-platform-update-managed.html'>To configure managed platform updates under Managed platform updates</a> in the AWS Elastic Beanstalk Developer Guide.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Elasticsearch domains are configured to send error logs to CloudWatch Logs.<br>You should enable error logs for Elasticsearch domains and send those logs to CloudWatch Logs for retention and response. Domain error logs can assist with security and access audits, and can help to diagnose availability issues.",
    "displayName": "Elasticsearch domain error logging to CloudWatch Logs should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f48af569-2e67-464b-9a62-b8df0f85bc5e",
    "implementationEffort": null,
    "name": "f48af569-2e67-464b-9a62-b8df0f85bc5e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to enable log publishing, see <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/createdomain-configure-slow-logs.html#createdomain-configure-slow-logs-console'>Enabling log publishing (console)</a> in the Amazon OpenSearch Service Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Elasticsearch domains have audit logging enabled. This control fails if an Elasticsearch domain does not have audit logging enabled.<br>Audit logs are highly customizable. They allow you to track user activity on your Elasticsearch clusters, including authentication successes and failures, requests to OpenSearch, index changes, and incoming search queries.",
    "displayName": "Elasticsearch domains should have audit logging enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/12ebb4cd-34b6-4c3a-bee9-7e35f4f6caff",
    "implementationEffort": null,
    "name": "12ebb4cd-34b6-4c3a-bee9-7e35f4f6caff",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For detailed instructions on enabling audit logs, see <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/audit-logs.html#audit-log-enabling'>Enabling audit logs</a> in the Amazon OpenSearch Service Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Elasticsearch domains are configured with at least three data nodes and zoneAwarenessEnabled is true.<br>An Elasticsearch domain requires at least three data nodes for high availability and fault-tolerance. Deploying an Elasticsearch domain with at least three data nodes ensures cluster operations if a node fails.",
    "displayName": "Elasticsearch domains should have at least three data nodes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/994cbcb3-43d4-419d-b5c4-9adc558f3ca2",
    "implementationEffort": null,
    "name": "994cbcb3-43d4-419d-b5c4-9adc558f3ca2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To modify the number of data nodes in an Elasticsearch domain<br>1. Open the Amazon OpenSearch Service console at <a href='https://console.aws.amazon.com/es/'>https://console.aws.amazon.com/es/</a>.<br>2. Under \"My domains\", choose the name of the domain to edit.<br>3. Choose \"Edit domain\".<br>4. Under \"Data nodes\", set \"Number of nodes\" to a number greater than or equal to three. For three Availability Zone deployments, set to a multiple of three to ensure equal distribution across Availability Zones.<br>5. Choose \"Submit\".",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Elasticsearch domains are configured with at least three dedicated master nodes. This control fails if the domain does not use dedicated master nodes. This control passes if Elasticsearch domains have five dedicated master nodes. However, using more than three master nodes might be unnecessary to mitigate the availability risk, and will result in additional cost.<br>An Elasticsearch domain requires at least three dedicated master nodes for high availability and fault-tolerance. Dedicated master node resources can be strained during data node blue/green deployments because there are additional nodes to manage. Deploying an Elasticsearch domain with at least three dedicated master nodes ensures sufficient master node resource capacity and cluster operations if a node fails.",
    "displayName": "Elasticsearch domains should be configured with at least three dedicated master nodes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b4b9a67c-c315-4f9b-b06b-04867a453aab",
    "implementationEffort": null,
    "name": "b4b9a67c-c315-4f9b-b06b-04867a453aab",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To modify the number of dedicated master nodes in an OpenSearch domain<br>1. Open the Amazon OpenSearch Service console at <a href='https://console.aws.amazon.com/es/'>https://console.aws.amazon.com/es/</a>.<br>2. Under \"My domains\", choose the name of the domain to edit.<br>3. Choose \"Edit domain\".<br>4. Under \"Dedicated master nodes\", set \"Instance type\" to the desired instance type.<br>5. Set \"Number of master nodes\" equal to three or greater.<br>6. Choose \"Submit\".",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether connections to Elasticsearch domains are required to use TLS 1.2. The check fails if the Elasticsearch domain TLSSecurityPolicy is not Policy-Min-TLS-1-2-2019-07.<br>HTTPS (TLS) can be used to help prevent potential attackers from using person-in-the-middle or similar attacks to eavesdrop on or manipulate network traffic. Only encrypted connections over HTTPS (TLS) should be allowed. Encrypting data in transit can affect performance. You should test your application with this feature to understand the performance profile and the impact of TLS. TLS 1.2 provides several security enhancements over previous versions of TLS.",
    "displayName": "Connections to Elasticsearch domains should be encrypted using TLS 1.2",
    "id": "/providers/Microsoft.Security/assessmentMetadata/effb5011-f8db-45ac-b981-b5bdfd7beb88",
    "implementationEffort": null,
    "name": "effb5011-f8db-45ac-b981-b5bdfd7beb88",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable TLS encryption, use the <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/configuration-api.html#configuration-api-actions-updatedomainconfig'>UpdateDomainConfig</a> API operation to configure the <a href='https://docs.aws.amazon.com/opensearch-service/latest/developerguide/configuration-api.html#configuration-api-datatypes-domainendpointoptions'>DomainEndpointOptions</a> in order to set the TLSSecurityPolicy. For more information, see the Amazon OpenSearch Service Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Credential Access"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks if a lifecycle policy is configured for an Amazon S3 bucket. This control fails if a lifecycle policy is not configured for an S3 bucket.",
    "displayName": "S3 buckets should have lifecycle policies configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0b168d89-4e52-45c9-bd6a-24f904abcc2e",
    "implementationEffort": null,
    "name": "0b168d89-4e52-45c9-bd6a-24f904abcc2e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/17/2023"
    },
    "remediationDescription": "For information about configuring lifecycle policies on an Amazon S3 bucket, see <a href='https://docs.aws.amazon.com/AmazonS3/latest/userguide/how-to-set-lifecycle-configuration-intro.html'>Setting lifecycle configuration on a bucket</a> and see <a href='https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-lifecycle-mgmt.html'>Managing your storage lifecycle</a> in the Amazon S3 User Guide.",
    "severity": "Low",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether S3 buckets have bucket-level public access blocks applied. This control fails is if any of the following settings are set to false:<br>* ignorePublicAcls<br>* blockPublicPolicy<br>* blockPublicAcls<br>* restrictPublicBuckets<br>Block Public Access at the S3 bucket level provides controls to ensure that objects never have public access. Public access is granted to buckets and objects through access control lists (ACLs), bucket policies, or both.<br>Unless you intend to have your S3 buckets publicly accessible, you should configure the bucket level Amazon S3 Block Public Access feature.",
    "displayName": "S3 Block Public Access setting should be enabled at the bucket level",
    "id": "/providers/Microsoft.Security/assessmentMetadata/83f16376-e2dd-487d-b5ee-ba67fef4c5c0",
    "implementationEffort": null,
    "name": "83f16376-e2dd-487d-b5ee-ba67fef4c5c0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to remove public access at a bucket level, see <a href='https://docs.aws.amazon.com/AmazonS3/latest/dev/access-control-block-public-access.html'>Blocking public access to your Amazon S3 storage</a> in the Amazon S3 User Guide.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Storage Object Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether Amazon SQS queues are encrypted at rest.<br>Server-side encryption (SSE) allows you to transmit sensitive data in encrypted queues. To protect the content of messages in queues, SSE uses keys managed in AWS KMS.<br>For more information, see <a href='https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-server-side-encryption.html'>Encryption at rest</a> in the Amazon Simple Queue Service Developer Guide.",
    "displayName": "Amazon SQS queues should be encrypted at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/340a07a1-7d68-4562-ac25-df77c214fe13",
    "implementationEffort": null,
    "name": "340a07a1-7d68-4562-ac25-df77c214fe13",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information about managing SSE using the AWS Management Console, see <a href='https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-configure-sse-existing-queue.html'>&nbsp;Configuring server-side encryption (SSE) for a queue (console)</a> in the Amazon Simple Queue Service Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "For full visibility of the security content from Microsoft Defender for servers, EC2 instances should be connected to Azure Arc. To ensure that all eligible EC2 instances automatically receive Azure Arc, enable auto-provisioning from Defender for Cloud at the AWS account level. Learn more about <a href='https://docs.microsoft.com/azure/azure-arc/servers/overview'>Azure Arc</a>, and <a href='https://docs.microsoft.com/azure/security-center/defender-for-servers-introduction'>Microsoft Defender for Servers</a>.",
    "displayName": "AWS accounts should have Azure Arc auto provisioning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/882a80f0-943f-473e-b6d7-40c7a625540e",
    "implementationEffort": null,
    "name": "882a80f0-943f-473e-b6d7-40c7a625540e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "25/10/2021"
    },
    "remediationDescription": "1. From the Defender for Cloud, open \"Environment settings\".<br>2. For the relevant AWS account, select the three dots at the end of the row, and select \"Edit settings\".<br>3. For the \"Servers\" plan, select \"View configuration\".<br>4. Enable auto-provisioning for the Azure Arc agent and click on the \"Save\" button.<br>5. Select \"Next\" and follow the instructions.<br>Note: To enable auto-provisioning, you'll need owner permissions for the relevant subscription.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Connect your EC2 instances to Azure Arc in order to have full visibility to Microsoft Defender for Servers security content. Learn more about <a href='https://docs.microsoft.com/azure/azure-arc/servers/overview'>Azure Arc</a>, and about <a href='https://docs.microsoft.com/azure/security-center/defender-for-servers-introduction'>Microsoft Defender for Servers</a> on hybrid-cloud environment.",
    "displayName": "EC2 instances should be connected to Azure Arc",
    "id": "/providers/Microsoft.Security/assessmentMetadata/231dee23-84db-44d2-bd9d-c32fbcfb42a3",
    "implementationEffort": null,
    "name": "231dee23-84db-44d2-bd9d-c32fbcfb42a3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "25/10/2021"
    },
    "remediationDescription": "1. From the Azure portal, open \"Servers - Azure Arc\".<br>2. From the top left corner, select \"Add\".<br>3. From \"Add a single server\", select \"Generate script\".<br>4. In the \"Resource details\" page, select the subscription and resource group to which you have connected the machine's AWS account.<br>5. Select \"Next\" and follow the instructions.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This control checks whether the RDS cluster or instance uses a port other than the default port of the database engine.<br>If you use a known port to deploy an RDS cluster or instance, an attacker can guess information about the cluster or instance.<br> The attacker can use this information in conjunction with other information to connect to an RDS cluster or instance or gain additional information about your application.<br>When you change the port, you must also update the existing connection strings that were used to connect to the old port.<br> You should also check the security group of the DB instance to ensure that it includes an ingress rule that allows connectivity on the new port.",
    "displayName": "RDS databases and clusters should not use a database engine default port",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f1736090-65fc-454f-a437-af58fd91ad1e",
    "implementationEffort": null,
    "name": "f1736090-65fc-454f-a437-af58fd91ad1e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To modify the default port of an existing DB instance</b><br>1. Open the Amazon RDS console at <a href='https://console.aws.amazon.com/rds/'>https://console.aws.amazon.com/rds/</a><br>2. Choose \"Databases\".<br>3. Select the DB instance to modify<br>4. Choose \"Modify\".<br>5. Under \"Database options\", change \"Database port\" to a non-default value.<br>6. Choose \"Continue\".<br>7. Under \"Scheduling of modifications\", choose when to apply modifications. You can choose either \"Apply during the next scheduled maintenance window\" or \"Apply immediately\".<br>8. For clusters, choose \"Modify cluster\". For instances, choose \"Modify DB Instance\".",
    "severity": "Low",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an active Amazon ECS task definition that has host networking mode also has privileged or user container definitions.<br> The control fails for task definitions that have host network mode and container definitions where privileged=false or is empty and user=root or is empty.<br>If a task definition has elevated privileges, it is because the customer has specifically opted in to that configuration.<br> This control checks for unexpected privilege escalation when a task definition has host networking enabled but the customer has not opted in to elevated privileges.",
    "displayName": "Amazon ECS task definitions should have secure networking modes and user definitions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0dc124a8-2a69-47c5-a4e1-678d725a33ab",
    "implementationEffort": null,
    "name": "0dc124a8-2a69-47c5-a4e1-678d725a33ab",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "For information on how to update a task definition, see <a href='https://docs.aws.amazon.com/AmazonECS/latest/developerguide/update-task-definition.html'>Updating a task definition in the Amazon Elastic Container Service Developer Guide</a>.<br>Note that when you update a task definition, it does not update running tasks that were launched from the previous task definition. To update a running task, you must redeploy the task with the new task definition.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "A public IP address is an IP address that is reachable from the internet.<br> If you launch your Amazon ECS instances with a public IP address, then your Amazon ECS instances are reachable from the internet.<br> Amazon ECS services should not be publicly accessible, as this may allow unintended access to your container application servers.",
    "displayName": "Amazon ECS services should not have public IP addresses assigned to them automatically",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9bb205cd-a931-4f77-a620-0a263479732b",
    "implementationEffort": null,
    "name": "9bb205cd-a931-4f77-a620-0a263479732b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To disable automatic public IP assignment, see <a href='https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-configure-network.html'>To configure VPC and security group settings for your service </a> in the Amazon Elastic Container Service Developer Guide.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether ACM certificates in your account are marked for expiration within 30 days. It checks both imported certificates and certificates provided by AWS Certificate Manager.<br>ACM can automatically renew certificates that use DNS validation. For certificates that use email validation, you must respond to a domain validation email.<br> ACM also does not automatically renew certificates that you import. You must renew imported certificates manually.<br> For more information about managed renewal for ACM certificates, see <a href='https://docs.aws.amazon.com/acm/latest/userguide/managed-renewal.html'>Managed renewal for ACM certificates</a> in the AWS Certificate Manager User Guide.",
    "displayName": "Imported ACM certificates should be renewed after a specified time period",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0e68b4d8-1a5e-47fc-a3eb-b3542fea43f1",
    "implementationEffort": null,
    "name": "0e68b4d8-1a5e-47fc-a3eb-b3542fea43f1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "ACM provides managed renewal for your Amazon-issued SSL/TLS certificates.<br> This means that ACM either renews your certificates automatically (if you use DNS validation), or it sends you email notices when the certificate expiration approaches. These services are provided for both public and private ACM certificates.<br> \"For domains validated by email\"<br>When a certificate is 45 days from expiration, ACM sends to the domain owner an email for each domain name.<br> To validate the domains and complete the renewal, you must respond to the email notifications.<br>For more information, see <a href='https://docs.aws.amazon.com/acm/latest/userguide/email-renewal-validation.html'>Renewal for domains validated by email</a> in the AWS Certificate Manager User Guide.<br>\"For domains validated by DNS\" <br>ACM automatically renews certificates that use DNS validation. 60 days before the expiration, ACM verifies that the certificate can be renewed.<br>If it cannot validate a domain name, then ACM sends a notification that manual validation is required.<br>It sends these notifications 45 days, 30 days, 7days, and 1 day before the expiration.<br>For more information, see <a href='https://docs.aws.amazon.com/acm/latest/userguide/dns-renewal-validation.html'>Renewal for domains validated by DNS</a> in the AWS Certificate Manager User Guide.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Overprovisioned identities in Azure are those that have been granted more permissions than they use, which can lead to potential misuse, either accidentally or maliciously.<br> Regularly adjusting these permissions to the necessary minimum can significantly reduce the risk of misuse.<br> If not addressed, this could increase the potential impact during a security incident.<br> To mitigate this risk and ensure that identities have only the permissions necessary for their function, remove unnecessary permissions and establish review processes.<br>",
    "displayName": "Azure overprovisioned identities should have only the necessary permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d19d5a12-41e9-44e2-b7f5-ee2160f62d62",
    "implementationEffort": "Moderate",
    "name": "d19d5a12-41e9-44e2-b7f5-ee2160f62d62",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "05/24/2024",
      "public": "05/01/2024"
    },
    "remediationDescription": "Remediate overprovisioned identities with least privileged built-in roles or with right-sized custom roles.</br> To remediate overprovisioned identities: </br></br>Remediation Steps for user as the affected resource:</br> 1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Select Users and click on 'All users', search for the affected identity.</br>4.Click on 'Azure role assignments', choose the affected subscription from the subscription drop down.</br>5.Review the roles assigned to the user</br>6.To revoke or remove unused permissions for the affected identity, navigate back to the specific resource where those permissions were granted. Take the necessary steps to adjust or remove those permissions accordingly.</br></br>Remediation Steps for group as the affected resource:</br> 1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Expand Manage > Click on groups > All groups > search for the affected identity.</br>4.Expand Manage, Choose Azure role assignments to verify the permissions assigned to the group.</br>5.To revoke or remove unused permissions for the affected identity, navigate back to the specific resource where those permissions were granted. Take the necessary steps to right size the permissions accordingly.</br>6.Ensure that groups are granted only the permissions they need to perform their intended tasks. Follow the principle of least privilege to minimize the risk of unauthorized access.</br></br> Remediation Steps for service principal as the affected resource:</br>1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Click on 'Enterprise applications' and navigate to 'All applications' under 'Manage' section.</br>4.Search and open the affected service principal, Click on the 'Roles and Administrators' under 'Manage' section to review the assigned permissions/roles to this affected service principal.</br>5.Ensure that Service principals are granted only the permissions they need to perform their intended tasks. Follow the principle of least privilege to minimize the risk of unauthorized access.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Microsoft Defender for Cloud discovered an identity that has not performed any action on any resource within your Azure subscription in the past 45 days. It is recommended to revoke permissions of inactive identities, in order to reduce the attack surface of your cloud environment.",
    "displayName": "Permissions of inactive identities in your Azure subscription should be revoked",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8b0bd683-bcfe-4ab1-96b9-f15a60eaa89d",
    "implementationEffort": null,
    "name": "8b0bd683-bcfe-4ab1-96b9-f15a60eaa89d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "05/24/2024",
      "public": "05/01/2024"
    },
    "remediationDescription": "To remediate inactive identities via Microsoft Entra, follow the below steps: </br></br>1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Navigate to Users/Groups/Enterprise applications in the left menu (Depends on the type of identity), and search for the affected identity.</br> 4.Navigate to 'Azure role assignments' in the left menu, and choose the effected subscription in the subscriptions dropdown.</br> 5.Remove all role assignments of the identity to any resource within the subscription, by clicking on the resource name, go to 'Access Control (IAM)', and delete the relevant assignments.</br></br>To remediate inactive identities via Microsoft Entra Permissions Management (requires additional license), follow the below steps:</br></br>1.Login to <a href=\"https://aka.ms/EntraPermissionsManagementWow\">Microsoft Entra Permissions Management</a></br> 2.Click on 'Permissions Management'.</br> 3.Start by looking at Permissions Analytics report > Click on the 'Reports tab'.</br> 4.Click on 'Permissions Analytics Report' > Select a cloud and one or more 'Authorization system' at the top right corner.</br> 5.Navigate to 'Inactive Identities' to view the list of Inactive Identities.</br> 6.Revoke the permissions of that identity to the affected subscription.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Overprovisioned identities in Azure are those that have been granted more permissions than they use, which can lead to potential misuse, either accidentally or maliciously.<br> Regularly adjusting these permissions to the necessary minimum can significantly reduce the risk of misuse.<br> If not addressed, this could increase the potential impact during a security incident.<br> To mitigate this risk and ensure that identities have only the permissions necessary for their function, remove unnecessary permissions and establish review processes.<br>",
    "displayName": "(Do not use) Azure overprovisioned identities should have only the necessary permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2b225f29-7692-4356-aba1-d729d9098fad",
    "implementationEffort": "Moderate",
    "name": "2b225f29-7692-4356-aba1-d729d9098fad",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "07/15/2025",
      "public": "07/15/2025"
    },
    "remediationDescription": "Remediate overprovisioned identities with least privileged built-in roles or with right-sized custom roles.</br> To remediate overprovisioned identities: </br></br>Remediation Steps for user as the affected resource:</br> 1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Select Users and click on 'All users', search for the affected identity.</br>4.Click on 'Azure role assignments', choose the affected subscription from the subscription drop down.</br>5.Review the roles assigned to the user</br>6.To revoke or remove unused permissions for the affected identity, navigate back to the specific resource where those permissions were granted. Take the necessary steps to adjust or remove those permissions accordingly.</br></br>Remediation Steps for group as the affected resource:</br> 1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Expand Manage > Click on groups > All groups > search for the affected identity.</br>4.Expand Manage, Choose Azure role assignments to verify the permissions assigned to the group.</br>5.To revoke or remove unused permissions for the affected identity, navigate back to the specific resource where those permissions were granted. Take the necessary steps to right size the permissions accordingly.</br>6.Ensure that groups are granted only the permissions they need to perform their intended tasks. Follow the principle of least privilege to minimize the risk of unauthorized access.</br></br> Remediation Steps for service principal as the affected resource:</br>1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Click on 'Enterprise applications' and navigate to 'All applications' under 'Manage' section.</br>4.Search and open the affected service principal, Click on the 'Roles and Administrators' under 'Manage' section to review the assigned permissions/roles to this affected service principal.</br>5.Ensure that Service principals are granted only the permissions they need to perform their intended tasks. Follow the principle of least privilege to minimize the risk of unauthorized access.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Microsoft Defender for Cloud discovered an identity that has not performed any action on any resource within your Azure subscription in the past 45 days. It is recommended to revoke permissions of inactive identities, in order to reduce the attack surface of your cloud environment.",
    "displayName": "(Do not use) Permissions of inactive identities in your Azure subscription should be revoked",
    "id": "/providers/Microsoft.Security/assessmentMetadata/44932ac0-e6f1-4bec-a44d-42a49c066b24",
    "implementationEffort": null,
    "name": "44932ac0-e6f1-4bec-a44d-42a49c066b24",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "07/15/2025",
      "public": "07/15/2025"
    },
    "remediationDescription": "To remediate inactive identities via Microsoft Entra, follow the below steps: </br></br>1.Login to <a href=\"https://ms.portal.azure.com/#home\">Azure portal</a></br>2.Navigate to 'Microsoft Entra ID'</br>3.Navigate to Users/Groups/Enterprise applications in the left menu (Depends on the type of identity), and search for the affected identity.</br> 4.Navigate to 'Azure role assignments' in the left menu, and choose the effected subscription in the subscriptions dropdown.</br> 5.Remove all role assignments of the identity to any resource within the subscription, by clicking on the resource name, go to 'Access Control (IAM)', and delete the relevant assignments.</br></br>To remediate inactive identities via Microsoft Entra Permissions Management (requires additional license), follow the below steps:</br></br>1.Login to <a href=\"https://aka.ms/EntraPermissionsManagementWow\">Microsoft Entra Permissions Management</a></br> 2.Click on 'Permissions Management'.</br> 3.Start by looking at Permissions Analytics report > Click on the 'Reports tab'.</br> 4.Click on 'Permissions Analytics Report' > Select a cloud and one or more 'Authorization system' at the top right corner.</br> 5.Navigate to 'Inactive Identities' to view the list of Inactive Identities.</br> 6.Revoke the permissions of that identity to the affected subscription.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This recommendation identifies GCP Firewall rules which allows inbound traffic on all protocols from public internet. <br/>Doing so, may allow a bad actor to brute force their way into the system and potentially get access to the entire network.",
    "displayName": "Ensure GCP compute firewall ingress does not allow unrestricted access to all ports",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c919774d-333e-4526-a9c4-b35a0fdd5ff8",
    "implementationEffort": null,
    "name": "c919774d-333e-4526-a9c4-b35a0fdd5ff8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "<b>From Console:</b> <br/>1. Go to the <a href='https://console.cloud.google.com/net-security/firewall-manager/firewall-policies/list'>Firewall rules</a> page in the Google Cloud console.<br/> 2. Click the firewall rule listed in the Security Health Analytics finding, and then click \"Edit\".<br/> 3. Under \"Source IP ranges\", edit the IP values to restrict the range of IPs that is allowed.<br/> 4. Under \"Protocols and ports\", select \"Specified protocols and ports\", select the allowed protocols, and enter ports that are allowed.<br/> 5. Click \"Save\".",
    "severity": "High",
    "tactics": [
      "Discovery",
      "Reconnaissance"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery",
      "Active Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enabling private IP Google access for your Google Cloud Platform (GCP) subnet can help improve the security and performance of your network. <br/>Private IP Google access allows resources in your subnet to access Google APIs and services over a private IP connection, rather than a public connection.",
    "displayName": "Ensure GCP subnet has a private IP Google access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7b48795a-692f-48d4-a9e5-bf4aaf3bfb94",
    "implementationEffort": null,
    "name": "7b48795a-692f-48d4-a9e5-bf4aaf3bfb94",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "<b>From Console:</b> <br/>1. Go to the <a href='https://console.cloud.google.com/networking/networks/list'>VPC networks</a> page in the Google Cloud console.<br/>2. In the list of networks, click the name of the desired network.<br/>3. On the \"VPC network details\" page, click the \"Subnets\" tab.<br/>4. In the list of subnets, click the name of the subnet associated with the Kubernetes cluster in the finding.<br/>5. On the \"Subnet details\" page, click \"Edit\".<br/>6.Under \"Private Google Access\", select \"On\".<br/>7. Click \"Save\".<br/>8. To remove public (external) IPs from VM instances whose only external traffic is to Google APIs, see <a href='https://cloud.google.com/compute/docs/ip-addresses/reserve-static-external-ip-address#unassign_ip'>Unassigning a static external IP address.</a>",
    "severity": "Low",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Logging allows administrators to audit storage bucket use, which is often required by compliance frameworks or industry regulations.",
    "displayName": "Ensure that logging is enabled for Cloud Storage buckets",
    "id": "/providers/Microsoft.Security/assessmentMetadata/258aafc2-7516-474d-9919-65a8a09d96b9",
    "implementationEffort": null,
    "name": "258aafc2-7516-474d-9919-65a8a09d96b9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "To remediate this finding, set up logging for the bucket indicated by the Security Health Analytics finding by completing the <a href='https://cloud.google.com/storage/docs/access-logs'>usage logs & storage logs</a> guide.",
    "severity": "Low",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Storage Object Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies VPC subnets which allow automatic public IP assignment. <br> VPC subnet is a part of the VPC having its own rules for traffic.<br> Assigning the Public IP to the subnet automatically (on launch) can accidentally expose the instances within this subnet to internet and should be edited to 'No' post creation of the Subnet.",
    "displayName": "VPC subnets should not allow automatic public IP assignment",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aad436f2-f0a2-46d8-acf1-19452fb732d2",
    "implementationEffort": null,
    "name": "aad436f2-f0a2-46d8-acf1-19452fb732d2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign into the AWS console. 2. In the console, select the specific region from \"region drop down\" on the top right corner, for which the alert is generated. 3. Navigate to the \"VPC\" service. 4. In the navigation pane, click on \"Subnets\". 5. Select the identified Subnet and choose the option \"Modify auto-assign IP settings\" under the Subnet Actions. 6. Disable the \"Auto-Assign IP\" option and save it.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies S3 buckets that have the bucket policy overly permissive to VPC endpoints. It is a leading practice to follow the principle of least privileges ensuring that the VPC endpoints have only necessary permissions instead of full permission on S3 operations. <br> NOTE: When working with Amazon S3 bucket policies for VPC endpoints, you might block your access to that bucket without intending to do so.<br> Bucket permissions that are intended to specifically limit bucket access to connections originating from your VPC endpoint can block all connections to the bucket.<br> Additionally, The Amazon S3 bucket policy might disable console access to the specified bucket because console requests don't originate from the specified VPC endpoint. <br>Hence, additional care should be taken while remediating any such overly permissive policies.<br> For more details refer <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html\">https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html</a>",
    "displayName": "S3 bucket should not be configured with policy overly permissive to VPC endpoints",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a3697e4-d854-41a5-a3df-d6a5fc664689",
    "implementationEffort": null,
    "name": "1a3697e4-d854-41a5-a3df-d6a5fc664689",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS console. 2. Navigate to the S3 dashboard. 3. Choose the reported S3 bucket. 4. In the \"Permissions\" tab, click on the \"Bucket Policy\". 5. Update the S3 bucket policy for the VPC endpoint so that it has only required permissions instead of full S3 permission.<br> Refer for example: <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html\">https://docs.aws.amazon.com/AmazonS3/latest/dev/example-bucket-policies-vpc-endpoint.html</a>",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies VPC endpoints that have a VPC endpoint (VPCE) policy that is overly permissive.<br> When the Principal element value is set to '*' within the access policy, the VPC endpoint allows full access to any IAM user or service within the VPC using credentials from any AWS accounts. <br> It is a leading practice to follow the principle of least privileged VPCE policy ensuring security against any data leakage and unauthorized access.<br> <br> For more details refer:<br> <a href=\"https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints-access.html\">https://docs.aws.amazon.com/vpc/latest/userguide/vpc-endpoints-access.html</a>",
    "displayName": "VPC enpoint should not be configured with policy overly permissive to any principal",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0ca6e24c-b113-429c-83e1-38e8c4b91396",
    "implementationEffort": null,
    "name": "0ca6e24c-b113-429c-83e1-38e8c4b91396",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS Console. 2. In the console, select the specific region from the region drop-down on the top right corner, for which the alert is generated. 3. Navigate to the \"VPC dashboard\". 4. Go to \"Endpoints\", from the left panel VIRTUAL PRIVATE CLOUD section. 5. Select the reported VPC endpoint. 6. On the \"Actions\" drop-down button, click on the \"Edit policy\". 7. On the \"Edit Policy\" page, Choose \"Custom\" policy. <br> a. Then add policy, without the \"Everyone\" grantee (i.e. '*' or 'AWS': '*') from the Principal element value with an AWS account ID (e.g. '123456789'), an AWS account ARN (e.g. 'arn:aws:iam::123456789:root') or an IAM user ARN (e.g. 'arn:aws:iam::123456789:user/vpce-admin'). <br> b. Add a Condition clause to the policy statement to filter the endpoint access to specific entities. 8. Click on \"Save\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies Amazon CloudFront web distributions which don't have AWS Web Application Firewall (AWS WAF) protection enabled.<br> it is a leading practice to enable the AWS WAF service on CloudFront web distributions to protect web applications from common web exploits, application layer attacks that could affect application availability, compromise security, or consume excessive resources.<br> To block malicious requests to your Cloudfront Content Delivery Network you should define the 'block' criteria in the WAF web access control list (web ACL).",
    "displayName": "Cloudfront distribution should have WAF enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ed36584a-91d9-4639-ae8d-893d0f2cb462",
    "implementationEffort": null,
    "name": "ed36584a-91d9-4639-ae8d-893d0f2cb462",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign in to the AWS console. 2. Go to the CloudFront Distributions Dashboard. 3. Click on the reported web distribution. 4. On \"General\" tab, Click on \"Edit\" button. 5. On \"Edit Distribution\" page, Choose a \"AWS WAF Web ACL\" from dropdown. 6. Click on \"Yes, Edit\"",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies AWS cloudfront distribution not configured with AWS WAF V2 web acl. <br>As a leading practice it is recommended to configure AWS WAF v2 on the cloudfront to protect against application-layer attacks. <br>To block malicious requests to your cloudfront, define the block criteria in the WAFv2 web acl.",
    "displayName": "Cloudfront should have AWS WAF V2 enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/45f50501-deed-438b-b931-340078d0022f",
    "implementationEffort": null,
    "name": "45f50501-deed-438b-b931-340078d0022f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign in to the AWS console. 2. Go to the CloudFront Distributions Dashboard. 3. Click on the reported web distribution. 4. On \"General\" tab, Click on \"Edit\" button under \"Settings\". 5. On \"Edit Distribution\" page, from \"AWS WAF Web ACL\" dropdown select WAFv2 ACL which you want to apply. <br> Note: In case no WAFv2 ACL found from \"AWS WAF Web ACL\" dropdown list, Please follow below URL to create WAFv2 ACL:<br><a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-creating.html\">https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-creating.html</a>. 6. Click on \"Save changes\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies AWS API Gateway REST API which is not configured with AWS Web Application Firewall protection.<br> As a leading practice, you should enable the AWS WAF service on API Gateway REST API to protect against common web exploits, application layer attacks.<br> To block malicious requests to your API Gateway REST API, define the block criteria in the WAF web access control list (web ACL).",
    "displayName": "API Gateway REST API should have AWS WAF V2 enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b288b879-d5e3-49d0-9bad-a9ddf738838a",
    "implementationEffort": null,
    "name": "b288b879-d5e3-49d0-9bad-a9ddf738838a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS console. 2. Make sure your the reported API Gateway REST API requires WAF based on your requirement and Note down the API Gateway REST API name Follow steps given in below URL to associate API Gateway REST API to WAF Web ACL ,<br><a href=\"https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html\">https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html</a>",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies Elastic Load Balancers v2 (ELBv2) which are configured with SSL negotiation policy containing weak ciphers.<br> To simplify, An SSL cipher, or an SSL cipher suite, is a set of algorithms or a set of instructions/steps that uses encryption keys to establish a secure connection between two entities usually the client (a user's browser) and the web server they are connecting to (your website).<br> As many of the other ciphers are not secure as per industry standards, it is recommended to use only the ciphers recommended in the following AWS link:<br> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html\">https://docs.aws.amazon.com/elasticloadbalancing/latest/application/create-https-listener.html</a>",
    "displayName": "ELB v2 should not have SSL negotiation policy configured with weak cipher",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eb2a1621-6fe5-4b17-be36-082897f04987",
    "implementationEffort": null,
    "name": "eb2a1621-6fe5-4b17-be36-082897f04987",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Go to the EC2 Dashboard, and select \"Load Balancers\". 4. Click on the reported Load Balancer. 5. On the 'Listeners' tab, Choose the \"HTTPS\" or 'SSL' rule; Click on \"Edit\", Change 'Security policy' to other than \"ELBSecurityPolicy-TLS-1-0-2015-04\" as it contains DES-CBC3-SHA cipher, which is a weak cipher. 6. Click on \"Update\" to save your changes.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies VPC route tables with overly permissive peering connection to all traffic. <br> It is a leading practice to ensure selective peering connection route tables to reduce the attack surface as resources outside of these routes are inaccessible to the peered VPC.",
    "displayName": "VPC route table should not allow VPC peering overly permissive to all traffic",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9d13e510-5e69-43ec-921f-fe52e2ecc36b",
    "implementationEffort": null,
    "name": "9d13e510-5e69-43ec-921f-fe52e2ecc36b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS Console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to \"VPC\" dashboard from \"Services\" dropdown. 4. From left menu, select \"Route Tables\". 5. Click on the alerted route table. 6. From top click on \"Action\" button. 7. From the Action menu dropdown, select \"Edit routes\". 8. From the list of destination remove the extra permissive destination by clicking the cross symbol available for that destination. 9. Add a destination with \"least access\". 10. Click on \"Save Routes\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies AWS KMS key that are not enabled with key rotation. <br> As a security leading practice, it is important to rotate the keys periodically so that if the keys are compromised, the data in the underlying service is still secure with the new keys.",
    "displayName": "AWS KMS key automatic rotation is not enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5e4503df-e4f7-4055-a38e-ff8ae44dfd1e",
    "implementationEffort": null,
    "name": "5e4503df-e4f7-4055-a38e-ff8ae44dfd1e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to Key Management Service (KMS). 4. Click on \"Customer managed keys\" (Left Panel). 5. Select reported KMS Customer managed key. 6. Under the \"Key Rotation\" tab, Enable \"Automatically rotate this KMS every year\". 7. Click on \"Save\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check ensures that CloudTrail logs are encrypted using AWS KMS key.<br> AWS CloudTrail is a service that enables governance, compliance, operational & risk auditing of the AWS account.<br> It is a compliance and security leading practice to encrypt the CloudTrail data with AWS KMS key as it may contain sensitive information.",
    "displayName": "CloudTrails logs should be encrypted using AWS KMS key",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4c548e51-ca15-4b21-92b7-80acef51da37",
    "implementationEffort": null,
    "name": "4c548e51-ca15-4b21-92b7-80acef51da37",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Login to AWS Console and navigate to the \"CloudTrail\" service. 2. For each trail, under Configuration > Storage Location, select \"Yes\" to \"Encrypt log files\" setting. 3.Choose and existing KMS key or create a new one to encrypt the logs with.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies Redshift Clusters which are encrypted with default KMS keys and not with customer-managed key. <br> It is a leading practice to use customer managed KMS Keys to encrypt your Redshift databases data.<br> Customer-managed CMKs give you more flexibility, including the ability to create, rotate, disable, define access control for, <br>and audit the encryption keys used to help protect your data.",
    "displayName": "RedShift cluster should be encrypted using  customer-managed keys (CMKs)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2a102936-e0ab-4ab6-ab05-0cb15a6587f6",
    "implementationEffort": null,
    "name": "2a102936-e0ab-4ab6-ab05-0cb15a6587f6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign in to the AWS console and open the Amazon Redshift console at <a href=\"https://console.aws.amazon.com/redshift\">https://console.aws.amazon.com/redshift</a>. 2. On the navigation menu, choose \"Clusters\", then choose the cluster that you want to modify encryption. 3. Choose \"Properties\". 4. In the Database configurations section, choose \"Edit\" then choose \"Edit encryption\". 5. Choose \"customer-managed key encryption options\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies Elastic File Systems (EFSs) which are encrypted with default KMS keys and not with Keys managed by Customer. It is a best practice to use customer managed KMS Keys to encrypt your EFS data. It gives you full control over the encrypted data.",
    "displayName": "Amazon EFS should be encrypted using CMK",
    "id": "/providers/Microsoft.Security/assessmentMetadata/885a3b62-d0de-4e54-aaba-f58875fb7888",
    "implementationEffort": null,
    "name": "885a3b62-d0de-4e54-aaba-f58875fb7888",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "AWS EFS Encryption of data at rest can only be enabled during file system creation. In order to resolve this alert, create a new EFS with encryption enabled with the customer-managed key, then migrate all required data from the reported EFS to this newly created EFS and delete reported EFS. <br><br> To create new EFS with encryption enabled, perform the following: <br> 1. Sign into the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to EFS dashboard and click on \"File systems\" on the left panel. 4. Click on \"Create file system\" button. 5. On the \"Configure file system access\" step, specify EFS details as per your requirements and Click on \"Next Step\". 6. On the \"Configure optional settings\" step, Under \"Enable encryption\" Choose \"Enable encryption of data at rest\" and Select customer managed key from \"Select KMS master key\" dropdown list along with other parameters and Click on \"Next Step\". 7. On the \"Review and create\" step, Review all your setting and Click on \"Create File System\" button. <br><br> To delete reported EFS which does not has encryption, perform the following: <br> 1. Sign into the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to EFS dashboard and click on \"File systems\" on the left panel. 4. Select the reported file system. 5. Click on \"Actions\" drop-down. 6. Click on \"Delete file system\". 7. In the \"Permanently delete file system\" popup box, To confirm the deletion enter the file system's ID and Click on \"Delete File System\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This check identifies AWS IAM policy which allows assume role permission across all services. Typically, AssumeRole is used if you have multiple accounts and need to access resources from each account then you can create long term credentials in one account and then use temporary security credentials to access all the other accounts by assuming roles in those accounts.",
    "displayName": "IAM policy should not allow assume role permission across all services",
    "id": "/providers/Microsoft.Security/assessmentMetadata/db0cfb9d-c281-4301-92aa-3d6d12837d8d",
    "implementationEffort": null,
    "name": "db0cfb9d-c281-4301-92aa-3d6d12837d8d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS Console. 2. Navigate to the \"IAM\" service. 3. Identify the reported policy. 4. Change the Service element of the policy document to be more restrictive so that it only allows AssumeRole permission on select services.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies RDS instances which are not set with the automatic backup setting. If Automatic Backup is set, RDS creates a storage volume snapshot of your DB instance, backing up the entire DB instance and not just individual databases which provide for point-in-time recovery. The automatic backup will happen during the specified backup window time and keeps the backups for a limited period of time as defined in the retention period. It is recommended to set automatic backups for your critical RDS servers that will help in the data restoration process.",
    "displayName": "Amazon RDS instance should be configured with automatic backup settings",
    "id": "/providers/Microsoft.Security/assessmentMetadata/894259c2-c1d5-47dc-b5c6-b242d5c76fdf",
    "implementationEffort": null,
    "name": "894259c2-c1d5-47dc-b5c6-b242d5c76fdf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign into the AWS console. 2. In the console, select the specific region from region drop down on the top right corner, for which the alert is generated. 3. Navigate to \"Amazon RDS\" console. 4. Choose \"DB Instances\", and then select the \"reported DB\" instance. 5. On \"Instance Actions\" drop-down list, choose \"Modify\". 6. In \"Backup\" section, <br> a. From the \"Backup Retention Period\" drop-down list, select the number of days you want RDS should retain automatic backups of this DB instance. b. Choose \"Start Time\" and \"Duration\" in \"Backup window\" which is the daily time range (in UTC) during which automated backups created. 7. Click on \"Continue\".  8. On the confirmation page, choose \"Modify DB Instance\" to save your changes",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies Elastic Load Balancers (ELB) which are using ACM certificates expired or expiring in 90 days. AWS Certificate Manager (ACM) is the preferred tool to provision, manage, and deploy your server certificates. With ACM you can request a certificate or deploy an existing ACM or external certificate to AWS resources. As a best practice, it is recommended to reimport expiring/expired certificates while preserving the ELB associations of the original certificate.",
    "displayName": "Elastic Load Balancer should not have ACM certificate expired or expiring in 90 days.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a5e0d700-3de1-469a-96d2-6536d9a92604",
    "implementationEffort": null,
    "name": "a5e0d700-3de1-469a-96d2-6536d9a92604",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign into the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to Amazon Certificate Manager(ACM) service dashboard. 4. Choose the reported certificate. 5. Under \"Actions\" drop-down click on 'Reimport certificate'. 6. On the \"Import a certificate\" page: <br> 6a. For \"Certificate body*\", paste the PEM-encoded certificate to import. 6b. For \"Certificate private key*\", paste the PEM-encoded, unencrypted private key that matches the SSL/TLS certificate public key. 6c. (Optional) For \"Certificate chain\", paste the PEM-encoded certificate chain delivered. 6d. Click Review and import button to continue the process. 7. On the \"Review and import\" page, review the imported certificate details then click on \"Import\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies RDS databases that are encrypted with default KMS keys and not with customer managed keys. As a leading practice, use customer managed keys to encrypt the data on your RDS databases and maintain control of your keys and data on sensitive workloads.",
    "displayName": "Amazon RDS database should be encrypted using customer managed key",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9137f5de-aac8-4cee-a22f-8d81f19be67f",
    "implementationEffort": null,
    "name": "9137f5de-aac8-4cee-a22f-8d81f19be67f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "You can set AWS RDS database encryption only during database creation. Thus, the steps for resolving this alert requires you to create a new RDS database with a customer managed key for encryption, migrate the data from the identified database to this newly created database, and delete the RDS database identified in the alert. <br><br> To create a new RDS database with encryption using a customer managed key: <br> 1. Log in to the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to the Amazon RDS Dashboard. 4. Select \"Create database\". 5. On the \"Select engine\" page, select \"Engine options\" and \"Next\". 6. On the \"Choose use case\" page, select \"Use case\" of database and \"Next\". 7. On the \"Specify DB details\" page, specify the database details you need and click \"Next\". 8. On the \"Configure advanced settings\" page, Under \"Encryption\", select \"Enable encryption\" and select the customer managed key from \"Master key\" dropdown list. 9. Select \"Create database\". <br><br> To delete the RDS database that uses the default KMS keys, which triggered the alert: <br> 1. Log in to the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to the Amazon RDS Dashboard. 4. Click on Instances, and select the reported RDS database. 5. Select the \"Instance actions\" drop-down and click \"Delete\". 6. In the \"Delete\" dialog, select the \"Create final snapshot?\" checkbox, if you want a backup. Provide a name for the final snapshot, confirm deletion and select \"Delete\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies expired SSL/TLS certificates. To enable HTTPS connections to your website or application in AWS, you need an SSL/TLS server certificate. You can use ACM or IAM to store and deploy server certificates. Removing expired SSL/TLS certificates eliminates the risk that an invalid certificate will be deployed accidentally to a resource such as AWS Elastic Load Balancer (ELB), which can damage the credibility of the application/website behind the ELB. This check generates alerts if there are any expired SSL/TLS certificates stored in AWS IAM. As a best practice, it is recommended to delete expired certificates.",
    "displayName": "IAM should not have expired SSL/TLS certificates",
    "id": "/providers/Microsoft.Security/assessmentMetadata/03a8f33c-b01c-4dfc-b627-f98114715ae0",
    "implementationEffort": null,
    "name": "03a8f33c-b01c-4dfc-b627-f98114715ae0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Removing invalid certificates through AWS Management Console is currently not supported. To delete SSL/TLS certificates stored in IAM through the AWS API i.e. the Command Line Interface (CLI). <br><br> Remediation CLI: <br> 1. Run describe-load-balancers command to make sure that the expired server certificate is not currently used by any active load balancer. <br> aws elb describe-load-balancers --region 'COMPUTE_REGION' --load-balancer-names 'ELB_NAME' --query 'LoadBalancerDescriptions[*].ListenerDescriptions [*].Listener.SSLCertificateId' <br><br> - This command output will return the Amazon Resource Name (ARN) for the SSL certificate currently used by the selected ELB: <br> arn:aws:iam::1234567890:server-certificate/MyCertificate <br><br> - If the load balancer listener using the reported expired certificate is not removed before the certificate, the ELB may continue to use the same certificate and work improperly. Thus, to delete the ELB listener that is using the expired SSL certificate, run following command: <br> aws elb delete-load-balancer-listeners --region 'COMPUTE_REGION' --load-balancer-name 'ELB_NAME' --load-balancer-ports 443 <br><br> 2. Now that is safe to remove the expired SSL/TLS certificate from AWS IAM, To delete it run: <br> aws iam delete-server-certificate --server-certificate-name 'CERTIFICATE_NAME'",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies the AWS EC2 instances which are still using EC2 Classic. With EC2-Classic(if your AWS Account supports it), your instances run in a single, flat network that you share with other customers.<br> Where as with Amazon VPC, your instances run in a virtual private cloud (VPC) that's logically isolated to your AWS account.<br> It is a security good practice that deploying VPCs will enable you to leverage enhanced infrastructure security controls.<br> Note: This alert only triggers in regions that support launching into AWS Classic",
    "displayName": "EC2 Classic instance should be configured with VPC",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0cd8771b-44a7-46bd-b8ba-2fb84d20d8d1",
    "implementationEffort": null,
    "name": "0cd8771b-44a7-46bd-b8ba-2fb84d20d8d1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Open the AWS Systems Manager console, and then choose \"Automation\" from the navigation pane. 2. Choose \"Execute automation\". 3. On the Owned by \"Amazon tab\", in the \"Automation document search box\", enter MigrateEC2Classic. 4. Select the \"radio button\" for the AWSSupport-MigrateEC2ClassicToVPC document, and then choose \"Next\". 5. Under Input parameters, for \"InstanceId\", enter your source \"EC2-Classic instance ID\". 6. For \"AutomationAssumeRole\" and \"TargetInstanceType\", choose your required parameters. By default, \"TargetInstanceType\" is set to t2.xlarge.<br> Note:: For more information about the AWS Identity and Access Management (IAM) permissions that are required for AutomationAssumeRole to successfully run the Automation, see AWSSupport-MigrateEC2ClassicToVPC. 7. For \"MigrationType\", select \"Test\" or \"CutOver\". 8. If you select \"CutOver\" for \"MigrationType\", then \"set\" the following parameters:<br> \"SNSNotificationARNForApproval\": Enter the ARN of the SNS topic used to send Approval notifications to stop the source instance.<br> \"ApproverIAM\": Enter the ARN of the IAM users or roles that can approve or reject the action to stop the source instance. 9. Choose \"Execute\".<br> Note: You should also consider disable EC2 Classic in the region to prevent further use.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies AWS AppSync which is not configured with AWS Web Application Firewall V2. <br> As a leading practice, enable the AWS WAF service on AppSync to protect against application layer attacks.<br> To block malicious requests to your AppSync, you can define the block criteria in the WAF web access control list (web ACL) for granular control.",
    "displayName": "AppSync should be configured with AWS WAF V2",
    "id": "/providers/Microsoft.Security/assessmentMetadata/04bf6bba-7661-45b7-8d81-a25d34330b7a",
    "implementationEffort": null,
    "name": "04bf6bba-7661-45b7-8d81-a25d34330b7a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign into the AWS console and open the \"AppSync Console\". 2. Choose the \"API\" that you want to associate with a \"web ACL\". 3. In the navigation \"pane\", choose \"Settings\". 4. In the \"Web application firewall\" section, turn on \"Enable AWS WAF\". 5. In the \"Web ACL\" dropdown list, choose the \"name\" of the \"web ACL\" to associate with your API. 6. Choose \"Save\" to associate the web ACL with your API.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies AWS ALB(Application Load Balancer) which is not configured with AWS Web Application Firewall V2. <br> As a leading practice, enable the AWS WAF service on AWS ALB to protect against application layer attacks.<br> To block malicious requests to your AppSync, you can define the block criteria in the WAF web access control list (web ACL) for granular control.",
    "displayName": "AWS Application Load Balancer should be configured with AWS WAF V2",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f9a947ba-7d72-482d-9a73-f426e931d4ff",
    "implementationEffort": null,
    "name": "f9a947ba-7d72-482d-9a73-f426e931d4ff",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign into the AWS console. 2. Make sure your the reported \"Application Load Balancer\" requires \"WAF\" based on your requirement and Note down the load balancer name. 3. Navigate to \"WAF & Shield\" dashboard. 4. Click on \"Web ACLs\", under \"AWS WAF\" section from left panel. 5. If Web ACL is not created; create a new \"Web ACL\" and add reported \"Application Load Balancer\" to \"Associated AWS resources\". 6. If you have Web ACL already created; Click on \"Web ACL\" and add your reported Application \"Load Balancer\" to \"Associated AWS resources\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies Elastic Load Balancers (Classic) which are configured with SSL negotiation policy containing vulnerable SSL protocol. <br> The SSL protocol establishes a secure connection between a client and a server and ensures that all the data passed between the client and your load balancer is private.<br> As a security leading practice, it is important to use the latest version SSL protocol.",
    "displayName": "AWS Classic Load Balancer should not have SSL negotiation  configured with vulnerable SSL protocol",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2ab12a85-37fc-47f3-a570-4688945ac7c8",
    "implementationEffort": null,
    "name": "2ab12a85-37fc-47f3-a570-4688945ac7c8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign into the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to \"EC2 Dashboard\" and click on \"Load Balancers\" (Left Panel). 4. Click on the reported Load Balancer's \"Listeners\" tab and Click on \"Edit\" button. 5. On \"Edit Listeners\" popup for rule \"HTTPS/SSL\", - If your cipher is \"Predefined Security Policy\", change \"Cipher\" to \"ELBSecurityPolicy-TLS-1-2-2017-01 or latest\" (OR) - If your cipher is \"Custom Security Policy\", Choose \"Protocol-TLSv1.2\" only on \"SSL Protocols\" section. 6. Click on \"Save\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies Elastic Load Balancers (Classic) which are configured with SSL negotiation policy containing insecure ciphers.<br> An SSL cipher is an encryption algorithm that uses encryption keys to create a coded message. <br>SSL protocols use several SSL ciphers to encrypt data over the Internet.<br> As many of the other ciphers are not secure, it is a leading practice to use only the ciphers recommended in the following AWS link:<br> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-ssl-security-policy.html\">https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-ssl-security-policy.html</a>",
    "displayName": "AWS Classic Load Balancer should not have SSL negotiation policy configured with weak cipher",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e44dfbce-8551-4935-8016-ccad8701ad12",
    "implementationEffort": null,
    "name": "e44dfbce-8551-4935-8016-ccad8701ad12",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign in to the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Go to the \"EC2 Dashboard\", and select \"Load Balancers\". 4. Click on the reported \"Load Balancer\". 5. On \"Listeners\" tab, Change the cipher for the \"HTTPS/SSL\" rule. - For a \"Predefined Security Policy', change \"Cipher\" to \"ELBSecurityPolicy-TLS-1-2-2017-01' or latest\" - For a \"Custom Security Policy\", select from the secure ciphers as recommended in the below AWS link: <br> <a href=\"https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-ssl-security-policy.html\"> https://docs.aws.amazon.com/elasticloadbalancing/latest/classic/elb-ssl-security-policy.html</a>. 6. \"Save\" your changes.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies the VPCs which have unauthorized peering. The leading practice is to disallow VPC peering between two VPCs from different AWS accounts, as this potentially enables unauthorized access to private resources.",
    "displayName": "VPC should not allow unauthorized peering connection",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fef14c73-c63f-4bcb-883b-113288b6d77b",
    "implementationEffort": null,
    "name": "fef14c73-c63f-4bcb-883b-113288b6d77b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Sign in to the AWS Console and navigate to AWS VPC service console. 2. In the left navigation panel, select \"Peering Connection\". 3. Choose the reported \"Peering Connection\". 4. Click on \"Actions\" and select \"Delete VPC Peering Connection\". 5. click on \"Yes, Delete\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "A hosted zone is a container for records (An object in a hosted zone that you use to define how you want to route traffic for the domain or a subdomain), which include information about how you want to route traffic for a domain (such as example.com) and all of its subdomains (such as www.example.com, retail.example.com, and seattle.accounting.example.com). A hosted zone has the same name as the corresponding domain. A public hosted zone is a container that holds information about how you want to route traffic on the internet for a specific domain. It is best practice to avoid AWS Route 53 Public Hosted Zones containing DNS records for private IPs or resources within your AWS account to overcome information leakage of your internal network and resources.",
    "displayName": "Amazon Route53 having public hosted zone with private records",
    "id": "/providers/Microsoft.Security/assessmentMetadata/470dc8a8-f118-40a1-96ed-a30f026c3d01",
    "implementationEffort": null,
    "name": "470dc8a8-f118-40a1-96ed-a30f026c3d01",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "You can not convert a public hosted zone into a private hosted zone. Hence, it is a leading practice to create and configure a Private Hosted Zone to manage private IPs within your Virtual Private Cloud (VPC) as Amazon Route 53 service will only return your private DNS records when queried from within the associated VPC, and delete the associated public hosted zone once the Private hosted zone is configured with all the records. <br><br> To create a private hosted zone using the Route 53 console: <br> 1. Sign into the AWS console and navigate to Route53 console. 2. choose Hosted Zones in the navigation pane. 3. Choose \"Create Hosted Zone\". 4. In the Create Private Hosted Zone pane, enter a \"domain name\". 5. In the Type list, choose \"Private Hosted Zone\" for Amazon VPC. 6. In the VPC ID list, choose the \"VPC\" that you want to associate with the hosted zone. If you want to associate more than one VPC with the hosted zone, you can add VPCs after you create the hosted zone. 7. Choose \"Create\". <br><br> To delete a public hosted zone using the Route 53 console: <br><br> 1. Sign into the AWS console and navigate to Route53 console. 2. Confirm that the hosted zone that you want to delete contains only an NS and an \"SOA record\". If it contains additional records, \"delete\" them. 3. On the Hosted Zones page, choose the \"row for the hosted zone\" that you want to delete. 4. Choose \"Delete Hosted Zone\". 5. Choose \"OK\" to confirm.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check identifies ACM Certificates which are using wildcard certificates for wildcard domain name instead of single domain name certificates. ACM allows you to use an asterisk (*) in the domain name to create an ACM Certificate containing a wildcard name that can protect several sites in the same domain. For example, a wildcard certificate issued for *.prismacloud.io can match both www.prismacloud.io and images.prismacloud.io. When you use wildcard certificates, if the private key of a certificate is compromised, then all domain and subdomains that use the compromised certificate are potentially impacted. So it is recommended to use single domain name certificates instead of wildcard certificates to reduce the associated risks with a compromised domain or subdomain.",
    "displayName": "AWS Certificate Manager certificate should not have wildcard domain name",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a5f791e6-be98-47ed-a865-538c759c62b4",
    "implementationEffort": null,
    "name": "a5f791e6-be98-47ed-a865-538c759c62b4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To remediate this finding, you have to replace the reported wildcard certificate with single domain name certificate for all the first-level subdomains resulted from the domain name of the website secured with the wildcard certificate and delete the reported wildcard domain certificate. <br><br> To create a new certificate with a single domain: <br> 1. Sign into the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to Amazon Certificate Manager(ACM) service. 4. In \"Request a certificate\" page enter the information requested: <br> a. On Step 1: \"Add domain names\" page, in the \"Domain name\" box, type the fully qualified domain name. Click on \"Next\". b. On Step 2: \"Select validation method\" page, Select the validation method. Click on \"Review\". c. On Step 3: \"Review\" page, review the domain name and validation method details. click on \"Confirm\". d. On Step 4: \"Validation\" page, validate the certificate request based on the validation method selected. then click on \"Continue\". <br><br> The certificate status should change from \"Pending validation\" to \"Issued\". Now access your application's web server configuration and replace the wildcard certificate with the newly issued single domain name certificate. <br><br> To delete the reported wildcard certificate: <br> 1. Sign into the AWS console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to Amazon Certificate Manager(ACM) service. 4. Choose the reported certificate. 5. Under \"Actions\" drop-down click on \"Delete\". 6. On \"Delete certificate\" popup windows, Click on \"Delete\" button.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This check identifies AWS regions in which the IAM Access Analyzer is not configured. AWS IAM Access Analyzer helps you identify the resources in your organization and accounts, such as Amazon S3 buckets or IAM roles, that are shared with an external entity and identify unintended access to your resources and data. So it is recommended to configure the Access analyzer in all regions in your account.\n\nNOTE: Access Analyzer analyzes only policies that are applied to resources in the same AWS Region that it's enabled in. To monitor all resources in your AWS environment, you must create an analyzer to enable Access Analyzer in each Region where you're using supported AWS resources. <br><br> For more details:<br> <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html\">https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html</a>",
    "displayName": "IAM Access Analyzer should be configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0ad7b369-2c97-406d-ac70-5d9f22bfcbd9",
    "implementationEffort": null,
    "name": "0ad7b369-2c97-406d-ac70-5d9f22bfcbd9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS Console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to the IAM dashboard. 4. Go to \"Access analyzer\", from the left panel. 5. Click on the \"Create analyzer\" button. 6. On the Create analyzer page, enter the parameters as per your requirements. 7. Click on the \"Create analyzer\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies AWS Private ECR repositories that have overly permissive registry policies. An ECR(Elastic Container Registry) repository is a collection of Docker images available on the AWS cloud. These images might contain sensitive information which should be restricted to unauthorized users.",
    "displayName": "Amazon private ECR repository policy should not be overly permissive",
    "id": "/providers/Microsoft.Security/assessmentMetadata/851c1c56-3a4a-422d-b86b-efa629b043b0",
    "implementationEffort": null,
    "name": "851c1c56-3a4a-422d-b86b-efa629b043b0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS Console. 2. Choose the region from the top right corner, for which the alert is generated. 3. Navigate to the AWS ECR Repository service dashboard. 4. Go to \"Repository\", from the left panel. 5. Select the repository for which alert is being generated. 6. Select the \"Permissions\" option from left menu below 'repositories'. 7. Click on \"Edit policy JSON\" to modify the JSON so that Principal is restrictive. 8. After modifications, click on \"Save\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies the AWS ECR Repository resources which are publicly accessible through IAM policies. Ensure that the AWS ECR Repository resources provisioned in your AWS account are not publicly accessible from the Internet to avoid sensitive data exposure and minimize security risks.",
    "displayName": "AWS ECR Repository should not be publicly accessible through IAM policies.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/04e4dc63-ee46-405b-a02a-2a8395fe233d",
    "implementationEffort": null,
    "name": "04e4dc63-ee46-405b-a02a-2a8395fe233d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS console. 2. Navigate to the AWS ECR Repository service dashboard. 3. Find resource-based policy of the AWS ECR Repository resource. 4. Update the \"Principal\" section of the policy to avoid public access.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This alert triggers if a CloudFormation template that when launched will result in resources allowing global network access. Below are three common causes:\n\n- Security Group with a {0.0.0.0/0, ::/0} rule\n- Network Access Control List with a {0.0.0.0/0, ::/0} rule\n- Network Access Control List with -1 IpProtocol",
    "displayName": "CloudFormation template should not contain globally open resources",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1bd970e0-1d18-4aed-8216-d0005f6595c2",
    "implementationEffort": null,
    "name": "1bd970e0-1d18-4aed-8216-d0005f6595c2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "It is a leading practice to review the template and ensure this is the intended behavior. <br> 1. Goto the AWS CloudFormation dashboard. 2. Click on the Stack you want to modify. 3. Select the \"Template\" tab and then View in \"Designer\". 4. Make your template modifications. 5. Check for \"syntax errors\" in your template by choosing \"Validate template\" near the top of the page and save. 6. Choose \"Amazon S3 bucket\", name your template and Save. 7. Copy the bucket URL and click OK. 8. Select \"Close\" to close Designer. 9. Click on the \"Stack\" you want to modify. 10. From the \"Actions\" pull down menu, select \"Update stack\". 11. Choose \"Replace current template\" and paste the URL from Designer into the Amazon S3 URL field. Then click on \"Next\". 12. Specify stack details, then click on \"Next\". 13. Configure stack options, then click on \"Next\". 14. Review, then select \"Update\" stack near the bottom of the page.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This check identifies the AWS Secret Manager Secret resources which are publicly accessible through IAM policies. Ensure that the AWS Secret Manager Secret resources provisioned in your AWS account are not publicly accessible from the Internet to avoid sensitive data exposure and minimize security risks.",
    "displayName": "AWS Secret Manager resource IAM policy allow secret publically accessible.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/baad8309-83f2-437a-a131-6e357c8db91f",
    "implementationEffort": null,
    "name": "baad8309-83f2-437a-a131-6e357c8db91f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "1. Log in to the AWS console. 2. Navigate to the AWS Secret Manager Secret service. 3. Find resource-based policy of the AWS Secret Manager Secret resource. 4. Update the \"Principal\" section of the policy to avoid public access.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "The domain registries for all generic TLDs and many geographic TLDs let you lock a domain to prevent someone from transferring the domain to another registrar without your permission.<br> It is a leading practice to lock your domain.",
    "displayName": "Domain transfer lock is not enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f7b076bd-9747-490f-b04d-1cf0418bc428",
    "implementationEffort": null,
    "name": "f7b076bd-9747-490f-b04d-1cf0418bc428",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To lock a domain to prevent unauthorized transfer to another registrar: <br><br> 1. Sign in to the AWS Management Console and open the Route 53 console at https://console.aws.amazon.com/route53/. 2. In the navigation pane, choose \"Registered Domains\". 3. Choose the name of the domain that you want to update. 4. Choose \"Enable\" (to lock the domain) or \"Disable\" (to unlock the domain). 5. Choose \"Save\". ",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Amazon Macie is a fully managed data security and data privacy service that uses machine learning and pattern matching to discover and protect your sensitive data in AWS.</br> It is a leading practice to enable macie to ensure data security and privacy.</br> for more information please refer:</br> https://aws.amazon.com/macie/faq/",
    "displayName": "AWS Macie should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c4e73b9a-f8ad-4e50-9e33-b33f21b6b80f",
    "implementationEffort": null,
    "name": "c4e73b9a-f8ad-4e50-9e33-b33f21b6b80f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "After you set up the required permissions, you can enable Macie.</br> Follow these steps to enable Macie.</br>To enable Macie, Open the Amazon Macie console at https://console.aws.amazon.com/macie/.</br>By using the AWS Region selector in the upper-right corner of the page, select the Region in which you want to enable Macie.</br>Choose \"Get started\".</br>(Optional) When you enable Macie, Macie creates a service-linked role that grants Macie the permissions that it requires to call other AWS services on your behalf. </br>To learn more about this role, see \"Service-linked roles for Amazon Macie\".</br> Enable Macie.</br>Within minutes, Macie generates an inventory of the Amazon Simple Storage Service (Amazon S3) buckets for your account in the current Region.</br> Macie also begins monitoring the buckets for security and access control.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "With invocation logging, you can collect the full request data, response data, and metadata associated with all calls performed in your account. This enables you to recreate activity trails for investigation purposes when a security incident occurs. Learn more at: <a href=\"https://docs.aws.amazon.com/bedrock/latest/userguide/model-invocation-logging.html\" target=\"_blank\">Model invocation logging - Amazon Bedrock</a>",
    "displayName": "AWS Bedrock should have model invocation logging enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a202dce-e13f-43ba-8a97-2f9235c5c834",
    "implementationEffort": "Low",
    "name": "1a202dce-e13f-43ba-8a97-2f9235c5c834",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "30/04/2024"
    },
    "remediationDescription": "To enable model invocation logging, in AWS Bedrock's settings:<br><ol><li>From your AWS account, open the AWS Bedrock service.</li><li>From the left sidebar, select \"Settings\".</li><li>Toggle the \"Model Invocation Logging\" to enable logs collection.</li><li>Choose the relevant data types you would like to log.</li><li>Select one of the destination options to store the model invocation logs and insert relevant details.</li><li>Select \"Save settings\".</li>",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Encrypting grounding data (i.e., knowledge-base data) can prevent access to sensitive data in the event of a data breach.",
    "displayName": "S3 buckets used to store knowledge base data should have server-side encryption enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/32a41e64-79e3-482e-8792-90d614e44522",
    "implementationEffort": "Low",
    "name": "32a41e64-79e3-482e-8792-90d614e44522",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "06/05/2024"
    },
    "remediationDescription": "To enable server-side encryption on an S3 bucket and allow AWS Bedrock to access it:<ol><li>From your AWS account, open Amazon S3 Service.</li><li>Select the bucket you used for your grounding data (when configuring the knowledge base, created via AWS Bedrock).</li><li>Select \"Properties\", and then under the \"Default encryption\" section, select either \"AES-256\" to use keys that are managed by Amazon S3, or \"AWS-KMS\" to use keys that are managed by AWS-KMS</li></ol>&#8226; If you use AWS-KMS for default encryption, you need to choose a master key from the list of the AWS KMS master keys that you have created<br>&#8226; Note that if you use AWS-KMS you are subject to limited requests per second</li></ul>Learn more at: <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html\" target=\"_blank\">Protecting data with server-side encryption - Amazon Simple Storage Service</a><br><br>To allow AWS Bedrock permission to access the encrypted bucket:<ul><li>Attach the policy defined here: <a href=\"https://docs.aws.amazon.com/AmazonS3/latest/userguide/serv-side-encryption.html\" target=\"_blank\">Encryption of knowledge base resources - Amazon Bedrock</a> To your Amazon Bedrock service role</li></ul>",
    "severity": "High",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation",
      "Data from Cloud Storage Object"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:7000-7001, 7199, 8888, 9042, 9160, 61620-61621.",
    "displayName": "Firewall should not be configured to have an open CASSANDRA port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/06ee058b-9ba9-4a54-a6d3-7214703d309f",
    "implementationEffort": null,
    "name": "06ee058b-9ba9-4a54-a6d3-7214703d309f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Configuring firewall rules to allow any IP address to connect to Cassandra ports can expose Cassandra services to attackers. <br>For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br><br> This recommendation is generated for vulnerable firewall rules, even if they were intentionally disabled. Disabled firewall rules alert you to unsafe configurations which could allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocol and port: TCP:9090.",
    "displayName": "Firewall should not be configured to have an open CISCOSECURE_WEBSM port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/87cb47d9-eb93-4413-be7f-2f89112d3e22",
    "implementationEffort": null,
    "name": "87cb47d9-eb93-4413-be7f-2f89112d3e22",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Configuring Firewall rules to allow any IP address to connect to CiscoSecure/WebSM ports can expose your CiscoSecure/WebSM services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a> <br><br> This recommendation is generated for vulnerable firewall rules, even if they were intentionally disabled. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:445 and UDP:445.",
    "displayName": "Firewall should not be configured to have an open DIRECTORY_SERVICES port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9c59d6ae-79c9-4f74-bacd-9bb8d2b05576",
    "implementationEffort": null,
    "name": "9c59d6ae-79c9-4f74-bacd-9bb8d2b05576",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to Directory ports might expose your Directory services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br> The Directory service ports are:<br> TCP - 445<br> UDP - 445<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:53 and UDP:53.",
    "displayName": "Firewall should not be configured to have an open DNS port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/99fa8cd5-10fc-4051-909c-62a6d1272956",
    "implementationEffort": null,
    "name": "99fa8cd5-10fc-4051-909c-62a6d1272956",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to DNS ports might expose your DNS services to attackers.<br> For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br> The DNS service ports are:<br> TCP - 53<br> UDP - 53<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:9200, 9300.",
    "displayName": "Firewall should not be configured to have an open ELASTICSEARCH port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9c39d3a7-a11d-4f1e-a5b8-8c3be23fe0d1",
    "implementationEffort": null,
    "name": "9c39d3a7-a11d-4f1e-a5b8-8c3be23fe0d1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to Elasticsearch ports might expose your Elasticsearch services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br><br> The Elasticsearch service ports are:<br> TCP - 9200, 9300<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the sourceRanges and allowed properties for one of two configurations: <br> <br> The sourceRanges property contains 0.0.0.0/0 and the allowed property contains a combination of rules that includes any protocol or protocol:port, except the following:<br> icmp<br> tcp:22<br> tcp:443<br> tcp:3389<br> udp:3389<br> sctp:22<br> <br> The sourceRanges property contains a combination of IP ranges that includes any non-private IP address and the allowed property contains a combination of rules that permit either all tcp ports or all udp ports.",
    "displayName": "Firewall should not be configured to be open to public access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/98c71657-9a57-4a9c-8cc0-e69136b9ec13",
    "implementationEffort": null,
    "name": "98c71657-9a57-4a9c-8cc0-e69136b9ec13",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow connections from all IP addresses, like 0.0.0.0/0, or from all ports can unnecessarily expose resources to attacks from unintended sources. These rules should be removed or scoped explicitly to the intended source IP ranges or ports. <br>For example, in applications intended to be public, consider restricting allowed ports to those needed for the application, like 80 and 443. If your application needs to allow connections from all IP addresses or ports, consider <a href=\"https://cloud.google.com/security-command-center/docs/how-to-use-security-health-analytics#allowlist-findings\">adding the asset to an allowlist</a>. Learn more about <a href=\"https://cloud.google.com/vpc/docs/using-firewalls#updating_firewall_rules\">Updating firewall rules</a>. <br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br> 1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. Click the firewall rule listed in the Security Health Analytics finding, and then click \"Edit\". 3. Under \"Source IP ranges\", \"edit\" the IP values to restrict the range of IPs that is allowed. 4. Under \"Protocols and ports\", \"select\" \"Specified protocols and ports\", \"select\" the allowed protocols, and enter ports that are allowed. 5. Click \"Save\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocol and port: TCP:21.",
    "displayName": "Firewall should not be configured to have an open FTP port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/14dae408-be1b-4ab9-8645-1d9eba885a3e",
    "implementationEffort": null,
    "name": "14dae408-be1b-4ab9-8645-1d9eba885a3e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to FTP ports might expose your FTP services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br> <br>The FTP service ports are:<br> TCP - 21<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:80.",
    "displayName": "Firewall should not be configured to have an open HTTP port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d6e19ca8-7446-4b1a-87e9-fb0bee876c80",
    "implementationEffort": null,
    "name": "d6e19ca8-7446-4b1a-87e9-fb0bee876c80",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to HTTP ports might expose your HTTP services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br><br> The HTTP service ports are:<br> TCP - 80<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:389, 636 and UDP:389.",
    "displayName": "Firewall should not be configured to have an open LDAP port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/114491f8-1760-40b9-ad56-04be9c0be1d6",
    "implementationEffort": null,
    "name": "114491f8-1760-40b9-ad56-04be9c0be1d6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to LDAP ports might expose your LDAP services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br><br> The LDAP service ports are:<br> TCP - 389, 636<br> UDP - 389<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:11211, 11214-11215 and UDP:11211, 11214-11215.",
    "displayName": "Firewall should not be configured to have an open MEMCACHED port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dcbfebbd-0d89-4605-b29c-a8b94a11ca4c",
    "implementationEffort": null,
    "name": "dcbfebbd-0d89-4605-b29c-a8b94a11ca4c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to Memcached ports might expose your Memcached services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br><br> The Memcached service ports are:<br> TCP - 11211, 11214, 11215<br> UDP - 11211, 11214, 11215<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:27017-27019.",
    "displayName": "Firewall should not be configured to have an open MONGODB port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0088a052-38cd-4ef3-80bc-982871756481",
    "implementationEffort": null,
    "name": "0088a052-38cd-4ef3-80bc-982871756481",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to MongoDB ports might expose your MongoDB services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br><br> The MongoDB service ports are:<br> TCP - 27017, 27018, 27019<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocol and port: TCP:3306.",
    "displayName": "Firewall should not be configured to have an open MYSQL port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/184a6210-9eb3-4d41-9453-84fd7f01186e",
    "implementationEffort": null,
    "name": "184a6210-9eb3-4d41-9453-84fd7f01186e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to MySQL ports might expose your MySQL services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br><br> The MySQL service ports are:<br> TCP - 3306<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:137-139 and UDP:137-139.",
    "displayName": "Firewall should not be configured to have an open NETBIOS port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f39b9212-7c2e-4265-85ad-14701b0209e3",
    "implementationEffort": null,
    "name": "f39b9212-7c2e-4265-85ad-14701b0209e3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to NetBIOS ports might expose your NetBIOS services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br><br> The NetBIOS service ports are:<br> TCP - 137, 138, 139<br> UDP - 137, 138, 139<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:1521, 2483-2484 and UDP:2483-2484.",
    "displayName": "Firewall should not be configured to have an open ORACLEDB port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/802bc806-5136-461f-a95d-dd65f8725af0",
    "implementationEffort": null,
    "name": "802bc806-5136-461f-a95d-dd65f8725af0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to OracleDB ports might expose your OracleDB services to attackers. SeFor more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br><br> The OracleDB service ports are:<br> TCP - 1521, 2483, 2484<br> UDP - 2483, 2484<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocol and port: TCP:110.",
    "displayName": "Firewall should not be configured to have an open POP3 port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4f5e97a0-d563-4c0a-8aca-958753dfbeb6",
    "implementationEffort": null,
    "name": "4f5e97a0-d563-4c0a-8aca-958753dfbeb6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to POP3 ports might expose your POP3 services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br><br> The POP3 service ports are:<br> TCP - 110<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the allowed property in firewall metadata for the following protocols and ports: TCP:5432 and UDP:5432.",
    "displayName": "Firewall should not be configured to have an open PostgreSQL port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/27d1143d-a7ab-405c-a80c-8b9da25bc5e4",
    "implementationEffort": null,
    "name": "27d1143d-a7ab-405c-a80c-8b9da25bc5e4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to PostgreSQL ports might expose your PostgreSQL services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br> <br>The PostgreSQL service ports are:<br> TCP - 5432<br> UDP - 5432<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates whether the allowed property in firewall metadata contains the following protocol and port: TCP:6379.",
    "displayName": "Firewall should not be configured to have an open REDIS port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9a7b9056-30af-476f-bdc8-8b421d29b5e3",
    "implementationEffort": null,
    "name": "9a7b9056-30af-476f-bdc8-8b421d29b5e3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to Redis ports might expose your Redis services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br> <br>The Redis service ports are:<br> TCP - 6379<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates whether the allowed property in firewall metadata contains the following protocol and port: TCP:25.",
    "displayName": "Firewall should not be configured to have an open SMTP port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5855b7ce-fded-464c-894c-d34bd834f17e",
    "implementationEffort": null,
    "name": "5855b7ce-fded-464c-894c-d34bd834f17e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to SMTP ports might expose your SMTP services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br><br> The SMTP service ports are:<br> TCP - 25<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates whether the allowed property in firewall metadata contains the following protocols and ports: TCP:22 and SCTP:22.",
    "displayName": "Firewall should not be configured to have an open SSH port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4c8753af-c7d5-404f-abdf-8e8bef018dc9",
    "implementationEffort": null,
    "name": "4c8753af-c7d5-404f-abdf-8e8bef018dc9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to SSH ports might expose your SSH services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>.<br> <br> The SSH service ports are:<br> SCTP - 22<br> TCP - 22<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates whether the allowed property in firewall metadata contains the following protocol and port: TCP:23.",
    "displayName": "Firewall should not be configured to have an open TELNET port that allows generic access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bdb01af7-e42a-49c6-952f-b83ce13914a7",
    "implementationEffort": null,
    "name": "bdb01af7-e42a-49c6-952f-b83ce13914a7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules that allow any IP address to connect to Telnet ports might expose your Telnet services to attackers. For more information, <a href=\"https://cloud.google.com/vpc/docs/firewalls\">see VPC firewall rules overview</a>. <br><br> The Telnet service ports are:<br> TCP - 23<br><br> This finding is generated for vulnerable firewall rules, even if you intentionally disable the rules. Active findings for disabled firewall rules alert you to unsafe configurations that will allow undesired traffic if enabled.<br><br> To remediate this finding, complete the following steps:<br>  1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.24292733.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, select the name of the firewall rule in the finding. 3. Select \"Edit\". 4. Under \"Source IP ranges\", \"delete\" 0.0.0.0/0. 5. \"Add\" specific IP addresses or IP ranges that you want to allow to connect to the instance. 6. \"Add\" specific protocols and ports you want to open on your instance. 7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates if the selfLink property of the targetHttpProxy resource matches the target attribute in the forwarding rule, and if the forwarding rule contains a loadBalancingScheme field set to External.",
    "displayName": "Compute instances should use a load balancer that is configured to use a target HTTPS proxy",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c3be77f6-6fa9-45bd-9bdb-420484420235",
    "implementationEffort": null,
    "name": "c3be77f6-6fa9-45bd-9bdb-420484420235",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "A Compute Engine instance uses a load balancer that is configured to use a target HTTP proxy instead of a target HTTPS proxy. <br><br> To protect the integrity of your data and prevent intruders from tampering with your communications, configure your HTTP(S) load balancers to allow only HTTPS traffic. For more information, see <a href=\"https://cloud.google.com/load-balancing/docs/https\">External HTTP(S) Load Balancing overview</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Target proxies\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/net-services/loadbalancing/advanced/targetProxies/list?_ga=2.90531293.612725499.1653394238-1730296467.1639556914\"> Go to Target proxies</a>. 2. In the list of target proxies, click the name of the target proxy in the finding. 3. Click the link under the \"URL map\". 4. Click \"Edit\". 5. Click \"Frontend configuration\". 6. Delete all \"Frontend IP\" and port configurations that allow HTTP traffic and create new ones that allow HTTPS traffic.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the management property of a node pool for the key-value pair, 'key': 'autoRepair', 'value': true.",
    "displayName": "GKE cluster's auto repair feature should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6aeb69dc-0d01-4228-88e9-7e610891d5dd",
    "implementationEffort": null,
    "name": "6aeb69dc-0d01-4228-88e9-7e610891d5dd",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "A Google Kubernetes Engine (GKE) cluster's auto repair feature, which keeps nodes in a healthy, running state, is disabled. <br><br> When enabled, GKE makes periodic checks on the health state of each node in your cluster. If a node fails consecutive health checks over an extended time period, GKE initiates a repair process for that node. For more information, see <a href=\"https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-repair\">Auto-repairing nodes</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Kubernetes clusters\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/kubernetes/list?_ga=2.187861103.612725499.1653394238-1730296467.1639556914\">Go to Kubernetes clusters </a>. 2. Click the \"Nodes\" tab.  3. For each node pool: <br> 1. Click the name of the node pool to go to its detail page. 2. Click \"Edit\". 3. Under \"Management\", select \"Enable auto-repair\". 4. Click \"Save\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the management property of a node pool for the key-value pair, 'key': 'autoUpgrade', 'value': true.",
    "displayName": "GKE cluster's auto upgrade feature should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1680e053-2e9b-4e77-a1c7-793ae286155e",
    "implementationEffort": null,
    "name": "1680e053-2e9b-4e77-a1c7-793ae286155e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "A GKE cluster's auto upgrade feature, which keeps clusters and node pools on the latest stable version of Kubernetes, is disabled. <br><br> For more information, see <a href=\"https://cloud.google.com/kubernetes-engine/docs/concepts/node-auto-upgrades\">Auto-upgrading nodes</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the Kubernetes clusters page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/kubernetes/list?_ga=2.28667387.612725499.1653394238-1730296467.1639556914\">Go to Kubernetes clusters</a> <br> 2. In the list of clusters, click the name of the cluster. <br> 3. Click the Nodes tab. <br> For each node pool: <br> 1. Click the name of the node pool to go to its detail page.<br> 2. Click \"Edit\".<br> 3. Under \"Management\", select \"Enable auto-upgrade\".<br> 4. Click \"Save\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that logging is not enabled on your GKE clusters. This poses a risk of reduced visibility into cluster activity, making it difficult to detect security issues or operational anomalies. We recommend enabling logging on GKE clusters to ensure comprehensive monitoring and timely detection of issues.",
    "displayName": "Logging should be enabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fa160a2c-e976-41cb-acff-1e1e3f1ed032",
    "implementationEffort": null,
    "name": "fa160a2c-e976-41cb-acff-1e1e3f1ed032",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To enable logging for your Kubernetes clusters: 1. In the Google Cloud console, navigate to the Kubernetes Engine page. 2. Select the cluster where logging is disabled. 3. Under the \"Features\" section in the details pane, click the pencil icon to edit Logging. 4. Check the box next to \"Enable Logging\". 5. In the drop-down \"Components\" box, select the components to be logged.  6. Click \"Save Changes\" and wait for the cluster to update.<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/view-logs\">logging in GKE</a>.",
    "severity": "Medium",
    "tactics": [
      "Persistence",
      "Defense Evasion"
    ],
    "techniques": [
      "Create or Modify System Process",
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that Cloud Monitoring is not enabled on your GKE clusters. Without Cloud Monitoring enabled, you lose critical insight into performance metrics, cluster health, and potential security breaches. This poses the risk of having difficulty troubleshooting issues, analyzing security events, and optimizing resource usage. We recommend enabling Cloud Monitoring in your GKE clusters to mitigate these risks.",
    "displayName": "Cloud Monitoring should be enabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6a7b7361-5100-4a8c-b23e-f712d7dad39b",
    "implementationEffort": null,
    "name": "6a7b7361-5100-4a8c-b23e-f712d7dad39b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To enable Cloud Monitoring on your existing GKE clusters: 1. In the Google Cloud console, navigate to \"Kubernetes engine\". 2. Select the cluster for which Cloud Monitoring needs to be enabled. 3. In the \"Details\" tab, navigate to the \"Features\" section. 4. Click the edit icon next to \"Cloud Monitoring\". 5. Check the \"Enable Cloud Monitoring\" option. 6. Choose the desired monitoring components from the \"Components\" dropdown. 7. Click \"Save changes\". <br> Enabling Cloud Monitoring may result in additional costs. For more details please refer to <a href=\"https://cloud.google.com/stackdriver/pricing#monitoring-costs\">Cloud Monitoring pricing details</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Discovery"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Network Service Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates whether the privateIpGoogleAccess property of a subnetwork is set to false.",
    "displayName": "Cluster hosts should be configured to use only private, internal IP addresses to access Google APIs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fae39f34-d931-4026-b09c-b0a785bb1ff9",
    "implementationEffort": null,
    "name": "fae39f34-d931-4026-b09c-b0a785bb1ff9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Cluster hosts are not configured to use only private, internal IP addresses to access Google APIs. <br><br> Private Google Access enables virtual machine (VM) instances with only private, internal IP addresses to reach the public IP addresses of Google APIs and services. For more information, see <a href=\"https://cloud.google.com/vpc/docs/configure-private-google-access\">Configuring Google Private Access</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Virtual Private Cloud networks\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/networks/list?_ga=2.186812655.612725499.1653394238-1730296467.1639556914\">Go to VPC networks </a>. 2. In the list of networks, click the name of the desired network. 3. On the \"VPC network details\" page, click the \"Subnets\" tab. 4. In the list of subnets, click the name of the subnet associated with the Kubernetes cluster in the finding. 5. On the \"Subnet details\" page, click \"Edit\". 6. Under \"Private Google Access\", select \"On\". 7. Click \"Save\". 8. To remove public (external) IPs from VM instances whose only external traffic is to Google APIs, see <a href=\"https://cloud.google.com/compute/docs/ip-addresses/reserve-static-external-ip-address#unassign_ip\">Unassigning a static external IP address</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that Container-Optimized OS (COS) is not used for your GKE node pools. COS is a specialized operating system from Google that is optimized for running Docker containers in GKE. This poses a risk of diminished security hardening and performance optimization for your container workloads. We recommend switching to Container-Optimized OS with containerd (cos_containerd) for your GKE node pools to improve both security and performance.",
    "displayName": "Container-Optimized OS should be configured for GKE node pools",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3e33004b-f0b8-488d-85ed-61336c7ad4ca",
    "implementationEffort": null,
    "name": "3e33004b-f0b8-488d-85ed-61336c7ad4ca",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To configure Container-Optimized OS for your Kubernetes node pools: 1. In the Google Cloud console, navigate to \"Kubernetes engine\". 2. Select your Kubernetes cluster that is not currently using Container-Optimized OS. 3. Go to the \"Nodes\" tab. 4. In the \"Node Pools\" section, identify the node pool that needs to be updated. 5. Click \"Edit\". Then, in the \"Image Type\" section, click \"Change\". 6. From the pop-up menu, select \"Container-Optimized OS with containerd\" and confirm by clicking \"Change\". 7. Apply these changes to all your node pools that are not compliant.<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/container-optimized-os/docs/concepts/features-and-benefits\">Container-Optimized OS overview</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Command and Scripting Interpreter"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that alias IP ranges are not enabled for pods within your GKE clusters. Alias IP ranges enhance network isolation for pods, thereby reducing the risk of IP conflicts and unauthorized access. This poses a risk of pods being more susceptible to security breaches and potential exploitation by attackers. We recommend using alias IP ranges for your GKE cluster to mitigate these risks.",
    "displayName": "Alias IP ranges should be used on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/49016ecd-d4d6-4f48-a64f-42af93e15120",
    "implementationEffort": null,
    "name": "49016ecd-d4d6-4f48-a64f-42af93e15120",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Alias IPs cannot be enabled on an existing cluster. To create a new GCP cluster with alias IPs: 1. In the Google Cloud console, navigate to the Kubernetes Engine page. 2. Click on \"Create\". 3. Configure your cluster according to your preferences and then navigate to the \"Networking\" tab. 4. Under \"Advanced networking options\", select \"Enable VPC-native traffic routing (uses alias IP)\" 5. Click on \"Create\" to finalize the creation of your cluster. <br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/alias-ips\">create a VPC-native cluster</a>.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Service Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that legacy authorization is enabled on your GKE clusters. Legacy authorization, or Attribute-Based Access Control (ABAC), is an outdated access management system and disabled by default in the latest GKE clusters. ABAC grants broad, statically defined permissions. This poses a risk of unauthorized access to your cluster resources. This also enables malicious actors to abuse privileges and expose sensitive data. We recommend disabling legacy authorization on your GKE clusters and switching to Role-Based Access Control (RBAC) to mitigate these risks.",
    "displayName": "Legacy authorization should be disabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bd1096e1-73cf-41ab-8f2a-257b78aed9dc",
    "implementationEffort": null,
    "name": "bd1096e1-73cf-41ab-8f2a-257b78aed9dc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To disable the legacy authorization in your GKE clusters: 1. In the Google Cloud console, navigate to \"Kubernetes Engine\". 2. Select the cluster you need to update. 3. Navigate to the \"Security\" section and edit the \"Legacy authorization\" setting. 4. Uncheck the \"Enable legacy authorization\" checkbox and click on \"Save changes\".<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_authn_methods\">disable legacy authorization</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Persistence"
    ],
    "techniques": [
      "Valid Accounts",
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the masterAuthorizedNetworksConfig property of a cluster for the key-value pair, 'enabled': false.",
    "displayName": "Control Plane Authorized Networks should be enabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/24df9ba4-8c98-42f2-9f64-50b095eca06f",
    "implementationEffort": null,
    "name": "24df9ba4-8c98-42f2-9f64-50b095eca06f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Control Plane Authorized Networks is not enabled on GKE clusters. <br><br> Control Plane Authorized Networks improves security for your container cluster by blocking specified IP addresses from accessing your cluster's control plane.<br> For more information, see <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks\">Adding authorized networks for control plane access</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Kubernetes clusters\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/kubernetes/list?_ga=2.99852889.612725499.1653394238-1730296467.1639556914\">Go to Kubernetes clusters</a>. 2. Select the cluster listed in the Security Health Analytics finding. 3. Click \"Edit\". <br> If the cluster configuration recently changed, the edit button might be disabled. If you aren't able to edit the cluster settings, wait a few minutes and then try again. 4. On the \"Control Plane Authorized Networks\" drop-down list, select \"Enabled\". 5. Click \"Add authorized network\". 6. Specify the authorized networks you want to use. <br> 7. Click \"Save\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the networkPolicy field of the addonsConfig property for the key-value pair, 'disabled': true.",
    "displayName": "Network policy should be enabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fd06513a-1e03-4d40-9159-243f76dcdcb7",
    "implementationEffort": null,
    "name": "fd06513a-1e03-4d40-9159-243f76dcdcb7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Network policy is disabled on GKE clusters. <br><br> By default, pod to pod communication is open. Open communication allows pods to connect directly across nodes, with or without network address translation. A NetworkPolicy resource is like a pod-level firewall that restricts connections between pods, unless the NetworkPolicy resource explicitly allows the connection. Learn how to <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#restrict_with_network_policy\">define a network policy</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Kubernetes clusters\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/kubernetes/list?_ga=2.266094920.612725499.1653394238-1730296467.1639556914\">Go to Kubernetes clusters</a>. 2. Click the name of the cluster listed in the Security Health Analytics finding. 3. Under \"Networking\", in the row for \"Network policy\", click \"Edit\". <br> If the cluster configuration recently changed, the edit button might be disabled. If you aren't able to edit the cluster settings, wait a few minutes and then try again. 4. In the dialog, select \"Enable network policy for control plane\" and \"Enable network policy for nodes\". 5. Click \"Save Changes\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the Compute Engine default service account is being used for the nodes in your GKE clusters. The default service account grants more permissions than necessary to the cluster workloads. This poses a risk of unauthorized access or privilege escalation. We recommend switching to custom service accounts with more restrictive permissions in your GKE clusters to mitigate these risks.",
    "displayName": "Default service accounts should not be used in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b73bad4f-4ea7-4d04-bab0-d400cb3ad639",
    "implementationEffort": null,
    "name": "b73bad4f-4ea7-4d04-bab0-d400cb3ad639",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "An existing node pool cannot be modified to use a custom service account. To create a new node pool that uses a custom service account: 1. In the Google Cloud console, navigate to the Kubernetes Engine page. 2. Select the cluster that needs to be updated. 3. Click \"Add node pool\". 4. Under the \"Security\" section in the node pool details, select the custom service account from the \"Service Account\" drop-down menu. 5. Click \"Create\" to create the node pool. 6. Migrate workloads to the new node pool from the old one. 7. Delete the old node pool.<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa\">use least privilege IAM service accounts</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that public access is enabled on your GKE clusters. This poses a risk of exposing your cluster resources to the public internet. Private clusters are ideal for workloads that require controlled access due to data privacy and security regulations. We recommend using private GKE clusters to restrict the exposure of your cluster resources to the public internet.",
    "displayName": "Private nodes should be enabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d3e70cff-e4db-47b1-b646-0ac5ed8ada36",
    "implementationEffort": null,
    "name": "d3e70cff-e4db-47b1-b646-0ac5ed8ada36",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To enable private nodes while creating a new GKE cluster: 1. In the Google Cloud Console, navigate to \"Kubernetes engine\" and click on \"Create\". 2. Choose the type of cluster and click \" Configure\". 3. Navigate to the \"Networking\" tab. 4. Under IPv4 network access, enable the private cluster option. 5. Provide the required details and click \"Create\" to create your cluster.<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters\">creating a private cluster</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the Kubernetes Web UI (Dashboard) is enabled on your GKE clusters. The Kubernetes Web UI (Dashboard) has historically been a source of vulnerabilities and should only be deployed when necessary. This poses a risk of unauthorized access to your cluster, potentially leading to data breaches or other malicious activities. We recommend disabling the Kubernetes Web UI (Dashboard) to mitigate these risks.",
    "displayName": "The Kubernetes Web UI (Dashboard) should be disabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d8fa5c03-a8e8-467b-992c-ad8b2db0f55e",
    "implementationEffort": null,
    "name": "d8fa5c03-a8e8-467b-992c-ad8b2db0f55e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "To disable the Kubernetes Web UI (Dashboard) on your GKE cluster: 1. In the Google Cloud Console, navigate to the Cloud Shell. 2. Run this command: <code>gcloud container clusters update [cluster-name] --zone [zone] --update-addons=KubernetesDashboard=DISABLED</code><br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster#disable_kubernetes_dashboard\">harden your cluster's security</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates whether the destinationRanges property in the firewall is set to 0.0.0.0/0 and the denied property contains the key-value pair, 'IPProtocol': 'all'.",
    "displayName": "Egress deny rule should be set on a firewall to block unwanted outbound traffic",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2acc6ce9-c9a7-4d91-b7c8-f2314ecbf8af",
    "implementationEffort": null,
    "name": "2acc6ce9-c9a7-4d91-b7c8-f2314ecbf8af",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "An egress deny rule is not set on a firewall. <br><br> A firewall that denies all egress network traffic prevents any unwanted outbound network connections, except those connections other firewalls explicitly authorize. For more information, see  <a href=\"https://cloud.google.com/vpc/docs/firewalls#egress_cases\">Egress cases</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.86205023.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. Click \"Create Firewall Rule\". 3. Give the firewall a name and, optionally, a description. 4. Under \"Direction of traffic\", select \"Egress\". 5. Under \"Action on match\", select \"Deny\". 6. In the \"Targets\" drop-down menu, select \"All instances in the network\". 7. In the \"Destination filter\" drop-down menu, select \"IP ranges\", and then type 0.0.0.0/0 into the \"Destination IP ranges\" box. 8. Under \"Protocols and ports\", select \"Deny all\". 9. Click \"Disable Rule\" then, under \"Enforcement\", select \"Enabled\". 10. Click \"Create\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "This recommendation evaluates the logConfig property in firewall metadata to see if it's empty or contains the key-value pair 'enable': false.",
    "displayName": "Firewall rule logging should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/37e5206e-a928-416b-9851-3689f506f73f",
    "implementationEffort": null,
    "name": "37e5206e-a928-416b-9851-3689f506f73f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Firewall rules logging is disabled. <br><br> Firewall rules logging lets you audit, verify, and analyze the effects of your firewall rules. It can be useful for auditing network access or providing early warning that the network is being used in an unapproved manner. The cost of logs can be significant. For more information on Firewall Rules Logging and its cost, see <a href=\"https://cloud.google.com/vpc/docs/using-firewall-rules-logging\">Using Firewall Rules Logging</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Firewall\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/networking/firewalls/list?_ga=2.19637887.612725499.1653394238-1730296467.1639556914\">Go to Firewall</a>. 2. In the list of firewall rules, click the name of the desired firewall rule. 3. Click \"Edit\". 4. Under \"Logs\", select \"On\". 5. Click \"Save\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This recommendation evaluates the IAM policy in resource metadata for any principals assigned roles/Owner, roles/Writer, or roles/Reader.",
    "displayName": "Users should have least privilege access with granular IAM roles",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4a7771a9-a2dd-40e8-87a2-921259d68667",
    "implementationEffort": null,
    "name": "4a7771a9-a2dd-40e8-87a2-921259d68667",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "A user has one of the following IAM basic roles: roles/owner, roles/editor, or roles/viewer. <br>These roles are too permissive and shouldn't be used. Instead, they should be assigned per project only. <br><br> For more information, see <a href=\"https://cloud.google.com/iam/docs/understanding-roles\">Understanding roles</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"IAM policy\" page in the GCP Cloud Console.  <a href=\"https://console.cloud.google.com/iam-admin/iam?_ga=2.35284326.612725499.1653394238-1730296467.1639556914\">Go to IAM policy</a>. 2. For each user assigned a primitive role, consider using more granular roles instead.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This recommendation evaluates IAM policies for key rings, projects, and organizations, and retrieves principals with roles that allow them to encrypt, decrypt or sign data using Cloud KMS keys: roles/owner, roles/cloudkms.cryptoKeyEncrypterDecrypter, roles/cloudkms.cryptoKeyEncrypter, roles/cloudkms.cryptoKeyDecrypter, roles/cloudkms.signer, and roles/cloudkms.signerVerifier.",
    "displayName": "Cryptographic keys should not have more than three users",
    "id": "/providers/Microsoft.Security/assessmentMetadata/24eb0365-d63d-43c0-b11f-8b0a1a0842f7",
    "implementationEffort": null,
    "name": "24eb0365-d63d-43c0-b11f-8b0a1a0842f7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Limit the number of principal users that can use cryptographic keys to three. <br><br>The following predefined roles grant permissions to encrypt, decrypt, or sign data using cryptographic keys: <br> 1. roles/owner 2. roles/cloudkms.cryptoKeyEncrypterDecrypter 3. roles/cloudkms.cryptoKeyEncrypter 4. roles/cloudkms.cryptoKeyDecrypter 5. roles/cloudkms.signer<br> 6. roles/cloudkms.signerVerifier<br> <br>For more information, see <a href=\"https://cloud.google.com/kms/docs/reference/permissions-and-roles\">Permissions and roles</a>.<br> <br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Cloud KMS keys\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/security/kms?_ga=2.259352909.612725499.1653394238-1730296467.1639556914\">Go to Cloud KMS keys</a>. 2. Click the \"name\" of the key ring indicated in the finding. 3. Click the \"name\" of the key indicated in the finding. 4. Select the box next to the primary version, and then click \"Show Info Panel\". 5. Reduce the number of principals having permissions to encrypt, decrypt, or sign data to three or fewer. <br>To revoke permissions, click \"Delete\" delete next to each principal.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This recommendation evaluates whether the enabled field in the bucket's versioning property is set to true.",
    "displayName": "Object versioning should be enabled on storage buckets where sinks are configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e836b239-c7dc-476a-9a85-829b565cbc59",
    "implementationEffort": null,
    "name": "e836b239-c7dc-476a-9a85-829b565cbc59",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "Object versioning isn't enabled on a storage bucket where sinks are configured. <br><br> To support the retrieval of objects that are deleted or overwritten, GCP Cloud Storage offers the Object Versioning feature. Enable Object Versioning to protect your Cloud Storage data from being overwritten or accidentally deleted. Learn how to <a href=\"https://cloud.google.com/storage/docs/using-object-versioning#set\">Enable Object Versioning</a>. <br><br> To remediate this finding, use the gsutil versioning set on command with the appropriate value: <br> gsutil versioning set on gs://finding.assetDisplayName<br> Replace finding.assetDisplayName with the name of the relevant bucket.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This recommendation evaluates the IAM policy of a bucket for the principals allUsers or allAuthenticatedUsers, which grant public access.",
    "displayName": "Storage buckets used as a log sink should not be publicly accessible",
    "id": "/providers/Microsoft.Security/assessmentMetadata/76261631-76ea-4bd4-b064-34a619be1de0",
    "implementationEffort": null,
    "name": "76261631-76ea-4bd4-b064-34a619be1de0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "A storage bucket is public and used as a log sink, meaning that anyone on the internet can access logs stored in this bucket. <br>allUsers represents anyone on the internet and allAuthenticatedUsers represents anyone who is logged into a Google service; <br>neither is constrained to users within your organization. <br><br> For more information, see <a href=\"https://cloud.google.com/storage/docs/access-control\">Overview of access control</a>. <br><br> To remediate this finding, complete the following steps: <br> 1. Go to the \"Cloud Storage browser\" page in the GCP Cloud Console.  <a href=\"https://console.cloud.google.com/storage/browser?_ga=2.102402502.612725499.1653394238-1730296467.1639556914\">Go to Cloud Storage browser </a>. 2. In the list of buckets, click the name of the bucket indicated in the finding. 3. Click the \"Permissions\" tab. 4. Remove \"allUsers\" and \"allAuthenticatedUsers\" from the list of principals.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This recommendation evaluates the IAM allow policy in resource metadata for principals assigned roles/redis.admin, roles/redis.editor, roles/redis.viewer at the organization or folder level.",
    "displayName": "Redis IAM role should not be assigned at the organization or folder level",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7c20b7aa-be3d-4a4b-af45-1b432c02f86b",
    "implementationEffort": null,
    "name": "7c20b7aa-be3d-4a4b-af45-1b432c02f86b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "A Redis IAM role is assigned at the organization or folder level. <br><br> The following Redis IAM roles should be assigned per project only, not at the organization or folder level:<br> 1. roles/redis.admin<br> 2. roles/redis.viewer<br> 3. roles/redis.editor<br><br> For more information, see <a href=\"https://cloud.google.com/memorystore/docs/redis/access-control\">Access control and permissions</a>.<br><br> To remediate this finding, complete the following steps:<br> 1. Go to the \"IAM policy\" page in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/iam-admin/iam?_ga=2.32744825.612725499.1653394238-1730296467.1639556914\">Go to IAM policy</a>. 2. Remove the \"Redis IAM roles\" indicated in the finding and add them on the individual projects instead.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This recommendation evaluates the IAM allow policy in project metadata for principals assigned roles/Owner.",
    "displayName": "Projects that have cryptographic keys should not have users with Owner permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/986fe72e-466a-462d-a06e-c77b439c53c0",
    "implementationEffort": null,
    "name": "986fe72e-466a-462d-a06e-c77b439c53c0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/19/2022"
    },
    "remediationDescription": "A user has roles/Owner permissions on a project that has cryptographic keys. For more information, see <a href=\"https://cloud.google.com/kms/docs/reference/permissions-and-roles\">Permissions and roles</a>. <br><br> To remediate this finding, complete the following steps:<br> 1. Go to the \"IAM page\" in the GCP Cloud Console. <a href=\"https://console.cloud.google.com/iam-admin/iam?_ga=2.27034106.612725499.1653394238-1730296467.1639556914\">Go IAM page</a>. 2. If necessary, select the project in the finding. 3. For each principal assigned the \"Owner\" role: <br> 1. Click \"Edit\". 2. In the \"Edit permissions\" panel, next to the \"Owner\" role, click \"Delete\". 3. Click \"Save\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Use corporate login credentials instead of personal accounts, such as Gmail accounts. <br/> It is recommended fully-managed corporate Google accounts be used for increased visibility, auditing, and controlling access to Cloud Platform resources. <br/> Gmail accounts based outside of the user's organization, such as personal accounts, should not be used for business purposes.",
    "displayName": "Ensure that corporate login credentials are used",
    "id": "/providers/Microsoft.Security/assessmentMetadata/67ebdf6b-6197-4e42-bbbf-eaf4e6c20b4c",
    "implementationEffort": null,
    "name": "67ebdf6b-6197-4e42-bbbf-eaf4e6c20b4c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "Follow the documentation and setup corporate login accounts <a href=\"https://cloud.google.com/docs/enterprise/best-practices-for-enterprise-organizations#manage-identities\">Manage Identities</a>.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "User managed service accounts should not have user-managed keys.<br> Anyone who has access to the keys will be able to access resources through the service account. GCP-managed keys are used by Cloud Platform services such as App Engine and Compute Engine. These keys cannot be downloaded. Google will keep the keys and automatically rotate them on an approximately weekly basis.<br> User-managed keys are created, downloadable, and managed by users. They expire 10 years from creation.<br>For user-managed keys, the user has to take ownership of key management activities which include:<ul> <li> Key storage</li><li>Key distribution</li><li>Key revocation </li><li>Key rotation</li><li>Protecting the keys from unauthorized users</li><li>Key recovery</li></ul>Even with key owner precautions, keys can be easily leaked by common development malpractices like checking keys into the source code or leaving them in the Downloads directory, or accidentally leaving them on support blogs/channels. It is recommended to prevent user-managed service account keys.",
    "displayName": "Ensure that there are only GCP-managed service account keys for each service account",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6991b2e9-ae9e-4e99-acb6-037c4b575215",
    "implementationEffort": null,
    "name": "6991b2e9-ae9e-4e99-acb6-037c4b575215",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b></br> 1. Go to the IAM page in the GCP Console using <a href=\"https://console.cloud.google.com/apis/credentials\">https://console.cloud.google.com/apis/credentials</a>. 2. In the left navigation pane, click \"Service accounts\". All service accounts and their corresponding keys are listed. 3. Click the service account. 4. Click the \"edit\" and delete the keys.</br></br> <b>From CLI:</b></br> To delete a user managed Service Account Key, run <code> gcloud iam service-accounts keys delete --iam-account=&ltuser-managed-service-account-EMAIL&gt &ltKEY-ID&gt</code>",
    "severity": "Low",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended to assign the \"Service Account User (iam.serviceAccountUser)\" and \"Service Account Token Creator (iam.serviceAccountTokenCreator)\" roles to a user for a specific service account rather than assigning the role to a user at project level.<br> A service account is a special Google account that belongs to an application or a virtual machine (VM), instead of to an individual end-user. <br> Application/VM-Instance uses the service account to call the service's Google API so that users aren't directly involved. <br> In addition to being an identity, a service account is a resource that has IAM policies attached to it. These policies determine who can use the service account. <br> Users with IAM roles to update the App Engine and Compute Engine instances (such as App Engine Deployer or Compute Instance Admin) can effectively run code as the service accounts used to run these instances, and indirectly gain access to all the resources for which the service accounts have access. <br> Similarly, SSH access to a Compute Engine instance may also provide the ability to execute code as that instance/Service account. <br> Based on business needs, there could be multiple user-managed service accounts configured for a project. <br> Granting the \"iam.serviceAccountUser\" or \"iam.serviceAserviceAccountTokenCreatorccountUser\" roles to a user for a project gives the user access to all service accounts in the project, including service accounts that may be created in the future. <br> This can result in elevation of privileges by using service accounts and corresponding \"Compute Engine instances\". <br> In order to implement \"least privileges\" best practices, IAM users should not be assigned the \"Service Account User\" or \"Service Account Token Creator\" roles at the project level. Instead, these roles should be assigned to a user for a specific service account, giving that user access to the service account. The \"Service Account User\" allows a user to bind a service account to a long-running job service, whereas the \"Service Account Token Creator\" role allows a user to directly impersonate (or assert) the identity of a service account.",
    "displayName": "Ensure that IAM users are not assigned the Service Account User or Service Account Token Creator roles at project level",
    "id": "/providers/Microsoft.Security/assessmentMetadata/54c381fe-a80a-4038-8a9d-c166d2922ea9",
    "implementationEffort": null,
    "name": "54c381fe-a80a-4038-8a9d-c166d2922ea9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the IAM page in the GCP Console by visiting: <a href=\"https://console.cloud.google.com/iam-admin/iam\">GCP Console IAM</a>. 2. Click on the filter table text bar. Type \"Role: Service Account User\" 3. Click the \"Delete Bin\" icon in front of the role \"Service Account User\" for every user listed as a result of a filter. 4. Click on the filter table text bar. Type \"Role: Service Account Token Creator\" 5. Click the \"Delete Bin\" icon in front of the role \"Service Account Token Creator\" for every user listed as a result of a filter. <br><br> <b> From Command Line: </b> <br> 1. Using a text editor, remove the bindings with the \"roles/iam.serviceAccountUser\" or \"roles/iam.serviceAccountTokenCreator\". <br> For example, you can use the iam.json file shown below as follows: <br> <code> { &quotbindings&quot: [ { &quotmembers&quot: [ &quotserviceAccount:our-project-123@appspot.gserviceaccount.com&quot, ], &quotrole&quot: &quotroles/appengine.appViewer&quot }, { &quotmembers&quot: [ &quotuser:email1@gmail.com&quot ], &quotrole&quot: &quotroles/owner&quot }, { &quotmembers&quot: [ &quotserviceAccount:our-project-123@appspot.gserviceaccount.com&quot, &quotserviceAccount:123456789012-compute@developer.gserviceaccount.com&quot ], &quotrole&quot: &quotroles/editor&quot } ], &quotetag&quot: &quotBwUjMhCsNvY=&quot }</code> <br> 2. Update the project's IAM policy: <br> <code> gcloud projects set-iam-policy PROJECT_ID iam.json </code>",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Service Account keys consist of a key ID (Private_key_Id) and Private key, which are used to sign programmatic requests users make to Google cloud services accessible to that particular service account. <br> It is recommended that all Service Account keys are regularly rotated. <br> Rotating Service Account keys will reduce the window of opportunity for an access key that is associated with a compromised or terminated account to be used. Service Account keys should be rotated to ensure that data cannot be accessed with an old key that might have been lost, cracked, or stolen.<br> Each service account is associated with a key pair managed by Google Cloud Platform (GCP). It is used for service-to-service authentication within GCP. Google rotates the keys daily. <br> GCP provides the option to create one or more user-managed (also called external key pairs) key pairs for use from outside GCP (for example, for use with Application Default Credentials). When a new key pair is created, the user is required to download the private key (which is not retained by Google). </br> With external keys, users are responsible for keeping the private key secure and other management operations such as key rotation. External keys can be managed by the IAM API, gcloud command-line tool, or the Service Accounts page in the Google Cloud Platform Console.</br> GCP facilitates up to 10 external service account keys per service account to facilitate key rotation.",
    "displayName": "Ensure user-managed/external keys for service accounts are rotated every 90 days or less",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0007dd31-9e95-460d-82bd-ae3e9e623161",
    "implementationEffort": null,
    "name": "0007dd31-9e95-460d-82bd-ae3e9e623161",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>Delete any external (user-managed) Service Account Key older than 90 days: 1. Go to APIs & Services\\Credentials using <a href=\"https://console.cloud.google.com/apis/credentials\">https://console.cloud.google.com/apis/credentials</a></br> 2. In the Section \"Service Account Keys\", for every external (user-managed) service account key where \"creation date is\" greater than or equal to the past 90 days, click \"Delete Bin Icon\" to Delete Service Account key. <br> <b>Create a new external (user-managed) Service Account Key for a Service Account:</b></br> 1. Go to \"APIs & Services\\Credentials\" using <a href=\"https://console.cloud.google.com/apis/credentials\">https://console.cloud.google.com/apis/credentials</a></br> 2. Click \"Create Credentials\" and Select \"Service Account Key\". 3. Choose the service account in the drop-down list for which an External (user-anaged) Service Account key needs to be created. 4. Select the desired key type format among \"JSON\" or \"P12\". 5. Click \"Create\". It will download the private key. Keep it safe. 6. Click \"Close\" if prompted. 7. The site will redirect to the \"APIs & Services\\Credentials\" page. Make a note of the new ID displayed in the Service account keys section.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended that the principle of 'Separation of Duties' is enforced while assigning service-account related roles to users. <br/> The built-in/predefined IAM role \"Service Account admin\" allows the user/identity to create, delete, and manage service account(s).<br/> The built-in/predefined IAM role \"Service Account User\" allows the user/identity (with adequate privileges on Compute and App Engine) to assign service account(s) to Apps/Compute Instances.<br/> Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. <br/> In Cloud IAM - service accounts, this could be an action such as using a service account to access resources that user should not normally have access to. <br/> Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. It is considered best practice. <br/> No user should have \"Service Account Admin\" and \"Service Account User\" roles assigned at the same time.",
    "displayName": "Ensure that Separation of duties is enforced while assigning service account related roles to users",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9e8cb9ac-87ee-424b-a9d2-0d41e411d18f",
    "implementationEffort": null,
    "name": "9e8cb9ac-87ee-424b-a9d2-0d41e411d18f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b> <br/> 1. Go to <a href=\"https://console.cloud.google.com/iam-admin/iam\">IAM & Admin/IAM</a>. 2. For any member having both \"Service Account Admin\" and \"Service account User\" roles granted/assigned, click the \"Delete Bin icon\" to remove either role from the member.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended that the IAM policy on Cloud KMS \"cryptokeys\" should restrict anonymous and/or public access. <br/> Granting permissions to \"allUsers\" or \"allAuthenticatedUsers\" allows anyone to access the dataset. <br/> Such access might not be desirable if sensitive data is stored at the location. <br/> In this case, ensure that anonymous and/or public access to a Cloud KMS \"cryptokey\" is not allowed.",
    "displayName": "Ensure that Cloud KMS cryptokeys are not anonymously or publicly accessible",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fcbcaef9-4bb0-49db-a932-afd64ed221d4",
    "implementationEffort": null,
    "name": "fcbcaef9-4bb0-49db-a932-afd64ed221d4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Command Line:</b> <br/> 1. List all Cloud KMS \"Cryptokeys\". <br> <code>gcloud kms keys list --keyring=[key_ring_name] --location=global --format=json | jq '.[].name'</code>. 2. Remove IAM policy binding for a KMS key to remove access to \"allUsers\" and \"allAuthenticatedUsers\" using the below command. <br/> <code>gcloud kms keys remove-iam-policy-binding [key_name] --keyring=[key_ring_name] --location=global --member='allAuthenticatedUsers' --role='[role]' <br/> gcloud kms keys remove-iam-policy-binding [key_name] --keyring=[key_ring_name] --location=global --member='allUsers' --role='[role]'</code>",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Google Cloud Key Management Service stores cryptographic keys in a hierarchical structure designed for useful and elegant access control management.<br/> The format for the rotation schedule depends on the client library that is used.<br/> For the gcloud command-line tool, the next rotation time must be in \"ISO\" or \"RFC3339\" format, and the rotation period must be in the form \"INTEGER[UNIT]\", where units can be one of seconds (s), minutes (m), hours (h) or days (d). <br/> Set a key rotation period and starting time. A key can be created with a specified \"rotation period\", which is the time between when new key versions are generated automatically.<br/> A key can also be created with a specified next rotation time. <br/> A key is a named object representing a \"cryptographic key\" used for a specific purpose.<br/> The key material, the actual bits used for \"encryption\", can change over time as new key versions are created.<br/> A key is used to protect some \"corpus of data\". A collection of files could be encrypted with the same key and people with \"decrypt\" permissions on that key would be able to decrypt those files.<br/> Therefore, it's necessary to make sure the \"rotation period\" is set to a specific time.",
    "displayName": "Ensure KMS encryption keys are rotated within a period of 90 days",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f756937d-b790-4718-8dd7-fa995930c4a1",
    "implementationEffort": null,
    "name": "f756937d-b790-4718-8dd7-fa995930c4a1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b> <br/> 1. Go to <a href=\"https://console.cloud.google.com/security/kms\">Cryptographic Keys</a>. 2. Click on the specific key ring. 3. From the list of keys, choose the specific key and Click on \"Right side pop up the blade (3 dots)\". 4. Click on \"Edit rotation period\". 5. On the pop-up window, \"Select a new rotation period\" in days which should be less than 90 and then choose \"Starting on\" date (date from which the rotation period begins).<br/><br/> <b>From Command Line:</b> <br/> 1. Update and schedule rotation by \"ROTATION_PERIOD\" and \"NEXT_ROTATION_TIME\" for each key: <br/> <code>gcloud kms keys update new --keyring=KEY_RING --location=LOCATION --next-rotation-time=NEXT_ROTATION_TIME --rotation-period=ROTATION_PERIOD</code>",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended that the principle of 'Separation of Duties' is enforced while assigning KMS related roles to users. <br/> The built-in/predefined IAM role \"Cloud KMS Admin\" allows the user/identity to create, delete, and manage service account(s).<br/> The built-in/predefined IAM role \"Cloud KMS CryptoKey Encrypter/Decrypter\" allows the user/identity (with adequate privileges on concerned resources) to encrypt and decrypt data at rest using an encryption key(s). <br/> The built-in/predefined IAM role Cloud KMS CryptoKey Encrypter allows the user/identity (with adequate privileges on concerned resources) to encrypt data at rest using an encryption key(s).<br/> The built-in/predefined IAM role \"Cloud KMS CryptoKey Decrypter\" allows the user/identity (with adequate privileges on concerned resources) to decrypt data at rest using an encryption key(s). <br/> Separation of duties is the concept of ensuring that one individual does not have all necessary permissions to be able to complete a malicious action. <br/> In Cloud KMS, this could be an action such as using a key to access and decrypt data a user should not normally have access to.<br/> Separation of duties is a business control typically used in larger organizations, meant to help avoid security or privacy incidents and errors. <br/> It is considered best practice. No user(s) should have Cloud KMS Admin and any of the \"Cloud KMS CryptoKey Encrypter/Decrypter\", \"Cloud KMS CryptoKey Encrypter\", \"Cloud KMS CryptoKey Decrypter\" roles assigned at the same time.",
    "displayName": "Ensure that Separation of duties is enforced while assigning KMS related roles to users",
    "id": "/providers/Microsoft.Security/assessmentMetadata/14007242-eadd-4d15-ad54-97201351c0ec",
    "implementationEffort": null,
    "name": "14007242-eadd-4d15-ad54-97201351c0ec",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b> <br/> 1. Go to <a href=\"https://console.cloud.google.com/iam-admin/iam\">IAM & Admin/IAM</a>. 2. For any member having \"Cloud KMS Admin\" and any of the \"Cloud KMS CryptoKey Encrypter/Decrypter\", \"Cloud KMS CryptoKey Encrypter\", \"Cloud KMS CryptoKey Decrypter\" roles granted/assigned, click the \"Delete Bin\" icon to remove the role from the member.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended that Cloud Audit Logging is configured to track all admin activities and read, write access to user data. <br/> Cloud Audit Logging maintains two audit logs for each project, folder, and organization: Admin Activity and Data Access. <br/> 1. Admin Activity logs contain log entries for API calls or other administrative actions that modify the configuration or metadata of resources. <br/> Admin Activity audit logs are enabled for all services and cannot be configured. 2. Data Access audit logs record API calls that create, modify, or read user-provided data. These are disabled by default and should be enabled. <br/> There are three kinds of Data Access audit log information: <br/> <ul> <li>Admin read: Records operations that read metadata or configuration information. Admin Activity audit logs record writes of metadata and configuration information that cannot be disabled. </li> <li>Data read: Records operations that read user-provided data.</li> <li>Data write: Records operations that write user-provided data.</li> </ul> It is recommended to have an effective default audit config configured in such a way that: <br/> 1. logtype is set to DATA_READ (to log user activity tracking) and DATA_WRITES (to log changes/tampering to user data). 2. audit config is enabled for all the services supported by the Data Access audit logs feature. 3. Logs should be captured for all users, i.e., there are no exempted users in any of the audit config sections. This will ensure overriding the audit config will not contradict the requirement.",
    "displayName": "Ensure that Cloud Audit Logging is configured properly across all services and all users from a project",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0b9173aa-68d9-4581-814f-fab4a91aa9af",
    "implementationEffort": null,
    "name": "0b9173aa-68d9-4581-814f-fab4a91aa9af",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b> <br/> 1. Go to <a href=\"https://console.cloud.google.com/iam-admin/audit\">Audit Logs</a>. 2. Follow the steps at <a href=\"https://cloud.google.com/logging/docs/audit/configure-data-access\">Configure Data Access</a> to enable audit logs for all Google Cloud services. Ensure that no exemptions are allowed. <br/><br/> <b>From Command Line:</b> <br/> 1. To read the project's IAM policy and store it in a file run a command: <br/> <code>gcloud projects get-iam-policy PROJECT_ID &gt /tmp/project_policy.yaml</code> <br/> Alternatively, the policy can be set at the organization or folder level. If setting the policy at the organization level, it is not necessary to also set it for each folder or project. <br/> <code> gcloud organizations get-iam-policy ORGANIZATION_ID &gt /tmp/org_policy.yaml <br/> gcloud resource-manager folders get-iam-policy FOLDER_ID &gt /tmp/folder_policy.yaml</code> <br/> 2. Edit policy in /tmp/policy.yaml, adding or changing only the audit logs configuration to: <br/> <code> auditConfigs: - auditLogConfigs: - logType: DATA_WRITE - logType: DATA_READ service: allServices </code> <br/><br/> <b>Note:</b> \"exemptedMembers\": is not set as audit logging should be enabled for all the users <br/> 3. To write new IAM policy run command: <br/> <code>gcloud organizations set-iam-policy ORGANIZATION_ID /tmp/org_policy.yaml </code> <br/> <code>gcloud resource-manager folders set-iam-policy FOLDER_ID /tmp/folder_policy.yaml </code> <br/> <code>gcloud projects set-iam-policy PROJECT_ID /tmp/project_policy.yaml </code> <br/><br/> If the preceding command reports a conflict with another change, then repeat these steps, starting with the first step.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended to create a sink that will export copies of all the log entries. This can help aggregate logs from multiple projects and export them to a Security Information and Event Management (SIEM). <br> Log entries are held in Stackdriver Logging. To aggregate logs, export them to a SIEM. To keep them longer, it is recommended to set up a log sink. Exporting involves writing a filter that selects the log entries to export, and choosing a destination in Cloud Storage, BigQuery, or Cloud Pub/Sub. <br> The filter and destination are held in an object called a sink. To ensure all log entries are exported to sinks, ensure that there is no filter configured for a sink. Sinks can be created in projects, organizations, folders, and billing accounts. ",
    "displayName": "Ensure that sinks are configured for all log entries",
    "id": "/providers/Microsoft.Security/assessmentMetadata/194b473e-7c5a-4754-b1ae-76591fe11b5c",
    "implementationEffort": null,
    "name": "194b473e-7c5a-4754-b1ae-76591fe11b5c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to \"Logging/Logs\" by visiting: <a href=\"https://console.cloud.google.com/logs/viewer\">GCP Logs explorer</a>. 2. Click the down arrow symbol on \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. This step converts \"Filter Bar\" to \"Advanced Filter Bar\".4.Clear any text from the \"Advanced Filter\" field. This ensures that the \"log-filter\" is set to empty and captures all the logs. 5. Click \"Submit Filter\" and the result should display all logs. 6. Click \"Create Sink\", which opens a menu on the right. 7. Fill out the fields and click \"Create Sink\". <br> For more information, see <a href=\"https://cloud.google.com/logging/docs/export/configure_export_v2#dest-create\">GCP Logging Documentation</a>. <br><br> <b> From Command Line: </b> <br> To create a sink to export all log entries in a Google Cloud Storage bucket: <br> <code> gcloud logging sinks create &ltsink-name&gt </code> <br> <code> storage.googleapis.com/DESTINATION_BUCKET_NAME </code> <br> Sinks can be created for a folder or organization, which will include all projects. <br> <code> gcloud logging sinks create &ltsink-name&gt </code> <br> <code> storage.googleapis.com/DESTINATION_BUCKET_NAME --include-children --folder=FOLDER_ID | --organization=ORGANIZATION_ID </code>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enabling retention policies on log buckets will protect logs stored in cloud storage buckets from being overwritten or accidentally deleted. <br> It is recommended to set up retention policies and configure Bucket Lock on all storage buckets that are used as log sinks. <br> Logs can be exported by creating one or more sinks that include a log filter and a destination. As Stackdriver Logging receives new log entries, they are compared against each sink. <br> If a log entry matches a sink's filter, then a copy of the log entry is written to the destination. <br> Sinks can be configured to export logs in storage buckets. <br> It is recommended to configure a data retention policy for these cloud storage buckets and to lock the data retention policy; thus permanently preventing the policy from being reduced or removed. <br> This way, if the system is ever compromised by an attacker or a malicious insider who wants to cover their tracks, the activity logs are definitely preserved for forensics and security investigations.",
    "displayName": "Ensure that retention policies on log buckets are configured using Bucket Lock",
    "id": "/providers/Microsoft.Security/assessmentMetadata/07ca1398-d477-400a-a9fc-4cfc78f723f9",
    "implementationEffort": null,
    "name": "07ca1398-d477-400a-a9fc-4cfc78f723f9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. If sinks are <b> not </b> configured, first follow the instructions in the recommendation: \"Ensure that sinks are configured for all Log entries\". 2. For each storage bucket configured as a sink, go to the Cloud Storage browser at \"https://console.cloud.google.com/storage/browser/&ltBUCKET_NAME&gt\". 3. Select the Bucket Lock tab near the top of the page. 4. In the Retention policy entry, click the Add Duration link. The \"Set a retention policy\" dialog box appears. 5. Enter the desired length of time for the retention period and click \"Save policy\". 6. Set the \"Lock status\" for this retention policy to \"Locked\". <br><br> <b> From Command Line: </b> <br> 1.To list all sinks destined to storage buckets: <br> <code> gcloud logging sinks list --folder=FOLDER_ID | --organization=ORGANIZATION_ID | --project=PROJECT_ID </code> <br> 2. For each storage bucket listed above, set a retention policy and lock it: <br> <code> gsutil retention set [TIME_DURATION] gs://[BUCKET_NAME] </code> <br> <code> gsutil retention lock gs://[BUCKET_NAME] </code> <br>For more information, see <a href=\"https://cloud.google.com/storage/docs/using-bucket%02lock#set-policy\">Bucket lock retention policy</a>.",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "In order to prevent unnecessary project ownership assignments to users/service-accounts and further misuses of projects and resources, all \"roles/Owner\" assignments should be monitored.<br> Members (users/Service-Accounts) with a role assignment to primitive role \"roles/Owner\" are project owners.<br> The project owner has all the privileges on the project the role belongs to. These are summarized below:<br> - All viewer permissions on all GCP Services within the project<br> - Permissions for actions that modify the state of all GCP services within the project<br> - Manage roles and permissions for a project and all resources within the project<br> - Set up billing for a project<br> Granting the owner role to a member (user/Service-Account) will allow that member to modify the Identity and Access Management (IAM) policy. Therefore, grant the owner role only if the member has a legitimate purpose to manage the IAM policy. This is because the project IAM policy contains sensitive access control data. Having a minimal set of users allowed to manage IAM policy will simplify any auditing that may be necessary. <br>Project ownership has the highest level of privileges on a project. To avoid misuse of project resources, the project ownership assignment/change actions mentioned above should be monitored and alerted to concerned recipients. <br>- Sending project ownership invites <br>- Acceptance/Rejection of project ownership invite by user <br>- Adding `role\\Owner` to a user/service-account <br>- Removing a user/Service account from `role\\Owner`",
    "displayName": "Ensure log metric filter and alerts exist for project ownership assignments/changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f42c20a6-8012-4e1e-bf4d-19b977e8c8d7",
    "implementationEffort": null,
    "name": "f42c20a6-8012-4e1e-bf4d-19b977e8c8d7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> (protoPayload.serviceName=\"cloudresourcemanager.googleapis.com\") <br> AND (ProjectOwnership OR projectOwnerInvitee) <br> OR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"REMOVE\" <br> AND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\") <br> OR (protoPayload.serviceData.policyDelta.bindingDeltas.action=\"ADD\" <br> AND protoPayload.serviceData.policyDelta.bindingDeltas.role=\"roles/owner\")<br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Google Cloud Platform (GCP) services write audit log entries to the Admin Activity and Data Access logs to help answer the questions of, \"who did what, where, and when?\" within GCP projects.<br>Cloud audit logging records information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by GCP services. Cloud audit logging provides a history of GCP API calls for an account, including API calls made via the console, SDKs, command-line tools, and other GCP services.  <br>Admin activity and data access logs produced by cloud audit logging enable security analysis, resource change tracking, and compliance auditing. <br>Configuring the metric filter and alerts for audit configuration changes ensures the recommended state of audit configuration is maintained so that all activities in the project are audit-able at any point in time.",
    "displayName": "Ensure that the log metric filter and alerts exist for Audit Configuration changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/34ed4dfb-fc6d-498f-b2b0-d1099704775d",
    "implementationEffort": null,
    "name": "34ed4dfb-fc6d-498f-b2b0-d1099704775d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> protoPayload.methodName=\"SetIamPolicy\" AND <br> protoPayload.serviceData.policyDelta.auditConfigDeltas:* <br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended that a metric filter and alarm be established for changes to Identity and Access Management (IAM) role creation, deletion and updating activities.  <br>Google Cloud IAM provides predefined roles that give granular access to specific Google Cloud Platform resources and prevent unwanted access to other resources. However, to cater to organization-specific needs, Cloud IAM also provides the ability to create custom roles. Project owners and administrators with the Organization Role Administrator role or the IAM Role Administrator role can create custom roles. Monitoring role creation, deletion and updating activities will help in identifying any over-privileged role at early stages.",
    "displayName": "Ensure that the log metric filter and alerts exist for Custom Role changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ba27e90d-311d-409d-8c69-7dfac0a1351c",
    "implementationEffort": null,
    "name": "ba27e90d-311d-409d-8c69-7dfac0a1351c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> resource.type=\"iam_role\"  <br> AND (protoPayload.methodName=\"google.iam.admin.v1.CreateRole\"  <br> OR protoPayload.methodName=\"google.iam.admin.v1.DeleteRole\"  <br> OR protoPayload.methodName=\"google.iam.admin.v1.UpdateRole\") <br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "It is recommended that a metric filter and alarm be established for Virtual Private Cloud (VPC) Network Firewall rule changes.  <br>Monitoring for Create or Update Firewall rule events gives insight to network access changes and may reduce the time it takes to detect suspicious activity.",
    "displayName": "Ensure that the log metric filter and alerts exist for VPC Network Firewall rule changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4a7723f9-ee51-4a2b-a4e5-2497a20c1964",
    "implementationEffort": null,
    "name": "4a7723f9-ee51-4a2b-a4e5-2497a20c1964",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> resource.type=\"gce_firewall_rule\" <br> AND (jsonPayload.event_subtype=\"compute.firewalls.patch\"  <br> OR jsonPayload.event_subtype=\"compute.firewalls.insert\")<br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "It is recommended that a metric filter and alarm be established for Virtual Private Cloud (VPC) network route changes.  <br>Google Cloud Platform (GCP) routes define the paths network traffic takes from a VM instance to another destination. The other destination can be inside the organization VPC network (such as another VM) or outside of it. Every route consists of a destination and a next hop. Traffic whose destination IP is within the destination range is sent to the next hop for delivery. <br>Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.",
    "displayName": "Ensure that the log metric filter and alerts exist for VPC network route changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b5c8e32b-a400-4d4b-8d2d-c5afbd4a6997",
    "implementationEffort": null,
    "name": "b5c8e32b-a400-4d4b-8d2d-c5afbd4a6997",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> resource.type=\"gce_route\" <br> AND (jsonPayload.event_subtype=\"compute.routes.delete\" <br> OR jsonPayload.event_subtype=\"compute.routes.insert\") <br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "It is recommended that a metric filter and alarm be established for Virtual Private Cloud (VPC) network changes.  <br>It is possible to have more than one VPC within a project. In addition, it is also possible to create a peer connection between two VPCs enabling network traffic to route between VPCs. <br>Monitoring changes to a VPC will help ensure VPC traffic flow is not getting impacted.",
    "displayName": "Ensure that the log metric filter and alerts exist for VPC network changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/59aef38a-19c2-4663-97a7-4c82a98dbab5",
    "implementationEffort": null,
    "name": "59aef38a-19c2-4663-97a7-4c82a98dbab5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> resource.type=gce_network <br> AND (jsonPayload.event_subtype=\"compute.networks.insert\" <br> OR jsonPayload.event_subtype=\"compute.networks.patch\" <br> OR jsonPayload.event_subtype=\"compute.networks.delete\" <br> OR jsonPayload.event_subtype=\"compute.networks.removePeering\" <br> OR jsonPayload.event_subtype=\"compute.networks.addPeering\") <br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended that a metric filter and alarm be established for Cloud Storage Bucket IAM changes. <br>Monitoring changes to cloud storage bucket permissions may reduce the time needed to detect and correct permissions on sensitive cloud storage buckets and objects inside the bucket.",
    "displayName": "Ensure that the log metric filter and alerts exist for Cloud Storage IAM permission changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2e14266c-76ea-4479-915e-4edaae7d78ec",
    "implementationEffort": null,
    "name": "2e14266c-76ea-4479-915e-4edaae7d78ec",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> resource.type=gcs_bucket <br> AND protoPayload.methodName=\"storage.setIamPermissions\" <br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended that a metric filter and alarm be established for SQL instance configuration changes. <br>Monitoring changes to SQL instance configuration changes may reduce the time needed to detect and correct misconfigurations done on the SQL server. <br>Below are a few of the configurable options which may the impact security posture of an SQL instance: <br>* Enable auto backups and high availability: Misconfiguration may adversely impact business continuity, disaster recovery, and high availability <br>* Authorize networks: Misconfiguration may increase exposure to untrusted networks",
    "displayName": "Ensure that the log metric filter and alerts exist for SQL instance configuration changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9dce022e-f7f9-4725-8a63-c0d4a868b4d3",
    "implementationEffort": null,
    "name": "9dce022e-f7f9-4725-8a63-c0d4a868b4d3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br> <b>Create the prescribed log metric:</b><br> 1. Go to \"Logging/Logs\" by visiting <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a> and click \"CREATE METRIC\". 2. Click the down arrow symbol on the \"Filter Bar\" at the rightmost corner and select \"Convert to Advanced Filter\". 3. Clear any text and add:<br> <code> protoPayload.methodName=\"cloudsql.instances.update\" <br> </code> 4. Click \"Submit Filter\". Display logs appear based on the filter text entered by the user. 5. In the \"Metric Editor\" menu on the right, fill out the name field. Set \"Units\" to \"1\" (default) and the \"Type\" to \"Counter\". This ensures that the log metric counts the number of log entries matching the advanced logs query. 6. Click \"Create Metric\".<br> <b>Create the display prescribed Alert Policy:</b><br> 1. Identify the newly created metric under the section \"User-defined Metrics\" at <a href=\"https://console.cloud.google.com/logs/metrics\">Metrics</a>. 2. Click the 3-dot icon in the rightmost column for the desired metric and select \"Create alert from Metric\". A new page opens. 3. Fill out the alert policy configuration and click \"Save\". Choose the alerting threshold and configuration that makes sense for the user's organization. For example, a threshold of zero(0) for the most recent value will ensure that a notification is triggered for every owner change in the project:<br> <code> Set `Aggregator` to `Count`<br> Set `Configuration`:<br> - Condition: above<br> - Threshold: 0<br> - For: most recent value<br> </code> 4. Configure the desired notifications channels in the section \"Notifications\". 5. Name the policy and click \"Save\".<br><br> <b>From Command Line:</b><br> Create a prescribed Log Metric:<br> * Use the command: gcloud beta logging metrics create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/beta/logging/metrics/create\">Reference</a><br> Create prescribed Alert Policy<br> * Use the command: gcloud alpha monitoring policies create<br> * Reference for Command Usage: <a href=\"https://cloud.google.com/sdk/gcloud/reference/alpha/monitoring/policies/create\">Reference</a>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow the user to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances.<br />Firewall rules are defined at the VPC network level and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. <br />When specifying a source for an ingress rule or a destination for an egress rule by address, only an IPv4 address or IPv4 block in CIDR notation can be used. Generic (0.0.0.0/0) incoming traffic from the internet to VPC or VM instance using SSH on Port 22 can be avoided.<br> GCP Firewall Rules within a VPC Network apply to outgoing (egress) traffic from instances and incoming (ingress) traffic to instances in the network. <br>Egress and ingresstraffic flows are controlled even if the traffic stays within the network (for example, instance-to-instance communication). <br>For an instance to have outgoing Internet access, the network must have a valid Internet gateway route or custom route whose destination IP is specified. <br>This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from the Internet through SSH with the default Port '22'. <br> Generic access from the Internet to a specific IP Range needs to be restricted.",
    "displayName": "Ensure that SSH access is restricted from the internet",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9f88a5b8-2853-4b3f-a4c7-33f225cae99a",
    "implementationEffort": null,
    "name": "9f88a5b8-2853-4b3f-a4c7-33f225cae99a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to VPC Network. 2. Go to the Firewall Rules. 3. Click the Firewall Rule you want to modify. 4. Click Edit. 5. Modify Source IP ranges to specific IP. 6. Click Save. <br><br> <b> From Command Line: </b> <br> <code> gcloud compute firewall-rules update FirewallName --allow=[PROTOCOL[:PORT[- PORT]],...] --source-ranges=[CIDR_RANGE,...] </code>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "GCP Firewall Rules are specific to a VPC Network. Each rule either allows or denies traffic when its conditions are met. Its conditions allow users to specify the type of traffic, such as ports and protocols, and the source or destination of the traffic, including IP addresses, subnets, and instances.<br />Firewall rules are defined at the VPC network level and are specific to the network in which they are defined. The rules themselves cannot be shared among networks. Firewall rules only support IPv4 traffic. <br />When specifying a source for an ingress rule or a destination for an egress rule by address, an IPv4 address or IPv4 block in CIDR notation can be used. Generic (0.0.0.0/0) incoming raffic from the Internet to a VPC or VM instance using RDP on Port 3389 can be avoided. <br> GCP Firewall Rules within a VPC Network. These rules apply to outgoing (egress) traffic from instances and incoming (ingress) traffic to instances in the network. <br> Egress and ingress traffic flows are controlled even if the traffic stays within the network (for example, instance-to-instance communication). For an instance to have outgoing Internet access, the network must have a valid Internet gateway route or custom route whose destination IP is specified. <br> This route simply defines the path to the Internet, to avoid the most general (0.0.0.0/0) destination IP Range specified from the Internet through RDP with the default Port 3389. Generic access from the Internet to a specific IP Range should be restricted.",
    "displayName": "Ensure that RDP access is restricted from the Internet",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8bc8464f-f32a-4b3c-954e-48f9db2d9bcf",
    "implementationEffort": null,
    "name": "8bc8464f-f32a-4b3c-954e-48f9db2d9bcf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to VPC Network. 2. Go to the Firewall Rules. 3. Click the Firewall Rule to be modified. 4. Click Edit. 5. Modify Source IP ranges to specific IP. 6. Click Save. <br> <br><b> From Command Line: </b> <br> 1.Update RDP Firewall rule with new SOURCE_RANGE from the below command: <br> <code>gcloud compute firewall-rules update FirewallName --allow=[PROTOCOL[:PORT[-PORT]],...] --source-ranges=[CIDR_RANGE,...]</code>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "To prevent use of \"default\" network, a project should not have a \"default\" network. <br> The default network has a preconfigured network configuration and automatically generates the following insecure firewall rules:<br><ul><li>default-allow-internal: Allows ingress connections for all protocols and ports among instances in the network. </li><li>default-allow-ssh: Allows ingress connections on TCP port 22(SSH) from any source to any instance in the network.</li><li>default-allow-rdp: Allows ingress connections on TCP port 3389(RDP) from any source to any instance in the network.</li><li>default-allow-icmp: Allows ingress ICMP traffic from any source to any instance in the network.</li></ul>These automatically created firewall rules do not get audit logged and cannot be configured to enable firewall rule logging. <br>Furthermore, the default network is an auto mode network, which means that its subnets use the same predefined range of IP addresses, and as a result, it's not possible to use Cloud VPN or VPC Network Peering with the default network. <br>Based on organization security and networking requirements, the organization should create a new network and delete the default network.",
    "displayName": "Ensure that the default network does not exist in a project",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ea1989f3-de6c-4389-8b6c-c8b9a3df1595",
    "implementationEffort": null,
    "name": "ea1989f3-de6c-4389-8b6c-c8b9a3df1595",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the \"VPC networks\" page by visiting: <br> <a target=\"_blank\" href=\"https://console.cloud.google.com/networking/networks/list\">VPC networks</a>. 2. Click the network named default. 3. On the network detail page, click \"EDIT\". 4. Click \"DELETE VPC NETWORK\". 5. If needed, create a new network to replace the default network. <br><br> <b> From Command Line: </b> <br> For each Google Cloud Platform project,<br> 1. Delete the default network: <br><code> gcloud compute networks delete default </code><br> 2. If needed, create a new network to replace it: <br><code>gcloud compute networks create NETWORK_NAME</code>",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "In order to prevent use of legacy networks, a project should not have a legacy network configured. <br> Legacy networks have a single network IPv4 prefix range and a single gateway IP address for the whole network. The network is global in scope and spans all cloud regions. <br> Subnetworks cannot be created in a legacy network and are unable to switch from legacy to auto or custom subnet networks. Legacy networks can have an impact for high network traffic projects and are subject to a single point of contention or failure.",
    "displayName": "Ensure legacy networks do not exist for a project",
    "id": "/providers/Microsoft.Security/assessmentMetadata/44995f9b-5963-4a92-8e99-6d68acbc187c",
    "implementationEffort": null,
    "name": "44995f9b-5963-4a92-8e99-6d68acbc187c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "For each Google Cloud Platform project,<br> 1. Follow the documentation and create a non-legacy network suitable for the organization's requirements. 2.  Follow the documentation and delete the networks in the \"legacy\" mode.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Cloud Domain Name System (DNS) is a fast, reliable and cost-effective domain name system that powers millions of domains on the internet. <br> Domain Name System Security Extensions (DNSSEC) in Cloud DNS enables domain owners to take easy steps to protect their domains against DNS hijacking and man-in-the-middle and other attacks. <br> Domain Name System Security Extensions (DNSSEC) adds security to the DNS protocol by enabling DNS responses to be validated. <br> Having a trustworthy DNS that translates a domain name like www.example.com into its associated IP address is an increasingly important building block of today's web-based applications. <br> Attackers can hijack this process of domain/IP lookup and redirect users to a malicious site through DNS hijacking and man-in-the-middle attacks. <br> DNSSEC helps mitigate the risk of such attacks by cryptographically signing DNS records. <br> As a result, it prevents attackers from issuing fake DNS responses that may misdirect browsers to nefarious websites.",
    "displayName": "Ensure that DNSSEC is enabled for Cloud DNS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/33509176-9e4d-4238-84ec-984ba67019fa",
    "implementationEffort": null,
    "name": "33509176-9e4d-4238-84ec-984ba67019fa",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to \"Cloud DNS\" by visiting <a target=\"_blank\" href=\"https://console.cloud.google.com/netservices/dns/zones\">Cloud DNS</a>. 2. For each zone of Type Public, set DNSSEC to \"On\". <br><br> <b> From Command Line: </b> <br> Use the below command to enable \"DNSSEC\" for Cloud DNS Zone Name.<br><code> gcloud dns managed-zones update ZONE_NAME --dnssec-state on </code>",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "DNSSEC algorithm numbers in this registry may be used in CERT RRs. <br> Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. <br> The algorithm used for key signing should be a recommended one and it should be strong. <br> Domain Name System Security Extensions (DNSSEC) algorithm numbers in this registry may be used in CERT RRs. <br> Zonesigning (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. <br> The algorithm used for key signing should be a recommended one and it should be strong. <br> When enabling DNSSEC for a managed zone, or creating a managed zone with DNSSEC, the user can select the DNSSEC signing algorithms and the denial-of-existence type. <br> Changing the DNSSEC settings is only effective for a managed zone if DNSSEC is not already enabled. <br> If there is a need to change the settings for a managed zone where it has been enabled, turn DNSSEC off and then re-enable it with different settings.",
    "displayName": "Ensure that RSASHA1 is not used for the key-signing key in Cloud DNS DNSSEC",
    "id": "/providers/Microsoft.Security/assessmentMetadata/87356ecc-b718-442d-af22-677bceaeae06",
    "implementationEffort": null,
    "name": "87356ecc-b718-442d-af22-677bceaeae06",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "1. If it is necessary to change the settings for a managed zone where it has been enabled, NSSEC must be turned off and re-enabled with different settings. <br> To turn off DNSSEC, run the following command: <br> <code> gcloud dns managed-zones update ZONE_NAME --dnssec-state off </code><br> 2. To update key-signing for a reported managed DNS Zone, run the following command: <br><code> gcloud dns managed-zones update ZONE_NAME --dnssec-state on --ksk-algorithm KSK_ALGORITHM --ksk-key-length KSK_KEY_LENGTH --zsk-algorithm ZSK_ALGORITHM - -zsk-key-length ZSK_KEY_LENGTH --denial-of-existence DENIAL_OF_EXISTENCE </code> <br><br> <table> <tr> <th>Algorithm</th> <th>KSK Length</th> <th>ZSK Length</th> </tr> <tr> <td>RSASHA1</td> <td>1024,2048</td> <td>1024,2048</td> </tr> <tr> <td>RSASHA256</td> <td>1024,2048</td> <td>1024,2048</td> </tr> <tr> <td>RSASHA512</td> <td>1024,2048</td> <td>1024,2048</td> </tr> <tr> <td>ECDSAP256SHA256</td> <td>256</td> <td>256</td> </tr> <tr> <td>ECDSAP384SHA384</td> <td>384</td> <td>384</td> </tr> </table>",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Weaken Encryption"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "DNSSEC algorithm numbers in this registry may be used in CERT RRs. <br> Zone signing (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. <br> The algorithm used for key signing should be a recommended one and it should be strong. <br> DNSSEC algorithm numbers in this registry may be used in CERT RRs. <br> Zonesigning (DNSSEC) and transaction security mechanisms (SIG(0) and TSIG) make use of particular subsets of these algorithms. <br> The algorithm used for key signing should be a recommended one and it should be strong. <br> When enabling DNSSEC for a managed zone, or creating a managed zone with DNSSEC, the DNSSEC signing algorithms and the denial-of-existence type can be selected. <br> Changing the DNSSEC settings is only effective for a managed zone if DNSSEC is not already enabled. <br> If the need exists to change the settings for a managed zone where it has been enabled, turn DNSSEC off and then re-enable it with different settings.",
    "displayName": "Ensure that RSASHA1 is not used for the zone-signing key in Cloud DNS DNSSEC",
    "id": "/providers/Microsoft.Security/assessmentMetadata/117ad72e-fed7-4dc8-995d-39919b9ba2d9",
    "implementationEffort": null,
    "name": "117ad72e-fed7-4dc8-995d-39919b9ba2d9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "1. If it is necessary to change the settings for a managed zone where it has been enabled, DNSSEC must be turned off and re-enabled with different settings. <br> To turn off DNSSEC, run the following command: <br> <code> gcloud dns managed-zones update ZONE_NAME --dnssec-state off </code><br> 2. To update zone-signing for a reported managed DNS Zone, run the following command: <br><code> gcloud dns managed-zones update ZONE_NAME --dnssec-state on --ksk-algorithm KSK_ALGORITHM --ksk-key-length KSK_KEY_LENGTH --zsk-algorithm ZSK_ALGORITHM - -zsk-key-length ZSK_KEY_LENGTH --denial-of-existence DENIAL_OF_EXISTENCE </code> <br><br> <table> <tr> <th>Algorithm</th> <th>KSK Length</th> <th>ZSK Length</th> </tr> <tr> <td>RSASHA1</td> <td>1024,2048</td> <td>1024,2048</td> </tr> <tr> <td>RSASHA256</td> <td>1024,2048</td> <td>1024,2048</td> </tr> <tr> <td>RSASHA512</td> <td>1024,2048</td> <td>1024,2048</td> </tr> <tr> <td>ECDSAP256SHA256</td> <td>256</td> <td>256</td> </tr> <tr> <td>ECDSAP384SHA384</td> <td>384</td> <td>384</td> </tr> </table>",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Weaken Encryption"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "It is recommended to configure your instance to not use the default Compute Engine service account because it has the Editor role on the project.<br>The default Compute Engine service account has the Editor role on the project, which allows read and write access to most Google Cloud Services.<br>To defend against privilege escalations if your VM is compromised and prevent an attacker from gaining access to all of your project, it is recommended to not use the default Compute Engine service account.<br>Instead, you should create a new service account and assigning only the permissions needed by your instance.<br>The default Compute Engine service account is named <code>[PROJECT_NUMBER]- compute@developer.gserviceaccount.com.</code><br>VMs created by GKE should be excluded. These VMs have names that start with \"gke-\" and are labeled \"goog-gke-node\".",
    "displayName": "Ensure that instances are not configured to use the default service account",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a107c44c-75e4-4607-b1b0-cd5cfcf249e0",
    "implementationEffort": null,
    "name": "a107c44c-75e4-4607-b1b0-cd5cfcf249e0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>1. Go to the <a href=\"https://console.cloud.google.com/compute/instances\">VM instances</a> page. 2. Click on the instance name to go to its \"VM instance details\" page. 3. Click \"STOP\" and then click \"EDIT\". 4. Under the section \"Service Account\", select a service account other that the default Compute Engine service account. You may first need to create a new service account. 5. Click \"Save\" and then click \"START\".<br><br><b>From Command Line:</b><br>1. Stop the instance: <code>gcloud compute instances stop INSTANCE_NAME</code> <br>2. Update the instance: <code>gcloud compute instances set-service-account INSTANCE_NAME --serviceaccount=SERVICE_ACCOUNT</code> <br>3. Restart the instance: <code>gcloud compute instances start INSTANCE_NAME</code>",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To support principle of least privileges and prevent potential privilege escalation it is recommended that instances are not assigned to default service account \"Compute Engine default service account\" with Scope \"Allow full access to all Cloud APIs\".<br>Along with ability to optionally create, manage and use user managed custom service accounts, Google Compute Engine provides default service account \"Compute Engine default service account\" for an instances to access necessary cloud services.<br>\"Project Editor\" role is assigned to \"Compute Engine default service account\" hence, This service account has almost all capabilities over all cloud services except billing.<br>However, when \"Compute Engine default service account\" assigned to an instance it can operate in 3 scopes.<br>1. Allow default access: Allows only minimum access required to run an Instance (Least Privileges) 2. Allow full access to all Cloud APIs: Allow full access to all the cloud APIs/Services (Too much access) 3. Set access for each API: Allows Instance administrator to choose only those APIs that are needed to perform specific business functionality expected by instance<br>When an instance is configured with \"Compute Engine default service account\" with Scope \"Allow full access to all Cloud APIs\", based on IAM roles assigned to the user(s) accessing Instance,<br>it may allow user to perform cloud operations/API calls that user is not supposed to perform leading to successful privilege escalation.<br>VMs created by GKE should be excluded. These VMs have names that start with \"gke-\" and are labeled \"goog-gke-node\".",
    "displayName": "Ensure that instances are not configured to use the default service account with full access to all Cloud APIs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a8c1fcf1-ca66-4fc1-b5e6-51d7f4f76782",
    "implementationEffort": null,
    "name": "a8c1fcf1-ca66-4fc1-b5e6-51d7f4f76782",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>1. Go to the <a href='https://console.cloud.google.com/compute/instances'>VM instances</a> page. 2. Click on the impacted VM instance. 3. If the instance is not stopped, click the \"Stop\" button. Wait for the instance to be stopped. 4. Next, click the \"Edit\" button. 5. Scroll down to the \"Service Account\" section. 6. Select a different service account or ensure that \"Allow full access to all Cloud APIs\" is not selected.&nbsp; 7. Click the \"Save\" button to save your changes and then click \"START\".<br><br><b>From Command Line:</b><br> 1. Stop the instance:<br><code>gcloud compute instances stop INSTANCE_NAME</code> <br>2. Update the instance:<br><code>gcloud compute instances set-service-account INSTANCE_NAME --serviceaccount=SERVICE_ACCOUNT --scopes [SCOPE1, SCOPE2...]</code> <br>3. Restart the instance:<br><code>gcloud compute instances start INSTANCE_NAME</code>",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Enabling OS login binds SSH certificates to IAM users and facilitates effective SSH certificate management.<br>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user.<br>It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.<br>To find out which instance causes the project to be unhealthy see recommendation \"Ensure oslogin is enabled for all instances\".",
    "displayName": "Ensure oslogin is enabled for a Project",
    "id": "/providers/Microsoft.Security/assessmentMetadata/49cb12f0-3dd3-4220-9cfb-5c3fd514a6d8",
    "implementationEffort": null,
    "name": "49cb12f0-3dd3-4220-9cfb-5c3fd514a6d8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>1. Go to the <a href='https://console.cloud.google.com/compute/metadata'>VM compute metadata</a> page. 2. Click \"Edit\". 3. Add a metadata entry where the key is \"enable-oslogin\" and the value is \"TRUE\". 4. Click \"Save\" to apply the changes. 5. For every instance that overrides the project setting, go to the <a href='https://console.cloud.google.com/compute/instances'>VM instances</a> page. 6. Click the name of the instance on which you want to remove the metadata value. 7. At the top of the instance details page, click \"Edit\" to edit the instance settings. 8. Under \"Custom metadata\", remove any entry with key \"enable-oslogin\" and the value is \"FALSE\" 9. At the bottom of the instance details page, click \"Save\" to apply your changes to the instance.<br><br><b>From Command Line:</b><br>1. Configure oslogin on the project:<br><code>gcloud compute project-info add-metadata --metadata enable-oslogin=TRUE</code> <br>2. Remove instance metadata that overrides the project settings.<br><code>gcloud compute instances remove-metadata INSTANCE_NAME --keys=enable-oslogin</code><br>Optionally, you can enable two factor authentication for OS login. For more information, see <a href='https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication'>here.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Enabling OS login binds SSH certificates to IAM users and facilitates effective SSH certificate management.<br>Enabling osLogin ensures that SSH keys used to connect to instances are mapped with IAM users. Revoking access to IAM user will revoke all the SSH keys associated with that particular user.<br>It facilitates centralized and automated SSH key pair management which is useful in handling cases like response to compromised SSH key pairs and/or revocation of external/third-party/Vendor users.",
    "displayName": "Ensure oslogin is enabled for all instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/569ef64e-d7aa-4d7e-aa0b-5b3e045ca2c3",
    "implementationEffort": null,
    "name": "569ef64e-d7aa-4d7e-aa0b-5b3e045ca2c3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>1. Go to the <a href='https://console.cloud.google.com/compute/instances'>VM instances</a> page. 2. Click the name of the instance on which you want to remove the metadata value. 3. At the top of the instance details page, click \"Edit\" to edit the instance settings. 4. Under \"Custom metadata\", remove any entry with key \"enable-oslogin\" and the value is \"FALSE\" 5. At the bottom of the instance details page, click \"Save\" to apply your changes to the instance.<br><br><b>From Command Line:</b><br>Remove instance metadata that overrides the project settings.<br><code>gcloud compute instances remove-metadata INSTANCE_NAME --keys=enable-oslogin</code><br>Optionally, you can enable two factor authentication for OS login. For more information, see <a href='https://cloud.google.com/compute/docs/oslogin/setup-two-factor-authentication'>here.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Interacting with a serial port is often referred to as the serial console, which is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support.<br>If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address. Therefore interactive serial console support should be disabled.<br>A virtual machine instance has four virtual serial ports. Interacting with a serial port is similar to using a terminal window, in that input and output is entirely in text mode and there is no graphical interface or mouse support.<br>The instance's operating system, BIOS, and other system-level entities often write output to the serial ports, and can accept input such as commands or answers to prompts.<br>Typically, these system-level entities use the first serial port (port 1) and serial port 1 is often referred to as the serial console.<br>The interactive serial console does not support IP-based access restrictions such as IP whitelists. If you enable the interactive serial console on an instance, clients can attempt to connect to that instance from any IP address.<br>This allows anybody to connect to that instance if they know the correct SSH key, username, project ID, zone, and instance name.<br>Therefore interactive serial console support should be disabled.",
    "displayName": "Ensure 'Enable connecting to serial ports' is not enabled for VM Instance",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7e060336-2c9e-4289-a2a6-8d301bad47bb",
    "implementationEffort": null,
    "name": "7e060336-2c9e-4289-a2a6-8d301bad47bb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>1. Login to Google Cloud console 2. Go to Computer Engine 3. Go to VM instances 4. Click on the Specific VM 5. Click \"EDIT\" 6. Unselect \"Enable connecting to serial ports\" below \"Remote access\" block. 7. Click \"Save\". <br><br><b>From Command Line:</b><br>Use the below command to disable<br><code>gcloud compute instances add-metadata INSTANCE_NAME --zone=ZONE --metadata=serial-port-enable=false</code><br>or<br><code>gcloud compute instances add-metadata INSTANCE_NAME --zone=ZONE --metadata=serial-port-enable=0</code>",
    "severity": "Medium",
    "tactics": [
      "Lateral Movement"
    ],
    "techniques": [
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To defend against against advanced threats and ensure that the boot loader and firmware on your VMs are signed and untampered, it is recommended that Compute instances are launched with Shielded VM enabled.<br>Shielded VMs are virtual machines (VMs) on Google Cloud Platform hardened by a set of security controls that help defend against rootkits and bootkits.<br>Shielded VM offers verifiable integrity of your Compute Engine VM instances, so you can be confident your instances haven't been compromised by boot- or kernel-level malware or rootkits.<br>Shielded VM's verifiable integrity is achieved through the use of Secure Boot, virtual trusted platform module (vTPM)-enabled Measured Boot, and integrity monitoring.<br>Shielded VM instances run firmware which is signed and verified using Google's Certificate Authority, ensuring that the instance's firmware is unmodified and establishing the root of trust for Secure Boot.<br>Integrity monitoring helps you understand and make decisions about the state of your VM instances and the Shielded VM vTPM enables Measured Boot by performing the measurements needed to create a known good boot baseline, called the integrity policy baseline.<br>The integrity policy baseline is used for comparison with measurements from subsequent VM boots to determine if anything has changed.<br>Secure Boot helps ensure that the system only runs authentic software by verifying the digital signature of all boot components, and halting the boot process if signature verification fails.",
    "displayName": "Ensure Compute instances are launched with Shielded VM enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a4b3b3a-7de9-4aa4-a29b-580d59b43f79",
    "implementationEffort": null,
    "name": "1a4b3b3a-7de9-4aa4-a29b-580d59b43f79",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>1. Go to the <a href='https://console.cloud.google.com/compute/instances'>VM instances</a> page. 2. Click on the instance name to see its \"VM instance details\" page. 3. Click \"STOP\" to stop the instance. 4. When the instance has stopped, click \"EDIT\". 5. In the Shielded VM section, select \"Turn on vTPM\" and \"Turn on Integrity Monitoring\". 6. Optionally, if you do not use any custom or unsigned drivers on the instance, also select \"Turn on Secure Boot\". 7. Click the \"Save\" button to modify the instance and then click \"START\" to restart it. <br><br><b>From Command Line:</b><br>You can only enable Shielded VM options on instances that have Shielded VM support. For a list of Shielded VM public images, run the gcloud compute images list command with the following flags:<br><code>gcloud compute images list --project gce-uefi-images --no-standard-images</code><br>1. Stop the instance:<br><code>gcloud compute instances stop INSTANCE_NAME</code> <br>2. Update the instance:<br><code>gcloud compute instances update INSTANCE_NAME --shielded-vtpm --shielded-vmintegrity-monitoring</code> <br>3. Optionally, if you do not use any custom or unsigned drivers on the instance, also turn on secure boot.<br><code>gcloud compute instances update INSTANCE_NAME --shielded-vm-secure-boot</code> <br>4. Restart the instance: <br><code>gcloud compute instances start INSTANCE_NAME</code>",
    "severity": "High",
    "tactics": [
      "Discovery",
      "Defense Evasion"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery",
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Compute instances should not be configured to have external IP addresses.<br>To reduce your attack surface, Compute instances should not have public IP addresses. Instead, instances should be configured behind load balancers, to minimize the instance's exposure to the internet.<br>Instances created by GKE should be excluded because some of them have external IP addresses and cannot be changed by editing the instance settings.<br>These VMs have names that start with \"gke-\" and are labeled \"goog-gke-node\".",
    "displayName": "Ensure that Compute instances do not have public IP addresses",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8bdd13ad-a9d2-4910-8b06-9c4cddb55abb",
    "implementationEffort": null,
    "name": "8bdd13ad-a9d2-4910-8b06-9c4cddb55abb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b><br>1. Go to the <a href='https://console.cloud.google.com/compute/instances'>VM instances</a> page. 2. Click on the instance name to go the the Instance detail page. 3. Click \"Edit\". 4. For each Network interface, ensure that External IP is set to None. 5. Click \"Done\" and then click \"Save\". <br><br><b>From Command Line:</b><br>1. Describe the instance properties: <code>gcloud compute instances describe INSTANCE_NAME --zone=ZONE</code><br>2. Identify the access config name that contains the external IP address. This access config appears in the following format:<br><code>networkInterfaces: - accessConfigs: - kind: compute#accessConfig name: External NAT natIP: 130.211.181.55 type: ONE_TO_ONE_NAT</code> <br>3. Delete the access config.<br><code>gcloud compute instances delete-access-config INSTANCE_NAME --zone=ZONE --access-config-name \"ACCESS_CONFIG_NAME\"</code>",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended that IAM policy on Cloud Storage bucket does not allows anonymous or public access.<br/>Allowing anonymous or public access grants permissions to anyone to access bucket content. <br/> Such access might not be desired if you are storing any sensitive data. <br/> Hence, ensure that anonymous or public access to a bucket is not allowed.",
    "displayName": "Ensure that Cloud Storage bucket is not anonymously or publicly accessible",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d8305d96-2aa5-458d-92b7-f8418f5f3328",
    "implementationEffort": null,
    "name": "d8305d96-2aa5-458d-92b7-f8418f5f3328",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b> <br/>1. Go to \"Storage browser\" by visiting <a href=\"https://console.cloud.google.com/storage/browser\">GCP Storage browser</a>. 2. Click on the bucket name to go to its \"Bucket details\" page. 3. Click on the \"Permissions\" tab. 4. Click \"Delete\" button in front of \"allUsers\" and \"allAuthenticatedUsers\" to remove that particular role assignment. <br/> <b>From Command Line:</b> <br/>Remove \"allUsers\" and \"allAuthenticatedUsers\" access. <br/> <code>gsutil iam ch -d allUsers gs://BUCKET_NAME <br/>gsutil iam ch -d allAuthenticatedUsers gs://BUCKET_NAME <code/>",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Storage Object Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended that uniform bucket-level access is enabled on Cloud Storage buckets. <br/> It is recommended to use uniform bucket-level access to unify and simplify how you grant access to your Cloud Storage resources.<br/> Cloud Storage offers two systems for granting users permission to access your buckets and objects: <br/> Cloud Identity and Access Management (Cloud IAM) and Access Control Lists (ACLs).  <br/> These systems act in parallel - in order for a user to access a Cloud Storage resource, only one of the systems needs to grant the user permission. <br/> Cloud IAM is used throughout Google Cloud and allows you to grant a variety of permissions at the bucket and project levels.<br/> ACLs are used only by Cloud Storage and have limited permission options, but they allow you to grant permissions on a per-object basis. <br/><br/> In order to support a uniform permissioning system, Cloud Storage has uniform bucket-level access.<br/> Using this feature disables ACLs for all Cloud Storage resources: <br/> access to Cloud Storage resources then is granted exclusively through Cloud IAM. <br/> Enabling uniform bucket-level access guarantees that if a Storage bucket is not publicly accessible, <br/>no object in the bucket is publicly accessible either.",
    "displayName": "Ensure that Cloud Storage buckets have uniform bucket-level access enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/64b5cdbc-0633-49af-b63d-a9dc90560196",
    "implementationEffort": null,
    "name": "64b5cdbc-0633-49af-b63d-a9dc90560196",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b> <br/>1. Open the \"Cloud Storage browser\" in the Google Cloud Console by visiting: <a href=\"https://console.cloud.google.com/storage/browser\">GCP Storage browser</a>. 2. In the list of buckets, click on the name of the desired bucket. 3. Select the \"Permissions\" tab near the top of the page. 4. In the text box that starts with \"This bucket uses fine-grained access control...\", click \"Edit\". 5. In the pop-up menu that appears, select \"Uniform\". 6. Click \"Save\". <br/> <b>From Command Line:</b> <br/>Use the \"on\" option in a uniformbucketlevelaccess set command: <br/> <code>gsutil uniformbucketlevelaccess set on gs://BUCKET_NAME/</code>",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended that the IAM policy on BigQuery datasets does not allow anonymous and/or public access.<br/>  Granting permissions to allUsers or allAuthenticatedUsers allows anyone to access the dataset. <br/>Such access might not be desirable if sensitive data is being stored in the dataset.<br/> Therefore, ensure that anonymous and/or public access to a dataset is not allowed.",
    "displayName": "Ensure that BigQuery datasets are not anonymously or publicly accessible",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dab1eea3-7693-4da3-af1b-2f73832655fa",
    "implementationEffort": null,
    "name": "dab1eea3-7693-4da3-af1b-2f73832655fa",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b>From Console:</b> <br/> 1. Go to \"BigQuery\" by visiting: <a href=\"https://console.cloud.google.com/bigquery\">BigQuery</a>. 2. Select the dataset from \"Resources\". 3. Click \"SHARE DATASET\" near the right side of the window. 4. Review each attached role. 5. Click the \"delete\" icon for each member \"allUsers\" or \"allAuthenticatedUsers\". On the popup click \"Remove\". <br/> <b>From Command Line:</b> <br/> 1. Retrieve the data set information: <br/> <code>bq show --format=prettyjson PROJECT_ID:DATASET_NAME > PATH_TO_FILE </code> <br/> 2. In the access section of the JSON file, update the dataset information to remove all roles containing \"allUsers\" or \"allAuthenticatedUsers\". 3. Update the dataset: <br/> <code>bq update --source PATH_TO_FILE PROJECT_ID:DATASET_NAME</code>",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enabling the \"log_lock_waits\" flag for a PostgreSQL instance creates a log for any session waits that take longer than the alloted \"deadlock_timeout\" time to acquire a lock. <br> The deadlock timeout defines the time to wait on a lock before checking for any conditions. Frequent run overs on deadlock timeout can be an indication of an underlying issue. <br> Logging such waits on locks by enabling the log_lock_waits flag can be used to identify poor performance due to locking delays or if a specially-crafted SQL is attempting to starve resources through holding locks for excessive amounts of time. <br> This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure that the 'log_lock_waits' database flag for Cloud SQL PostgreSQL instance is set to 'on'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8191f530-fde7-4177-827a-43ce0f69ffe7",
    "implementationEffort": null,
    "name": "8191f530-fde7-4177-827a-43ce0f69ffe7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_lock_waits\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"log_lock_waits\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_lock_waits=on </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The \"log_min_error_statement\" flag defines the minimum message severity level that is considered as an error statement. <br> Messages for error statements are logged with the SQL statement. <br> Valid values include \"DEBUG5\", \"DEBUG4\", \"DEBUG3\", \"DEBUG2\", \"DEBUG1\", \"INFO\", \"NOTICE\", \"WARNING\", \"ERROR\", \"LOG\", \"FATAL\", and \"PANIC\". <br> Each severity level includes the subsequent levels mentioned above. <br> Note: To effectively turn off logging failing statements, set this parameter to PANIC. <br> ERROR is considered the best practice setting. Changes should only be made in accordance with the organization's logging policy. <br>Auditing helps in troubleshooting operational problems and also permits forensic analysis. <br> If \"log_min_error_statement\" is not set to the correct value, messages may not be classified as error messages appropriately. <br> Considering general log messages as error messages would make it difficult to find actual errors, while considering only stricter severity levels as error messages may skip actual errors to log their SQL statements. <br> The \"log_min_error_statement\" flag should be set in accordance with the organization's logging policy. <br> This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure that the 'log_min_messages' database flag for Cloud SQL PostgreSQL instance is set appropriately",
    "id": "/providers/Microsoft.Security/assessmentMetadata/492fed4e-1871-4c12-948d-074ee0f07559",
    "implementationEffort": null,
    "name": "492fed4e-1871-4c12-948d-074ee0f07559",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_min_error_statement\" from the drop-down menu and set appropriate value. 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"log_min_error_statement\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_min_error_statement=<DEBUG5|DEBUG4|DEBUG3|DEBUG2|DEBUG1|INFO|NOTICE|WARNING|ERROR|LOG|FATAL|PANIC> </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "PostgreSQL can create a temporary file for actions such as sorting, hashing and temporary query results when these operations exceed \"work_mem\". <br> The \"log_temp_files\" flag controls logging names and the file size when it is deleted. <br> Configuring \"log_temp_files\" to 0 causes all temporary file information to be logged, while positive values log only files whose size is greater than or equal to the specified number of kilobytes. <br> A value of \"-1\" disables temporary file information logging. <br> If all temporary files are not logged, it may be more difficult to identify potential performance issues that may be due to either poor application coding or deliberate resource starvation attempts.",
    "displayName": "Ensure that the 'log_temp_files' database flag for Cloud SQL PostgreSQL instance is set to '0' ",
    "id": "/providers/Microsoft.Security/assessmentMetadata/29622fc0-14dc-4d65-a5a8-e9a39ffc4b62",
    "implementationEffort": null,
    "name": "29622fc0-14dc-4d65-a5a8-e9a39ffc4b62",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_temp_files\" from the drop-down menu and set the value as 0. 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"log_temp_files\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_temp_files=`0`</code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The \"log_min_duration_statement\" flag defines the minimum amount of execution time of a statement in milliseconds where the total duration of the statement is logged. Ensure that \"log_min_duration_statement\" is disabled, i.e., a value of -1 is set. <br> Logging SQL statements may include sensitive information that should not be recorded in logs. This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure that the 'log_min_duration_statement' database flag for Cloud SQL PostgreSQL instance is set to '-1'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1c9e237b-419f-4e73-b43a-94b5863dd73e",
    "implementationEffort": null,
    "name": "1c9e237b-419f-4e73-b43a-94b5863dd73e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_min_duration_statement\" from the drop-down menu and set the value of \"-1\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code> 2. Configure the \"log_min_duration_statement\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_min_duration_statement=-1 </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set \"cross db ownership chaining\" database flag for Cloud SQL SQL Server instance to \"off\". <br> Use the \"cross db ownership\" for chaining option to configure cross-database ownership chaining for an instance of Microsoft SQL Server. <br> This server option allows you to control cross-database ownership chaining at the database level or to allow cross-database ownership chaining for all databases. <br> Enabling \"cross db ownership\" is not recommended unless all of the databases hosted by the instance of SQL Server must participate in cross-database ownership chaining and you are aware of the security implications of this setting. <br> This recommendation is applicable to SQL Server database instances.",
    "displayName": "Ensure that the 'cross db ownership chaining' database flag for Cloud SQL SQL Server instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/26973a34-79a6-46a0-874f-358c8c00af05",
    "implementationEffort": null,
    "name": "26973a34-79a6-46a0-874f-358c8c00af05",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the SQL Server instance for which you want to enable to database flag. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"cross db ownership chaining\" from the drop-down menu, and set its value to \"off\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"cross db ownership chaining\" database flag for every Cloud SQL SQL Server database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags \"cross db ownership chaining=off\" </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set \"contained database authentication\" database flag for Cloud SQL on the SQL Server instance is set to \"off\". <br> A contained database includes all database settings and metadata required to define the database and has no configuration dependencies on the instance of the Database Engine where the database is installed. <br> Users can connect to the database without authenticating a login at the Database Engine level. <br> Isolating the database from the Database Engine makes it possible to easily move the database to another instance of SQL Server. <br> Contained databases have some unique threats that should be understood and mitigated by SQL Server Database Engine administrators. <br> Most of the threats are related to the USER WITH PASSWORD authentication process, which moves the authentication boundary from the Database Engine level to the database level, hence this is recommended to disable this flag. <br> This recommendation is applicable to SQL Server database instances.",
    "displayName": "Ensure that the 'contained database authentication' database flag for Cloud SQL on the SQL Server instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/658ce98f-ecf1-4c14-967f-3c4faf130fbf",
    "implementationEffort": null,
    "name": "658ce98f-ecf1-4c14-967f-3c4faf130fbf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the SQL Server instance for which you want to enable to database flag. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"contained database authentication\" from the drop-down menu, and set its value to \"off\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code> 2. Configure the \"contained database authentication\" database flag for every Cloud SQL SQL Server database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags \"contained database authentication=off\" </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to enforce all incoming connections to SQL database instance to use SSL. <br> SQL database connections if successfully trapped (MITM); can reveal sensitive data like credentials, database queries, query outputs etc. <br> For security, it is recommended to always use SSL encryption when connecting to your instance. <br> This recommendation is applicable for Postgresql, MySql generation 1 and MySql generation 2 instances.",
    "displayName": "Ensure that the Cloud SQL database instance requires all incoming connections to use SSL",
    "id": "/providers/Microsoft.Security/assessmentMetadata/13872d43-aac6-4018-9c89-507b8fe9be54",
    "implementationEffort": null,
    "name": "13872d43-aac6-4018-9c89-507b8fe9be54",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Click on an instance name to see its configuration overview. 3. In the left-side panel, select \"Connections\". 4. In the \"SSL connections\" section, click \"Allow only SSL connections\". 5. Under \"Configure SSL server certificates\" click \"Create new certificate\". 6. Under \"Configure SSL client certificates\" click \"Create a client certificate\". 7. Follow the instructions shown to learn how to connect to your instance. <br><br> <b> From Command Line: </b> <br> To enforce SSL encryption for an instance run the command: <br><code> gcloud sql instances patch INSTANCE_NAME --require-ssl </code><br><br> Note: <br> \"RESTART\" is required for type MySQL Generation 1 Instances (\"backendType: FIRST_GEN\") to get this configuration in effect.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Database Server should accept connections only from trusted Network(s)/IP(s) and restrict access from the world. <br> To minimize attack surface on a Database server instance, only trusted/known and required IP(s) should be white-listed to connect to it. <br> An authorized network should not have IPs/networks configured to \"0.0.0.0/0\" which will allow access to the instance from anywhere in the world. Note that authorized networks apply only to instances with public IPs.",
    "displayName": "Ensure that Cloud SQL database instances are not open to the world",
    "id": "/providers/Microsoft.Security/assessmentMetadata/de78ebca-1ec6-4872-8061-8fcfb27752fc",
    "implementationEffort": null,
    "name": "de78ebca-1ec6-4872-8061-8fcfb27752fc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b><br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Click the instance name to open its \"Instance details\" page. 3. Under the \"Configuration\" section click \"Edit configurations\". 4. Under \"Configuration options\" expand the \"Connectivity\" section. 5. Click the \"delete\" icon for the authorized network \"0.0.0.0/0\". 6. Click \"Save\" to update the instance.<br><br> <b> From Command Line: </b><br> Update the authorized network list by dropping off any addresses. <br><code> oud sql instances patch INSTANCE_NAME --authorized-networks=IP_ADDR1,IP_ADDR2... </code> ",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to configure Second Generation Sql instance to use private IPs instead of public IPs. <br> To lower the organization's attack surface, Cloud SQL databases should not have public IPs. <br> Private IPs provide improved network security and lower latency for your application.",
    "displayName": "Ensure that Cloud SQL database instances do not have public IPs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1658239d-caf7-471d-83c5-2e4c44afdcff",
    "implementationEffort": null,
    "name": "1658239d-caf7-471d-83c5-2e4c44afdcff",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. <br>2. Click the instance name to open its Instance details page. <br>3. Select the \"Connections\" tab. <br>4. Deselect the \"Public IP\" checkbox. <br>5. If the instance is not already configured to use a private IP, see <a target=\"_blank\" href=\"https://cloud.google.com/sql/docs/mysql/configure-private-ip\">Configuring private IP for an existing instance</a>. <br>6. Click \"Save\" to update the instance.<br><br> <b> From Command Line: </b> <br> 1. For every instance remove its public IP and assign a private IP instead: <br> <code> gcloud beta sql instances patch INSTANCE_NAME --network=VPC_NETWOR_NAME --no-assign-ip </code> <br>2. Confirm the changes using the following command: <br> <code>gcloud sql instances describe INSTANCE_NAME</code>",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to have all SQL database instances set to enable automated backups. <br> Backups provide a way to restore a Cloud SQL instance to recover lost data or recover from a problem with that instance. <br> Automated backups need to be set for any instance that contains data that should be protected from loss or damage. <br> This recommendation is applicable for SQL Server, PostgreSql, MySql generation 1 and MySql generation 2 instances.",
    "displayName": "Ensure that Cloud SQL database instances are configured with automated backups",
    "id": "/providers/Microsoft.Security/assessmentMetadata/afaac6e6-6240-48a2-9f62-4e257b851311",
    "implementationEffort": null,
    "name": "afaac6e6-6240-48a2-9f62-4e257b851311",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the instance where the backups need to be configured. 3. Click \"Edit\". 4. In the \"Backups\" section, check \"Enable automated backups\", and choose a backup window. 5. Click \"Save\". <br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br> <code> gcloud sql instances list </code> 2. Enable \"Automated backups\" for every Cloud SQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --backup-start-time [HH:MM] </code>The \"backup-start-time\" parameter is specified in 24-hour time, in the UTC+00 time zone, and specifies the start of a 4-hour backup window. Backups can start any time during the backup window.",
    "severity": "High",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set the local_infile database flag for a Cloud SQL MySQL instance to off.<br />The local_infile flag controls the server-side LOCAL capability for LOAD DATA statements. Depending on the local_infile setting, the server refuses or permits local data loading by clients that have LOCAL enabled on the client side.<br />To explicitly cause the server to refuse LOAD DATA LOCAL statements (regardless of how client programs and libraries are configured at build time or runtime), start mysqld with local_infile disabled. local_infile can also be set at runtime.<br />Due to security issues associated with the local_infile flag, it is recommended to disable it. This recommendation is applicable to MySQL database instances.",
    "displayName": "Ensure that the 'local_infile' database flag for a Cloud SQL Mysql instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/633a87f4-bd71-45ce-9eca-c6bb8cbe8b21",
    "implementationEffort": null,
    "name": "633a87f4-bd71-45ce-9eca-c6bb8cbe8b21",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br />1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the MySQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"local_infile\" from the drop-down menu, and set its value to \"off\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page. <br /> <br /> <b> From Command Line: </b> <br />List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list </code><br />Configure the local_infile database flag for every Cloud SQL Mysql database instance using the below command:<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags local_infile=off </code><br />Note: <br />This command will overwrite all database flags that were previously set. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Ensure that the log_checkpoints database flag for the Cloud SQL PostgreSQL instance is set to on.<br />Enabling log_checkpoints causes checkpoints and restart points to be logged in the server log. Some statistics are included in the log messages, including the number of buffers written and the time spent writing them. <br /> This parameter can only be set in the postgresql.conf file or on the server command line. This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure that the 'log_checkpoints' database flag for Cloud SQL PostgreSQL instance is set to 'on'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a2404629-0132-4ab3-839e-8389dbe9fe98",
    "implementationEffort": null,
    "name": "a2404629-0132-4ab3-839e-8389dbe9fe98",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br>1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_checkpoints\" from the drop-down menu, and set its value. 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page. <br /> <br /> <b> From Command Line: </b> <br />List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list </code><br />Configure the log_checkpoints database flag for every Cloud SQL PosgreSQL database instance using the below command:<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags log_checkpoints=on </code><br />Note: This command will overwrite all previously set database flags. To keep those and add new ones, include the values for all flags to be set on the instance. Any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Enabling the log_connections setting causes each attempted connection to the server to be logged, along with successful completion of client authentication. This parameter cannot be changed after the session starts.<br />PostgreSQL does not log attempted connections by default. Enabling the log_connections setting will create log entries for each attempted connection as well as successful completion of client authentication which can be useful in troubleshooting issues and to determine any unusual connection attempts to the server. <br /> This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure that the 'log_connections' database flag for Cloud SQL PostgreSQL instance is set to 'on'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4016e27f-a451-4e24-9222-39d7d107ad74",
    "implementationEffort": null,
    "name": "4016e27f-a451-4e24-9222-39d7d107ad74",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the PostgreSQL instance for which you want to enable the database flag. 3. Click \"Edit\".  4. Scroll down to the \"Flags\" section.  5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_connections\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\".  7. Confirm the changes under \"Flags\" on the Overview page. <br /> <br /> <b> From Command Line: </b> <br /> List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list</code><br />Configure the log_connections database flag for every Cloud SQL PosgreSQL database instance using the below command.<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags log_connections=on</code><br />Note: <br />This command will overwrite all previously set database flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Enabling the log_disconnections setting logs the end of each session, including the session duration.<br />PostgreSQL does not log session details such as duration and session end by default. Enabling the log_disconnections setting will create log entries at the end of each session which can be useful in troubleshooting issues and determine any unusual activity across a time period. <br />The log_disconnections and log_connections work hand in hand and generally, the pair would be enabled/disabled together. This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure that the 'log_disconnections' database flag for Cloud SQL PostgreSQL instance is set to 'on'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a86f62be-7402-4797-91dc-8ba2b976cb74",
    "implementationEffort": null,
    "name": "a86f62be-7402-4797-91dc-8ba2b976cb74",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\".  4. Scroll down to the \"Flags\" section.  5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_disconnections\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\".  7. Confirm the changes under \"Flags\" on the Overview page. <br /><b> From Command Line: </b><br /> List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list</code><br />Configure the log_disconnections database flag for every Cloud SQL PosgreSQL database instance using the below command.<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags log_disconnections=on</code><br />Note: <br /> This command will overwrite all previously setdatabase flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "A service account is a special Google account that belongs to an application or a VM, instead of to an individual end-user.<br> The application uses the service account to call the service's Google API so that users aren't directly involved.<br> It's recommended not to use admin access for ServiceAccount.<br> Service accounts represent service-level security of the Resources (application or a VM) which can be determined by the roles assigned to it.<br> Enrolling ServiceAccount with Admin rights gives full access to an assigned application or a VM.<br> A ServiceAccount Access holder can perform critical actions like delete, update change settings, etc.<br> without user intervention.<br> For this reason, it's recommended that service accounts not have Admin rights.",
    "displayName": "Ensure that Service Account has no Admin privileges",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ae77cb8b-0b43-4e86-8b5c-f5afcf95766a",
    "implementationEffort": null,
    "name": "ae77cb8b-0b43-4e86-8b5c-f5afcf95766a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to <a href=\"https://console.cloud.google.com/iam-admin/iam\">IAM & admin/IAM</a>. 2. Go to the \"Members\". 3. Identify \"User-Managed user created\" service account with roles containing \"*Admin\" or \"*admin\" or role matching \"Editor\" or role matching \"Owner\". 4. Click the \"Delete bin\" icon to remove the role from the member (service account in this case) <br /><b> From Command Line: </b><br /> 1. Using a text editor, Remove \"Role\" which contains \"roles/*Admin\" or \"roles/*admin\" or matched \"roles/editor\" or matches \"roles/owner\". Add a role to the bindings array that defines the group members and the role for those members.<br> For example, to grant the role roles/appengine.appViewer to the \"ServiceAccount\" which is roles/editor, you would change the example shown below as follows:<br><code>{ 'bindings': [ { 'members': [ 'serviceAccount:our-project-123@appspot.gserviceaccount.com', ], 'role': 'roles/appengine.appViewer' }, { 'members': [ 'user:email1@gmail.com' ], 'role': 'roles/owner' }, { 'members': [ 'serviceAccount:our-project-123@appspot.gserviceaccount.com', 'serviceAccount:123456789012-compute@developer.gserviceaccount.com' ], 'role': 'roles/editor' } ], 'etag': 'BwUjMhCsNvY=' } </code><br> 2. Update the project's IAM policy:<br><code>gcloud projects set-iam-policy PROJECT_ID iam.json</code>",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set \"skip_show_database\" database flag for Cloud SQL Mysql instance to \"on\".<br> 'skip_show_database' database flag prevents people from using the SHOW DATABASES statement if they do not have the SHOW DATABASES privilege.<br> This can improve security if you have concerns about users being able to see databases belonging to other users.<br> Its effect depends on the SHOW DATABASES privilege: If the variable value is ON, the SHOW DATABASES statement is permitted only to users who have the SHOW DATABASES privilege, and the statement displays all database names.<br> If the value is OFF, SHOW DATABASES is permitted to all users, but displays the names of only those databases for which the user has the SHOW DATABASES or other privilege.<br> This recommendation is applicable to Mysql database instances.<br> ",
    "displayName": "Ensure 'skip_show_database' database flag for Cloud SQL Mysql instance is set to 'on'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9e5b33de-bcfa-4044-93ce-4937bf8f0bbd",
    "implementationEffort": null,
    "name": "9e5b33de-bcfa-4044-93ce-4937bf8f0bbd",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the  Mysql instance where the database flag needs to be enabled. 3. Click \"Edit\".  4. Scroll down to the \"Flags\" section.  5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"skip_show_database\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\".  7. Confirm the changes under \"Flags\" on the Overview page. <br /><b> From Command Line: </b><br /> 1. List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list</code><br /> 2. Configure the \"skip_show_database\" database flag for every Cloud SQL Mysql database instance using the below command.<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags skip_show_database=on</code><br />Note: <br /> This command will overwrite all previously setdatabase flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Low",
    "tactics": [
      "Reconnaissance"
    ],
    "techniques": [
      "Active Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enabling the log_hostname setting causes the duration of each completed statement to be logged.<br> This does not logs the text of the query and thus behaves different from the log_min_duration_statement flag.<br> This parameter cannot be changed after session start.<br> Monitoring the time taken to execute the queries can be crucial in identifying any resource hogging queries and assessing the performance of the server.<br> Further steps such as load balancing and use of optimized queries can be taken to ensure the performance and stability of the server.<br> This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure 'log_duration' database flag for Cloud SQL PostgreSQL instance is set to 'on'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/272820a7-06ce-44b3-8318-4ec1f82237dc",
    "implementationEffort": null,
    "name": "272820a7-06ce-44b3-8318-4ec1f82237dc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the  PosgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\".  4. Scroll down to the \"Flags\" section.  5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_duration\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\".  7. Confirm the changes under \"Flags\" on the Overview page. <br /><b> From Command Line: </b><br /> 1. List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list</code><br /> 2. Configure the \"log_duration\" database flag for every Cloud SQL PosgreSQL database instance using the below command.<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags log_duration=on </code><br />Note: <br /> This command will overwrite all previously setdatabase flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "PostgreSQL logs only the IP address of the connecting hosts.<br> The \"log_hostname\" flag controls the logging of \"hostnames\" in addition to the IP addresses logged.<br> The performance hit is dependent on the configuration of the environment and the host name resolution setup.<br> This parameter can only be set in the \"postgresql.conf\" file or on the server command line.<br> Logging hostnames can incur overhead on server performance as for each statement logged, DNS resolution will be required to convert IP address to hostname.<br> Depending on the setup, this may be non-negligible.<br> Additionally, the IP addresses that are logged can be resolved to their DNS names later when reviewing the logs excluding the cases where dynamic hostnames are used.<br> This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure 'log_hostname' database flag for Cloud SQL PostgreSQL instance is set appropriately",
    "id": "/providers/Microsoft.Security/assessmentMetadata/989db7d6-71d5-4928-a9a6-c9ab7b8044e9",
    "implementationEffort": null,
    "name": "989db7d6-71d5-4928-a9a6-c9ab7b8044e9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the  PosgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\".  4. Scroll down to the \"Flags\" section.  5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_hostname\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\".  7. Confirm the changes under \"Flags\" on the Overview page. <br /><b> From Command Line: </b><br /> 1. List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list</code><br /> 2. Configure the \"log_hostname\" database flag for every Cloud SQL PosgreSQL database instance using the below command.<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags log_hostname=<off|on> </code><br />Note: <br /> This command will overwrite all previously setdatabase flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Low",
    "tactics": [
      "Discovery",
      "Reconnaissance"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery",
      "Gather Victim Host Information"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The PostgreSQL planner/optimizer is responsible to parse and verify the syntax of each query received by the server.<br> If the syntax is correct a \"parse tree\" is built up else an error is generated.<br> The \"log_parser_stats\" flag controls the inclusion of parser performance statistics in the PostgreSQL logs for each query.<br> The \"log_parser_stats\" flag enables a crude profiling method for logging parser performance statistics which even though can be useful for troubleshooting, it may increase the amount of logs significantly and have performance overhead.<br> This recommendation is applicable to PostgreSQL database instances.<br> ",
    "displayName": "Ensure 'log_parser_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a6efc275-b1c1-4003-8e85-2f30b2eb56e6",
    "implementationEffort": null,
    "name": "a6efc275-b1c1-4003-8e85-2f30b2eb56e6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting https://console.cloud.google.com/sql/instances. 2. Select the  PosgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\".  4. Scroll down to the \"Flags\" section.  5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_parser_stats\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\".  7. Confirm the changes under \"Flags\" on the Overview page. <br /><b> From Command Line: </b><br /> 1. List all Cloud SQL database instances using the following command:<br /><code> gcloud sql instances list</code><br /> 2. Configure the \"log_parser_stats\" database flag for every Cloud SQL PosgreSQL database instance using the below command.<br /><code> gcloud sql instances patch INSTANCE_NAME --database-flags log_parser_stats=off </code><br />Note: <br /> This command will overwrite all previously setdatabase flags. To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. For flags that do not take a value, specify the flag name followed by an equals sign ('=').",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Flow Logs is a feature that enables users to capture information about the IP traffic going to and from network interfaces in the organization's VPC Subnets. Once a flow log is created, the user can view and retrieve its data in Stackdriver Logging. <br> It is recommended that Flow Logs be enabled for every business-critical VPC subnet.<br>VPC networks and subnetworks provide logically isolated and secure network partitions where GCP resources can be launched. When Flow Logs is enabled for a subnet, VMs within that subnet start reporting on all Transmission Control Protocol (TCP) and User Datagram Protocol (UDP) flows. <br> Each VM samples the TCP and UDP flows it sees, inbound and outbound, whether the flow is to or from another VM, a host in the on-premises datacenter, a Google service, or a host on the Internet. If two GCP VMs are communicating, and both are in subnets that have VPC Flow Logs enabled, both VMs report the flows.<br>Flow Logs supports the following use cases: 1. Network monitoring. 2. Understanding network usage and optimizing network traffic expenses. 3. Network forensics. 4. Real-time security analysis<br>Flow Logs provide visibility into network traffic for each VM inside the subnet and can be used to detect anomalous traffic or insight during security workflows.",
    "displayName": "Ensure that VPC Flow Logs is enabled for every subnet in a VPC Network",
    "id": "/providers/Microsoft.Security/assessmentMetadata/25631aaa-3866-43ac-860f-22c12bff1a4b",
    "implementationEffort": null,
    "name": "25631aaa-3866-43ac-860f-22c12bff1a4b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the VPC network GCP Console visiting <a href='https://console.cloud.google.com/networking/networks/list'>https://console.cloud.google.com/networking/networks/list</a>. 2. Click the \"name\" of a subnet, The Subnet details page displays. 3. Click the \"EDIT\" button. 4. Set \"Flow Logs\" to On. 5. Click \"Save\". <br /> <br /> <b> From Command Line: </b> <br />To set Private Google access for a network subnet, run the following command::<br /><code> gcloud compute networks subnets update [SUBNET_NAME] --region [REGION] --enable-flow-logs </code>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "It is recommended to use Instance specific SSH key(s) instead of using common/shared project-wide SSH key(s) to access Instances. <br />Project-wide SSH keys are stored in Compute/Project-meta-data. Project wide SSH keys can be used to login into all the instances within project. Using project-wide SSH keys eases the SSH key management but if compromised, poses the security risk which can impact all the instances within project. <br> It is recommended to use Instance specific SSH keys which can limit the attack surface if the SSH keys are compromised.",
    "displayName": "Ensure 'Block Project-wide SSH keys' is enabled for VM instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/00f8a6a6-cf69-4c11-822e-3ebf4910e545",
    "implementationEffort": null,
    "name": "00f8a6a6-cf69-4c11-822e-3ebf4910e545",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the VM instances page by visiting: <a href='https://console.cloud.google.com/compute/instances'>https://console.cloud.google.com/compute/instances</a>.It will list all the instances in your project. 2. Click on the \"name\" of the Impacted instance. 3. Click \"Edit\" in the toolbar. 4. Under \"SSH Keys\", go to the \"Block project-wide\" SSH keys checkbox. 5. To block users with project-wide SSH keys from connecting to this instance, select \"Block project-wide\" SSH keys. 6. Click \"Save\" at the bottom of the page. 7. Repeat steps for every impacted Instance.<br /> <br /> <b> From Command Line: </b> <br /> Block project-wide public SSH keys, set the metadata value to TRUE:<br /><code> gcloud compute instances add-metadata INSTANCE_NAME --metadata block-project-ssh-keys=TRUE </code>",
    "severity": "Medium",
    "tactics": [
      "Lateral Movement"
    ],
    "techniques": [
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. <br> However, both capabilities are required if you want to use instances to help route packets.<br />Forwarding of data packets should be disabled to prevent data loss or information disclosure. <br />Compute Engine instance cannot forward a packet unless the source IP address of the packet matches the IP address of the instance. Similarly, GCP won't deliver a packet whose destination IP address is different than the IP address of the instance receiving the packet. <br> However, both capabilities are required if you want to use instances to help route packets. To enable this source and destination IP check, disable the canIpForward field, which allows an instance to send and receive packets with non-matching destination or source IPs.",
    "displayName": "Ensure that IP forwarding is not enabled on Instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0ba588a6-4539-4e67-bc62-d7b2b51300fb",
    "implementationEffort": null,
    "name": "0ba588a6-4539-4e67-bc62-d7b2b51300fb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the \"VM Instances\" page by visiting: <a href='https://console.cloud.google.com/compute/instances'>https://console.cloud.google.com/compute/instances</a>. 2. Select the \"VM Instance\" you want to remediate 3. Click the \"Delete\" button. 4. On the \"VM Instances\" page, click \"CREATE INSTANCE\". 5. Create a new instance with the desired configuration. By default, the instance is configured to not allow IP forwarding.<br /> <br /> <b> From Command Line: </b> <br /> Delete the instance<br /><code> gcloud compute instances delete INSTANCE_NAME </code><br />Create a new instance to replace it, with IP forwarding set to Off<br /><code> gcloud compute instances create </code>",
    "severity": "Medium",
    "tactics": [
      "Exfiltration"
    ],
    "techniques": [
      "Exfiltration over C2 Channel"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The same SQL query can be excuted in multiple ways and still produce different results.<br> The PostgreSQL planner/optimizer is responsible to create an optimal execution plan for each query.<br> The \"log_planner_stats\" flag controls the inclusion of PostgreSQL planner performance statistics in the PostgreSQL logs for each query.<br> The \"log_planner_stats\" flag enables a crude profiling method for logging PostgreSQL planner performance statistics which even though can be useful for troubleshooting, it may increase the amount of logs significantly and have performance overhead.<br> This recommendation is applicable to PostgreSQL database instances.",
    "displayName": "Ensure 'log_planner_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7d87879a-d498-4e61-b552-b34463f87f83",
    "implementationEffort": null,
    "name": "7d87879a-d498-4e61-b552-b34463f87f83",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_planner_stats\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"log_planner_stats\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_planner_stats=off </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The PostgreSQL executor is responsible to execute the plan handed over by the PostgreSQL planner.<br> The executor processes the plan recursively to extract the required set of rows.<br> The \"log_executor_stats\" flag controls the inclusion of PostgreSQL executor performance statistics in the PostgreSQL logs for each query.<br> The \"log_executor_stats\" flag enables a crude profiling method for logging PostgreSQL executor performance statistics which even though can be useful for troubleshooting, it may increase the amount of logs significantly and have performance overhead.<br> This recommendation is applicable to PostgreSQL database instances.<br> ",
    "displayName": "Ensure 'log_executor_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/19711549-76eb-4f1f-b43b-b1048e66c1f0",
    "implementationEffort": null,
    "name": "19711549-76eb-4f1f-b43b-b1048e66c1f0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_executor_stats\" from the drop-down menu and  set appropriate value. 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"log_executor_stats\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_executor_stats=off </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The \"log_statement_stats\" flag controls the inclusion of end to end performance statistics of a SQL query in the PostgreSQL logs for each query.<br> This cannot be enabled with other module statistics (\"log_parser_stats\", \"log_planner_stats\", \"log_executor_stats\").<br> The \"log_statement_stats\" flag enables a crude profiling method for logging end to end performance statistics of a SQL query.<br> This can be useful for troubleshooting but may increase the amount of logs significantly and have performance overhead.<br> This recommendation is applicable to PostgreSQL database instances.<br> ",
    "displayName": "Ensure 'log_statement_stats' database flag for Cloud SQL PostgreSQL instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c36e73b7-ee30-4684-a1ad-2b878d2b10bf",
    "implementationEffort": null,
    "name": "c36e73b7-ee30-4684-a1ad-2b878d2b10bf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_statement_stats\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"log_statement_stats\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_statement_stats=off </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The \"log_min_error_statement\" flag defines the minimum message severity level that are considered as an error statement.<br> Messages for error statements are logged with the SQL statement.<br> Valid values include \"DEBUG5\", \"DEBUG4\", \"DEBUG3\", \"DEBUG2\", \"DEBUG1\", \"INFO\", \"NOTICE\", \"WARNING\", \"ERROR\", \"LOG\", \"FATAL\", and \"PANIC\".<br> Each severity level includes the subsequent levels mentioned above.<br> Ensure a value of ERROR or stricter is set.<br> Auditing helps in troubleshooting operational problems and also permits forensic analysis.<br> If \"log_min_error_statement\" is not set to the correct value, messages may not be classified as error messages appropriately.<br> Considering general log messages as error messages would make is difficult to find actual errors and considering only stricter severity levels as error messages may skip actual errors to log their SQL statements.<br> The \"log_min_error_statement\" flag should be set to \"ERROR\" or stricter.<br> This recommendation is applicable to PostgreSQL database instances. ",
    "displayName": "Ensure 'log_min_error_statement' database flag for Cloud SQL PostgreSQL instance is set to 'Error' or stricter",
    "id": "/providers/Microsoft.Security/assessmentMetadata/50a1058e-925b-4998-9d93-5eaa8f7021a3",
    "implementationEffort": null,
    "name": "50a1058e-925b-4998-9d93-5eaa8f7021a3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"log_min_error_statement\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"log_min_error_statement\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags log_min_error_statement=<DEBUG5|DEBUG4|DEBUG3|DEBUG2|DEBUG1|INFO|NOTICE|WARNI NG|ERROR> </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set \"external scripts enabled\" database flag for Cloud SQL SQL Server instance to off.<br> \"external scripts enabled\" enable the execution of scripts with certain remote language extensions.<br> This property is OFF by default.<br> When Advanced Analytics Services is installed, setup can optionally set this property to true.<br> As the \"External Scripts Enabled\" feature allows scripts external to SQL such as files located in an R library to be executed, which could adversely affect the security of the system, hence this should be disabled.<br> This recommendation is applicable to SQL Server database instances.",
    "displayName": "Ensure 'external scripts enabled' database flag for Cloud SQL SQL Server instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/98b8908a-18b9-46ea-8c52-3f8db1da996f",
    "implementationEffort": null,
    "name": "98b8908a-18b9-46ea-8c52-3f8db1da996f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the SQL Server instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"external scripts enabled\" from the drop-down menu and set the value as \"on\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"external scripts enabled\" database flag for every Cloud SQL SQL Server database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags \"external scripts enabled=off\" </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "User Execution"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set \"user connections\" database flag for Cloud SQL SQL Server instance according organization-defined value.<br> The \"user connections\" option specifies the maximum number of simultaneous user connections that are allowed on an instance of SQL Server.<br> The actual number of user connections allowed also depends on the version of SQL Server that you are using, and also the limits of your application or applications and hardware.<br> SQL Server allows a maximum of 32,767 user connections.<br> Because user connections is a dynamic (self-configuring) option, SQL Server adjusts the maximum number of user connections automatically as needed, up to the maximum value allowable.<br> For example, if only 10 users are logged in, 10 user connection objects are allocated.<br> In most cases, you do not have to change the value for this option.<br> The default is 0, which means that the maximum (32,767) user connections are allowed.<br> This recommendation is applicable to SQL Server database instances.",
    "displayName": "Ensure 'user connections' database flag for Cloud SQL SQL Server instance is set as appropriate",
    "id": "/providers/Microsoft.Security/assessmentMetadata/91f55b07-083c-4ec5-a2be-4b52bbc2e2df",
    "implementationEffort": null,
    "name": "91f55b07-083c-4ec5-a2be-4b52bbc2e2df",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the SQL Server instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"user connections\" from the drop-down menu and set the value as organization recommended value. 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"user connections\" database flag for every Cloud SQL SQL Server database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags \"user connections=[0-32,767]\" </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended that, \"user options\" database flag for Cloud SQL SQL Server instance should not be configured.<br> The \"user options\" option specifies global defaults for all users.<br> A list of default query processing options is established for the duration of a user's work session.<br> The user options option allows you to change the default values of the SET options (if the server's default settings are not appropriate).<br> A user can override these defaults by using the SET statement.<br> You can configure user options dynamically for new logins.<br> After you change the setting of user options, new login sessions use the new setting; current login sessions are not affected.<br> This recommendation is applicable to SQL Server database instances.",
    "displayName": "Ensure 'user options' database flag for Cloud SQL SQL Server instance is not configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fab1e680-86f0-4616-bee9-1b7394e49ade",
    "implementationEffort": null,
    "name": "fab1e680-86f0-4616-bee9-1b7394e49ade",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. Click the X next \"user options\" flag shown. 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Clear the user options database flag for every Cloud SQL SQL Server database instance using either of the below commands:     <br> 1.Clearing all flags to their default value: <br> <code>gcloud sql instances patch [INSTANCE_NAME] --clear-database-flags</code> <br> OR <br> 2. To clear only \"user options\" database flag, configure the database flag by overriding the \"user options\". Exclude \"user options\" flag and its value, and keep all other flags you want to configure:<br> <code>gcloud sql instances patch [INSTANCE_NAME] --database-flags [FLAG1=VALUE1,FLAG2=VALUE2]</code> <br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set \"remote access\" database flag for Cloud SQL SQL Server instance to \"off\".<br> The \"remote access\" option controls the execution of stored procedures from local or remote servers on which instances of SQL Server are running.<br> This default value for this option is 1.<br> This grants permission to run local stored procedures from remote servers or remote stored procedures from the local server.<br> To prevent local stored procedures from being run from a remote server or remote stored procedures from being run on the local server, this must be disabled.<br> The Remote Access option controls the execution of local stored procedures on remote servers or remote stored procedures on local server.<br> 'Remote access' functionality can be abused to launch a Denial-of-Service (DoS) attack on remote servers by off-loading query processing to a target, hence this should be disabled.<br> This recommendation is applicable to SQL Server database instances.",
    "displayName": "Ensure 'remote access' database flag for Cloud SQL SQL Server instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dddbbe7d-7e32-47d8-b319-39cbb70b8f88",
    "implementationEffort": null,
    "name": "dddbbe7d-7e32-47d8-b319-39cbb70b8f88",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"remote access\" from the drop-down menu and set the value as \"off\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"remote access\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags \"remote access=off\" </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "High",
    "tactics": [
      "Lateral Movement"
    ],
    "techniques": [
      "Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to set \"3625 (trace flag)\" database flag for Cloud SQL SQL Server instance to \"off\".<br> Trace flags are frequently used to diagnose performance issues or to debug stored procedures or complex computer systems, but they may also be recommended by Microsoft Support to address behavior that is negatively impacting a specific workload.<br> All documented trace flags and those recommended by Microsoft Support are fully supported in a production environment when used as directed.<br> \"3625(trace log)\" Limits the amount of information returned to users who are not members of the sysadmin fixed server role, by masking the parameters of some error messages using '******'.<br> This can help prevent disclosure of sensitive information, hence this is recommended to disable this flag.<br> This recommendation is applicable to SQL Server database instances.",
    "displayName": "Ensure '3625 (trace flag)' database flag for Cloud SQL SQL Server instance is set to 'off'",
    "id": "/providers/Microsoft.Security/assessmentMetadata/631246fb-7192-4709-a0b3-b83e65e6b550",
    "implementationEffort": null,
    "name": "631246fb-7192-4709-a0b3-b83e65e6b550",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br> 1. Go to the Cloud SQL Instances page in the Google Cloud Console by visiting: <a target=\"_blank\" href=\"https://console.cloud.google.com/sql/instances\">Cloud SQL Instances</a>. 2. Select the PostgreSQL instance where the database flag needs to be enabled. 3. Click \"Edit\". 4. Scroll down to the \"Flags\" section. 5. To set a flag that has not been set on the instance before, click \"Add item\", choose the flag \"3625\" from the drop-down menu and set the value as \"off\". 6. Click \"Save\". 7. Confirm the changes under \"Flags\" on the Overview page.<br><br> <b> From Command Line: </b> <br> 1. List all Cloud SQL database instances using the following command: <br><code> gcloud sql instances list </code><br> 2. Configure the \"3625\" database flag for every Cloud SQL PosgreSQL database instance using the below command: <br> <code> gcloud sql instances patch INSTANCE_NAME --database-flags \"3625=off\" </code><br><br> Note: <br> This command will overwrite all database flags previously set. <br> To keep those and add new ones, include the values for all flags to be set on the instance; any flag not specifically included is set to its default value. <br> For flags that do not take a value, specify the flag name followed by an equals sign (\"=\").",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "System Information Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Secure Sockets Layer (SSL) policies determine what port Transport Layer Security (TLS) features clients are permitted to use when connecting to load balancers.<br>To prevent usage of insecure features, SSL policies should use (a) at least TLS 1.2 with the MODERN profile; <br> or (b) the RESTRICTED profile, because it effectively requires clients to use TLS 1.2 regardless of the chosen minimum TLS version; <br> or (3) a CUSTOM profile that does not support any of the following features:<br>TLS_RSA_WITH_AES_128_GCM_SHA256<br>TLS_RSA_WITH_AES_256_GCM_SHA384<br>TLS_RSA_WITH_AES_128_CBC_SHA<br>TLS_RSA_WITH_AES_256_CBC_SHA<br>TLS_RSA_WITH_3DES_EDE_CBC_SHA<br><br>Load balancers are used to efficiently distribute traffic across multiple servers.<br> Both SSL proxy and HTTPS load balancers are external load balancers, meaning they distribute traffic from the Internet to a GCP network.<br> GCP customers can configure load balancer SSL policies with a minimum TLS version (1.0, 1.1, or 1.2) that clients can use to establish a connection, along with a profile (Compatible, Modern, Restricted, or Custom) that specifies permissible cipher suites.<br> To comply with users using outdated protocols, GCP load balancers can be configured to permit insecure cipher suites.<br> In fact, the GCP default SSL policy uses a minimum TLS version of 1.0 and a Compatible profile, which allows the widest range of insecure cipher suites.<br> As a result, it is easy for customers to configure a load balancer without even knowing that they are permitting outdated cipher suites.",
    "displayName": "Ensure no HTTPS or SSL proxy load balancers permit SSL policies with weak cipher suites",
    "id": "/providers/Microsoft.Security/assessmentMetadata/58c07fca-9c6e-46fa-84a7-642f224a1d18",
    "implementationEffort": null,
    "name": "58c07fca-9c6e-46fa-84a7-642f224a1d18",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br />1. If the \"TargetSSLProxy\" or \"TargetHttpsProxy\" does not have an SSL policy configured, create a new \"SSL policy\". Otherwise, modify the existing insecure policy. 2. Navigate to the \"SSL Policies\" page by visiting: <a href='https://console.cloud.google.com/net-security/sslpolicies'>https://console.cloud.google.com/net-security/sslpolicies</a>. 3. Click on the name of the \"insecure policy\" to go to its \"SSL policy\" details page. 4. Click \"EDIT\". 5. Set \"Minimum TLS version\" to \"TLS 1.2\". 6. Set \"Profile\" to \"Modern\" or \"Restricted\". 7. Alternatively, if teh user selects the profile \"Custom\", make sure that the following features are disabled:<br />TLS_RSA_WITH_AES_128_GCM_SHA256<br />TLS_RSA_WITH_AES_256_GCM_SHA384<br />TLS_RSA_WITH_AES_128_CBC_SHA<br />TLS_RSA_WITH_AES_256_CBC_SHA<br />TLS_RSA_WITH_3DES_EDE_CBC_SHA<br /> <br /> <b> From Command Line: </b> <br /> For each insecure SSL policy, update it to use secure cyphers:<br /><code> gcloud compute ssl-policies update NAME [--profile COMPATIBLE|MODERN|RESTRICTED|CUSTOM] --min-tls-version 1.2 [--custom-features FEATURES] </code><br />If the target proxy has a GCP default SSL policy, use the following command corresponding to the proxy type to update it:<br /><code> gcloud compute target-ssl-proxies update TARGET_SSL_PROXY_NAME --ssl-policy SSL_POLICY_NAME</code><br /><code>gcloud compute target-https-proxies update TARGET_HTTPS_POLICY_NAME --ssl-policy SSL_POLICY_NAME</code>",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Weaken Encryption"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Customer-Supplied Encryption Keys (CSEK) are a feature in Google Cloud Storage and Google Compute Engine.<br> If you supply your own encryption keys, Google uses your key to protect the Google-generated keys used to encrypt and decrypt your data.<br> By default, Google Compute Engine encrypts all data at rest.<br> Compute Engine handles and manages this encryption for you without any additional actions on your part.<br> However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys.<br>By default, Google Compute Engine encrypts all data at rest. Compute Engine handles and manages this encryption for you without any additional actions on your part. <br>However, if you wanted to control and manage this encryption yourself, you can provide your own encryption keys.<br>If you provide your own encryption keys, Compute Engine uses your key to protect the Google-generated keys used to encrypt and decrypt your data. <br>Only users who can provide the correct key can use resources protected by a customer-supplied encryption key.<br>Google does not store your keys on its servers and cannot access your protected data unless you provide the key. <br>This also means that if you forget or lose your key, there is no way for Google to recover the key or to recover any data encrypted with the lost key.<br>At least business critical VMs should have VM disks encrypted with CSEK.",
    "displayName": "Ensure VM disks for critical VMs are encrypted with Customer-Supplied Encryption Key",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6ca40f30-2508-4c90-85b6-36564b909364",
    "implementationEffort": null,
    "name": "6ca40f30-2508-4c90-85b6-36564b909364",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console: </b> <br />1. Go to Compute Engine \"Disks\" by visiting: <a href='https://console.cloud.google.com/compute/disks'>https://console.cloud.google.com/compute/disks</a>. 2. Click \"CREATE DISK\". 3. Set \"Encryption\" type to \"Customer supplied\". 4. Provide the \"Key\" in the box. 5. Select \"Wrapped key\". 6. Click \"Create\".<br /> <br /> <b> From Command Line: </b> <br /> In the gcloud compute tool, encrypt a disk using the --csek-key-file flag during instance creation. If you are using an RSA-wrapped key, use the gcloud beta component:<br /><code> gcloud (beta) compute instances create INSTANCE_NAME --csek-key-file example-file.json </code><br />To encrypt a standalone persistent disk:<br /><code> gcloud (beta) compute disks create DISK_NAME --csek-key-file example-file.json </code>",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Collection",
      "Impact"
    ],
    "techniques": [
      "Unsecured Credentials",
      "Data from Local System",
      "Data Encrypted for Impact"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Cloud DNS logging records the queries from the name servers within your VPC to Stackdriver.<br> Logged queries can come from Compute Engine VMs, GKE containers, or other GCP resources provisioned within the VPC.<br>Security monitoring and forensics cannot depend solely on IP addresses from VPC flow logs, especially when considering the dynamic IP usage of cloud resources, HTTP virtual host routing, <br>and other technology that can obscure the DNS name used by a client from the IP address. <br>Monitoring of Cloud DNS logs provides visibility to DNS names requested by the clients within the VPC. <br>These logs can be monitored for anomalous domain names, evaluated against threat intelligence, and<br>Note: For full capture of DNS, firewall must block egress UDP/53 (DNS) <br>and TCP/443 (DNS over HTTPS) to prevent client from using external DNS name server for resolution.",
    "displayName": "Ensure that Cloud DNS logging is enabled for all VPC networks",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c10bad5f-cd86-4ea0-a40c-5d31510da525",
    "implementationEffort": null,
    "name": "c10bad5f-cd86-4ea0-a40c-5d31510da525",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From Command Line: </b> <br />Add New DNS Policy With Logging Enabled<br />For each VPC network that needs a DNS policy with logging enabled:<br /><code> gcloud dns policies create enable-dns-logging --enable-logging --description='Enable DNS Logging' --networks=VPC_NETWORK_NAME </code>The VPC_NETWORK_NAME can be one or more networks in comma-separated list<br />Enable Logging for Existing DNS Policy For each VPC network that has an existing DNS policy that needs logging enabled:<br /><code> gcloud dns policies update POLICY_NAME --enable-logging --networks=VPC_NETWORK_NAME </code><br />The VPC_NETWORK_NAME can be one or more networks in comma-separated list",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Access to VMs should be restricted by firewall rules that allow only IAP traffic by ensuring only connections proxied by the IAP are allowed. <br>To ensure that load balancing works correctly health checks should also be allowed.<br>IAP ensure that access to VMs is controlled by authenticating incoming requests.<br> However if the VM is still accessible from IP addresses other than the IAP it may still be possible to send unauthenticated requests to the instance.<br> Care must be taken to ensure that loadblancer health checks are not blocked as this would stop the loadbalancer from correctly knowing the health of the VM and loadbalancing correctly.",
    "displayName": "Ensure Firewall Rules for instances behind Identity Aware Proxy (IAP) only allow the traffic from Google Cloud Loadbalancer (GCLB) Health Check and Proxy Addresses",
    "id": "/providers/Microsoft.Security/assessmentMetadata/814c3346-91c9-4e70-90b6-985cfd3e0478",
    "implementationEffort": null,
    "name": "814c3346-91c9-4e70-90b6-985cfd3e0478",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console:</b> 1. Go to the Cloud Console <a href='https://console.cloud.google.com/networking/firewalls/list?_ga=2.72166934.480049361.1580860862-1336643914.1580248695'>VPC network > Firewall rules</a>. 2. Select the \"checkbox\" next to the following rules:<br>default-allow-http<br>default-allow-https<br>default-allow-internal. 3. Click \"Delete\". 4. Click \"Create\" firewall rule and set the following values:<br>\"Name:\" allow-iap-traffic <br>\"Targets:\" All instances in the network<br>  \"Source IP ranges\" (press Enter after you paste each value in the box):<br>130.211.0.0/22<br>35.191.0.0/16<br>\"Protocols and ports:\"<br>Specified protocols and ports<br>tcp:80 5. When you're finished updating values, click \"Create\".",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery",
      "Endpoint Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Google Cloud encrypts data at-rest and in-transit, but customer data must be decrypted for processing. Confidential Computing is a breakthrough technology which encrypts data in-use-while it is being processed.<br> Confidential Computing environments keep data encrypted in memory and elsewhere outside the central processing unit (CPU). <br>Confidential VMs leverage the Secure Encrypted Virtualization (SEV) feature of AMD EPYC CPUs.<br> Customer data will stay encrypted while it is used, indexed, queried, or trained on.<br> Encryption keys are generated in hardware, per VM, and not exportable. Thanks to built-in hardware optimizations of both performance and security, there is no significant performance penalty to Confidential Computing workloads.<br>Confidential Computing enables customers' sensitive code and other data encrypted in memory during processing. Google does not have access to the encryption keys. <br>Confidential VM can help alleviate concerns about risk related to either dependency on Google infrastructure or Google insiders' access to customer data in the clear.",
    "displayName": "Ensure that Compute instances have Confidential Computing enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/171e9492-73a7-43de-adce-6bd0a3cf6045",
    "implementationEffort": null,
    "name": "171e9492-73a7-43de-adce-6bd0a3cf6045",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "<b> From the Console:</b> 1. Go to the VM instances page by visiting: <a href='https://console.cloud.google.com/compute/instances'>https://console.cloud.google.com/compute/instances</a>. 2. Click \"DCREATE INSTANCE\". 3. Fill out the desired \"configuration\" for your instance. 4. Under the \"Confidential VM service\" section, check the option \"Enable the Confidential Computing service on this VM instance\". 5. Click \"Create\".<br /><br /> <b>From Command Line: </b> <br />Create a new instance with Confidential Compute enabled.<br /><code>gcloud beta compute instances create INSTANCE_NAME --zone ZONE --confidential-compute --maintenance-policy=TERMINATE </code>",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. <br> The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys.<br> This is seamless and do not require any additional input from the user.<br> However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets.<br> If CMEK is used, the CMEK is used to encrypt the data encryption keys instead of using google-managed encryption keys.<br>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys. <br>This is seamless and does not require any additional input from the user.<br>For greater control over the encryption, customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery tables. <br>The CMEK is used to encrypt the data encryption keys instead of using google-managed encryption keys.<br> BigQuery stores the table and CMEK association and the encryption/decryption is done automatically.<br>Applying the Default Customer-managed keys on BigQuery data sets ensures that all the new tables created in the future will be encrypted using CMEK but existing tables need to be updated to use CMEK individually. <br>Note: Google does not store your keys on its servers and cannot access your protected data unless you provide the key.<br> This also means that if you forget or lose your key, there is no way for Google to recover the key or to recover any data encrypted with the lost key.",
    "displayName": "Ensure that all BigQuery Tables are encrypted with Customer-managed encryption key (CMEK)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f4cfc689-cac8-4f45-8355-652dcda3ec55",
    "implementationEffort": null,
    "name": "f4cfc689-cac8-4f45-8355-652dcda3ec55",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "Currently, there is no way to update the encryption of existing data in the table.<br />The data needs to be copied to either an original table or another table while specifying the customer managed encryption key (CMEK).<br /><b> From Command Line: </b> <br />Use the following command to copy the data. The source and the destination needs to be same in case copying to the original table.<br /><code> bq cp --destination_kms_key 'customer_managed_key' source_dataset.source_table destination_dataset.destination_table </code>",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys.<br> The data is encrypted using the data encryption keys and data encryption keys themselves are further encrypted using key encryption keys. <br>This is seamless and do not require any additional input from the user. <br>However, if you want to have greater control, Customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets.<br>BigQuery by default encrypts the data as rest by employing Envelope Encryption using Google managed cryptographic keys.<br> This is seamless and does not require any additional input from the user.<br>For greater control over the encryption, customer-managed encryption keys (CMEK) can be used as encryption key management solution for BigQuery Data Sets.<br> Setting a Default Customer-managed encryption key (CMEK) for a data set ensure any tables created in future will use the specified CMEK if none other is provided.<br>Note: Google does not store your keys on its servers and cannot access your protected data unless you provide the key. <br>This also means that if you forget or lose your key, there is no way for Google to recover the key or to recover any data encrypted with the lost key.",
    "displayName": "Ensure that a Default Customer-managed encryption key (CMEK) is specified for all BigQuery Data Sets",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f024ea22-7e48-4b3b-a824-d61794c14bb4",
    "implementationEffort": null,
    "name": "f024ea22-7e48-4b3b-a824-d61794c14bb4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2022"
    },
    "remediationDescription": "The default CMEK for existing data sets can be updated by specifying the default key in the EncryptionConfiguration.kmsKeyName field when calling the datasets.insert or datasets.patch methods",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Microsoft Defender's <a href=\"https://docs.microsoft.com/azure/azure-arc/kubernetes/extensions\">cluster extension</a> provides security capabilities for your GKE clusters. The extension collects data from a cluster and its nodes to identify security vulnerabilities and threats. <br> The extension works with <a href=\"https://docs.microsoft.com/azure/azure-arc/kubernetes/overview\">Azure Arc-enabled Kubernetes</a>. <br>Learn more about <a href=\"https://docs.microsoft.com/en-us/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks\">Microsoft Defender for Cloud's security features for containerized environments</a>.",
    "displayName": "GKE clusters should have Microsoft Defender's extension for Azure Arc installed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0faf27b6-f1d5-4f50-b22a-5d129cba0113",
    "implementationEffort": null,
    "name": "0faf27b6-f1d5-4f50-b22a-5d129cba0113",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "02/15/2022"
    },
    "remediationDescription": "<ol><li> Go to Microsoft Defender for Cloud <a href=\"https://ms.portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/EnvironmentSettings\">Environment settings</a>. <br></li> <li> Select the GCP environment which represents the cluster. <br> </li> <li> Enable <b>Auto provision Defender's sensor for Azure Arc</b> toggle in the <b>Containers</b> plan settings <br> </li> <li> Follow the onboarding steps to grant the necessary permissions for provisioning the defender sensor on the GKE cluster. </li> </ol> Note: When the process completes, it may take up to 6 hours until your resource moves to the 'healthy resources' tab.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Azure Policy extension for Kubernetes extends <a target=\"_blank\" href=\"https://github.com/open-policy-agent/gatekeeper\">Gatekeeper</a> v3, an admission controller webhook for <a target=\"_blank\" href=\"https://www.openpolicyagent.org/\">Open Policy Agent</a> (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner. <br> The extension works with <a href=\"https://docs.microsoft.com/azure/azure-arc/kubernetes/overview\">Azure Arc-enabled Kubernetes</a>.",
    "displayName": "GKE clusters should have the Azure Policy extension installed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6273e20b-8814-4fda-a297-42a70b16fcbf",
    "implementationEffort": null,
    "name": "6273e20b-8814-4fda-a297-42a70b16fcbf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "02/15/2022"
    },
    "remediationDescription": "<ol><li> Go to Microsoft Defender for Cloud <a href=\"https://ms.portal.azure.com/#view/Microsoft_Azure_Security/SecurityMenuBlade/~/EnvironmentSettings\">Environment settings</a>. <br></li> <li> Select the GCP environment which represents the cluster. <br> </li> <li> Enable <b>Auto provision Azure Policy extension for Azure Arc</b> toggle in the <b>Containers</b> plan settings <br> </li> <li> Follow the onboarding steps to grant the necessary permissions for provisioning the Azure policy extension on the GKE cluster. </li> </ol> Note: When the process completes, it may take up to 6 hours until your resource moves to the 'healthy resources' tab.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Connect your GCP Virtual Machines to Azure Arc in order to have full visibility to Microsoft Defender for Servers security content. Learn more about <a href='https://docs.microsoft.com/azure/azure-arc/'>Azure Arc</a>, and about <a href='https://docs.microsoft.com/azure/security-center/defender-for-servers-introduction'>Microsoft Defender for Servers</a> on hybrid-cloud environment.",
    "displayName": "GCP VM instances should be connected to Azure Arc",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9bbe2f0f-d6c6-48e8-b4d0-cf25d2c50206",
    "implementationEffort": null,
    "name": "9bbe2f0f-d6c6-48e8-b4d0-cf25d2c50206",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2021"
    },
    "remediationDescription": "1. From the Azure portal, open \"Servers - Azure Arc\". 2. From the top left corner, select \"Add\". 3. From \"Add a single server\", select \"Generate script\". 4. In the \"Resource details\" page, select the subscription and resource group to which you have connected the machine's GCP Project. 5. Select \"Next\" and follow the instructions.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To receive the full Defender for Servers capabilities using Azure Arc auto-provisioning, GCP VMs should have OS config agent enabled",
    "displayName": "GCP VM instances should have OS config agent installed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/20622d8c-2a4f-4a03-9896-a5f2f7ede717",
    "implementationEffort": null,
    "name": "20622d8c-2a4f-4a03-9896-a5f2f7ede717",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2021"
    },
    "remediationDescription": "Follow the steps described in GCP documentation to install the OS config agent. <a href='https://cloud.google.com/compute/docs/manage-os#agent-install'>Learn more</a>",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "For full visibility of the security content from Microsoft Defender for servers, GCP VM instances should be connected to Azure Arc. To ensure that all eligible VM instances automatically receive Azure Arc, enable auto-provisioning from Defender for Cloud at the GCP project level. Learn more about <a href='https://docs.microsoft.com/azure/azure-arc/servers/overview'>Azure Arc</a>, and <a href='https://docs.microsoft.com/azure/security-center/defender-for-servers-introduction'>Microsoft Defender for Servers</a>.",
    "displayName": "GCP projects should have Azure Arc auto provisioning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1716d754-8d50-4b90-87b6-0404cad9b4e3",
    "implementationEffort": null,
    "name": "1716d754-8d50-4b90-87b6-0404cad9b4e3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "01/19/2021"
    },
    "remediationDescription": "1. From the Defender for Cloud, open \"Environment settings\". 2. For the relevant GCP project, select the three dots at the end of the row, and select \"Edit settings\". 3. For the \"Servers\" plan, select \"View configuration\". 4. Enable auto-provisioning for the Azure Arc agent and click on the \"Save\" button. 5. Select \"Next\" and follow the instructions.<br>Note: To enable auto-provisioning, you'll need owner permissions for the relevant subscription.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to use standard authentication flow instead. <br><br> Security risks involved in using API-Keys appear below:<br> 1. API keys are simple encrypted strings<br> 2. API keys do not identify the user or the application making the API request<br> 3. API keys are typically accessible to clients, making it easy to discover and steal an API key <br><br> To avoid the security risk in using API keys, it is recommended to use standard authentication flow instead.",
    "displayName": "Ensure API keys are not created for a project",
    "id": "/providers/Microsoft.Security/assessmentMetadata/29ed3416-2035-4d44-986e-0bcbb7de172e",
    "implementationEffort": null,
    "name": "29ed3416-2035-4d44-986e-0bcbb7de172e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "02/15/2022"
    },
    "remediationDescription": "<b> From the Console:</b> <br> 1. Go to \"APIs & Services - Credentials\" using <a href='https://console.cloud.google.com/apis/credentials'>https://console.cloud.google.com/apis/credentials</a>. 2. In the section \"API Keys\", to delete API Keys: Click the \"Delete Bin Icon\" in front of every \"API Key Name\".",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Unrestricted keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to restrict API key usage to trusted hosts, HTTP referrers and apps. <br><br> Security risks involved in using API-Keys appear below:<br> 1. API keys are simple encrypted strings<br> 2. API keys do not identify the user or the application making the API request<br> 3. API keys are typically accessible to clients, making it easy to discover and steal an API key <br><br>In light of these potential risks, Google recommends using the standard authentication flow instead of API keys. However, there are limited cases where API keys are more appropriat. <br>For example, if there is a mobile application that needs to use the Google Cloud Translation API, but doesn't otherwise need a backend server, API keys are the simplest way to authenticate to that API.<br><br> In order to reduce attack vectors, API-Keys can be restricted only to trusted hosts, HTTP referrers and applications.",
    "displayName": "Ensure API keys are restricted to use by only specified Hosts and Apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/63e0e2db-70c3-4edc-becf-93961d3156ed",
    "implementationEffort": null,
    "name": "63e0e2db-70c3-4edc-becf-93961d3156ed",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "02/15/2022"
    },
    "remediationDescription": "<b> From the Console:</b> <br> 1. Go to \"APIs & Services - Credentials\" using <a href='https://console.cloud.google.com/apis/credentials'>https://console.cloud.google.com/apis/credentials</a>. 2. In the section \"API Keys\", Click the \"API Key Name\". The API Key properties display on a new page. 3. In the \"Key restrictions\" section, set the application restrictions to any of \"HTTP referrers\", \"IP Adresses\", \"Android Apps\", \"iOs Apps\". 4. Click \"Save\". 5. Repeat steps 2,3,4 for every unrestricted API key.<br><br> \"Note\": Do not set \"HTTP referrers\" to wild-cards (* or *.[TLD] or .[TLD]/) allowing access to any/wide HTTP referrer(s). <br> Do not set \"IP addresses\" and referrer to any host \"(0.0.0.0 or 0.0.0.0/0 or ::0)\"",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Steal Application Access Token"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "API keys are insecure because they can be viewed publicly, such as from within a browser, or they can be accessed on a device where the key resides. It is recommended to restrict API keys to use (call) only APIs required by an application. <br><br> Security risks involved in using API-Keys are below:<br> 1. API keys are simple encrypted strings<br> 2. API keys do not identify the user or the application making the API request<br> 3. API keys are typically accessible to clients, making it easy to discover and steal an API key <br><br>In light of these potential risks, Google recommends using the standard authentication flow instead of API-Keys. However, there are limited cases where API keys are more appropriate. For example, if there is a mobile application that needs to use the Google Cloud Translation API, but doesn't otherwise need a backend server, API keys are the simplest way to authenticate to that API.<br><br> In order to reduce attack surfaces by providing least privileges, API-Keys can be restricted to use (call) only APIs required by an application.",
    "displayName": "Ensure API keys are restricted to only APIs that application needs access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/54d3b0ae-67b3-4fee-9ac4-f6c784b9d16b",
    "implementationEffort": null,
    "name": "54d3b0ae-67b3-4fee-9ac4-f6c784b9d16b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "02/15/2022"
    },
    "remediationDescription": "<b> From the Console:</b> <br> 1. Go to \"APIs & Services - Credentials\" using <a href='https://console.cloud.google.com/apis/credentials'>https://console.cloud.google.com/apis/credentials</a>. 2. In the section \"API Keys\", Click the \"API Key Name\". The API Key properties display on a new page. 3. In the \"Key restrictions\" section go to \"API restrictions\". 4. Click the \"Select API\" drop-down to choose an API. 5. Click \"Save\". 6. Repeat steps 2,3,4,5 for every unrestricted API key. <br><br> \"Note\": Do not set API restrictions to Google Cloud APIs, as this option allows access to all services offered by Google cloud.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Steal Application Access Token"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It is recommended to rotate API keys every 90 days. <br><br> Security risks involved in using API-Keys are listed below:<br> 1. API keys are simple encrypted strings<br> 2. API keys do not identify the user or the application making the API request<br> 3. API keys are typically accessible to clients, making it easy to discover and steal an API key <br><br>Because of these potential risks, Google recommends using the standard authentication flow instead of API Keys. However, there are limited cases where API keys are more appropriate. For example, if there is a mobile application that needs to use the Google Cloud Translation API, but doesn't otherwise need a backend server, API keys are the simplest way to authenticate to that API.<br><br> Once a key is stolen, it has no expiration, meaning it may be used indefinitely unless the project owner revokes or regenerates the key. Rotating API keys will reduce the window of opportunity for an access key that is associated with a compromised or terminated account to be used.<br><br> API keys should be rotated to ensure that data cannot be accessed with an old key that might have been lost, cracked, or stolen.",
    "displayName": "Ensure API keys are rotated every 90 days",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fbc1ef5d-989e-4b64-8e9d-221b422f9c43",
    "implementationEffort": null,
    "name": "fbc1ef5d-989e-4b64-8e9d-221b422f9c43",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "02/15/2022"
    },
    "remediationDescription": "<b> From the Console:</b> <br> 1. Go to \"APIs & Services - Credentials\" using <a href='https://console.cloud.google.com/apis/credentials'>https://console.cloud.google.com/apis/credentials</a>. 2. In the section \"API Keys\", Click the \"API Key Name\". The API Key properties display on a new page. 3. Click \"REGENERATE KEY\" to rotate API key. 4. Click \"Save\". 5. Repeat steps 2,3,4 for every API key that has not been rotated in the last 90 days.<br><br> \"Note\": Do not set \"HTTP referrers\" to wild-cards (* or *.[TLD] or .[TLD]/) allowing access to any/wide HTTP referrer(s). <br> Do not set \"IP addresses\" and referrer to \"any host (0.0.0.0 or 0.0.0.0/0 or ::0)\".",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Microsoft Defender for Cloud discovered an identity that has not performed any action on any resource within your GCP project in the last 90 days. It is recommended to revoke permissions of inactive identities, in order to reduce the attack surface of your cloud environment.",
    "displayName": "Permissions of inactive identities in your GCP project should be revoked",
    "id": "/providers/Microsoft.Security/assessmentMetadata/257e9506-fd47-4123-a8ef-92017f845906",
    "implementationEffort": null,
    "name": "257e9506-fd47-4123-a8ef-92017f845906",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "05/24/2024",
      "public": "11/01/2023"
    },
    "remediationDescription": "To remediate inactive identities, follow the below steps:<br><br>1. Login to <a href=\"https://console.cloud.google.com/welcome/new\">Google Cloud Console</a><br>2. Navigate to 'IAM & Admin > IAM'. This will bring you to the IAM page where you can see all the identities and their assigned roles.<br>3. Click the pencil icon next to the relevant identity.<br>4. In the edit dialog, you will see a list of roles assigned to the identity. Click the trash can icon next to the roles you identified as unused or unnecessary to remove them.<br>5. Click 'Save' to apply the changes.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Overprovisioned identities in Google Cloud Platform (GCP) are those that have more access privileges than they need or use.<br> This can increase the risk in case of a compromise of a user, key, or resource.<br> The principle of least privilege dictates that a resource should only have access to the exact resources it needs to function.<br> This minimizes the potential damage if an identity is compromised, as the attacker would have limited access.<br> To mitigate this risk and ensure that identities have only the permissions necessary for their function, remove unnecessary permissions and establish review processes..<br>",
    "displayName": "GCP overprovisioned identities should have only the necessary permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8353c257-30be-4048-8ac3-b8f26d89d2ea",
    "implementationEffort": "Moderate",
    "name": "8353c257-30be-4048-8ac3-b8f26d89d2ea",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "05/24/2024",
      "public": "05/01/2024"
    },
    "remediationDescription": "To modify/remove permissions to an identity in GCP Environment <br>1. Login to the <a href=\"https://console.cloud.google.com/welcome/new?pli=1\">Google Cloud console</a><br>2. Navigate to IAM & Admin > Navigate to Roles by choosing the project affected identity<br>3. Click on the Role to check the assigned permissions<br>4. Evaluate the Members and roles of the affected identity and remove the unused permissions by clicking on \"Edit principal\" and disable option <br>5. If you want to further evaluate which permissions the identity needs, use <a href=\"https://cloud.google.com/blog/products/identity-security/achieve-least-privilege-with-less-effort-using-iam-recommender\">IAM recommender</a> that helps security professionals remove over-provisioned access to the identities. It helps identify and remove unwanted access to GCP resources using machine learning to make smart access control recommendations<br>Follow the instructions in the <a href=\"https://cloud.google.com/iam/docs/granting-changing-revoking-access\">Granting, changing, and revoking access to resources</a> guide to edit the access with the identity.<br>Recommend using <a href=\"https://cloud.google.com/iam/docs/roles-overview#custom\">custom roles</a> that will help you enforce the privilege of least privilege.<br> To ensure safe deployments by granting only necessary access to cloud run resources check out <a href=\"https://cloud.google.com/blog/products/identity-security/securing-cloud-run-deployments-with-least-privilege-access\">this article</a> <br>Check this out to learn about <a href=\"https://cloud.google.com/iam/docs/understanding-roles?_ga=2.4884083.1161513113.1698509435-1002969425.1697953842\">IAM roles (basic and predefined)</a>.<br><br><u>Automated Remediation:</u><br>Microsoft Entra Permissions Management can provide the activity based custom role to implement.<br> Permissions Management can help analyze the risk of over-provisioned active identities by calculating the permissions creep index indicating the high-risk permissions assignment.<br> To learn more about how to implement automated remediation, go to <a href=\"https://aka.ms/EntraPermissionsManagementWow\">Microsoft Entra permissions Management</a>.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Microsoft Defender for Cloud discovered an identity that has not performed any action on any resource within your GCP project in the last 90 days. It is recommended to revoke permissions of inactive identities, in order to reduce the attack surface of your cloud environment.",
    "displayName": "(Do not use) Permissions of inactive identities in your GCP project should be revoked",
    "id": "/providers/Microsoft.Security/assessmentMetadata/12ff4f46-3d40-4d53-9f36-dd7f186e9c0f",
    "implementationEffort": null,
    "name": "12ff4f46-3d40-4d53-9f36-dd7f186e9c0f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "07/15/2025",
      "public": "07/15/2025"
    },
    "remediationDescription": "To remediate inactive identities, follow the below steps:<br><br>1. Login to <a href=\"https://console.cloud.google.com/welcome/new\">Google Cloud Console</a><br>2. Navigate to 'IAM & Admin > IAM'. This will bring you to the IAM page where you can see all the identities and their assigned roles.<br>3. Click the pencil icon next to the relevant identity.<br>4. In the edit dialog, you will see a list of roles assigned to the identity. Click the trash can icon next to the roles you identified as unused or unnecessary to remove them.<br>5. Click 'Save' to apply the changes.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Overprovisioned identities in Google Cloud Platform (GCP) are those that have more access privileges than they need or use.<br> This can increase the risk in case of a compromise of a user, key, or resource.<br> The principle of least privilege dictates that a resource should only have access to the exact resources it needs to function.<br> This minimizes the potential damage if an identity is compromised, as the attacker would have limited access.<br> To mitigate this risk and ensure that identities have only the permissions necessary for their function, remove unnecessary permissions and establish review processes..<br>",
    "displayName": "(Do not use) GCP overprovisioned identities should have only the necessary permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/38a89c9a-e427-4b7a-a8c5-6c232fa4c110",
    "implementationEffort": "Moderate",
    "name": "38a89c9a-e427-4b7a-a8c5-6c232fa4c110",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "07/15/2025",
      "public": "07/15/2025"
    },
    "remediationDescription": "To modify/remove permissions to an identity in GCP Environment <br>1. Login to the <a href=\"https://console.cloud.google.com/welcome/new?pli=1\">Google Cloud console</a><br>2. Navigate to IAM & Admin > Navigate to Roles by choosing the project affected identity<br>3. Click on the Role to check the assigned permissions<br>4. Evaluate the Members and roles of the affected identity and remove the unused permissions by clicking on \"Edit principal\" and disable option <br>5. If you want to further evaluate which permissions the identity needs, use <a href=\"https://cloud.google.com/blog/products/identity-security/achieve-least-privilege-with-less-effort-using-iam-recommender\">IAM recommender</a> that helps security professionals remove over-provisioned access to the identities. It helps identify and remove unwanted access to GCP resources using machine learning to make smart access control recommendations<br>Follow the instructions in the <a href=\"https://cloud.google.com/iam/docs/granting-changing-revoking-access\">Granting, changing, and revoking access to resources</a> guide to edit the access with the identity.<br>Recommend using <a href=\"https://cloud.google.com/iam/docs/roles-overview#custom\">custom roles</a> that will help you enforce the privilege of least privilege.<br> To ensure safe deployments by granting only necessary access to cloud run resources check out <a href=\"https://cloud.google.com/blog/products/identity-security/securing-cloud-run-deployments-with-least-privilege-access\">this article</a> <br>Check this out to learn about <a href=\"https://cloud.google.com/iam/docs/understanding-roles?_ga=2.4884083.1161513113.1698509435-1002969425.1697953842\">IAM roles (basic and predefined)</a>.<br><br><u>Automated Remediation:</u><br>Microsoft Entra Permissions Management can provide the activity based custom role to implement.<br> Permissions Management can help analyze the risk of over-provisioned active identities by calculating the permissions creep index indicating the high-risk permissions assignment.<br> To learn more about how to implement automated remediation, go to <a href=\"https://aka.ms/EntraPermissionsManagementWow\">Microsoft Entra permissions Management</a>.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "The \"root\" account has unrestricted access to all resources in the AWS account. It is highly recommend that the use of this account be avoided.<br>The \"root\" account is the most privileged AWS account. Minimizing the use of this account and adopting the principle of least privilege for access management will reduce the risk of accidental changes and unintended disclosure of highly privileged credentials.",
    "displayName": "Avoid the use of the \"root\" account",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a47a6c3b-0629-406c-ad09-d91f7d9f78a3",
    "implementationEffort": null,
    "name": "a47a6c3b-0629-406c-ad09-d91f7d9f78a3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Follow the remediation instructions of the \"Ensure IAM policies are attached only to groups or roles\" recommendation",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Multi-Factor Authentication (MFA) adds an extra layer of protection on top of a user name and password.<br> With MFA enabled, when a user signs in to an AWS website, they will be prompted for their user name and password as well as for an authentication code from their AWS MFA device. <br> It is recommended that MFA be enabled for all accounts that have a console password.<br>Enabling MFA provides increased security for console access as it requires the authenticating principal to possess a device that emits a time-sensitive key and have knowledge of a credential.",
    "displayName": "Ensure multi-factor authentication (MFA) is enabled for all IAM users that have a console password",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b73d3c97-01e1-43b4-bf01-a459e5eed3de",
    "implementationEffort": null,
    "name": "b73d3c97-01e1-43b4-bf01-a459e5eed3de",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to enable MFA: 1. Sign in to the AWS Management Console and open the <a target=\"_blank\" href=\"https://console.aws.amazon.com/iam/\">IAM console</a>. 2. In the navigation pane, choose Users. 3. In the User Name list, choose the name of the intended MFA user. 4. Choose the Security Credentials tab, and then choose Manage MFA Device. 5. In the Manage MFA Device wizard, choose A virtual MFA device, and then chooseNext Step. IAM generates and displays configuration information for the virtual MFA device, includinga QR code graphic. The graphic is a representation of the 'secret configuration key' that isavailable for manual entry on devices that do not support QR codes. 6. Open your virtual MFA application. (For a list of apps that you can use for hosting virtual MFA devices, see <a target=\"_blank\" href=\"https://aws.amazon.com/iam/features/mfa/?audit=2019q1#Virtual_MFA_Applications\">Virtual MFA Applications</a>.) If the virtual MFA application support smultiple accounts (multiple virtual MFA devices), choose the option to create a new account (a new virtual MFA device). 7. Determine whether the MFA app supports QR codes, and then do one of the following:<br>* Use the app to scan the QR code. For example, you might choose the camera icon or choose an option similar to Scan code, and then use the device's camera to scan the code.<br>* In the Manage MFA Device wizard, choose Show secret key for manual configuration, and then type the secret configuration key into your MFA application.<br> When you are finished, the virtual MFA device starts generating one-time passwords. 8. In the Manage MFA Device wizard, in the Authentication Code 1 box, type the one-time password that currently appears in the virtual MFA device. Wait up to 30 seconds for the device to generate a new one-time password. Then type the second one-time password into the Authentication Code 2 box. Choose Active Virtual MFA.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. <br> It is recommended that all credentials that have been unused in 90 or greater days be removed or deactivated.<br> Disabling or removing unnecessary credentials will reduce the window of opportunity for credentials associated with a compromised or abandoned account to be used.",
    "displayName": "Ensure credentials unused for 90 days or greater are disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f13dc885-79aa-456b-ba28-3428147ecf55",
    "implementationEffort": null,
    "name": "f13dc885-79aa-456b-ba28-3428147ecf55",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to remove or deactivate credentials: <br> 1. Login to the AWS Management Console: <br> 2. Click \"Services\" <br> 3. Click \"IAM\" <br> 4. Click on \"Users\" <br> 5. Click on \"Security Credentials\" <br> 6. As an Administrator: Click on \"Make Inactive\" for credentials that have not been used in 90 Days <br> 7. As an IAM User: Click on \"Make Inactive\" or \"Delete\" for credentials which have not been used in 90 Days",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Access keys consist of an access key ID and secret access key, which are used to sign programmatic requests that you make to AWS. <br> AWS users need their own access keys to make programmatic calls to AWS from the AWS Command Line Interface (AWS CLI), Tools for Windows PowerShell, the AWS SDKs, or direct HTTP calls using the APIs for individual AWS services. <br> It is recommended that all access keys be regularly rotated. <br> Rotating access keys will reduce the window of opportunity for an access key that is associated with a compromised or terminated account to be used. <br> Access keys should be rotated to ensure that data cannot be accessed with an old key which might have been lost, cracked, or stolen.",
    "displayName": "Ensure access keys are rotated every 90 days or less",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d72f547e-c011-4cdb-9dda-8c4d6dc09bf2",
    "implementationEffort": null,
    "name": "d72f547e-c011-4cdb-9dda-8c4d6dc09bf2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to rotate access keys: <br> 1. Login to the AWS Management Console: <br> 2. Click \"Services\" <br> 3. Click \"IAM\" <br> 4.Click on \"Users\" <br> 5. Click on \"Security Credentials\" <br> 6. As an Administrator: Click on \"Make Inactive\" for keys that have not been rotated in 90 Days <br> 7. As an IAM User: Click on \"MakeInactive\" or \"Delete\" for keys which have not been rotated or used in 90 Days <br> 8. Click on \"Create Access Key\" <br> 9. Update programmatic call with new Access Key credentials<br> Via CLI:<br> <code>aws iam update-access-key <br> aws iam create-access-key <br> aws iam delete-access-key </code>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one uppercase letter. <br> Setting a password complexity policy increases account resiliency against brute force login attempts.",
    "displayName": "Ensure IAM password policy requires at least one uppercase letter",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6e5ebe18-e026-4c26-875c-fcbea8089071",
    "implementationEffort": null,
    "name": "6e5ebe18-e026-4c26-875c-fcbea8089071",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to set the password policy as prescribed: Via AWS Console: <br>1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) <br> 2. Go to IAM Service on the AWS Console <br> 3. Click on \"Account Settings\" on the Left Pane <br> 4. Check \"Requires at least one uppercase letter\" <br>5. Click \"Apply password policy\"<br> Via CLI:<br><code>aws iam update-account-password-policy --require-uppercase-characters</code><br><b> Note: </b> All commands starting with <code>aws iam update-account-password-policy</code> can be combined into a single command.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one lowercase letter. <br>Setting a password complexity policy increases account resiliency against brute force login attempts",
    "displayName": "Ensure IAM password policy requires at least one lowercase letter",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1c420241-9bec-4af8-afb7-038a711b7d22",
    "implementationEffort": null,
    "name": "1c420241-9bec-4af8-afb7-038a711b7d22",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to set the password policy as prescribed: Via the AWS Console <br>1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) <br>2. Go to IAM Service on the AWS Console <br>3. Click on \"Account Settings\" on the Left Pane <br>4. Check \"Requires at least one lowercase letter\" <br>5. Click \"Apply password policy\"<br> Via CLI:<br><code>aws iam update-account-password-policy --require-lowercase-characters</code><br><b> Note: </b> All commands starting with <code>aws iam update-account-password-policy</code> can be combined into a single command.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Password policies are, in part, used to enforce password complexity requirements. <br> IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one symbol.<br> Setting a password complexity policy increases account resiliency against brute force login attempts.",
    "displayName": "Ensure IAM password policy requires at least one symbol",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1919c309-1c8b-4fab-bd8c-7ff77521db40",
    "implementationEffort": null,
    "name": "1919c309-1c8b-4fab-bd8c-7ff77521db40",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to set the password policy as prescribed: Via the AWS Console <br>1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) <br>2. Go to IAM Service on the AWS Console <br>3. Click on \"Account Settings\" on the Left Pane <br>4. Check \"Requires at least one lowercase letter\" <br>5. Click \"Apply password policy\"<br>Via CLI:<br><code>aws iam update-account-password-policy --require-symbols</code><br><b> Note: </b> All commands starting with <code>aws iam update-account-password-policy</code> can be combined into a single command.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are comprised of different character sets. <br> It is recommended that the password policy require at least one number. <br> Setting a password complexity policy increases account resiliency against brute force login attempts.",
    "displayName": "Ensure IAM password policy requires at least one number",
    "id": "/providers/Microsoft.Security/assessmentMetadata/84fb0ae8-4785-449c-b9ac-e106a2509540",
    "implementationEffort": null,
    "name": "84fb0ae8-4785-449c-b9ac-e106a2509540",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to set the password policy as prescribed:<br> Via AWS Console: <br>1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Go to IAM Service on the AWS Console 3. Click on \"Account Settings\" on the Left Pane 4. Check \"Require at least one number\" 5. Click \"Apply password policy\" <br>Via CLI:<br><code>aws iam update-account-password-policy --require-numbers</code><br> <b> Note: </b> All commands starting with <code>aws iam update-account-password-policy</code> can be combined into a single command.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Password policies are, in part, used to enforce password complexity requirements. IAM password policies can be used to ensure password are at least a given length. <br>It is recommended that the password policy require a minimum password length '14'. <br> Setting a password complexity policy increases account resiliency against brute force login attempts.",
    "displayName": "Ensure IAM password policy requires minimum length of 14 or greater",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e109af9f-128b-4774-a40c-aab8eff3934c",
    "implementationEffort": null,
    "name": "e109af9f-128b-4774-a40c-aab8eff3934c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to set the password policy as prescribed:<br> Via AWS Console: <br>1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) <br>2. Go to IAM Service on the AWS Console <br>3. Click on \"Account Settings\" on the Left Pane <br> 4. Set \"Minimum password length\" to 14 or greater. <br>5. Click \"Apply password policy\"<br> Via CLI:<br><code>aws iam update-account-password-policy --minimum-password-length 14</code><br> <b> Note: </b> All commands starting with <code>aws iam update-account-password-policy</code> can be combined into a single command.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "IAM password policies can prevent the reuse of a given password by the same user. <br>It is recommended that the password policy prevent the reuse of passwords. <br> Preventing password reuse increases account resiliency against brute force login attempts.",
    "displayName": "Ensure IAM password policy prevents password reuse",
    "id": "/providers/Microsoft.Security/assessmentMetadata/22e99393-671c-4979-a08a-cd1533da9ece",
    "implementationEffort": null,
    "name": "22e99393-671c-4979-a08a-cd1533da9ece",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to set the password policy as prescribed:<br> Via AWS Console:<br> 1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Go to IAM Service on the AWS Console 3. Click on \"Account Settings\" on the Left Pane 4. Check \"Prevent password reuse\" 5. Set \"Number of passwords to remember\" is set to '24'. <br> Via CLI:<br><code>aws iam update-account-password-policy --password-reuse-prevention 24</code><br> <b> Note: </b> All commands starting with <code>aws iam update-account-password-policy</code> can be combined into a single command.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "IAM password policies can require passwords to be rotated or expired after a given number of days. <br> It is recommended that the password policy expire passwords after 90 days or less. <br> Reducing the password lifetime increases account resiliency against brute force login attempts. Additionally, requiring regular password changes help in the following scenarios: <br> * Passwords can be stolen or compromised sometimes without your knowledge. This can happen via a system compromise, software vulnerability, or internal threat. <br>* Certain corporate and government web filters or proxy servers have the ability to intercept and record traffic even if it's encrypted. <br>* Many people use the same password for many systems such as work, email, and personal. <br>* Compromised end user workstations might have a keystroke logger.",
    "displayName": "Ensure IAM password policy expires passwords within 90 days or less",
    "id": "/providers/Microsoft.Security/assessmentMetadata/729c20d1-fe7c-4e1b-8c9c-ab5ad56d7f96",
    "implementationEffort": null,
    "name": "729c20d1-fe7c-4e1b-8c9c-ab5ad56d7f96",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to set the password policy as prescribed:<br>Via AWS Console:<br> 1. Login to AWS Console (with appropriate permissions to View Identity Access Management Account Settings) 2. Go to IAM Service on the AWS Console 3. Click on \"Account Settings\" on the Left Pane 4. Check \"Enable password expiration\" 5. Set \"Password expiration period (in days):\" to 90 or less<br>Via CLI:<br><code>aws iam update-account-password-policy --max-password-age 90</code><br> <b> Note: </b> All commands starting with <code>aws iam update-account-password-policy</code> can be combined into a single command.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "The root account is the most privileged user in an AWS account. AWS Access Keys provide programmatic access to a given AWS account. <br> It is recommended that all access keys associated with the root account be removed. <br> Removing access keys associated with the root account limits vectors by which the account can be compromised. <br> Additionally, removing the root access keys encourages the creation and use of role based accounts that are least privileged.",
    "displayName": "Root account access key shouldn't exist",
    "id": "/providers/Microsoft.Security/assessmentMetadata/412835f5-0339-4180-9c22-ea8735dc6c24",
    "implementationEffort": null,
    "name": "412835f5-0339-4180-9c22-ea8735dc6c24",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To delete access keys:<br> 1. Log in to your account using the root credentials. <br>2. Select the account name near the top-right corner of the page and then select \"My Security Credentials\".<br> 3. In the pop-up warning, select \"Continue to Security Credentials\". <br> 4. Select \"Access keys (access key ID and secret access key)\".<br> 5. To permanently delete the key, select \"Delete\" and then select \"Yes\". You cannot recover deleted keys.<br> 6. If there is more than one root user access key, then repeat steps 4 and 5 for each key.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "The root account is the most privileged user in an account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they're prompted for their user name and password and for an authentication code from their AWS MFA device.<br> When you use virtual MFA for root accounts, it is recommended that the device used is not a personal device. Instead, use a dedicated mobile device (tablet or phone) that you manage to keep charged and secured independent of any individual personal devices. <br> This lessens the risks of losing access to the MFA due to device loss, device trade-in, or if the individual owning the device is no longer employed at the company.",
    "displayName": "MFA should be enabled for the \"root\" account",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1c9ea4ef-3bb5-4f02-b8b9-55e788e1a21a",
    "implementationEffort": null,
    "name": "1c9ea4ef-3bb5-4f02-b8b9-55e788e1a21a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable MFA for the root account: <br> 1. Log in to your account using the root credentials. <br> 2. Select the account name near the top-right corner of the page and then select \"My Security Credentials\". <br> 3. In the pop-up warning, select \"Continue to Security Credentials\". <br> 4. Select \"Multi-factor authentication (MFA)\". <br>\t5. Select \"Activate MFA\". <br> 6. Select the type of device to use for MFA and then select \"Continue\". <br> 7. Complete the steps to configure the device type appropriate to your selection.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "The root account is the most privileged user in an account. MFA adds an extra layer of protection on top of a user name and password. With MFA enabled, when a user signs in to an AWS website, they're prompted for their user name and password and for an authentication code from their AWS MFA device.<br> For Level 2, it is recommended that you protect the root account with a hardware MFA. A hardware MFA has a smaller attack surface than a virtual MFA. For example, a hardware MFA doesn't suffer the attack surface introduced by the mobile smartphone that a virtual MFA resides on. <br> Using hardware MFA for many, many accounts might create a logistical device management issue. If this occurs, consider implementing this Level 2 recommendation selectively to the highest security accounts. You can then apply the Level 1 recommendation to the remaining accounts.",
    "displayName": "Hardware MFA should be enabled for the \"root\" account",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eb39e935-38fc-4b0c-8cf2-d6affab0306a",
    "implementationEffort": null,
    "name": "eb39e935-38fc-4b0c-8cf2-d6affab0306a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable hardware-based MFA for the root account: <br> 1. Log in to your account using the root credentials.<br> 2. Select the account name near the top-right corner of the page and then select \"My Security Credentials\". <br> 3. In the pop-up warning, select \"Continue to Security Credentials\". 4. Select \"Multi-factor authentication (MFA)\". <br> 5. Select \"Activate MFA\". <br> 6. Select a hardware-based (not virtual) device to use for MFA and then select \"Continue\". <br> 7. Complete the steps to configure the device type appropriate to your selection.",
    "severity": "Low",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "By default, IAM users, groups, and roles have no access to AWS resources. IAM policies are the means by which privileges are granted to users, groups, or roles. <br> It is recommended that IAM policies be applied directly to groups and roles but not users.<br>Assigning privileges at the group or role level reduces the complexity of access management as the number of users grow. <br> Reducing access management complexity may in-turn reduce opportunity for a principal to inadvertently receive or retain excessive privileges.",
    "displayName": "IAM policies should be attached only to groups or roles",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a773f81a-0b2d-4f8e-826a-77fc432416c3",
    "implementationEffort": null,
    "name": "a773f81a-0b2d-4f8e-826a-77fc432416c3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate, create an IAM group, assign the policy to the group, and then add the users to the group. The policy is applied to each user in the group. <br><br> To create an IAM group: <br> 1. Open the IAM console at https://console.aws.amazon.com/iam/. <br> 2. Select \"Groups\" and then select \"Create New Group\". <br>\t3. Enter a name for the group to create and then select \"Next Step\". <br> 4. Select each policy to assign to the group and then select \"Next Step\". <br> The policies that you Select should include any policies currently attached directly to a user account. <br> The next step to resolve a failed check is to add users to a group and then assign the policies to that group. <br> Each user in the group gets assigned the policies assigned to the group. <br> 5. Confirm the details on the \"Review\" page and then select \"Create Group\". <br> For more information about creating groups, see Creating IAM groups [https://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups_create.html] in the IAM User Guide. <br><br> To add users to an IAM group:<br> 1. Open the IAM console at https://console.aws.amazon.com/iam/.<br> 2. Select \"Groups\".<br> 3. select \"Group Actions\" and then select \"Add Users to Group\". <br> 4. Select the users to add to the group and then select \"Add Users\".<br> For more information about adding users to groups, see Adding and removing users in an IAM group [https://docs.aws.amazon.com/IAM/latest/UserGuide/id_groups_manage_add-remove-users.html]. <br><br> To remove a policy attached directly to a user: <br> 1. Open the IAM console at https://console.aws.amazon.com/iam/. <br> 2. Select \"Users\". <br> 3. For the user to detach a policy from, select the name in the \"User name\" column. <br> 4. For each policy listed under \"Attached directly\", select the \"X\" on the right side of the page to remove the policy from the user and then select \"Remove\". <br> 5. Confirm that the user can still use AWS services as expected.",
    "severity": "Low",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "AWS provides a support center that can be used for incident notification and response, as well as technical support and customer services. <br> Create an IAM Role to allow authorized users to manage incidents with AWS Support.<br>By implementing least privilege for access control, an IAM Role will require an appropriate IAM Policy to allow Support Center Access in order to manage Incidents with AWS Support.",
    "displayName": "Ensure a support role has been created to manage incidents with AWS Support",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6614c30d-c9f3-4acd-8371-c8f362148398",
    "implementationEffort": null,
    "name": "6614c30d-c9f3-4acd-8371-c8f362148398",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Using the Amazon unified command line interface:<br> Create an IAM role for managing incidents with AWS:<br>* Create a trust relationship policy document that allows \"iam_user\" to manage AWS incidents, and save it locally as /tmp/TrustPolicy.json:<br><code>{ \"Version\": \"2012-10-17\", \"Statement\": [ { \"Effect\": \"Allow\", \"Principal\": { \"AWS\": \"&lt;span style=\"font-style: italic;\"&gt;&lt;iam_user&gt;&lt;/span&gt;\" }, \"Action\": \"sts:AssumeRole\" } ] }</code><br>* Create the IAM role using the above trust policy:<br><code>aws iam create-role --role-name &lt;aws_support_iam_role&gt; --assume-rolepolicy-document file:///tmp/TrustPolicy.json </code> <br>* Attach \"AWSSupportAccess\" managed policy to the created IAM role:<br><code>aws iam attach-role-policy --policy-arn &lt;iam_policy_arn&gt; --role-name&lt;aws_support_iam_role&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "AWS console defaults the checkbox for creating access keys to enabled. This results in many access keys being generated unnecessarily. <br> In addition to unnecessary credentials, it also generates unnecessary management work in auditing and rotating these keys. <br> Requiring that additional steps be taken by the user after their profile has been created will give a stronger indication of intent that access keys are [a] necessary for their work and [b] once the access key is established on an account that the keys may be in use somewhere in the organization",
    "displayName": "Do not setup access keys during initial user setup for all IAM users that have a console password",
    "id": "/providers/Microsoft.Security/assessmentMetadata/655f9340-184f-4b6e-8214-b835003ab0b1",
    "implementationEffort": null,
    "name": "655f9340-184f-4b6e-8214-b835003ab0b1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to delete access keys that do not pass the audit: 1. Login to the AWS Management Console: 2. Click \"Services\" 3. Click \"IAM\" 4. Click on \"Users\" 5. Click on \"Security Credentials\" 6. As an Administrator <br>* Click on \"Delete\" for keys that were created at the same time as the user profile but have not been used. 7. As an IAM User <br>* Click on \"Delete\" for keys that were created at the same time as the user profile but have not been used.<br>Via CLI:<br> <code>aws iam delete-access-key</code>",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Persistence",
      "Initial Access"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "IAM policies are the means by which privileges are granted to users, groups, or roles. <br> It is recommended and considered a standard security advice to grant least privilege-that is, granting only the permissions required to perform a task. <br> Determine what users need to do and then craft policies for them that let the users perform only those tasks, instead of allowing full administrative privileges. <br> It's more secure to start with a minimum set of permissions and grant additional permissions as necessary, rather than starting with permissions that are too lenient and then trying to tighten them later. <br> Providing full administrative privileges instead of restricting to the minimum set of permissions that the user is required to do exposes the resources to potentially unwanted actions.<br> IAM policies that have a statement with \"Effect\": \"Allow\" with \"Action\": \"*\" over \"Resource\": \"*\" should be removed.",
    "displayName": "IAM policies that allow full \"*:*\" administrative privileges should not be created",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1d08b362-7e24-46b0-bed1-4a6c1d1526a5",
    "implementationEffort": null,
    "name": "1d08b362-7e24-46b0-bed1-4a6c1d1526a5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To modify an IAM policy: <br> 1. Open the IAM console at https://console.aws.amazon.com/iam/. <br> 2. Select \"Policies\". <br> 3. Select the radio button next to the policy to remove. 4. From the \"Policy actions\" drop-down menu, select \"Detach\". <br> 5. On the \"Detach policy\" page, select the radio button next to each user to detach the policy from and then select \"Detach policy\". <br> Confirm that the user that you detached the policy from can still access AWS services and resources as expected.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. <br> The recorded information includes the identity of the API caller, the time of the API call, the source IP address of the API caller, the request parameters, and the response elements returned by the AWS service. CloudTrail provides a history of AWS API calls for an account, including API calls made via the Management Console, SDKs, command line tools, and higher-level AWS services (such as CloudFormation). <br>The AWS API call history produced by CloudTrail enables security analysis, resource change tracking, and compliance auditing. Additionally, <br> * ensuring that a multi-regions trail exists will ensure that unexpected activity occurring in otherwise unused regions is detected <br>* ensuring that a multi-regions trail exists will ensure that \"Global Service Logging\" is enabled for a trail by default to capture recording of events generated on AWS global services <br>* for a multi-regions trail, ensuring that management events configured for all type of Read/Writes ensures recording of management operations that are performed on all resources in an AWS account.",
    "displayName": "Ensure CloudTrail is enabled in all regions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b3d8e09b-83a6-417a-ae1e-3f5b54576965",
    "implementationEffort": null,
    "name": "b3d8e09b-83a6-417a-ae1e-3f5b54576965",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to enable global (Multi-region) CloudTrail logging:<br>Via the management Console:<br>1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/cloudtrail<br>2. Click on \"Trails\" on the left navigation pane. <br>3. Click \"Get Started Now\", if presented <br>* Click \"Add new trail\"<br>* Enter a trail name in the \"Trail name\" box. <br>* Set the \"Apply trail to all regions\" option to \"Yes\". <br>* Specify an S3 bucket name in the \"S3 bucket\" box. <br>* Click \"Create\". <br>4. If 1 or more trails already exist, select the target trail to enable for global logging. <br>5. Click the edit icon (pencil) next to \"Apply trail to all regions\", Click \"Yes\" and Click \"Save\". 6. Click the edit icon (pencil) next to \"Management Events\", click \"All\" for setting \"Read/Write Events\" and Click \"Save\". <br>Via CLI: <br><code>aws cloudtrail create-trail --name &lt;trail_name&gt; --bucket-name &lt;s3_bucket_for_cloudtrail&gt; --is-multi-region-trail aws cloudtrail update-trail --name &lt;trail_name&gt; --is-multi-region-trail </code><br><br><b>Note:</b> Creating CloudTrail via CLI without providing any overriding options configures<br>Management Events to set All type of Read/Writes by default.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "To ensure additional integrity checking of CloudTrail logs, we recommend enabling file validation on all CloudTrails.",
    "displayName": "CloudTrail log file validation should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/324ec96c-9719-46ce-b6a9-e7f4fed7dd6e",
    "implementationEffort": null,
    "name": "324ec96c-9719-46ce-b6a9-e7f4fed7dd6e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Enable log file validation on a given trail:<br>Via the management Console<br>1. Sign in to the AWS Management Console and open the IAM console at <a href=\"https://console.aws.amazon.com/cloudtrail\">https://console.aws.amazon.com/cloudtrail</a><br>2. Select on \"Trails\" on the left navigation pane<br>3. Select the target trail<br>4. Within the \"S3\" section select the edit icon (pencil)<br>5. Select \"Advanced\"<br>6. Select \"Yes\" radio button in section \"Enable log file validation\"<br>7. Click \"Save\"<br>Via CLI<br><code>aws cloudtrail update-trail --name --enable-log-file-validation</code><br><br>Note that periodic validation of logs using these digests can be performed by running the following command: <br><code>aws cloudtrail validate-logs --trail-arn --start-time --end-time</code>",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "CloudTrail logs a record of every API call made in your AWS account. These log files are stored in an S3 bucket. <br> It is recommended that the bucket policy, or access control list (ACL), applied to the S3 bucket that CloudTrail logs to prevents public access to the CloudTrail logs. <br>Allowing public access to CloudTrail log content may aid an adversary in identifying weaknesses in the affected account's use or configuration.",
    "displayName": "Ensure the S3 bucket used to store CloudTrail logs is not publicly accessible",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a41f2846-4a59-44e9-89bb-1f62d4b03a85",
    "implementationEffort": null,
    "name": "a41f2846-4a59-44e9-89bb-1f62d4b03a85",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to remove any public access that has been granted to the bucket via an ACL or S3 bucket policy:<br>1. Go to Amazon S3 console at https://console.aws.amazon.com/s3/home<br>2. Right-click on the bucket and click Properties.<br>3. In the \"Properties\" pane, click the \"Permissions\" tab.<br>4. The tab shows a list of grants, one row per grant, in the bucket ACL. Each row identifies the grantee and the permissions granted.<br>5. Select the row that grants permission to \"Everyone\" or \"Any Authenticated User\".<br>6. Uncheck all the permissions granted to \"Everyone\" or \"Any Authenticated User\" (click <code>x</code> to delete the row).<br>7. Click \"Save\" to save the ACL.<br>8. If the \"Edit bucket policy\" button is present, click it.<br>9. Remove any \"Statement\" having an \"Effect\" set to \"Allow\" and a \"Principal\" set to \"*\" or {\"AWS\" : \"*\"}.",
    "severity": "High",
    "tactics": [
      "Discovery",
      "Impact"
    ],
    "techniques": [
      "Cloud Storage Object Discovery",
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "In addition to capturing CloudTrail logs within a specified S3 bucket for long term analysis, real-time analysis can be performed by configuring CloudTrail to send logs to CloudWatch Logs. <br> For a trail that is enabled in all regions in an account, CloudTrail sends log files from all those regions to a CloudWatch Logs log group. We recommended that CloudTrail logs will be sent to CloudWatch Logs to ensure AWS account activity is being captured, monitored, and appropriately alarmed on. <br>Sending CloudTrail logs to CloudWatch Logs facilitates real-time and historic activity logging based on user, API, resource, and IP address, and provides opportunity to establish alarms and notifications for anomalous or sensitivity account activity.",
    "displayName": "CloudTrail trails should be integrated with CloudWatch Logs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/842be2e5-2cd8-420f-969a-6d6b4096c580",
    "implementationEffort": null,
    "name": "842be2e5-2cd8-420f-969a-6d6b4096c580",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Via the AWS management Console: <br>1. Sign in to the AWS Management Console and open the CloudTrail console at https://console.aws.amazon.com/cloudtrail/<br>2. Under All Buckets, select the target bucket you wish to evaluate. <br>3. Select Properties on the top right of the console. <br>4. Select <code>Trails\" in the left menu. <br>5. Click on each trail where no \"CloudWatch Logs\" are defined. <br>6. Go to the \"CloudWatch Logs\" section and then select \"Configure\". <br>7. Define a new or select an existing log group. <br>8. Click on \"Continue\". <br>9. Configure \"IAM Role\" which will deliver CloudTrail events to CloudWatch Logs <br>* Create/Select an \"IAM Role\" and \"Policy Name\". <br>* Select \"Allow\" to continue. <br>Note that it can also be enabled via CLI:<br><code>aws cloudtrail update-trail --name &lt;trail_name&gt; --cloudwatch-logs-log-grouparn &lt;cloudtrail_log_group_arn&gt; --cloudwatch-logs-role-arn &lt;cloudtrail_cloudwatchLogs_role_arn&gt;</code>",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "AWS Config is a web service that performs configuration management of supported AWS resources within your account and delivers log files to you. <br> The recorded information includes the configuration item (AWS resource), relationships between configuration items (AWS resources), any configuration changes between resources. <br>It is recommended to enable AWS Config be enabled in all regions. <br><br>The AWS configuration item history captured by AWS Config enables security analysis, resource change tracking, and compliance auditing.",
    "displayName": "Ensure AWS Config is enabled in all regions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3ff06f36-f8fd-4af5-bd02-5195593423fb",
    "implementationEffort": null,
    "name": "3ff06f36-f8fd-4af5-bd02-5195593423fb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To implement AWS Config configuration:<br>Via AWS Management Console: <br>1. Select the region you want to focus on in the top right of the console. <br>2. Click \"Services\". <br>3. Click \"Config\". <br>4. Define which resources you want to record in the selected region. <br>5. Choose to include global resources (IAM resources). <br>6. Specify an S3 bucket in the same account or in another managed AWS account. <br>7. Create an SNS Topic from the same AWS account or another managed AWS account.<br><br>Via AWS Command Line Interface: <br>1. Ensure there is an appropriate S3 bucket, SNS topic, and IAM role per the <a href=\"https://docs.aws.amazon.com/config/latest/developerguide/gs-cli-prereq.html\">AWS Config Service prerequisites</a>. <br>2. Run this command to set up the configuration recorder:<br><code>aws configservice subscribe --s3-bucket my-config-bucket --sns-topic arn:aws:sns:us-east-1:012345678912:my-config-notice --iam-role arn:aws:iam::012345678912:role/myConfigRole</code> <br>3. Run this command to start the configuration recorder:<br><code>start-configuration-recorder --configuration-recorder-name &lt;value&gt;</code>",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "S3 Bucket Access Logging generates a log that contains access records Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket for each request made to your S3 bucket. <br> An access log record contains details about the request, such as the request type, the resources specified in the request worked, and the time and date the request was processed. <br>It is recommended that bucket access logging be enabled on the CloudTrail S3 bucket. <br>By enabling S3 bucket logging on target S3 buckets, it is possible to capture all events which may affect objects within an target buckets. Configuring logs to be placed in a separate bucket allows access to log information which can be useful in security and incident response workflows.",
    "displayName": "Ensure S3 bucket access logging is enabled on the CloudTrail S3 bucket",
    "id": "/providers/Microsoft.Security/assessmentMetadata/759e80dc-92c2-4afd-afa3-c01294999363",
    "implementationEffort": null,
    "name": "759e80dc-92c2-4afd-afa3-c01294999363",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to enable S3 bucket logging:<br>Via the Management Console.<br>1. Sign in to the AWS Management Console and open the S3 console at https://console.aws.amazon.com/s3.<br>2. Under \"All Buckets\" click on the target S3 bucket.<br>3. Click on \"Properties\" in the top right of the console.<br>4. Under \"Bucket\": &lt;s3_bucket_for_cloudtrail&gt; click on \"Logging\".<br>5. Configure bucket logging.<br>* Click on \"Enabled\" checkbox.<br>* Select Target Bucket from list.<br>* Enter a Target Prefix.<br>6. Click \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "We recommended to configure CloudTrail use SSE-KMS. <br>Configuring CloudTrail to use SSE-KMS provides additional confidentiality controls on log data as a given user must have S3 read permission on the corresponding log bucket and must be granted decrypt permission by the CMK policy.",
    "displayName": "CloudTrail logs should be encrypted at rest using KMS CMKs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/190f732b-c68e-4816-9961-aba074272627",
    "implementationEffort": null,
    "name": "190f732b-c68e-4816-9961-aba074272627",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To configure CloudTrail SSE-KMS:<br>Via the Management Console: <br>1. Sign in to the AWS Management Console and open the CloudTrail console at <a href=\"https://console.aws.amazon.com/cloudtrail\">https://console.aws.amazon.com/cloudtrail. </a><br>2. In the left navigation pane, select \"Trails\"</code>. <br>3. Click on a Trail. <br>4. Under the \"S3\"section click on the edit button (pencil icon). <br>5. Click \"Advanced\". <br>6. Select an existing CMK from the \"KMS key Id\" drop-down menu. <br>* <b>Note:</b> Ensure the CMK is located in the same region as the S3 bucket <br>* <b>Note:</b> You will need to apply a KMS Key policy on the selected CMK in order for CloudTrail as a service to encrypt and decrypt log files using the CMK provided. Steps are provided <a href=\"https://docs.aws.amazon.com/awscloudtrail/latest/userguide/create-kms-key-policy-for-cloudtrail.html\">here</a> for editing the selected CMK Key policy. <br>7. Click \"Save\". <br>8. You will see a notification message stating that you need to have decrypt permissions on the specified KMS key to decrypt log files. <br>9. Click \"Yes\".<br><br>Via CLI: <br><code>aws cloudtrail update-trail --name &lt;trail_name&gt; --kms-id &lt;cloudtrail_kms_key&gt; aws kms put-key-policy --key-id &lt;cloudtrail_kms_key&gt; --policy &lt;cloudtrail_kms_key_policy&gt;</code>",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "AWS Key Management Service (KMS) allows customers to rotate the backing key which is key material stored within the KMS which is tied to the key ID of the Customer Created customer master key (CMK). <br> It is the backing key that is used to perform cryptographic operations such as encryption and decryption. <br> Automated key rotation currently retains all prior backing keys so that decryption of encrypted data can take place transparently. It is recommended that CMK key rotation be enabled. <br> Rotating encryption keys helps reduce the potential impact of a compromised key as data encrypted with a new key cannot be accessed with a previous key that may have been exposed.",
    "displayName": "Ensure rotation for customer created CMKs is enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/66748314-d51c-4d9c-b789-eebef29a7039",
    "implementationEffort": null,
    "name": "66748314-d51c-4d9c-b789-eebef29a7039",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Via the Management Console:<br>1. Sign in to the AWS Management Console and open the IAM console at https://console.aws.amazon.com/iam.<br>2. In the left navigation pane, choose \"Encryption Keys\".<br>3. Select a customer created master key (CMK).<br>4. Under the \"Key Policy\" section, move down to \"Key Rotation\".<br> 5. Check the \"Rotate this key every year\" checkbox.<br><br>Via CLI<br>Run the following command to enable key rotation:<br><code>aws kms enable-key-rotation --key-id &lt;kms_key_id&gt;</code>",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "VPC Flow Logs provide visibility into network traffic that passes through the VPC and can be used to detect anomalous traffic or insight during security events.",
    "displayName": "VPC flow logging should be enabled in all VPCs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3428e584-0fa6-48c0-817e-6d689d7bb879",
    "implementationEffort": null,
    "name": "3428e584-0fa6-48c0-817e-6d689d7bb879",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "1. Sign into the management console.<br>2. Select \"Services\" then \"VPC\".<br>3. In the left navigation pane, select \"Your VPCs\".<br>4. Select a VPC.<br>5. In the right pane, select the \"Flow Logs\" tab.<br>6. If no Flow Log exists, select \"Create Flow Log\".<br>7. For Filter, select Reject.<br>8. Enter in a \"Role\" and \"Destination Log Group\".<br>9. Select \"Create Log Flow\".<br>10. Select \"CloudWatch Logs Group\".<br><br><b>Note:</b> Setting the filter to \"Reject\" will dramatically reduce the logging data accumulation for this recommendation and provide sufficient information for the purposes of breach detection.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for unauthorized API calls. <br> Monitoring unauthorized API calls will help reveal application errors and may reduce time to detect malicious activity.",
    "displayName": "Ensure a log metric filter and alarm exist for unauthorized API calls",
    "id": "/providers/Microsoft.Security/assessmentMetadata/231951ea-e9db-41cd-a7d0-611105fa4fb9",
    "implementationEffort": null,
    "name": "231951ea-e9db-41cd-a7d0-611105fa4fb9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for unauthorized API calls and the log group name taken from audit step '1'. <br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;unauthorized_api_calls_metric&gt;` --metric-transformations metricName= `&lt;unauthorized_api_calls_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.errorCode = \"*UnauthorizedOperation\") || ($.errorCode = \"AccessDenied*\")}'</code><br> <b>Note:</b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;unauthorized_api_calls_alarm&gt;` --metric-name `&lt;unauthorized_api_calls_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for console logins that are not protected by multi-factor authentication (MFA). <br>Monitoring for single-factor console logins will increase visibility into accounts that are not protected by MFA.",
    "displayName": "Ensure a log metric filter and alarm exist for Management Console sign-in without MFA",
    "id": "/providers/Microsoft.Security/assessmentMetadata/001ddfe0-1b98-443f-819d-99f060fd67d5",
    "implementationEffort": null,
    "name": "001ddfe0-1b98-443f-819d-99f060fd67d5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for AWS Management Console sign-in without MFA and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;no_mfa_console_signin_metric&gt;` --metric-transformations metricName= `&lt;no_mfa_console_signin_metric&gt;`,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventName = \"ConsoleLogin\") &amp;&amp; ($.additionalEventData.MFAUsed != \"Yes\") }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;no_mfa_console_signin_alarm&gt;` --metric-name `&lt;no_mfa_console_signin_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for root login attempts. <br><br> Monitoring for root account logins will provide visibility into the use of a fully privileged account and an opportunity to reduce the use of it.",
    "displayName": "Ensure a log metric filter and alarm exist for usage of 'root' account",
    "id": "/providers/Microsoft.Security/assessmentMetadata/59f84fbd-7946-41b3-88b1-d899dcac92bc",
    "implementationEffort": null,
    "name": "59f84fbd-7946-41b3-88b1-d899dcac92bc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for \"Root\" account usage and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name `&lt;cloudtrail_log_group_name&gt;` --filter-name `&lt;root_usage_metric&gt;` --metric-transformations metricName= `&lt;root_usage_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filterpattern '{ $.userIdentity.type = \"Root\" &amp;&amp; $.userIdentity.invokedBy NOTEXISTS &amp;&amp; $.eventType != \"AwsServiceEvent\" }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;root_usage_alarm&gt;` --metricname `&lt;root_usage_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established changes made to Identity and Access Management (IAM) policies. <br> Monitoring changes to IAM policies will help ensure authentication and authorization controls remain intact.",
    "displayName": "Ensure a log metric filter and alarm exist for IAM policy changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8e5ad1a9-3803-4399-baf2-a7eb9483b954",
    "implementationEffort": null,
    "name": "8e5ad1a9-3803-4399-baf2-a7eb9483b954",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for IAM policy changes and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name `&lt;cloudtrail_log_group_name&gt;` --filter-name `&lt;iam_changes_metric&gt;` --metric-transformations metricName=`&lt;iam_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventName=DeleteGroupPolicy)||($.eventName=DeleteRolePolicy)||($.eventName=DeleteUserPolicy)||($.eventName=PutGroupPolicy)||($.eventName=PutRolePolicy)||($.eventName=PutUserPolicy)||($.eventName=CreatePolicy)||($.eventName=DeletePolicy)||($.eventName=CreatePolicyVersion)||($.eventName=DeletePolicyVersion)||($.eventName=AttachRolePolicy)||($.eventName=DetachRolePolicy)||($.eventName=AttachUserPolicy)||($.eventName=DetachUserPolicy)||($.eventName=AttachGroupPolicy)||($.eventName=DetachGroupPolicy)}'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br>aws cloudwatch put-metric-alarm --alarm-name `&lt;iam_changes_alarm&gt;` --metric-name <code>`&lt;iam_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations. <br><br> Monitoring changes to CloudTrail's configuration will help ensure sustained visibility to activities performed in the AWS account.",
    "displayName": "Ensure a log metric filter and alarm exist for CloudTrail configuration changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0dc3b824-092a-4fc6-b8b4-31d5c2403024",
    "implementationEffort": null,
    "name": "0dc3b824-092a-4fc6-b8b4-31d5c2403024",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for cloudtrail configuration changes and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;cloudtrail_cfg_changes_metric&gt;` --metric-transformations metricName= `&lt;cloudtrail_cfg_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventName = CreateTrail) || ($.eventName = UpdateTrail) || ($.eventName = DeleteTrail) || ($.eventName = StartLogging) || ($.eventName = StopLogging)}'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br>aws cloudwatch put-metric-alarm --alarm-name `&lt;iam_changes_alarm&gt;` --metric-name aws <code>cloudwatch put-metric-alarm --alarm-name `&lt;cloudtrail_cfg_changes_alarm&gt;` --metric-name `&lt;cloudtrail_cfg_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for failed console authentication attempts. <br> Monitoring failed console logins may decrease lead time to detect an attempt to brute force a credential, which may provide an indicator, such as source IP, that can be used in other event correlation.",
    "displayName": "Ensure a log metric filter and alarm exist for AWS Management Console authentication failures",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0e09bb35-54a3-48a1-855d-9fd3239deaf7",
    "implementationEffort": null,
    "name": "0e09bb35-54a3-48a1-855d-9fd3239deaf7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for AWS management Console Login Failures and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;console_signin_failure_metric&gt;` --metric-transformations metricName= `&lt;console_signin_failure_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventName = ConsoleLogin) &amp;&amp; ($.errorMessage = \"Failed authentication\") }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;console_signin_failure_alarm&gt;` --metric-name `&lt;console_signin_failure_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for customer created CMKs which have changed state to disabled or scheduled deletion. <br> Data encrypted with disabled or deleted keys will no longer be accessible.",
    "displayName": "Ensure a log metric filter and alarm exist for disabling or scheduled deletion of customer created CMKs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d12e97c1-1f3e-4c69-8cc1-6e4cc6a9b167",
    "implementationEffort": null,
    "name": "d12e97c1-1f3e-4c69-8cc1-6e4cc6a9b167",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for disabled or scheduled for deletion CMK's and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;disable_or_delete_cmk_changes_metric&gt;` --metrictransformations metricName= `&lt;disable_or_delete_cmk_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventSource = kms.amazonaws.com) &amp;&amp; (($.eventName=DisableKey)||($.eventName=ScheduleKeyDeletion)) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;disable_or_delete_cmk_changes_alarm&gt;` --metric-name `&lt;disable_or_delete_cmk_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluationperiods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for changes to S3 bucket policies. <br>Monitoring changes to S3 bucket policies may reduce time to detect and correct permissive policies on sensitive S3 buckets.",
    "displayName": "Ensure a log metric filter and alarm exist for S3 bucket policy changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/69ed2dc0-6f39-4a33-a747-20a28f85b33c",
    "implementationEffort": null,
    "name": "69ed2dc0-6f39-4a33-a747-20a28f85b33c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for S3 bucket policy changes and the log group name taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;s3_bucket_policy_changes_metric&gt;` --metric-transformations metricName= `&lt;s3_bucket_policy_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventSource = s3.amazonaws.com) &amp;&amp; (($.eventName = PutBucketAcl) || ($.eventName = PutBucketPolicy) || ($.eventName = PutBucketCors) || ($.eventName = PutBucketLifecycle) || ($.eventName = PutBucketReplication) || ($.eventName = DeleteBucketPolicy) || ($.eventName = DeleteBucketCors) || ($.eventName = DeleteBucketLifecycle) || ($.eventName = DeleteBucketReplication)) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;s3_bucket_policy_changes_alarm&gt;` --metric-name `&lt;s3_bucket_policy_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is recommended that a metric filter and alarm be established for detecting changes to CloudTrail's configurations. <br>Monitoring changes to AWS Config configuration will help ensure sustained visibility of configuration items within the AWS account.",
    "displayName": "Ensure a log metric filter and alarm exist for AWS Config configuration changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/965a7c7f-e6da-4062-83f4-9c1800e51e44",
    "implementationEffort": null,
    "name": "965a7c7f-e6da-4062-83f4-9c1800e51e44",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for AWS Configuration changes and the log group name taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;aws_config_changes_metric&gt;` --metric-transformations metricName= `&lt;aws_config_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventSource = config.amazonaws.com) &amp;&amp; (($.eventName=StopConfigurationRecorder)||($.eventName=DeleteDeliveryChannel) ||($.eventName=PutDeliveryChannel)||($.eventName=PutConfigurationRecorder)) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `` - -metric-name `` --statistic Sum --period 300 -- threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluationperiods 1 --namespace 'CISBenchmark' --alarm-actions</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Security Groups are a stateful packet filter that controls ingress and egress traffic within a VPC. <br> It is recommended that a metric filter and alarm be established changes to Security Groups. <br>Monitoring changes to security group will help ensure that resources and services are not unintentionally exposed.",
    "displayName": "Ensure a log metric filter and alarm exist for security group changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aedabb63-8bdb-47f9-955c-72b652a75e2a",
    "implementationEffort": null,
    "name": "aedabb63-8bdb-47f9-955c-72b652a75e2a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for security groups changes and the log group name taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;security_group_changes_metric&gt;` --metric-transformations metricName= `&lt;security_group_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{($.eventName = AuthorizeSecurityGroupIngress) || ($.eventName = AuthorizeSecurityGroupEgress) || ($.eventName = RevokeSecurityGroupIngress) || ($.eventName = RevokeSecurityGroupEgress) || ($.eventName = CreateSecurityGroup) || ($.eventName = DeleteSecurityGroup) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;security_group_changes_alarm&gt;` --metric-name `&lt;security_group_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. NACLs are used as a stateless packet filter to control ingress and egress traffic for subnets within a VPC. <br> It is recommended that a metric filter and alarm be established for changes made to NACLs. <br>Monitoring changes to NACLs will help ensure that AWS resources and services are not unintentionally exposed.",
    "displayName": "Ensure a log metric filter and alarm exist for changes to Network Access Control Lists (NACL)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ec356185-75b9-4ff2-a284-9f64fc885e72",
    "implementationEffort": null,
    "name": "ec356185-75b9-4ff2-a284-9f64fc885e72",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for NACL changes and the log group name taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;nacl_changes_metric&gt;` --metric-transformations metricName = `&lt;nacl_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateNetworkAcl) || ($.eventName = CreateNetworkAclEntry) || ($.eventName = DeleteNetworkAcl) || ($.eventName = DeleteNetworkAclEntry) || ($.eventName = ReplaceNetworkAclEntry) || ($.eventName = ReplaceNetworkAclAssociation) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;nacl_changes_alarm&gt;` --metric-name `&lt;nacl_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluationperiods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Network gateways are required to send/receive traffic to a destination outside of a VPC. <br> It is recommended that a metric filter and alarm be established for changes to network gateways. <br>Monitoring changes to network gateways will help ensure that all ingress/egress traffic traverses the VPC border via a controlled path.",
    "displayName": "Ensure a log metric filter and alarm exist for changes to network gateways",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c7156050-6f51-4d3f-a880-9f2363648cfb",
    "implementationEffort": null,
    "name": "c7156050-6f51-4d3f-a880-9f2363648cfb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for network gateways changes and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;network_gw_changes_metric&gt;` --metric-transformations metricName= `&lt;network_gw_changes_metric&gt;`,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateCustomerGateway) || ($.eventName = DeleteCustomerGateway) || ($.eventName = AttachInternetGateway) || ($.eventName = CreateInternetGateway) || ($.eventName = DeleteInternetGateway) || ($.eventName = DetachInternetGateway) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;network_gw_changes_alarm&gt;` --metric-name `&lt;network_gw_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluationperiods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. Routing tables are used to route network traffic between subnets and to network gateways. <br> It is recommended that a metric filter and alarm be established for changes to route tables. <br>Monitoring changes to route tables will help ensure that all VPC traffic flows through an expected path.",
    "displayName": "Ensure a log metric filter and alarm exist for route table changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7e70666f-4bec-4ca0-8b59-c6c8b9b3cc1e",
    "implementationEffort": null,
    "name": "7e70666f-4bec-4ca0-8b59-c6c8b9b3cc1e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for route table changes and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;route_table_changes_metric&gt;` --metric-transformations metricName= `&lt;route_table_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateRoute) || ($.eventName = CreateRouteTable) || ($.eventName = ReplaceRoute) || ($.eventName = ReplaceRouteTableAssociation) || ($.eventName = DeleteRouteTable) || ($.eventName = DeleteRoute) || ($.eventName = DisassociateRouteTable) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;route_table_changes_alarm&gt;` --metric-name `&lt;route_table_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms. <br> It is possible to have more than 1 VPC within an account, in addition it is also possible to create a peer connection between 2 VPCs enabling network traffic to route between VPCs. It is recommended that a metric filter and alarm be established for changes made to VPCs. <br>Monitoring changes to IAM policies will help ensure authentication and authorization controls remain intact. ",
    "displayName": "Ensure a log metric filter and alarm exist for VPC changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4b4bfa9b-fd2a-43f1-961f-654b9d5c9a60",
    "implementationEffort": null,
    "name": "4b4bfa9b-fd2a-43f1-961f-654b9d5c9a60",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to setup the metric filter, alarm, SNS topic, and subscription: <br>1. Create a metric filter based on filter pattern provided which checks for VPC changes and the &lt;cloudtrail_log_group_name&gt; taken from audit step '1'.<br><code>aws logs put-metric-filter --log-group-name &lt;cloudtrail_log_group_name&gt; --filter-name `&lt;vpc_changes_metric&gt;` --metric-transformations metricName = `&lt;vpc_changes_metric&gt;` ,metricNamespace='CISBenchmark',metricValue=1 --filter-pattern '{ ($.eventName = CreateVpc) || ($.eventName = DeleteVpc) || ($.eventName = ModifyVpcAttribute) || ($.eventName = AcceptVpcPeeringConnection) || ($.eventName = CreateVpcPeeringConnection) || ($.eventName = DeleteVpcPeeringConnection) || ($.eventName = RejectVpcPeeringConnection) || ($.eventName = AttachClassicLinkVpc) || ($.eventName = DetachClassicLinkVpc) || ($.eventName = DisableVpcClassicLink) || ($.eventName = EnableVpcClassicLink) }'</code><br><b> Note: </b> You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. <br>2. Create an SNS topic that the alarm will notify.<br><code>aws sns create-topic --name &lt;sns_topic_name&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the same topic for all monitoring alarms. <br>3. Create an SNS subscription to the topic created in step '2'.<br><code>aws sns subscribe --topic-arn &lt;sns_topic_arn&gt; --protocol &lt;protocol_for_sns&gt; --notification-endpoint &lt;sns_subscription_endpoints&gt;</code> <br><b> Note: </b> you can execute this command once and then re-use the SNS subscription for all monitoring alarms. <br>4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step '1' and an SNS topic created in step '2'.<br><code>aws cloudwatch put-metric-alarm --alarm-name `&lt;vpc_changes_alarm&gt;` --metric-name `&lt;vpc_changes_metric&gt;` --statistic Sum --period 300 --threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions &lt;sns_topic_arn&gt;</code>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "To reduce the server's exposure, it is recommended not to allow unrestricted ingress access to port '22'.",
    "displayName": "Security groups should not allow ingress from 0.0.0.0/0 to port 22",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e1f4bba6-5f43-4dc5-ab15-f2a9f5807fea",
    "implementationEffort": null,
    "name": "e1f4bba6-5f43-4dc5-ab15-f2a9f5807fea",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "1. Login to the AWS Management Console at <a target=\"_blank\" href=\"https://console.aws.amazon.com/vpc/home\"> VPC </a> <br> 2. In the left pane, select \"Security Groups\" <br> 3. For each security group, perform the following: <br> 4. Select the security group <br> 5. Select the \"Inbound Rules\" tab <br> 6. Identify the rules to be removed <br> 7. Select the \"x\" in the \"Remove\" column <br>8. Select \"Save\"",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Security groups provide stateful filtering of ingress/egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to port 3389. <br> Removing unfettered connectivity to remote console services, such as RDP, reduces a server's exposure to risk.",
    "displayName": "Ensure no security groups allow ingress from 0.0.0.0/0 to port 3389",
    "id": "/providers/Microsoft.Security/assessmentMetadata/79082bbe-34fc-480a-a7fc-3aad94954609",
    "implementationEffort": null,
    "name": "79082bbe-34fc-480a-a7fc-3aad94954609",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Perform the following to implement the prescribed state: <br> 1. Login to the AWS Management Console at <a target=\"_blank\" href=\"https://console.aws.amazon.com/vpc/home\"> VPC </a> <br> 2. In the left pane, click \"Security Groups\" <br> 3. For each security group, perform the following: <br> 4. Select the security group <br> 5.Click the \"Inbound Rules\" tab <br> 6. Identify the rules to be removed <br> 7. Click the \"x\" in the \"Remove\" column <br> 8. Click \"Save\"",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Security group should restrict all traffic to reduce resource exposure.",
    "displayName": "VPC's default security group should restricts all traffic",
    "id": "/providers/Microsoft.Security/assessmentMetadata/500c4d2e-9baf-4081-b8a8-936ac85771a5",
    "implementationEffort": null,
    "name": "500c4d2e-9baf-4081-b8a8-936ac85771a5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "1. Identify AWS resources that exist within the default security group 2. Create a set of least privilege security groups for those resources 3. Place the resources in those security groups 4. Remove the resources noted in #1 from the default security group<br><br> Security Group State:<br> 1. Login to the AWS Management Console at https://console.aws.amazon.com/vpc/home <br>2. Repeat the next steps for all VPCs - including the default VPC in each AWS region: <br>3. In the left pane, select \"Security Groups\"<br> 4. For each default security group, perform the following: <br> 5. Select the \"default\" security group <br>6. Select the \"Inbound Rules\" tab <br> 7. Remove any inbound rules <br> 8. Select the \"Outbound Rules\" tab <br>9. Remove any outbound rules",
    "severity": "Low",
    "tactics": [
      "Lateral Movement"
    ],
    "techniques": [
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Microsoft Defender for Cloud discovered an identity that has not performed any action on any resource within your AWS account in the past 90 days. It is recommended to revoke permissions of inactive identities, in order to reduce the attack surface of your cloud environment.",
    "displayName": "Permissions of inactive identities in your AWS account should be revoked",
    "id": "/providers/Microsoft.Security/assessmentMetadata/71016e8c-d079-479d-942b-9c95b463e4a6",
    "implementationEffort": null,
    "name": "71016e8c-d079-479d-942b-9c95b463e4a6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "05/24/2024",
      "public": "11/01/2023"
    },
    "remediationDescription": "To remediate inactive identities, follow the below steps:<br><br> 1. Sign in to the AWS management console, Navigate to <a href=\"https://console.aws.amazon.com/iam\">IAM dashboard</a>.<br>2. In the IAM dashboard, go to 'Users', 'Groups', or 'Roles' depending on the type of identity you want to review.<br>3.Click on the specific identity you want to modify.<br>4.Under the Permissions tab, you will see policies attached directly to the user and through groups. Select the policies you want to remove, and click the 'Remove' Button.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Over-provisioned active identities in AWS, particularly non-human accounts, pose a significant security risk as they can increase the impact in case of a compromise.<br> These identities have access to privileges that they do not use, which can be exploited in the event of a security breach.<br> To mitigate this risk and ensure that identities have only the permissions necessary for their function, remove unnecessary permissions and establish review processes.<br> This will help to limit the potential damage in the event of a compromise.<br>",
    "displayName": "AWS overprovisioned identities should have only the necessary permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/427f7886-bb3c-42f6-a22c-979780b8e5ef",
    "implementationEffort": "Moderate",
    "name": "427f7886-bb3c-42f6-a22c-979780b8e5ef",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "05/24/2024",
      "public": "05/01/2024"
    },
    "remediationDescription": "To modify/remove permissions to an identity in AWS <br>1.Open the <a href=\"https://console.aws.amazon.com/iam\">IAM console</a> <br>2. In the navigation pane of the IAM console, choose Roles.<br>3. Choose the name of the role/user that you want to modify, and then choose the Permissions tab and determine what action is needed for the roles.<br>4. Recommend to remove the unused permissions with the goal of achieving least privilege access. You can either remove all the unused permissions from the Identity or assign least privilege. It is recommended to use the least privileged roles, with just enough privileges to perform the required tasks.<br>5. To grant only the permissions required to perform tasks, you can create customer managed policies that are specific to your use cases and resources. Use <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#customer-managed-policies\">customer managed policies</a> to continue refining permissions for your specific requirements.<br>6. To edit an existing customer managed policy, Follow the instructions in the Managing IAM policies <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage.html\">Managing IAM Policies</a> guide to validate/edit/delete the IAM policy associated with the identity. <br>7. To help you determine the specific permissions you require, use <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html\">AWS Identity and Access Management (IAM) Access Analyzer</a>, to generate least-privilege policies based on access activity. Additionally, check out the implementation guidance for least privileges <a href=\"https://docs.aws.amazon.com/wellarchitected/latest/framework/sec_permissions_least_privileges.html\">here</a> and the <a href=\"https://aws.amazon.com/blogs/security/techniques-for-writing-least-privilege-iam-policies\">best practices</a><br><br><u>Automated remediation</u><br> To learn more about how to implement automated remediation, go to <a href=\"https://aka.ms/EntraPermissionsManagementWow\">Microsoft Entra Permissions Management</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Microsoft Defender for Cloud discovered an identity that has not performed any action on any resource within your AWS account in the past 90 days. It is recommended to revoke permissions of inactive identities, in order to reduce the attack surface of your cloud environment.",
    "displayName": "(Do not use) Permissions of inactive identities in your AWS account should be revoked",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d4fea40f-e897-41b1-afbd-15ba2ebd1c4d",
    "implementationEffort": null,
    "name": "d4fea40f-e897-41b1-afbd-15ba2ebd1c4d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "07/15/2025",
      "public": "07/15/2025"
    },
    "remediationDescription": "To remediate inactive identities, follow the below steps:<br><br> 1. Sign in to the AWS management console, Navigate to <a href=\"https://console.aws.amazon.com/iam\">IAM dashboard</a>.<br>2. In the IAM dashboard, go to 'Users', 'Groups', or 'Roles' depending on the type of identity you want to review.<br>3.Click on the specific identity you want to modify.<br>4.Under the Permissions tab, you will see policies attached directly to the user and through groups. Select the policies you want to remove, and click the 'Remove' Button.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Over-provisioned active identities in AWS, particularly non-human accounts, pose a significant security risk as they can increase the impact in case of a compromise.<br> These identities have access to privileges that they do not use, which can be exploited in the event of a security breach.<br> To mitigate this risk and ensure that identities have only the permissions necessary for their function, remove unnecessary permissions and establish review processes.<br> This will help to limit the potential damage in the event of a compromise.<br>",
    "displayName": "(Do not use) AWS overprovisioned identities should have only the necessary permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e73b8caf-64c1-4948-833d-53bb60210dde",
    "implementationEffort": "Moderate",
    "name": "e73b8caf-64c1-4948-833d-53bb60210dde",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "07/15/2025",
      "public": "07/15/2025"
    },
    "remediationDescription": "To modify/remove permissions to an identity in AWS <br>1.Open the <a href=\"https://console.aws.amazon.com/iam\">IAM console</a> <br>2. In the navigation pane of the IAM console, choose Roles.<br>3. Choose the name of the role/user that you want to modify, and then choose the Permissions tab and determine what action is needed for the roles.<br>4. Recommend to remove the unused permissions with the goal of achieving least privilege access. You can either remove all the unused permissions from the Identity or assign least privilege. It is recommended to use the least privileged roles, with just enough privileges to perform the required tasks.<br>5. To grant only the permissions required to perform tasks, you can create customer managed policies that are specific to your use cases and resources. Use <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_managed-vs-inline.html#customer-managed-policies\">customer managed policies</a> to continue refining permissions for your specific requirements.<br>6. To edit an existing customer managed policy, Follow the instructions in the Managing IAM policies <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/access_policies_manage.html\">Managing IAM Policies</a> guide to validate/edit/delete the IAM policy associated with the identity. <br>7. To help you determine the specific permissions you require, use <a href=\"https://docs.aws.amazon.com/IAM/latest/UserGuide/what-is-access-analyzer.html\">AWS Identity and Access Management (IAM) Access Analyzer</a>, to generate least-privilege policies based on access activity. Additionally, check out the implementation guidance for least privileges <a href=\"https://docs.aws.amazon.com/wellarchitected/latest/framework/sec_permissions_least_privileges.html\">here</a> and the <a href=\"https://aws.amazon.com/blogs/security/techniques-for-writing-least-privilege-iam-policies\">best practices</a><br><br><u>Automated remediation</u><br> To learn more about how to implement automated remediation, go to <a href=\"https://aka.ms/EntraPermissionsManagementWow\">Microsoft Entra Permissions Management</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "S3 object-level API operations such as GetObject, DeleteObject, and PutObject are called data events.<br> By default, CloudTrail trails don't log data events and so it is recommended to enable Object-level logging for S3 buckets. <br><br> Enabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis,<br> monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity within your S3 Buckets using Amazon CloudWatch Events",
    "displayName": "Ensure that Object-level logging for write events is enabled for S3 bucket",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fc757bcc-b37b-48e5-aee2-6960cdcae2f3",
    "implementationEffort": null,
    "name": "fc757bcc-b37b-48e5-aee2-6960cdcae2f3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Login to the AWS Management Console and navigate to S3 dashboard at <a href=\"https://console.aws.amazon.com/s3/\">https://console.aws.amazon.com/s3/</a>. 2. In the left navigation panel, click \"buckets\" and then click on the \"S3 Bucket Name\" that you want to examine. 3. Click \"Properties\" tab to see in detail bucket configuration. 4. Click on the \"Object-level logging\" setting, enter the \"CloudTrail\" name for the recording activity. You can choose an existing Cloudtrail or create a new one by navigating to the Cloudtrail console link <br> <a href=\"https://console.aws.amazon.com/cloudtrail/\">https://console.aws.amazon.com/cloudtrail/</a>. 5. Once the Cloudtrail is selected, check the Write event checkbox, so that object-level logging for Write events is enabled. 6. Repeat steps 2 to 5 to enable object-level logging of write events for other S3 buckets. <br><br><b>From Command Line:</b><br> To enable object-level data events logging for S3 buckets within your AWS account, run put-event-selectors command using the name of the trail that you want to reconfigure as identifier: <br> <br> aws cloudtrail put-event-selectors --region 'region-name' --trail-name 'trail-name' --event-selectors '[{ 'ReadWriteType': 'WriteOnly', 'IncludeManagementEvents':true, 'DataResources': [{ 'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3:::'s3-bucket-name'/'] }] }]' <br><br> 2. The command output will be object-level event trail configuration. 3. If you want to enable it for all buckets at once then change Values parameter to ['arn:aws:s3'] in command given above. 4. Repeat step 1 for each s3 bucket to update object-level logging of write events. 5. Change the AWS region by updating the --region command parameter and perform the process for other regions.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "S3 object-level API operations such as GetObject, DeleteObject, and PutObject are called data events. <br>By default, CloudTrail trails don't log data events and so it is recommended to enable Object-level logging for S3 buckets. <br><br> Enabling object-level logging will help you meet data compliance requirements within your organization, perform comprehensive security analysis,<br> monitor specific patterns of user behavior in your AWS account or take immediate actions on any object-level API activity using Amazon CloudWatch Events.",
    "displayName": "Ensure that Object-level logging for read events is enabled for S3 bucket",
    "id": "/providers/Microsoft.Security/assessmentMetadata/062f7887-588b-4c0a-abb6-da9a82461213",
    "implementationEffort": null,
    "name": "062f7887-588b-4c0a-abb6-da9a82461213",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Login to the AWS Management Console and navigate to S3 dashboard at <a href=\"https://console.aws.amazon.com/s3/\">https://console.aws.amazon.com/s3/</a>. 2. In the left navigation panel, click \"buckets\" and then click on the \"S3 Bucket Name\" that you want to examine. 3. Click \"Properties\" tab to see in detail bucket configuration. 4. Click on the \"Object-level\" logging setting, enter the \"CloudTrail\" name for the recording activity. You can choose an existing Cloudtrail or create a new one by navigating to the Cloudtrail console link<br> <a href=\"https://console.aws.amazon.com/cloudtrail/\">https://console.aws.amazon.com/cloudtrail/</a>. 5. Once the Cloudtrail is selected, check the Read event checkbox, so that object-level logging for Read events is enabled. 6. Repeat steps 2 to 5 to enable object-level logging of read events for other S3 buckets. <br><br><b>From Command Line:</b><br> 1. To enable object-level data events logging for S3 buckets within your AWS account, run put-event-selectors command using the name of the trail that you want to reconfigure as identifier:<br><br> aws cloudtrail put-event-selectors --region 'region-name' --trail-name 'trail-name' --event-selectors '[{ 'ReadWriteType': 'ReadOnly', 'IncludeManagementEvents':true, 'DataResources': [{ 'Type': 'AWS::S3::Object', 'Values': ['arn:aws:s3:::'s3-bucket-name'/'] }] }]' <br><br> 2. The command output will be object-level event trail configuration. 3. If you want to enable it for all buckets at ones then change Values parameter to ['arn:aws:s3'] in command given above. 4. Repeat step 1 for each s3 bucket to update object-level logging of read events. 5. Change the AWS region by updating the --region command parameter and perform the process for other regions.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Real-time monitoring of API calls can be achieved by directing CloudTrail Logs to CloudWatch Logs and establishing corresponding metric filters and alarms.<br> It is recommended that a metric filter and alarm be established for AWS Organizations changes made in the master AWS Account. <br> Monitoring AWS Organizations changes can help you prevent any unwanted, accidental or intentional modifications that may lead to unauthorized access or other security breaches.<br> This monitoring technique helps you to ensure that any unexpected changes performed within your AWS Organizations can be investigated and any unwanted changes can be rolled back",
    "displayName": "Ensure a log metric filter and alarm exists for AWS Organizations changes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/90f5ce81-f640-4d34-981d-c88b0857032b",
    "implementationEffort": null,
    "name": "90f5ce81-f640-4d34-981d-c88b0857032b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>Perform the following to setup the metric filter, alarm, SNS topic, and subscription:</b><br> 1. Create a metric filter based on filter pattern provided which checks for AWS Organizations changes and the 'cloudtrail_log_group_name' taken from audit step 1:<br> aws logs put-metric-filter --log-group-name 'cloudtrail_log_group_name' -- filter-name 'organizations_changes' --metric-transformations metricName= 'organizations_changes' ,metricNamespace='CISBenchmark',metricValue=1 -- filter-pattern '{ ($.eventSource = organizations.amazonaws.com) && (($.eventName = 'AcceptHandshake') || ($.eventName = 'AttachPolicy') || ($.eventName = 'CreateAccount') || ($.eventName = 'CreateOrganizationalUnit') || ($.eventName = 'CreatePolicy') || ($.eventName = 'DeclineHandshake') || ($.eventName = 'DeleteOrganization') || ($.eventName = 'DeleteOrganizationalUnit') || ($.eventName = 'DeletePolicy') || ($.eventName = 'DetachPolicy') || ($.eventName = 'DisablePolicyType') || ($.eventName = 'EnablePolicyType') || ($.eventName = 'InviteAccountToOrganization') || ($.eventName = 'LeaveOrganization') || ($.eventName = 'MoveAccount') || ($.eventName = 'RemoveAccountFromOrganization') || ($.eventName = 'UpdatePolicy') || ($.eventName = 'UpdateOrganizationalUnit')) }'<br><br> Note: You can choose your own metricName and metricNamespace strings. Using the same metricNamespace for all Foundations Benchmark metrics will group them together. 2. Create an SNS topic that the alarm will notify:<br> aws sns create-topic --name 'sns_topic_name'<br> Note: you can execute this command once and then re-use the same topic for all monitoring alarms. 3. Create an SNS subscription to the topic created in step 2:<br> aws sns subscribe --topic-arn 'sns_topic_arn' --protocol 'protocol_for_sns' - -notification-endpoint 'sns_subscription_endpoints'<br> Note: you can execute this command once and then re-use the SNS subscription for all monitoring alarms. 4. Create an alarm that is associated with the CloudWatch Logs Metric Filter created in step 1 and an SNS topic created in step 2:<br> aws cloudwatch put-metric-alarm --alarm-name 'organizations_changes' -- metric-name 'organizations_changes' --statistic Sum --period 300 -- threshold 1 --comparison-operator GreaterThanOrEqualToThreshold --evaluation-periods 1 --namespace 'CISBenchmark' --alarm-actions 'sns_topic_arn'",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Network Access Control List (NACL) function provide stateless filtering of ingress and egress network traffic to AWS resources. <br>It is recommended that no NACL allows unrestricted ingress access to remote server administration ports, such as SSH to port 22 and RDP to port 3389. <br> Public access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise",
    "displayName": "Ensure no Network ACLs allow ingress from 0.0.0.0/0 to remote server administration ports",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ef0783b1-bdf0-4c86-91ca-16afef0c4a71",
    "implementationEffort": null,
    "name": "ef0783b1-bdf0-4c86-91ca-16afef0c4a71",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Login to the AWS Management Console at <a href=\"https://console.aws.amazon.com/vpc/home\">https://console.aws.amazon.com/vpc/home</a>. 2. In the left pane, click \"Network ACLs\". 3. For each \"network ACL\" to remediate, perform the following:<br> 1. Select the \"network ACL\". 2. Click the \"Inbound Rules\" tab. 3. Click Edit \"Inbound rules\". 4. Either A) update the Source field to a range other than 0.0.0.0/0, or, B) Click Delete to remove the offending inbound rule. 5. Click Save",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication. <br> Adding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted",
    "displayName": "Ensure MFA Delete is enabled on S3 buckets",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3285a9b2-694d-47b1-9e29-b32fa46aced0",
    "implementationEffort": null,
    "name": "3285a9b2-694d-47b1-9e29-b32fa46aced0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "Perform the steps below to enable MFA delete on an S3 bucket.<br> Note:<br> -You cannot enable MFA Delete using the AWS Management Console. You must use the AWS CLI or API.<br> -You must use your 'root' account to enable MFA Delete on S3 buckets.<br> From Command line:<br> 1. Run the s3api put-bucket-versioning command <br> aws s3api put-bucket-versioning --profile my-root-profile --bucket Bucket_Name --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa 'arn:aws:iam::aws_account_id:mfa/root-account-mfa-device passcode'",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Amazon S3 buckets can contain sensitive data, that for security purposes should be discovered, monitored, classified and protected. Macie along with other 3rd party tools can automatically provide an inventory of Amazon S3 buckets. <br> Using a Cloud service or 3rd Party software to continuously monitor and automate the process of data discovery and classification for S3 buckets using machine learning and pattern matching is a strong defense in protecting that information.<br> Amazon Macie is a fully managed data security and data privacy service that uses machine learning and pattern matching to discover and protect your sensitive data in AWS.",
    "displayName": "Ensure all data in Amazon S3 has been discovered, classified and secured when required",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b0bd5898-e100-44e3-88c6-db9c8c2a5a59",
    "implementationEffort": null,
    "name": "b0bd5898-e100-44e3-88c6-db9c8c2a5a59",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Log on to the Macie console at <a href=\"https://console.aws.amazon.com/macie/\">https://console.aws.amazon.com/macie/</a>. 2. Click \"Get started\". 3. Click \"Enable Macie\". <br><br> Setup a repository for sensitive data discovery results<br> 1. In the Left pane, under Settings, click \"Discovery results\". 2. Make sure \"Create bucket\" is selected. 3. Create a \"bucket\", enter a name for the bucket. The name must be unique across all S3 buckets. In addition, the name must start with a lowercase letter or a number. 4. Click on \"Advanced\". 5. Block all public access, make sure Yes is selected. 6. KMS encryption, specify the \"AWS KMS\" key that you want to use to encrypt the results. The key must be a symmetric, customer master key (CMK) that's in the same Region as the S3 bucket. 7. Click on Save. <br><br> Create a job to discover sensitive data<br> 1. In the left pane, click \"S3 buckets\". Macie displays a list of all the S3 buckets for your account. 2. Select the check box for each bucket that you want Macie to analyze as part of the job. 3. Click \"Create job\". 4. Click \"Quick create\". 5. For the Name and description step, enter a name and, optionally, a description of the job. 6. Then click \"Next\". 7. For the Review and create step, click \"Submit\". <br><br> Review your findings<br> 1. In the left pane, click \"Findings\". 2. To view the details of a specific finding, choose any field other than the check box for the finding. <br><br> If you are using a 3rd Party tool to manage and protect your s3 data, follow the Vendor documentation for implementing and configuring that tool.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "AWS IAM users can access AWS resources using different types of credentials, such as passwords or access keys. <br>It is recommended that all credentials that have been unused in 45 or greater days be deactivated or removed. <br> Disabling or removing unnecessary credentials will reduce the window of opportunity for credentials associated with a compromised or abandoned account to be used.",
    "displayName": "Ensure credentials unused for 45 days or greater are disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5e9a9506-2657-4f9f-92b1-586c46948e76",
    "implementationEffort": null,
    "name": "5e9a9506-2657-4f9f-92b1-586c46948e76",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Login to the AWS Management Console. 2. Click \"Services\". 3. Click \"IAM\". 4. Click on \"Users\". 5. Click on \"Security Credentials\". 6. Select user whose Console last sign-in is greater than 45 days. 7. Click \"Security credentials\". 8. In section \"Sign-in\" credentials, Console password click \"Manage\". 9. Under Console Access select \"Disable\". 10. Click \"Apply\". <br><br> Perform the following to deactivate Access Keys:<br> 1. Login to the AWS Management Console. 2. Click \"Services\". 3. Click \"IAM\". 4. Click on \"Users\". 5. Click on \"Security Credentials\". 6. Select any access keys that are over 45 days old and that have been used and Click on Make \"Inactive\". 7. Select any access keys that are over 45 days old and that have not been used and Click the \"X\" to Delete.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Ensure and verify that RDS database instances provisioned in your AWS account do restrict unauthorized access in order to minimize security risks. <br>To restrict access to any publicly accessible RDS database instance, you must disable the database Publicly Accessible flag and update the VPC security group associated with the instance. <br> Ensure that no public-facing RDS database instances are provisioned in your AWS account and restrict unauthorized access in order to minimize security risks.<br> When the RDS instance allows unrestricted access (0.0.0.0/0), everyone and everything on the Internet can establish a connection to your database and this can increase the opportunity for malicious activities such as brute force attacks, PostgreSQL injections, or DoS/DDoS attacks",
    "displayName": "Ensure that public access is not given to RDS Instance",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3b2fa72a-ba1c-4347-8ab2-49964b676ff4",
    "implementationEffort": null,
    "name": "3b2fa72a-ba1c-4347-8ab2-49964b676ff4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Log in to the AWS management console and navigate to the RDS dashboard at <a href=\"https://console.aws.amazon.com/rds/\">https://console.aws.amazon.com/rds/</a>. 2. Under the navigation panel, On \"RDS Dashboard\", click \"Databases\". 3. Select the \"RDS instance\" that you want to update. 4. Click \"Modify\" from the dashboard top menu. 5. On the \"Modify DB\" Instance panel, under the Connectivity section, click on \"Additional connectivity configuration\" and update the value for Publicly Accessible to Not publicly accessible to restrict public access. Follow the below steps to update subnet configurations:<br>  Select the \"Connectivity and security\" tab, and click on the \"VPC\" attribute value inside the Networking section.<br> Select the \"Details\" tab from the \"VPC\" dashboard bottom panel and click on \"Route table\" configuration attribute value.<br>  On the Route table details page, select the \"Routes\" tab from the dashboard bottom panel and click on \"Edit routes\".<br>  On the \"Edit routes\" page, update the \"Destination\" of Target which is set to igw-xxxxx and click on \"Save\" routes. 6. On the \"Modify DB\" Instance panel Click on \"Continue\" and In the Scheduling of modifications section, perform one of the following actions based on your requirements:<br> Select \"Apply\" during the next scheduled maintenance window to apply the changes automatically during the next scheduled maintenance window.<br>  Select \"Apply\" immediately to apply the changes right away. With this option, any pending modifications will be asynchronously applied as soon as possible, regardless of the maintenance window setting for this RDS database instance. Note that any changes available in the pending modifications queue are also applied. If any of the pending modifications require downtime, choosing this option can cause unexpected downtime for the application. 7. Repeat steps 3 to 6 for each RDS instance available in the current region. 8. Change the AWS region from the navigation bar to repeat the process for other regions. <br><br><b>From Command Line:</b><br> 1. Run describe-db-instances command to list all RDS database names identifiers, available in the selected AWS region:<br><br> aws rds describe-db-instances --region 'region-name' --query 'DBInstances[*].DBInstanceIdentifier'.<br><br> 2. The command output should return each database instance identifier. 3. Run modify-db-instance command to modify the selected RDS instance configuration. Then use the following command to disable the Publicly Accessible flag for the selected RDS instances. This command use the apply-immediately flag. If you want to avoid any downtime --no-apply-immediately flag can be used:<br><br> aws rds modify-db-instance --region 'region-name' --db-instance-identifier 'db-name' --no-publicly-accessible --apply-immediately.<br><br> 4. The command output should reveal the PubliclyAccessible configuration under pending values and should get applied at the specified time. 5. Updating the Internet Gateway Destination via AWS CLI is not currently supported To update information about Internet Gateway use the AWS Console Procedure. 6. Repeat steps 1 to 5 for each RDS instance provisioned in the current region. 7. Change the AWS region by using the --region filter to repeat the process for other regions.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Security Hub collects security data from across AWS accounts, services, and supported third-party partner products and helps you analyze your security trends and identify the highest priority security issues.<br> When you enable Security Hub, it begins to consume, aggregate, organize, and prioritize findings from AWS services that you have enabled, such as Amazon GuardDuty, Amazon Inspector, and Amazon Macie.<br> You can also enable integrations with AWS partner security products. <br> AWS Security Hub provides you with a comprehensive view of your security state in AWS and helps you check your environment against security industry standards and best practices - enabling you to quickly assess the security posture across your AWS accounts.",
    "displayName": "Ensure AWS Security Hub is enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eaf3fd0c-3623-43a9-85a0-bb4657149426",
    "implementationEffort": null,
    "name": "eaf3fd0c-3623-43a9-85a0-bb4657149426",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Use the credentials of the IAM identity to sign in to the Security Hub console. 2. When you open the Security Hub console for the first time, choose \"Enable AWS Security Hub\". 3. On the \"welcome page\", Security standards list the security standards that Security Hub supports. 4. Choose \"Enable Security Hub\". <br><br><b>From Command Line:</b><br> 1. Run the enable-security-hub command. To enable the default standards, include --enable-default-standards.<br><br> aws securityhub enable-security-hub --enable-default-standards.<br><br> 2. To enable the security hub without the default standards, include --no-enable-default-standards.<br><br> aws securityhub enable-security-hub --no-enable-default-standards",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Security groups provide stateful filtering of ingress and egress network traffic to AWS resources.<br> It is recommended that no security group allows unrestricted ingress access to remote server administration ports, such as SSH to port 22 and RDP to port 3389. <br> Public access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise.",
    "displayName": "Ensure no security groups allow ingress from ::/0 to remote server administration ports",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1cc26a92-37a3-490e-bd17-4e52200168a7",
    "implementationEffort": null,
    "name": "1cc26a92-37a3-490e-bd17-4e52200168a7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Login to the AWS Management Console at <a href=\"https://console.aws.amazon.com/vpc/home\">https://console.aws.amazon.com/vpc/home</a>. 2. In the left pane, click \"Security Groups\". 3. For each security group, perform the following:<br> 4. Select the \"security group\". 5. Click the \"Inbound Rules\" tab. 6. Click the \"Edit inbound rules\" button. 7. Identify the rules to be edited or removed. 8. Either A) update the Source field to a range other than ::/0, or, B) Click \"Delete\" to remove the offending inbound rule. 9. Click \"Save rules\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Access keys are long-term credentials for an IAM user or the AWS account 'root' user. <br> You can use access keys to sign programmatic requests to the AWS CLI or AWS API (directly or using the AWS SDK) <br> Access keys are long-term credentials for an IAM user or the AWS account 'root' user.<br> You can use access keys to sign programmatic requests to the AWS CLI or AWS API. <br> One of the best ways to protect your account is to not allow users to have multiple access keys.",
    "displayName": "Ensure there is only one active access key available for any single IAM user",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ae1741bf-b2db-4086-aa35-f6824f671374",
    "implementationEffort": null,
    "name": "ae1741bf-b2db-4086-aa35-f6824f671374",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "<b>From Console:</b><br> 1. Sign in to the AWS Management Console and navigate to IAM dashboard at <a href=\"https://console.aws.amazon.com/iam/\">https://console.aws.amazon.com/iam/</a>. 2. In the left navigation panel, choose \"Users\". 3. Click on the \"IAM\" user name that you want to examine. 4. On the \"IAM\" user configuration page, select \"Security Credentials\" tab. 5. In \"Access Keys\" section, choose one access key that is less than 90 days old.<br> This should be the only active key used by this IAM user to access AWS resources programmatically. Test your application(s) to make sure that the chosen access key is working. 6. In the same \"Access Keys\" section, identify your non-operational access keys (other than the chosen one) and deactivate it by clicking the Make Inactive link. 7. If you receive the Change \"Key Status\" confirmation box, click \"Deactivate\" to switch off the selected key. 8. Repeat steps no. 3 - 7 for each \"IAM\" user in your AWS account. <br><br><b>From Command Line:</b><br> 1. Using the IAM user and access key information provided in the Audit CLI, choose one access key that is less than 90 days old. This should be the only active key used by this IAM user to access AWS resources programmatically. Test your application(s) to make sure that the chosen access key is working. 2. Run the update-access-key command below using the IAM user name and the non-operational access key IDs to deactivate the unnecessary key(s). Refer to the Audit section to identify the unnecessary access key ID for the selected IAM user. <br>Note - the command does not return any output:<br><br> aws iam update-access-key --access-key-id 'access-key-id' --status Inactive --user-name 'user-name' <br><br> 3. To confirm that the selected access key pair has been successfully deactivated run the list-access-keys audit command again for that IAM User:<br><br> aws iam list-access-keys --user-name 'user-name' <br><br>The command output should expose the metadata for each access key associated with the IAM user.<br> If the non-operational key pair(s) Status is set to Inactive, the key has been successfully deactivated and the IAM user access configuration adheres now to this recommendation. 4. Repeat steps no. 1 - 3 for each IAM user in your AWS account.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "With the creation of an AWS account, a 'root user' is created that cannot be disabled or deleted. That user has unrestricted access to and control over all resources in the AWS account.<br> It is highly recommended that the use of this account be avoided for everyday tasks. <br> The 'root user' has unrestricted access to and control over all account resources. <br>Use of it is inconsistent with the principles of least privilege and separation of duties,<br> and can lead to unnecessary harm due to error or account compromise.",
    "displayName": "Eliminate use of the 'root' user for administrative and daily tasks",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f9884933-6108-400f-9e1c-90ec73d095fe",
    "implementationEffort": null,
    "name": "f9884933-6108-400f-9e1c-90ec73d095fe",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/01/2023"
    },
    "remediationDescription": "If you find that the 'root' user account is being used for daily activity to include administrative tasks that do not require the 'root' user:<br><br> 1. Change the 'root' user password. 2. Deactivate or delete any access keys associate with the 'root' user.<br><br> **Remember, anyone who has 'root' user credentials for your AWS account has unrestricted access to and control of all the resources in your account,<br> including billing information.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Auto Scaling groups that are associated with a load balancer are using Elastic Load Balancing health checks. <br> PCI DSS does not require load balancing or highly available configurations. This is recommended by AWS best practices.",
    "displayName": "Auto Scaling groups associated with a load balancer should use health checks",
    "id": "/providers/Microsoft.Security/assessmentMetadata/837d6a45-503f-4c95-bf42-323763960b62",
    "implementationEffort": null,
    "name": "837d6a45-503f-4c95-bf42-323763960b62",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable Elastic Load Balancing health checks: <br />1. Open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.<br />2. On the navigation pane, under \"Auto Scaling\", choose \"Auto Scaling Groups\".<br />3. To select the group from the list, choose the right box.<br />4. From \"Actions\", choose \"Edit\"<br />5. For \"Health Check Type\", choose \"ELB\".<br />6. For \"Health Check Grace Period\", enter \"300\".<br />7. Choose \"Save\".",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "AWS CloudTrail is a web service that records AWS API calls for your account and delivers log files to you. Not all services enable logging by default for all APIs and events. <br> You should implement any additional audit trails other than CloudTrail and review the documentation for each service in CloudTrail Supported Services and Integrations.",
    "displayName": "CloudTrail should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2917bcec-6991-4ea4-9e73-156e6ef831e4",
    "implementationEffort": null,
    "name": "2917bcec-6991-4ea4-9e73-156e6ef831e4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To create a new trail in CloudTrail<br />1. Sign in to the AWS Management Console using the IAM user you configured for CloudTrail administration.<br>2. Open the CloudTrail console at https://console.aws.amazon.com/cloudtrail/.<br>3. Select the AWS Region where you want your trail to be created. <br>4. In the navigation pane, select \"Trails\".<br>5. On the \"Trails\" page, select \"Get Started Now\". If you do not see that option, select \"Create Trail\".<br>6. In\" Trail name\", provide your trail a name, such as My-Management-Events-Trail. As a best practice, use a name that quickly identifies the purpose of the trail. In this case, you're creating a trail that logs management events.<br>7. In \"Management Events\", make sure \"Read/Write\" events is set to \"All\".<br>8. In \"Data Events\", do not make any changes. This trail will not log any data events.<br>9. Create a new S3 bucket for the logs:<br>a. In \"Storage Location\", in \"Create a new S3 bucket\", select \"Yes\".<br>b. In \"S3 bucket\", provide your bucket a name. <br>c. Under \"Advanced\", choose \"Yes\" for both \"Encrypt log files with SSE-KMS\" and \"Enable log file validation\".<br>10. Choose \"Create\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To protect your replicated instances from threats. A private replication instance should have a private IP address that you cannot access outside of the replication network. <br> A replication instance should have a private IP address when the source and target databases are in the same network, and the network is connected to the replication instance's VPC using a VPN, AWS Direct Connect, or VPC peering. <br> You should also ensure that access to your AWS DMS instance configuration is limited to only authorized users. <br> To do this, restrict users' IAM permissions to modify AWS DMS settings and resources.",
    "displayName": "AWS Database Migration Service replication instances should not be public",
    "id": "/providers/Microsoft.Security/assessmentMetadata/132a70b8-ffda-457a-b7a3-e6f2e01fc0af",
    "implementationEffort": null,
    "name": "132a70b8-ffda-457a-b7a3-e6f2e01fc0af",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To configure the AWS DMS replication instances setting to be not publicly accessible: <br>1. Open the AWS Database Migration Service console at https://console.aws.amazon.com/dms/. <br>2. In the left navigation pane, under \"Resource management\", navigate to \"Replication instances\". <br>3. To delete the public instance, select the check box for the instance, choose \"Actions\", then choose \"delete\". <br>4. Choose \"Create replication instance\". Provide the configuration details. <br>5.To disable public access, make sure that \"Publicly accessible\" is not selected. <br>6. Choose \"Create\", <br>Note: public access setting cannot be changed once a replication instance is created. It must be deleted and recreated.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Amazon EBS snapshots should not be publicly restorable by everyone unless explicitly allowed, to avoid accidental exposure of data. Additionally, permission to change Amazon EBS configurations should be restricted to authorized AWS accounts only.",
    "displayName": "Amazon EBS snapshots should not be publicly restorable",
    "id": "/providers/Microsoft.Security/assessmentMetadata/02e8de17-1a01-45cb-b906-6d07a78f4b3c",
    "implementationEffort": null,
    "name": "02e8de17-1a01-45cb-b906-6d07a78f4b3c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Make a public Amazon EBS snapshot private<br>1. Open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.<br>2. In the navigation pane, under \"Elastic Block Store\", select \"Snapshots\" and then select your public snapshot.<br>3. Select \"Actions\", then select \"Modify permissions\".<br>4. Select \"Private\".<br>5. (Optional) Add AWS account numbers for authorized accounts to share your snapshot with.<br>6. Select \"Save\".",
    "severity": "High",
    "tactics": [
      "Collection",
      "Discovery"
    ],
    "techniques": [
      "Data from Cloud Storage Object",
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Security groups should be attached to Amazon EC2 instances or to an ENI. <br> healthy finding can indicate there are unused Amazon EC2 security groups.",
    "displayName": "Unused EC2 security groups should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f065cc7b-f63b-4865-b8ff-4a1292e1a5cb",
    "implementationEffort": null,
    "name": "f065cc7b-f63b-4865-b8ff-4a1292e1a5cb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "The following steps should be applied to each security group not attached to an ENI.<br>To delete a security group:<br>1. Open the Amazon VPC console at https://console.aws.amazon.com/vpc/.<br>2. In the navigation pane, under \"Security\", select \"Security groups\".<br>3. Select the check box for the security group to delete.<br>4. From \"Actions\", select \"Delete security group\".<br>5. Select \"Delete\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Elastic IP addresses that are allocated to a VPC should be attached to Amazon EC2 instances or in-use elastic network interfaces (ENIs).",
    "displayName": "Unused EC2 EIPs should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/601406b5-110c-41be-ad69-9c5661ba5f7c",
    "implementationEffort": null,
    "name": "601406b5-110c-41be-ad69-9c5661ba5f7c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To release an Elastic IP address follow the following steps. Note that in oder to release an address, it shouldn't be associated with an instance<br>1. Open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.<br>2. In the navigation pane, under \"Network &amp; Security\", select \"Elastic IPs\".<br>3. Select the Elastic IP address, select \"Actions\", and then select \"Release Elastic IP address\".<br>4. When prompted, select \"Release\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "To enforce encryption in transit, you should use redirect actions with Application Load Balancers to redirect client HTTP requests to an HTTPS request on port 443.",
    "displayName": "Application Load Balancer should be configured to redirect all HTTP requests to HTTPS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fce0daac-96e4-47ab-ab35-18ac6b7dcc70",
    "implementationEffort": null,
    "name": "fce0daac-96e4-47ab-ab35-18ac6b7dcc70",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To redirect HTTP requests to HTTPS on an Application Load Balancer:<br>1. Open the Amazon EC2 console at https://console.aws.amazon.com/ec2/.<br>2. In the navigation pane, under \"Load Balancing\", select \"Load balancers\".<br>3. Select an Application Load Balancer.<br>4. Select \"Listeners\".<br>5. Enable the check box for an HTTP listener (port 80 TCP) and then select \"Edit\".<br>6. If there is an existing rule, you must delete it. Otherwise, select \"Add action\" and then select \"Redirect to...\".<br>7. Select \"HTTPS\" and then enter 443.<br>8. Select the check mark in a circle symbol and then select \"Update\".",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Credential Access"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "VPC cannot contain domains with a public endpoint. <br>Note: this does not evaluate the VPC subnet routing configuration to determine public reachability.",
    "displayName": "Amazon Elasticsearch Service domains should be in a VPC",
    "id": "/providers/Microsoft.Security/assessmentMetadata/df952171-786d-44b5-b309-9c982bddeb7c",
    "implementationEffort": null,
    "name": "df952171-786d-44b5-b309-9c982bddeb7c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "If you create a domain with a public endpoint, you cannot later place it within a VPC. Instead, you must create a new domain and migrate your data. <br>The reverse is also true. If you create a domain within a VPC, it cannot have a public endpoint. Instead, you must either create another domain or disable this control.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is important to enable encryptions rest of Amazon ES domains to protect sensitive data",
    "displayName": "Amazon Elasticsearch Service domains should have encryption at rest enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cf747c91-14f3-4b30-aafe-eb12c18fd030",
    "implementationEffort": null,
    "name": "cf747c91-14f3-4b30-aafe-eb12c18fd030",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "By default, domains do not encrypt data at rest. <br>To enable the feature, you must create another domain and migrate your data. <br> Note: existing domains cannot be configured to use the feature.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "<p>This control checks whether Amazon GuardDuty is enabled in your GuardDuty account and Region.<p>It is highly recommended that you enable GuardDuty in all supported AWS Regions. Doing so allows GuardDuty to generate findings about unauthorized or unusual activity, even in Regions that you do not actively use. This also allows GuardDuty to monitor CloudTrail events for global AWS services such as IAM.</p>",
    "displayName": "GuardDuty should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4b32e0a4-44a7-4f18-ad92-549f7d219061",
    "implementationEffort": null,
    "name": "4b32e0a4-44a7-4f18-ad92-549f7d219061",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable GuardDuty: <br> 1. Open the GuardDuty console at https://console.aws.amazon.com/guardduty/ \t<br> 2. Choose \"Get Started\". <br> Choose \"Enable GuardDuty\".",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "All IAM users should have multi-factor authentication (MFA) enabled.",
    "displayName": "MFA should be enabled for all IAM users",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9c676d6f-60cb-4c7b-a484-17164c598016",
    "implementationEffort": null,
    "name": "9c676d6f-60cb-4c7b-a484-17164c598016",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To configure MFA for a user: <br>  1. Open the IAM console at https://console.aws.amazon.com/iam/. <br> 2. Select \"Users\".<br> 3. Select the user name of the user to configure MFA for.<br> 4. Select \"Security credentials\" and then Select \"Manage\" next to \"Assigned MFA device\".<br> 5. Follow the \"Manage MFA Device\" wizard to assign the type of device appropriate for your environments.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Checks whether the account password policy for IAM users uses the following minimum configurations.<br> * RequireUppercaseCharacters- Require at least one uppercase character in password. (Default = true)<br>* RequireLowercaseCharacters- Require at least one lowercase character in password. (Default = true)<br>* RequireNumbers- Require at least one number in password. (Default = true) <br>* MinimumPasswordLength- Password minimum length. (Default = 7 or longer)<br> * PasswordReusePrevention- Number of passwords before allowing reuse. (Default = 4) <br> * MaxPasswordAge- Number of days before password expiration. (Default = 90)",
    "displayName": "Password policies for IAM users should have strong configurations",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fd751d04-8378-4cf8-8f1b-594ee340ae08",
    "implementationEffort": null,
    "name": "fd751d04-8378-4cf8-8f1b-594ee340ae08",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To modify the password policy:<br>1. Open the IAM console at https://console.aws.amazon.com/iam/. <br>2. Under \"Access management\", select \"Account settings\".<br>3. Select \"Prevent password reuse\". For \"Number of passwords to remember\", enter \"24\".<br>\t4. Select \"Change password policy\".<br> 5. Select \"Require at least one uppercase letter from Latin alphabet (A-Z)\".<br> 6. Select \"Require at least one lowercase letter from Latin alphabet (a-z)\".<br> 7. Select \"Require at least one non-alphanumeric character (!@#$%^&*()_+-=[]{}|')\".<br> 8. Select \"Require at least one number\". <br> 9. For \"Enforce minimum password length\", enter \"14\".<br> 10. Select \"Enable password expiration\". For \"Expire passwords in day(s)\", enter \"90\".<br> 11. Select \"Save changes\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Lambda function resource-based policy should restrict public access. This recommendation does not check access by internal principals. <br> Ensure access to the function is restricted to authorized principals only by using least privilege resource-based policies.",
    "displayName": "Lambda functions should restrict public access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/64b236a0-f9d7-454a-942a-8c2ba3943cf7",
    "implementationEffort": null,
    "name": "64b236a0-f9d7-454a-942a-8c2ba3943cf7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To use the AWS CLI to revoke function-use permission from an AWS service or another account:</b><br>1. Get the statement ID from the output of GetPolicy, from the AWS CLI and run the following:<br><code>aws lambda get-policy --function-name yourfunctionname</code><br> This returns the policy string associated with the publicly accessible Lambda function.<br>2. From the policy statement returned by the <code>get-policy</code> command, copy the string value of the <code>Sid</code> field, and run from the AWS CLI, run<br><code>aws lambda remove-permission --function-name yourfunctionname --statement-id youridvalue </code><br><br><b>To use the Lambda console to restrict access to the Lambda function:</b><br>1. Open the AWS Lambda console at https://console.aws.amazon.com/lambda/, Navigate to \"Functions\" and then select your publicly accessible Lambda function.<br>2. Under \"Designer\" select the key icon at the top left, that has the tool-tip \"View permissions\".<br>3. Under \"Function policy\", Consider adding the following IAM condition to scope access to your account only.<br><code>\"Condition\":{\"StringEquals\":{\"AWS:SourceAccount\":\"account_id\"}}</code>",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud identified that the VPC configuration (VpcConfig) is not set for Lambda functions that need to access internal resources like databases or APIs. <br>This poses a risk of unauthorized access as functions without a VPC may be exposed to the internet. <br>Configuring a VPC restricts network access and enhances security. <br>Ensure that the VPC configuration has a security config.",
    "displayName": "Network Access Setting & VPC configuration should be enabled on Internet exposed Lambda",
    "id": "/providers/Microsoft.Security/assessmentMetadata/10445918-c305-4c6a-9851-250e8ec7b872",
    "implementationEffort": null,
    "name": "10445918-c305-4c6a-9851-250e8ec7b872",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To review the VPC configuration of Lambda functions:<br>1. In the AWS Management Console, navigate to the Lambda service.<br>2. Select the Lambda function you want to configure.<br>3. Open the VPC configuration section.<br>4. Ensure the function is attached to private subnets (without direct internet access) and associated with appropriate security groups.<br>5. Use the AWS CLI command to verify the VPC configuration: aws lambda get-function-configuration --function-name <FunctionName>.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "We recommend only allowing authorized principals to access the snapshot and change Amazon RDS configuration.",
    "displayName": "RDS snapshots should prohibit public access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f64521fc-a9f1-4d43-b667-8d94b4a202af",
    "implementationEffort": null,
    "name": "f64521fc-a9f1-4d43-b667-8d94b4a202af",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remove public access for Amazon RDS Snapshots:<br/>1. From the Amazon RDS console, https://console.aws.amazon.com/rds/, open \"Snapshots\" and select the public Snapshot to modify.<br/>2. From the \"Actions\" list, select \"Share Snapshots\".<br/>3. From \"DB snapshot visibility\", select \"Private\" and \"for all\".<br/>4. Save your changes.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "We recommend that you also ensure that access to your RDS instance's configuration is limited to authorized users only, by restricting users' IAM permissions to modify RDS instances' settings and resources.",
    "displayName": "RDS DB Instances should prohibit public access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/72f3b7f1-76b8-4cf5-8da5-4ba5745b512c",
    "implementationEffort": null,
    "name": "72f3b7f1-76b8-4cf5-8da5-4ba5745b512c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<b>To remove public access for an Amazon RDS Database, follow one of these procedures:<b><br><br>\"Modify the DB instance's publicly accessible configuration:\"<br>1. From the Amazon RDS console, https://console.aws.amazon.com/rds/, open \"Databases\" and select the public database.<br>2. Select \"Modify\".<br>3. Scroll to \"Network & Security\".<br>4. For the Public accessibility option, select \"No\".<br>5. Scroll to the bottom and select \"Continue\".<br>6. From \"Scheduling of modifications\", select \"Apply immediately\".<br>7. Select \"Modify DB Instance\".<br>\"Configure the VPC subnet security group to prohibit public access:\"<br>1. From the Amazon RDS console, https://console.aws.amazon.com/rds/, open \"Databases\" and select the public database.<br>2. From \"Connectivity & Security\",  select the configured VPC security group.<br>3. From the \"Actions\" list, select \"Edit inbound rules\".<br>4. Define rules to prohibit public access (you can choose between specific IPs, ranges of IPs and security groups).<br>5. Select \"Save rules\".",
    "severity": "High",
    "tactics": [
      "Discovery",
      "Impact"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery",
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "We recommend Amazon Redshift clusters to avoid public accessibility by evaluating the 'publiclyAccessible' field in the cluster configuration item.",
    "displayName": "Amazon Redshift clusters should prohibit public access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7f5ac036-11e1-4cda-89b5-a115b9ae4f72",
    "implementationEffort": null,
    "name": "7f5ac036-11e1-4cda-89b5-a115b9ae4f72",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To disable public access for an Amazon Redshift cluster:<br/>1. From the Amazon RDS console, https://console.aws.amazon.com/redshift/, open   \"Clusters\" and select your public Amazon Redshift cluster.<br/>2. From the \"Cluster\" drop-down menu, select \"Modify cluster\".<br/>3. For the \"Publicly accessible\" option, select \"No\".<br/>4. Select \"Modify\".",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Allowing public write access to your S3 bucket can leave you vulnerable to malicious actions such as storing data at your expense, encrypting your files for ransom, or using your bucket to operate malware.",
    "displayName": "S3 buckets public write access should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/994d14f1-b8d7-4cb3-ad4e-a7ccb08065d5",
    "implementationEffort": null,
    "name": "994d14f1-b8d7-4cb3-ad4e-a7ccb08065d5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remove public write access for an S3 bucket<br>1. Open the AWS console at https://console.aws.amazon.com/s3/ and select the name of the bucket identified in the recommendation.<br>2. Select the \"Permissions\" tab and then select \"Public access settings\".<br>3. Select \"Edit\", select all four options, and then select \"save\".<br>4. If prompted, enter \"confirm\" and then choose \"confirm\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Removing public read access to your S3 bucket can help protect your data and prevent a data breach.",
    "displayName": "S3 buckets public read access should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f65de27c-1b77-4a2d-bc89-8631ff9ee786",
    "implementationEffort": null,
    "name": "f65de27c-1b77-4a2d-bc89-8631ff9ee786",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remove public read access for an S3 bucket<br>1. Open the AWS console at https://console.aws.amazon.com/s3/, and select the name of the bucket identified in the recommendation.<br>2. Select the \"Permissions\" tab and then select \"Public access settings\".<br>3. Select \"Edit\", select all four options, and then select \"save\".<br>4. If prompted, enter \"confirm\" and then choose \"confirm\".",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enabling S3 cross-region replication ensures that multiple versions of the data are available in different distinct Regions. <br> This allows you to protect your S3 bucket against DDoS attacks and data corruption events.",
    "displayName": "S3 buckets should have cross-region replication enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/35713036-bd12-4646-9b92-4c56a761a710",
    "implementationEffort": null,
    "name": "35713036-bd12-4646-9b92-4c56a761a710",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable S3 bucket replication:<br/>1. Open the Amazon S3 console at https://console.aws.amazon.com/s3/ and Select the name of the bucket identified in the recommendation.<br/>2. Select \"Management\" and then select \"Replication\".<br/>3. Select \"add rule\", and then select \"Entire bucket\" as your source bucket.<br>4. Select your destination bucket (Versioning should be enabled on the destination bucket as well).<br/>5. Select an IAM role.<br/>6. Enter a name for the rule, select \"Enabled\" for the status, then select \"Next\".<br/>7. Select \"Save\".",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enable server-side encryption to protect data in your S3 buckets. <br> Encrypting the data can prevent access to sensitive data in the event of a data breach.",
    "displayName": "S3 buckets should have server-side encryption enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3cb793ab-20d3-4677-9723-024c8fed0c23",
    "implementationEffort": null,
    "name": "3cb793ab-20d3-4677-9723-024c8fed0c23",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "<p><strong>To enable default encryption on an S3 bucket</strong></p><ol><li>Open the Amazon S3 console at <a href=\"https://console.aws.amazon.com/s3/\" target=\"_blank\">https://console.aws.amazon.com/s3/</a> and select the name of the bucket identified in the recommendation.</li><li>Select <strong>Properties</strong> and, under the <strong>Default encryption</strong> section, choose one of the following:<ul><li><strong>AES-256</strong> to use keys managed by Amazon S3 (SSE-S3)</li><li><strong>AWS-KMS</strong> to use AWS KMS keys (SSE-KMS)</li><li><strong>DSSE-KMS</strong> to use dual-layer encryption with AWS KMS keys</li></ul><p style=\"margin: 5px 0 0 0; font-size: 13px;\"><em>If you use AWS-KMS or DSSE-KMS for default encryption, choose a KMS key from the list of keys you have created, or enter the ARN of a key in the same Region.</em><br><em>Note: Using AWS KMS is subject to AWS KMS request rate limits. For more information, see the AWS Key Management Service Developer Guide.</em></p></li><li>Select <strong>Save changes</strong>.</li></ol>",
    "severity": "Medium",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Data from Cloud Storage Object"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "We recommend to require requests to use Secure Socket Layer (SSL) on all Amazon S3 bucket. <br> S3 buckets should have policies that require all requests ('Action: S3:*') to only accept transmission of data over HTTPS in the S3 resource policy, indicated by the condition key 'aws:SecureTransport'.",
    "displayName": "S3 buckets should require requests to use Secure Socket Layer",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1fb7ea50-412e-4dd4-ac79-94d54bd8f21e",
    "implementationEffort": null,
    "name": "1fb7ea50-412e-4dd4-ac79-94d54bd8f21e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To configure an S3 bucket to deny nonsecure transport<br>1. Open the Amazon S3 console at https://console.aws.amazon.com/s3/.<br>2. Navigate to the noncompliant bucket, and then choose the bucket name.<br>3. Choose \"Permissions\", then choose \"Bucket Policy\".<br>4. Add a similar policy statement to that in the policy below. Replace \"awsexamplebucket\" with the name of the bucket you are modifying.<br><code>{\"Id\":\"ExamplePolicy\",\"Version\":\"2012-10-17\",\"Statement\":[{\"Sid\":\"AllowSSLRequestsOnly\",\"Action\":\"s3:*\",\"Effect\":\"Deny\",\"Resource\":[\"arn:aws:s3:::awsexamplebucket\",\"arn:aws:s3:::awsexamplebucket/*\"],\"Condition\": {\"Bool\":{\"aws:SecureTransport\":\"false\"}},\"Principal\": \"*\"}]}</code><br>5. Choose \"Save\".",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Enabling Block Public Access setting for your S3 bucket can help prevent sensitive data leaks and protect your bucket from malicious actions.",
    "displayName": "S3 Block Public Access setting should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ac66d910-ae29-4cab-967b-c3f0810b7642",
    "implementationEffort": null,
    "name": "ac66d910-ae29-4cab-967b-c3f0810b7642",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To enable Amazon S3 Block Public Access:<br/>1. Open the Amazon S3 console at https://console.aws.amazon.com/s3/ and then select \"Block public access\" under \"account settings\".<br/>2. Select \"Edit\" and then select \"Block all public access\".<br/>3. Select \"Save changes\".",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Storage Object Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Direct internet access should be disabled for an SageMaker notebook instance. <br> This checks whether the 'DirectInternetAccess' field is disabled for the notebook instance. <br> Your instance should be configured with a VPC and the default setting should be Disable - Access the internet through a VPC. <br> In order to enable internet access to train or host models from a notebook, make sure that your VPC has a NAT gateway and your security group allows outbound connections. Ensure access to your SageMaker configuration is limited to only authorized users, and restrict users' IAM permissions to modify SageMaker settings and resources.",
    "displayName": "Disable direct internet access for Amazon SageMaker notebook instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0991c64b-ccf5-4408-aee9-2ef03d460020",
    "implementationEffort": null,
    "name": "0991c64b-ccf5-4408-aee9-2ef03d460020",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "Note that you can't change the internet access setting after a notebook instance is created. It must be stopped, deleted, and recreated.<br/>To configure an SageMaker notebook instance to deny direct internet access:<br/>1. From the SageMaker console, https://console.aws.amazon.com/sagemaker/, open \"Notebook instances\" and delete the instance that has direct internet access enabled.<br/> 2. Select the instance, open \"Actions\", and select \"Stop\". When the instance has stopped, open \"Actions\", and select \"Delete\".<br/>3. Select \"Create notebook instance\" and enter the configuration details.<br/>4. Expand the \"Network\" section and select the VPC, subnet, and security group. Under \"Direct internet access\", select \"Disable &mdash; Access the internet through a VPC\".<br/>5. Select \"Create notebook instance\".",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Discovery"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This control checks whether an Application Load Balancer is associated with an AWS WAF Classic or AWS WAF web access control list (web ACL). The control fails if the Enabled field for the AWS WAF configuration is set to false.",
    "displayName": "Application Load Balancers should be associated with an AWS WAF web ACL",
    "id": "/providers/Microsoft.Security/assessmentMetadata/705beecb-5e6d-42f8-8c43-9206cb9e8b64",
    "implementationEffort": null,
    "name": "705beecb-5e6d-42f8-8c43-9206cb9e8b64",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "To associate an Application Load Balancer with a web ACL, see, <a href='https://docs.aws.amazon.com/waf/latest/developerguide/web-acl-associating-aws-resource.html'>Associating or disassociating a web ACL with an AWS resource</a>  in the AWS WAF Developer Guide.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Initial Access"
    ],
    "techniques": [
      "Network Service Scanning",
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "This control checks whether root access is turned on for an Amazon SageMaker notebook instance. The control fails if root access is turned on for a SageMaker notebook instance.",
    "displayName": "Users should not have root access to SageMaker notebook instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9e929ffe-2973-47c0-b37d-6c66d69724f1",
    "implementationEffort": null,
    "name": "9e929ffe-2973-47c0-b37d-6c66d69724f1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/18/2024"
    },
    "remediationDescription": "To restrict root access to SageMaker notebook instances, see <a href='https://docs.aws.amazon.com/sagemaker/latest/dg/nbi-root-access.html'>Control root access to a SageMaker notebook instance</a> in the Amazon SageMaker Developer Guide.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is COMPLIANT or NON_COMPLIANT after the patch installation on the instance.<br>It only checks instances that are managed by AWS Systems Manager Patch Manager.<br>It does not check whether the patch was applied within the 30-day limit prescribed by PCI DSS requirement '6.2'.<br>It also does not validate whether the patches applied were classified as security patches.<br>You should create patching groups with the appropriate baseline settings and ensure in-scope systems are managed by those patch groups in Systems Manager. For more information about patch groups, see the <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-patch-group-tagging.html\">AWS Systems Manager User Guide</a>.",
    "displayName": "Amazon EC2 instances managed by Systems Manager should have a patch compliance status of COMPLIANT after a patch installation",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5b3c2887-d7b7-4887-b074-4e6057027709",
    "implementationEffort": null,
    "name": "5b3c2887-d7b7-4887-b074-4e6057027709",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "\"To remediate noncompliant patches\"<br>This rule checks whether the compliance status of the Amazon EC2 Systems Manager patch compliance is COMPLIANT or NON_COMPLIANT. To find out more about patch compliance states, see the <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/about-patch-compliance-states.html\">AWS Systems Manager User Guide</a>.<br>1. Open the AWS Systems Manager console at https://console.aws.amazon.com/systems-manager/.<br>2. In the navigation pane, under \"Node Management\", choose \"Run Command\".<br>3. Choose \"Run command\".<br>4. Choose the radio button next to AWS-RunPatchBaseline and then change the \"Operation\" to \"Install\".<br>5. Choose \"Choose instances manually\" and then choose the noncompliant instance(s).<br>6. Scroll to the bottom and then choose \"Run\".<br>7. After the command has completed, to monitor the new compliance status of your patched instances, in the navigation pane, choose \"Compliance\".<br>See the AWS Systems Manager User Guide for more information about the following<br>* <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/patch-manager-ssm-documents.html\">Using Systems Manager documents to patch a managed instance</a><br>* <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/run-command.html\">Running commands using the Systems Manager Run command</a>",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether the status of the AWS Systems Manager association compliance is COMPLIANT or NON_COMPLIANT after the association is run on an instance. The control passes if the association compliance status is COMPLIANT.<br/>A State Manager association is a configuration that is assigned to your managed instances. The configuration defines the state that you want to maintain on your instances. For example, an association can specify that antivirus software must be installed and running on your instances, or that certain ports must be closed.<br/>After you create one or more State Manager associations, compliance status information is immediately available to you in the console or in response to AWS CLI commands or corresponding Systems Manager API operations. For associations, \"Configuration\" Compliance shows statuses of Compliant or Non-compliant and the severity level assigned to the association, such as \"Critical\" or \"Medium\". To learn more about State Manager association compliance, see About <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-compliance-about.html#sysman-compliance-about-association\">About State Manager association compliance</a> in the AWS Systems Manager User Guide.<br/>You must configure your in-scope EC2 instances for Systems Manager association. You must also configure the patch baseline for the security rating of the vendor of patches, and set the autoapproval date to meet PCI DSS '3.2.1' requirement '6.2'. For additional guidance on how to <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-state-assoc.html\">Create an association</a>, see Create an association in the AWS Systems Manager User Guide. For additional information on working with patching in Systems Manager, see <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-patch.html\"> AWS Systems Manager Patch Manager</a> in the AWS Systems Manager User Guide.",
    "displayName": "Instances managed by Systems Manager should have an association compliance status of COMPLIANT",
    "id": "/providers/Microsoft.Security/assessmentMetadata/67a90ae0-b3d1-44f0-9dcf-a03234ebeb65",
    "implementationEffort": null,
    "name": "67a90ae0-b3d1-44f0-9dcf-a03234ebeb65",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "A failed association can be related to different things, including targets and SSM document names. To remediate this issue, you must first identify and investigate the association. You can then update the association to correct the specific issue.<br>You can edit an association to specify a new name, schedule, severity level, or targets. After you edit an association, Systems Manager creates a new version.<br>\"To investigate and update a failed association\"<br>1. Open the AWS Systems Manager console at https://console.aws.amazon.com/systems-manager/.<br>2. In the navigation pane, under \"Node Management\", choose \"Fleet Manager\".<br>3. Choose the instance ID that has an \"Association status\" of \"Failed\".<br>4. Choose \"View details\".<br>5. Choose \"Associations\".<br>6. Note the name of the association that has an \"Association status\" of \"Failed\". This is the association that you need to investigate. You need to use the association name in the next step.<br>7. In the navigation pane,under \"Node Management\", choose \"State Manager\". Search for the association name, then select the association. After you determine the issue, edit the failed association to correct the problem. For information on how to edit an association, see <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-state-assoc-edit.html\"> Edit an association</a>.<br>For more information on creating and editing State Manager associations, see <a href=\"https://docs.aws.amazon.com/systems-manager/latest/userguide/systems-manager-associations.html\">Working with associations in Systems Manager</a> in the AWS Systems Manager User Guide.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Status of the Amazon EC2 Systems Manager patch compliance is 'COMPLIANT' or 'NON_COMPLIANT' after the patch installation on the instance. <br> Only  instances that are managed by AWS Systems Manager Patch Manager are checked. Patches that were applied within the 30-day limit prescribed by PCI DSS requirement '6' are not checked. ",
    "displayName": "EC2 instances should be managed by AWS Systems Manager",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4be5393d-cc33-4ef7-acae-80295bc3ae35",
    "implementationEffort": null,
    "name": "4be5393d-cc33-4ef7-acae-80295bc3ae35",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To ensure EC2 instances are managed by Systems Manager:<br/>1. From the AWS Systems Manager console, https://console.aws.amazon.com/systems-manager/, select \"Quick setup\".<br/>2. Leave the default options.<br/>3. Select \"Set up Systems Manager\".",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether the GitHub or Bitbucket source repository URL contains either personal access tokens or a user name and password.<br>Authentication credentials should never be stored or transmitted in clear text or appear in the repository URL. Instead of personal access tokens or user name and password, you should use OAuth to grant authorization for accessing GitHub or Bitbucket repositories.<br> Using personal access tokens or a user name and password could expose your credentials to unintended data exposure and unauthorized access.",
    "displayName": "CodeBuild GitHub or Bitbucket source repository URLs should use OAuth",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9694d4ef-f21a-40b7-b535-618ac5c5d21e",
    "implementationEffort": null,
    "name": "9694d4ef-f21a-40b7-b535-618ac5c5d21e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "You can update your CodeBuild project to use OAuth.<br><b>To remove basic authentication / (GitHub) Personal Access Token from CodeBuild project source</b><br>1. Open the CodeBuild console at <a href='https://console.aws.amazon.com/codebuild/'>https://console.aws.amazon.com/codebuild/</a>.<br>2. Choose the build project that contains personal access tokens or a user name and password.<br>3. From \"Edit\", choose \"Source\".<br>4. Choose \"Disconnect from GitHub / Bitbucket\".<br>5. Choose \"Connect using OAuth\", then choose \"Connect to GitHub / Bitbucket\".<br>6. When prompted, choose \"authorize as appropriate\".<br>7. Reconfigure your repository URL and additional configuration settings, as needed.<br>8. Choose \"Update source\".<br> For more information, refer to <a href='https://docs.aws.amazon.com/codebuild/latest/userguide/use-case-based-samples.html'>CodeBuild use case-based samples</a> the AWS CodeBuild User Guide.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This control checks whether the project contains the environment variables <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code>.<br>Authentication credentials <code>AWS_ACCESS_KEY_ID</code> and <code>AWS_SECRET_ACCESS_KEY</code> should never be stored in clear text, as this could lead to unintended data exposure and unauthorized access.",
    "displayName": "CodeBuild project environment variables should not contain credentials",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a88b4b72-b461-4b5e-b024-91da1cbe500f",
    "implementationEffort": null,
    "name": "a88b4b72-b461-4b5e-b024-91da1cbe500f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "09/15/2021"
    },
    "remediationDescription": "To remediate this issue, update your CodeBuild project to remove the environment variable.<br><b>To remove environment variables from a CodeBuild project</b><br>1. Open the CodeBuild console at <a href='https://console.aws.amazon.com/codebuild/'>https://console.aws.amazon.com/codebuild/</a>.<br>2. Expand \"Build\".<br>3. Choose \"Build project\", and then choose the build project that contains plaintext credentials.<br>4. From \"Edit\", choose \"Environment\".<br>5. Expand \"Additional configuration\".<br>6. Choose \"Update environment\".<br><br><b>To store sensitive values in the Amazon EC2 Systems Manager Parameter Store and then retrieve them from your build spec</b><br>1. Open the CodeBuild console at <a href='https://console.aws.amazon.com/codebuild/'>https://console.aws.amazon.com/codebuild/</a>.<br>2. Expand \"Build\".<br>3. Choose \"Build project\", and then choose the build project that contains plaintext credentials.<br>4. From \"Edit\", choose \"Environment\".<br>5. Expand \"Additional configuration\" and scroll to \"Environment variables\".<br>6. Follow <a href='https://docs.aws.amazon.com/systems-manager/latest/userguide/sysman-paramstore-console.html'>this tutorial</a> to create a Systems Manager parameter that contains your sensitive data.<br>7. After you create the parameter, copy the parameter name.<br>8. Back in the CodeBuild console, choose \"Create environmental variable\".<br>9. Enter the name of your variable as it appears in your build spec.<br>10. For \"Value\", paste the name of your parameter.<br>11. For \"Type\", choose \"Parameter\".<br>12. To remove your noncompliant environmental variable that contains plaintext credentials, choose \"Remove\".<br>13. Choose \"Update environment\".<br>For more information, see <a href='https://docs.aws.amazon.com/codebuild/latest/userguide/build-env-ref-env-vars.html'>Environment variables in build environments</a> in the AWS CodeBuild User Guide.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that client certificates are available for users to authenticate to your GKE clusters. Once issued, these certificates cannot be revoked. This poses a risk of unauthorized access to your clusters, as compromised certificates could be used by attackers to gain access and potentially exploit your cluster resources. We recommend disabling client certificate authentication when creating your GKE clusters to mitigate these risks. Use alternative mechanisms provided by Kubernetes, such as OIDC, in place of client certificates.",
    "displayName": "Client certificate authentication should be disabled for users in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1be3fe01-9e7b-4eea-89b7-b0ce15b5a9b3",
    "implementationEffort": null,
    "name": "1be3fe01-9e7b-4eea-89b7-b0ce15b5a9b3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/22/2024"
    },
    "remediationDescription": "It is not possible to remove a client certificate from an existing cluster. To create a new cluster without generating a client certificate: 1. In the Google Cloud console, navigate to \"Kubernetes Engine\" and click on \"Create\". 2. Click on the \"Security\" tab. 3. Under \"Legacy security options\", uncheck the box \"Issue a client certificate\". 4. Enter other required information and click \"Create\". 5. Migrate workloads from the old cluster to the new cluster. 6. Delete the old cluster. <br>For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/api-server-authentication#disabling_authentication_with_a_client_certificate\">disabling authentication with a client certificate</a>.",
    "severity": "High",
    "tactics": [
      "Defense Evasion",
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Unsecured Credentials",
      "Access Token Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that anonymous authentication is enabled on nodes in your GKE clusters. This poses a risk of unauthorized access to your cluster where an attacker can access resources without authenticating. We recommend disabling anonymous requests on nodes in your clusters.",
    "displayName": "Anonymous authentication should be disabled on nodes in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/78a80c33-c3b9-473f-af9f-fbbbf90d5405",
    "implementationEffort": null,
    "name": "78a80c33-c3b9-473f-af9f-fbbbf90d5405",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/09/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to disable anonymous authentication: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"authentication\": { \"anonymous\": { \"enabled\": false } }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Discovery"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Valid Accounts",
      "External Remote Services",
      "Network Service Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that unauthorized requests are allowed on nodes in your GKE clusters. This poses a risk of unauthorized access to your cluster where an attacker can access resources without going through authorization. We recommend enabling explicit request authorization in your cluster.",
    "displayName": "Explicit request authorization should be enabled on nodes in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5af1436d-b92a-4e35-812c-df95c4963e1f",
    "implementationEffort": null,
    "name": "5af1436d-b92a-4e35-812c-df95c4963e1f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/09/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to require explicit request authorization: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following sections: <pre><code>\"authentication\": { \"webhook\": { \"enabled\": true } } </code></pre> <pre><code>\"authorization\": { \"mode\": \"Webhook\" }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Privilege Escalation"
    ],
    "techniques": [
      "Create or Modify System Process",
      "Scheduled Task/Job",
      "Valid Accounts",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that a client certificate file is not configured and authentication using client certificates is not enabled on nodes in your GKE clusters. This poses a risk of unauthorized access and potential manipulation of the kubelet. Without proper authentication, attackers can potentially execute commands or perform actions with the same privileges as the kubelet itself. We recommend enabling client certificate authentication on nodes in your GKE clusters.",
    "displayName": "Client certificate authentication should be enabled on nodes in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/addce29d-9817-4801-b58e-d1930726fad2",
    "implementationEffort": null,
    "name": "addce29d-9817-4801-b58e-d1930726fad2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/09/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable client certificate authentication: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"authentication\": { \"x509\": { \"clientCAFile\": \"[path-to-client-ca-file]\" } }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Unsecured Credentials",
      "Steal or Forge Kerberos Tickets",
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud identified that iptables are being managed manually on nodes in your GKE clusters. This poses a risk of overly permissive or restrictive network policies which can allow unauthorized access for attackers or block necessary communication. We recommend enabling the makeIPTablesUtilChains configuration option to allow kubelet to manage iptables in your GKE clusters.",
    "displayName": "Automatic iptables management should be enabled on nodes in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/826367d0-88a1-42e9-8c07-a06c637d49a8",
    "implementationEffort": null,
    "name": "826367d0-88a1-42e9-8c07-a06c637d49a8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/09/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable the automatic management of iptables: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"makeIPTablesUtilChains\": true</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the event recording limit is not configured on nodes in your GKE clusters. This poses a risk of insufficient logging where an attacker can perform malicious activities without being detected due to inadequate event recording. We recommend setting the eventRecordQPS argument to an appropriate value for your cluster.",
    "displayName": "Event recording limit should be configured on nodes in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0fda1656-45e9-424c-82e5-8adfbe3df15e",
    "implementationEffort": null,
    "name": "0fda1656-45e9-424c-82e5-8adfbe3df15e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/09/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to set an event recording limit on nodes in your cluster: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"eventRecordQPS\": [value]</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Deobfuscate/Decode Files or Information"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Defender for Cloud identified that the rotate certificates setting is not enabled on nodes in your GKE clusters. This poses a risk of the kubelet suffering downtime due to an expired certificate. We recommend enabling the rotate certificates setting on nodes in your GKE clusters.",
    "displayName": "Certificate rotation should be enabled on nodes in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/78922d46-9763-400e-9f57-e49b50024d41",
    "implementationEffort": null,
    "name": "78922d46-9763-400e-9f57-e49b50024d41",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/10/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable certificate rotation on nodes in your cluster: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"rotateCertificates\": true</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that server certificate rotation is not enabled on your GKE clusters. This poses a risk of the kubelet suffering downtime due to an expired certificate. We recommend enabling the RotateKubeletServerCertificate setting on your GKE clusters.",
    "displayName": "Server certificate rotation should be enabled on nodes in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f27fdbbe-dda9-4c03-b401-c3730fda1a8f",
    "implementationEffort": null,
    "name": "f27fdbbe-dda9-4c03-b401-c3730fda1a8f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/09/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable kubelet server certificate rotation: 1. SSH into each worker node. 2. Edit the kubelet config file and add the following section: <pre><code>\"featureGates\": { \"RotateKubeletServerCertificate\": true }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the cluster admin role is being used in your GKE clusters. This poses a risk of an attacker gaining full control over every resource in the cluster. We recommend removing the cluster admin role binding from all entities in your clusters.",
    "displayName": "The cluster admin role should not be used in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d7c13ec0-3d17-4232-aba5-2b1f40f25bd2",
    "implementationEffort": null,
    "name": "d7c13ec0-3d17-4232-aba5-2b1f40f25bd2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/19/2024"
    },
    "remediationDescription": "To remove the cluster-admin role from all entities in your clusters: 1. In the gcloud CLI, run the following command to retrieve the list of clusterrolebindings for cluster-admin: <pre><code>kubectl get clusterrolebindings -o json | jq -r '.items[] | select(.roleRef.name==\"cluster-admin\") | .metadata.name</code></pre> 2. For each clusterrolebinding returned (except those starting with \"system:\"), run the following command: <code>kubectl delete clusterrolebinding [clusterrolebinding-name]</code> <br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl\">cluster access for kubectl</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Persistence"
    ],
    "techniques": [
      "Valid Accounts",
      "Abuse Elevation Control Mechanism",
      "Create or Modify System Process",
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Defender for Cloud identified that user accounts in your GKE clusters have get, list, or watch access to secret objects. This poses a risk, as attackers with access to these user accounts could gain additional access to the Kubernetes cluster or external resources. This access would allow them to view data contained in secret objects. We recommend removing get, list, and watch access to secret objects in your GKE clusters.",
    "displayName": "Access to secret objects should be restricted in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9f218fcd-1291-4c44-ac73-b85a4ef1b346",
    "implementationEffort": null,
    "name": "9f218fcd-1291-4c44-ac73-b85a4ef1b346",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/04/2024"
    },
    "remediationDescription": "To remove access to secret objects in your GKE clusters: 1. In the gcloud CLI, run the following command to list the roles and cluster roles: <pre><code> kubectl get role,clusterrole -A -o yaml > roles.yaml</code></pre> 2. Identify the nonessential roles and cluster roles that have get, list, or watch access to secret objects. 3. For each role identified, run the following command to get the definition: <pre><code>kubectl get role [role name] -n [namespace] -o yaml > [role name].yaml</code></pre> 4. For each cluster role identified, run the following command to get the definition: <pre><code>kubectl get clusterrole [cluster role name] -o yaml > [cluster role name].yaml</code></pre> 5. For each role and cluster role, edit the YAML file to remove the rule containing the permissions \"get\", \"list\", or \"watch\" on object type \"secrets\". 6. For each role and cluster role, run the following command to apply the change: <pre><code>kubectl apply -f [role or cluster role name].yaml</code></pre> Before removing permissions from a role or cluster role, ensure that applications do not require the permissions. Do not remove permissions from the system cluster roles that are required for system components to function. For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl\">cluster access for kubectl</a>, <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/#role-example\">using RBAC authorization</a>, and <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/#default-roles-and-role-bindings\">default roles</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Credential Access"
    ],
    "techniques": [
      "Account Manipulation",
      "Credentials from Password Stores",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that wildcards are present in roles and cluster roles on your GKE clusters. This poses a risk of privilege escalation, allowing users or services to perform unintended actions across multiple resources. We recommend eliminating the use of wildcards in roles and cluster roles on your GKE clusters and assigning more specific permissions to enforce the principle of least privilege.",
    "displayName": "Wildcards in roles should be removed in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/575bb35d-70f3-4049-948b-7e631201b19f",
    "implementationEffort": null,
    "name": "575bb35d-70f3-4049-948b-7e631201b19f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/19/2024"
    },
    "remediationDescription": "To eliminate wildcard use in roles and cluster roles: 1. In the gcloud CLI, run the following command to identify roles using wildcards: <pre><code>kubectl get roles --all-namespaces -o json | jq '.items[] | select(.rules[]? | (.resources[]? == \"*\" or .verbs[]? == \"*\")) | .metadata.namespace + \"/\" + .metadata.name'</code></pre> 2. Run the following command to identify cluster roles using wildcards: <pre><code>kubectl get clusterroles -o json | jq '.items[] | select(.rules[]? | (.resources[]? == \"*\" or .verbs[]? == \"*\")) | .metadata.name'</code></pre> 3. Update the identified roles and cluster roles to replace wildcards with specific objects and actions.<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/best-practices/rbac#no-wildcards\">best practices for GKE RBAC</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Persistence"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Valid Accounts",
      "Create or Modify System Process",
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that default service accounts are used in your GKE clusters. Kubernetes creates a default service account for each namespace. Default service accounts are not tied to any specific workload and may have broad permissions. This poses a risk of unauthorized access to cluster resources. We recommend using custom service accounts with the required privileges and disabling automatic mounting of service account access tokens in pods to mitigate these risks.",
    "displayName": "Default service accounts should not be used in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f1340674-137f-4ec6-bc66-6a691518c925",
    "implementationEffort": null,
    "name": "f1340674-137f-4ec6-bc66-6a691518c925",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/27/2024"
    },
    "remediationDescription": "To remove permissions from the default service accounts and add a new custom service account in your GKE cluster, perform the following steps for each namespace: 1. In the gcloud CLI, run the following command to create a Kubernetes service account: <pre><code>kubectl create serviceaccount [your-service-account-name] --namespace=[your-namespace-name]</code></pre> 2. Run the following command for each role that needs to be bound to the service account: <pre><code>kubectl create rolebinding [role-binding-name] --role=[role-name] --serviceaccount=[namespace-name]:[service-account-name]</code></pre> 3. Update the \"serviceAccountName\" key in your deployment YAML file with the newly created service account name. 4. Apply the updated deployment manifest by running the following command: <pre><code>kubectl apply -f [deployment-yaml-file-name]</code></pre> 5. Run the following command to get the deployment file for the default service account: <pre><code>kubectl get serviceaccount default -n [your-namespace] -o yaml > default.yaml</code></pre> 6. Edit the \"default.yaml\" file and add the following to the end of the file with no indentation: <pre><code>automountServiceAccountToken: false</code></pre> 7. Run the following command to import the updated default service account configuration: <pre><code>kubectl apply -f default.yaml</code></pre> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl\">cluster access for kubectl</a>, <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/#kubectl-create-rolebinding\">create rolebinding</a>, and <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/#opt-out-of-api-credential-automounting\">opt out of API credential automounting</a>.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation",
      "Persistence"
    ],
    "techniques": [
      "Account Manipulation",
      "Valid Accounts",
      "Create or Modify System Process",
      "Access Token Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that service account tokens are automatically mounted inside pods in your GKE clusters. This poses a risk of a privilege escalation attack where an attacker can compromise a single pod in the cluster and gain additional access to the Kubernetes cluster and its resources. We recommend disabling the automounting of service account tokens inside pods to ensure clusters remain secure.",
    "displayName": "Service Account Tokens should be mounted only where necessary in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4e86f3a3-c9fd-43c4-975c-37820134de6a",
    "implementationEffort": null,
    "name": "4e86f3a3-c9fd-43c4-975c-37820134de6a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/04/2024"
    },
    "remediationDescription": "To disable automount of service account tokens in pods: 1. In the gcloud CLI, run the following command to identify pods that have the service account token mounted: <pre><code>kubectl get pods --all-namespaces -o json | jq '.items[] | select(.spec.automountServiceAccountToken == null or .spec.automountServiceAccountToken == true) | {name: .metadata.name, namespace: .metadata.namespace}'</code></pre> 2. Update the pod manifests for the identified resources (Note: Do not make any changes to pods in the kube-system, gke-managed-cim, or gmp-system namespaces) using the following configuration: \"spec: automountServiceAccountToken: false\" 3. Run the following command to apply the changes to updated pods: <pre><code>kubectl apply -f [path_to_your_pod_manifest.yaml]</code></pre> 4. Update all service account manifests using the following configuration: \"automountServiceAccountToken: false\" 5. Run the following command to apply the changes to the identified service accounts: <pre><code>kubectl apply -f [path_to_your_service_account_manifest.yaml]</code></pre> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl\">cluster access for kubectl</a> and <a href=\"https://kubernetes.io/docs/concepts/security/service-accounts/#assign-to-pod\">assign a service account to a pod</a>.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Unsecured Credentials",
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Defender for Cloud identified the use of bind, impersonate, and escalate privileges on your GKE clusters. This poses a risk of privilege escalation because these permissions allow subjects to elevate their privileges beyond what is explicitly granted by cluster administrators. We recommend minimizing the use of these permissions in your GKE clusters to prevent unauthorized access and security breaches.",
    "displayName": "Access to bind, impersonate, and escalate permissions should be limited in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6f63f6be-fa7a-4612-a6ef-5c4f88689e57",
    "implementationEffort": null,
    "name": "6f63f6be-fa7a-4612-a6ef-5c4f88689e57",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/26/2024"
    },
    "remediationDescription": "To limit access to bind, impersonate and escalate permissions in your GKE clusters: 1. In the gcloud CLI, identify the ClusterRoles and Roles with access to bind permissions using the following command: <pre><code>kubectl get clusterroles,roles -A -o json | jq -r '.items[] | select(.rules[]?.verbs[]? == \"bind\") | .metadata.name'</code></pre> 2. Identify the ClusterRoles and Roles with access to impersonate permissions using the following command: <pre><code>kubectl get clusterroles,roles -A -o json | jq -r '.items[] | select(.rules[]?.verbs[]? == \"impersonate\") | .metadata.name'</code></pre> 3. Identify the ClusterRoles and Roles with access to escalate permissions using the following command: <pre><code>kubectl get clusterroles,roles -A -o json | jq -r '.items[] | select(.rules[]?.verbs[]? == \"escalate\") | .metadata.name'</code></pre> 4. For each Role identified, run the following command to get the definition: <pre><code>kubectl get role [role name] -n [namespace] -o yaml > [role name].yaml</code></pre> 5. For each ClusterRole identified, run the following command to get the definition: <pre><code>kubectl get clusterrole [cluster role name] -o yaml > [cluster role name].yaml</code></pre> 6. For each Role and ClusterRole, edit the YAML file to remove the rule containing \"bind\", \"impersonate\", or \"escalate\". 7. For each Role and ClusterRole, run the following command to apply the change: <pre><code>kubectl apply -f [role or cluster role name].yaml</code></pre> Before removing these permissions from a role, ensure that applications do not require these permissions. Do not remove these permissions from the system cluster roles that are required for system components to function. For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl\">cluster access for kubectl</a> and <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/#role-example\">using RBAC authorization</a>.",
    "severity": "High",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that non-default roles are assigned to the unauthenticated group in your GKE clusters. This poses a risk of exposing sensitive data or functionality because it grants access to resources for users who are not authenticated. We recommend removing non-default RoleBindings and ClusterRoleBindings to system:unauthenticated in your GKE clusters.",
    "displayName": "Permissions to the unauthenticated group should be removed in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/81498eee-8df6-41d3-a3b3-296e50d3accc",
    "implementationEffort": null,
    "name": "81498eee-8df6-41d3-a3b3-296e50d3accc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/26/2024"
    },
    "remediationDescription": "To remove roles and cluster roles from the unauthenticated group in your clusters: 1. In the gcloud CLI, run the following command to identify ClusterRoleBindings: <pre><code>kubectl get clusterrolebindings -o json | jq -r '[\"Name\"], [\"-----\"], (.items[] | select((.subjects | length) > 0) | select(any(.subjects[]; .name == \"system:unauthenticated\")) | [.metadata.namespace, .metadata.name]) | @tsv'</code></pre> 2. Run the following command to identify RoleBindings: <pre><code>kubectl get rolebindings -A -o json | jq -r '[\"Name\"], [\"-----\"], (.items[] | select((.subjects | length) > 0) | select(any(.subjects[]; .name == \"system:unauthenticated\")) | [.metadata.namespace, .metadata.name]) | @tsv'</code></pre> 3. Run the following command to remove the unnecessary ClusterRoleBindings: <pre><code>kubectl delete clusterrolebinding [clusterrolebinding-name]</code></pre> 4. Run the following command to remove the unnecessary RoleBindings: <pre><code>kubectl delete rolebinding [rolebinding-name]</code></pre> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl\">cluster access for kubectl</a> and <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control#rolebinding\">assign roles</a>.",
    "severity": "High",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Defender for Cloud identified that non-default roles are assigned to the authenticated group in your GKE clusters. This poses a risk of privilege escalation which can lead to unauthorized access to resources in your cluster. Any user with a Google account is automatically a member of the authenticated group, even those not specifically authorized to your cluster. We recommend removing non-default RoleBindings and ClusterRoleBindings to system:authenticated in your GKE clusters.",
    "displayName": "Permissions to the authenticated group should be removed in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8b0b278e-3246-4284-9f0c-51372bd61b43",
    "implementationEffort": null,
    "name": "8b0b278e-3246-4284-9f0c-51372bd61b43",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/24/2024"
    },
    "remediationDescription": "To remove roles and cluster roles from the authenticated group in your GKE clusters: 1. In the gcloud CLI, run the following command to identify ClusterRoleBindings: <pre><code>kubectl get clusterrolebindings -o json | jq -r '[\"Name\"], [\"-----\"], (.items[] | select((.subjects | length) > 0) | select(any(.subjects[]; .name == \"system:authenticated\")) | [.metadata.namespace, .metadata.name]) | @tsv'</code></pre> 2. Run the following command to identify RoleBindings: <pre><code>kubectl get rolebindings -A -o json | jq -r '[\"Name\"], [\"-----\"], (.items[] | select((.subjects | length) > 0) | select(any(.subjects[]; .name == \"system:authenticated\")) | [.metadata.namespace, .metadata.name]) | @tsv'</code></pre> 3. Run the following command to remove the unnecessary ClusterRoleBindings: <pre><code>kubectl delete clusterrolebinding [clusterrolebinding-name]</code></pre> 4. Run the following command to remove the unnecessary RoleBindings: <pre><code>kubectl delete rolebinding [rolebinding-name]</code></pre> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/cluster-access-for-kubectl\">cluster access for kubectl</a> and <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control#rolebinding\">assign roles</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Defense Evasion"
    ],
    "techniques": [
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism",
      "Masquerading"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that network policies are not associated with the namespaces in your GKE clusters. A network policy specifies rules to control traffic flow across the cluster. This poses a risk of unauthorized access and data breaches because without network policies, all traffic is allowed for the pods associated with a namespace. We recommend defining network policies for all namespaces in your GKE clusters to mitigate these risks.",
    "displayName": "Network policies should be configured for namespaces in GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/de53419d-bd91-4c15-adae-77488981008a",
    "implementationEffort": null,
    "name": "de53419d-bd91-4c15-adae-77488981008a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/23/2024"
    },
    "remediationDescription": "To create network policies for the namespaces in your GKE clusters: 1. In the gcloud CLI, run the following command to enable the network policy add-on: <pre><code>gcloud container clusters update [cluster-name] --update-addons=NetworkPolicy=ENABLED </code></pre> 2. Run the following command to enable network policy enforcement on your cluster: <pre><code>gcloud container clusters update [cluster-name] --enable-network-policy</code></pre> 3. Define each namespace's network policy in a YAML manifest file, making sure to specify the ingress and egress rules. 4. Use \"namespaceSelector\" in the manifest file to associate the policy with a namespace. 5. Apply the network policy in the cluster using the following command: <pre><code>kubectl apply -f [yaml-file]</code></pre> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/network-policy#console\">Kubernetes network policy enforcement</a> and <a href=\"https://kubernetes.io/docs/concepts/services-networking/network-policies/\">network policies</a>.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Impact"
    ],
    "techniques": [
      "Impair Defenses",
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the default namespace is being used in your GKE clusters. This poses a risk of unauthorized access to your cluster resources as the default namespace is accessible to everyone with access to the cluster. The default namespace also makes it difficult to apply RBAC and security controls to specific cluster resources. We recommend placing your resources into non-default namespaces in your GKE clusters to mitigate these risks.",
    "displayName": "The default namespace should not be used in GKE Clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9d3ea157-d1e5-4e27-9b04-460bb5834ae9",
    "implementationEffort": null,
    "name": "9d3ea157-d1e5-4e27-9b04-460bb5834ae9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/23/2024"
    },
    "remediationDescription": "To create new namespaces and deploy resources within them in your GKE clusters: 1. In the gcloud CLI, run the following command to create a namespace: <code>kubectl create namespace [namespace-name]</code> 2. Run the following command to deploy your Kubernetes resources in the namespace: <code>kubectl apply -f [YAML-file-name] --namespace=[namespace-name]</code><br> For more details, follow the instructions in <a href=\"https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/\">namespaces</a> and <a href=\"https://kubernetes.io/docs/tasks/administer-cluster/namespaces/#creating-a-new-namespace\">creating a new namespace</a>.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Impact"
    ],
    "techniques": [
      "Valid Accounts",
      "Abuse Elevation Control Mechanism",
      "Network Denial of Service",
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the database encryption property, 'key': 'databaseEncryption.state', 'value': 'ENCRYPTED'.",
    "displayName": "Ensure Kubernetes Secrets are encrypted using keys managed in Cloud KMS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9df787f7-dfbf-4ebc-8864-655316bfe760",
    "implementationEffort": null,
    "name": "9df787f7-dfbf-4ebc-8864-655316bfe760",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "To enable Application-layer Secrets Encryption, several configuration items are required. These include:<br>1. A key ring<br>2. A key<br>3. A GKE service account with Cloud KMS CryptoKey Encrypter/Decrypter role<br><br>Once these are created, Application-layer Secrets Encryption can be enabled on an existing or new cluster.<br><br>Using Google Cloud Console:<br>To create a key<br>1. Go to Cloud KMS by visiting <a href=\"https://console.cloud.google.com/security/kms\">https://console.cloud.google.com/security/kms</a>.<br>2. Select CREATE KEY RING.<br>3. Enter a Key ring name and the region where the keys will be stored.<br>4. Click CREATE.<br>5. Enter a Key name and appropriate rotation period within the Create key pane.<br>6. Click CREATE.<br><br>To enable on an existing cluster:<br>1. Go to Kubernetes Engine by visiting: <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a>.<br>2. Select the cluster to be updated.<br>3. Under the Details pane, within the Security heading, click on the pencil named Application-layer secrets encryption.<br>4. Enable Encrypt secrets at the application layer and choose a kms key.<br>5. Click SAVE CHANGES.<br><br>Using Command Line:<br>Create a key ring:<br><code>gcloud kms keyrings create {ring_name} --location {location} --project {key_project_id}</code><br><br>Create a key:<br><code>gcloud kms keys create {key_name} --location {location} --keyring {ring_name} --purpose encryption --project {key_project_id}</code><br><br>Grant the Kubernetes Engine Service Agent service account the Cloud KMS CryptoKey Encrypter/Decrypter role:<br><code>gcloud kms keys add-iam-policy-binding {key_name} --location {location} --keyring {ring_name} --member serviceAccount:{service_account_name} --role roles/cloudkms.cryptoKeyEncrypterDecrypter --project {key_project_id}</code><br><br>To enable on an existing cluster:<br><code>gcloud container clusters update {cluster_name} --zone {zone} --database-encryption-key projects/{key_project_id}/locations/{location}/keyRings/{ring_name}/cryptoKeys/{key_name} --project {cluster_project_id}</code>",
    "severity": "High",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the config property of a node pool for the key-value pair 'key': 'config.metadata['disable-legacy-endpoints']', 'value': true.",
    "displayName": "Ensure legacy Compute Engine instance metadata APIs are Disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/383540a2-31d4-40ab-9051-8eda511295f4",
    "implementationEffort": null,
    "name": "383540a2-31d4-40ab-9051-8eda511295f4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "The legacy GCE metadata endpoint must be disabled upon the cluster or node-pool creation.<br>For GKE versions 1.12 and newer, the legacy GCE metadata endpoint is disabled by default.<br><br>Using Google Cloud Console:<br>To update an existing cluster, create a new Node pool with the legacy GCE metadata endpoint disabled:<br>1. Go to Kubernetes Engine by visiting <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a><br>2. Click on the name of cluster to be upgraded and click ADD NODE POOL.<br>3. Navigate to the Metadata pane and ensure that GCE instance metadata is set to the key:value pair of disable-legacy-endpoints: true<br>4. Click SAVE<br><br>Workloads will need be be migrated from any existing non-conforming Node pools, to the new Node pool, then delete non-conforming Node pools to complete the remediation.<br><br>Using Command Line:<br>To update an existing cluster, create a new Node pool with the legacy GCE metadata endpoint disabled:<br><code>gcloud container node-pools create {node_pool_name} --metadata disable-legacy-endpoints=true --cluster {cluster_name} --zone {compute_zone}</code><br><br>You will need to migrate workloads from any existing non-conforming Node pools, to the new Node pool, then delete non-conforming Node pools to complete the remediation.",
    "severity": "Low",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the config property of a node pool for the key-value pair, 'key': 'config.workloadMetadataConfig.mode', 'value': 'GKE_METADATA'.",
    "displayName": "Ensure the GKE Metadata Server is Enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a2c41d29-552a-45e4-9961-7cd98134749a",
    "implementationEffort": null,
    "name": "a2c41d29-552a-45e4-9961-7cd98134749a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "The GKE Metadata Server requires Workload Identity to be enabled on a cluster. Modify the cluster to enable Workload Identity and enable the GKE Metadata Server.<br><br>Using Google Cloud Console:<br>1. Go to Kubernetes Engine by visiting <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a><br>2. From the list of clusters, select the cluster for which Workload Identity is disabled.<br>3. Under the DETAILS pane, navigate down to the Security subsection.4. Click on the pencil icon named Edit Workload Identity, click on Enable Workload Identity in the pop-up window, and select a workload pool from the drop-down box. By default, it will be the namespace of the Cloud project containing the cluster, for example: <project_id>.svc.id.goog.<br>5. Click SAVE CHANGES and wait for the cluster to update.<br>6. Once the cluster has updated, select each Node pool within the cluster Details page.<br>7. For each Node pool, select EDIT within the Node pool details page.<br>8. Within the Edit node pool pane, check the Enable GKE Metadata Server checkbox.<br>9. Click SAVE.<br><br>Using Command Line:<br><code>gcloud container clusters update {cluster_name} --identity-namespace={project_id}.svc.id.goog</code><br>Note that existing Node pools are unaffected. New Node pools default to --workload-metadata-from-node=GKE_METADATA_SERVER.<br><br>To modify an existing Node pool to enable GKE Metadata Server:<br><code>gcloud container node-pools update {node_pool_name} --cluster={cluster_name} --workload-metadata-from-node=GKE_METADATA_SERVER</code><br>Workloads may need modification in order for them to use Workload Identity as described within: <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity\">https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity</a>.",
    "severity": "Low",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud identified that release channels are not configured on your GKE clusters. This poses a risk of unmanaged version updates, potentially exposing the cluster to unpatched vulnerabilities. We recommend enforcing release channels to automate version management and ensure clusters remain secure and up to date.",
    "displayName": "Release channels should be configured on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5e060fbd-6d3a-4dcb-8abb-35b98498a3ef",
    "implementationEffort": null,
    "name": "5e060fbd-6d3a-4dcb-8abb-35b98498a3ef",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/11/2024"
    },
    "remediationDescription": "To configure release channels in your GKE clusters at the time of provisioning:<br> 1. In the Google Cloud Console, navigate to \"Kubernetes Engine\" and click \"Clusters\". 2. Click \"Create\" and select \"Configure\" for the required cluster mode. 3. Under the \"Release channel\" section, click the \"Release channel\" drop-down menu. 4. Select \"Regular\" or \"Stable\" from the drop-down. 5. Configure the remaining cluster settings as required. 6. Click \"Create\". 7. Migrate workloads from the old cluster to the new cluster. 8. Delete the old cluster. <br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels\">release channels guide</a>.",
    "severity": "Low",
    "tactics": [
      "Defense Evasion",
      "Initial Access"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Masquerading",
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that Shielded GKE Nodes are not enabled on your GKE clusters. Shielded GKE nodes protect clusters against boot- or kernel-level malware or rootkits. This poses a risk of unauthorized access and tampering with node integrity. We recommend enabling Shielded GKE Nodes on GKE clusters to mitigate these risks.",
    "displayName": "Shielded GKE Nodes should be enabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9deb856f-5178-4215-973b-b0a83f456521",
    "implementationEffort": null,
    "name": "9deb856f-5178-4215-973b-b0a83f456521",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "To enable Shielded GKE Nodes in your existing GKE clusters: 1. In the Google Cloud console, navigate to \"Kubernetes Engine\". 2. Select the cluster for which Shielded GKE Nodes needs to be enabled. 3. Under the \"Security\" section in the \"Details\" pane, click the edit icon next to \"Shielded GKE nodes\". 4. Check the box labeled \"Enable shielded GKE nodes\". 5. Click \"Save Changes\".<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#enabling_in_an_existing_cluster\">enabling Shielded GKE Nodes in an existing cluster</a>.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Defense Evasion"
    ],
    "techniques": [
      "Boot or Logon Autostart Execution",
      "Masquerading"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that integrity monitoring is not enabled for the shielded GKE nodes in your GKE clusters. This poses a risk of undetected malicious activity. Integrity monitoring alerts you in case of an integrity failure and prevents compromised nodes from being deployed into the cluster. Without this feature, any unauthorized modifications could go unnoticed, potentially compromising the security and integrity of your cluster. We recommend enabling integrity monitoring for shielded GKE nodes in your GKE cluster to mitigate these risks.",
    "displayName": "Integrity monitoring should be enabled on shielded GKE nodes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8b33b0e4-0523-40eb-b561-4b4193869e6c",
    "implementationEffort": null,
    "name": "8b33b0e4-0523-40eb-b561-4b4193869e6c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "To enable integrity monitoring for shielded GKE nodes in your GKE clusters: 1. In the Google Cloud console, navigate to \"Kubernetes Engine\". 2. Select the cluster for which integrity monitoring needs to be enabled. 3. Click \"Add Node Pool\". 4. Ensure that the \"Enable integrity monitoring\" checkbox is checked under the \"Shielded options\" header. 5. Click \"Save\". 6. Migrate workloads from the old node pool to the new one. 7. Delete the old node pool. <br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/shielded-gke-nodes#integrity_monitoring\">integrity monitoring.</a>",
    "severity": "Medium",
    "tactics": [
      "Persistence"
    ],
    "techniques": [
      "Boot or Logon Autostart Execution"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the config property of a node pool for the key-value pair, 'key': 'config.shieldedInstanceConfig.enableSecureBoot', 'value': true.",
    "displayName": "Ensure Secure Boot for Shielded GKE Nodes is Enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b4b05ff3-f938-4813-8003-64fa9699ceba",
    "implementationEffort": null,
    "name": "b4b05ff3-f938-4813-8003-64fa9699ceba",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "Once a Node pool is provisioned, it cannot be updated to enable Secure Boot.<br>New Node pools must be created within the cluster with Secure Boot enabled.<br><br>Using Google Cloud Console:<br> 1. Go to Kubernetes Engine by visiting: <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a><br>2. From the list of clusters, click on the cluster requiring the update and click ADD NODE POOL.<br>3. Ensure that the Secure boot checkbox is checked under the Shielded options Heading.<br>4. Click SAVE.<br><br>Workloads will need to be migrated from existing non-conforming Node pools to the newly created Node pool, then delete the non-conforming pools.<br><br>Using Command Line:<br>To create a Node pool within the cluster with Secure Boot enabled, run the following command:<br><code>gcloud container node-pools create {node_pool_name} --cluster {cluster_name} --zone {compute_zone} --shielded-secure-boot</code><br><br>Workloads will need to be migrated from existing non-conforming Node pools to the newly created Node pool, then delete the non-conforming pools.",
    "severity": "Low",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the network config property for the key-value pair, 'key': 'networkConfig.enableIntraNodeVisibility', 'value': true.",
    "displayName": "Enable VPC Flow Logs and Intranode Visibility",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4c6ca2c7-5984-47cd-a6ad-9eac5e194cb5",
    "implementationEffort": null,
    "name": "4c6ca2c7-5984-47cd-a6ad-9eac5e194cb5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "Enable Intranode Visibility:<br><br>Using Google Cloud Console:<br>1. Go to Kubernetes Engine by visiting: <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a>.<br>2. Select Kubernetes clusters for which intranode visibility is disabled.<br>3. Within the Details pane, under the Network section, click on the pencil icon named Edit intranode visibility.<br>4. Check the box next to Enable Intranode visibility.<br>5. Click SAVE CHANGES.<br><br>Using Command Line:<br>To enable intranode visibility on an existing cluster, run the following command:<br><code>gcloud container clusters update {cluster_name} --enable-intra-node-visibility</code><br><br>Enable VPC Flow Logs:<br><br>Using Google Cloud Console:<br>1. Go to Kubernetes Engine by visiting: <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a>.<br>2. Select Kubernetes clusters for which VPC Flow Logs are disabled.<br>3. Select Nodes tab.<br>4. Select Node Pool without VPC Flow Logs enabled.<br>5. Select an Instance Group within the node pool.<br>6. Select an Instance Group Member.<br>7. Select the Subnetwork under Network Interfaces.<br>8. Click on EDIT.<br>9. Set Flow logs to On.<br>10. Click SAVE.<br><br>Using Command Line:<br>1. Find the subnetwork name associated with the cluster.<br><code>gcloud container clusters describe {cluster_name} --region {cluster_region} --format json | jq '.subnetwork'</code><br><br>2. Update the subnetwork to enable VPC Flow Logs.<br><code>gcloud compute networks subnets update {subnet_name} --enable-flow-logs</code>",
    "severity": "Low",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the private cluster config property for the key-value pair, 'key': 'privateClusterConfig.enablePrivateEndpoint', 'value': true.",
    "displayName": "Ensure clusters are created with Private Endpoint Enabled and Public Access Disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a2b3786f-853e-4c19-bbdf-8bdad4f6ba60",
    "implementationEffort": null,
    "name": "a2b3786f-853e-4c19-bbdf-8bdad4f6ba60",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "Once a cluster is created without enabling Private Endpoint only, it cannot be remediated. Rather, the cluster must be recreated.<br><br>Using Google Cloud Console:<br>1. Go to Kubernetes Engine by visiting: <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a><br>2. Click CREATE CLUSTER, and choose CONFIGURE for the Standard mode cluster.<br>3. Configure the cluster as required then click Networking under CLUSTER in the navigation pane.<br>4. Under IPv4 network access, click the Private cluster radio button.<br>5. Uncheck the Access control plane using its external IP address checkbox.<br>6. In the Control plane IP range textbox, provide an IP range for the control plane.<br>7. Configure the other settings as required, and click CREATE.<br><br>Using Command Line:<br>Create a cluster with a Private Endpoint enabled and Public Access disabled by including the --enable-private-endpoint flag within the cluster create command:<br><code>gcloud container clusters create {cluster_name} --enable-private-endpoint</code><br><br>Setting this flag also requires the setting of <code>--enable-private-nodes</code>, <code>--enable-ip-alias</code> and <code>--master-ipv4-cidr={master_cidr_range}</code>.",
    "severity": "High",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that authentication using client certificates is enabled on your GKE clusters. This poses a risk of unauthorized access and broadens the attack surface for cluster compromise. Client certificates are only base64 encoded and not encrypted. They also require the additional management overhead of key management and rotation. We recommend disabling client certificate authentication for your GKE clusters and switching to secure authentication mechanisms like OpenID Connect tokens.",
    "displayName": "Client certificate authentication should be disabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/99c226ab-946a-44ea-8d89-456bca2a344a",
    "implementationEffort": null,
    "name": "99c226ab-946a-44ea-8d89-456bca2a344a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "To disable client certificate authentication while creating a new GKE cluster: 1. In the gcloud CLI, run the following command to create a cluster without generating a client certificate: <code>gcloud container clusters create [cluster_name] --no-issue-client-certificate</code> 2. Migrate your existing workloads from the non-compliant cluster to the new one. 3. Remove the non-compliant cluster. <br>For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/how-to/api-server-authentication#disabling_authentication_with_a_client_certificate\">disabling authentication with a client certificate</a>.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Trusted Relationship",
      "Subvert Trust Controls"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that Kubernetes alpha features are enabled on your GKE clusters. Alpha clusters expire after thirty days, are not covered by an SLA, and do not receive security updates. This poses a risk of unauthorized access to your cluster due to alpha features being enabled or due to unpatched security vulnerabilities. We recommend disabling alpha features when creating GKE clusters.",
    "displayName": "Alpha features should not be enabled on GKE clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1ab645b5-5b20-49af-adff-1ad1c17db30c",
    "implementationEffort": null,
    "name": "1ab645b5-5b20-49af-adff-1ad1c17db30c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "It is not possible to disable alpha features on an existing cluster. To create a new cluster without enabling alpha features: 1. In the Google Cloud console, navigate to \"Kubernetes Engine\" and click on \"Create\". 2. Configure the cluster settings without selecting \"Enable Kubernetes alpha features in this cluster\" 3. Click \"Create\". 4. Migrate workloads from the old cluster to the new cluster. 5. Delete the old cluster.<br> For more details, follow the instructions in <a href=\"https://cloud.google.com/kubernetes-engine/docs/concepts/feature-gates#alpha\">alpha Kubernetes features</a>.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "This recommendation evaluates the binary authorization property for for the key-value pair, 'key': 'binaryAuthorization.enabled', 'value': true.",
    "displayName": "Ensure use of Binary Authorization",
    "id": "/providers/Microsoft.Security/assessmentMetadata/22dcd4dd-6019-4cf2-bb1b-42dc8fd73d36",
    "implementationEffort": null,
    "name": "22dcd4dd-6019-4cf2-bb1b-42dc8fd73d36",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2024"
    },
    "remediationDescription": "Using Google Cloud Console:<br>1. Go to Binary Authorization by visiting: <a href=\"https://console.cloud.google.com/security/binary-authorization\">https://console.cloud.google.com/security/binary-authorization</a>.<br>2. Enable the Binary Authorization API (if disabled).<br>3. Create an appropriate policy for use with the cluster. See <a href=\"https://cloud.google.com/binary-authorization/docs/policy-yaml-reference\">https://cloud.google.com/binary-authorization/docs/policy-yaml-reference</a> for guidance.<br>4. Go to Kubernetes Engine by visiting: <a href=\"https://console.cloud.google.com/kubernetes/list\">https://console.cloud.google.com/kubernetes/list</a>.<br>5. Select the cluster for which Binary Authorization is disabled.<br>6. Under the details pane, within the Security section, click on the pencil icon named Edit Binary Authorization.<br>7. Check the box next to Enable Binary Authorization.<br>8. Choose whether to Audit, Enforce or both Audit and Enforce the policy and provide a directory for the policy to be used.<br>9. Click SAVE CHANGES.<br><br>Using Command Line:<br>Update the cluster to enable Binary Authorization:<br><code>gcloud container cluster update {cluster_name} --zone {compute_zone} --binauthz-evaluation-mode={evaluation_mode}</code><br><br>See: <a href=\"https://cloud.google.com/sdk/gcloud/reference/container/clusters/update#--binauthz-evaluation-mode\">https://cloud.google.com/sdk/gcloud/reference/container/clusters/update#--binauthz-evaluation-mode</a> for more details around the evaluation modes available.<br><br>Create a Binary Authorization Policy using the Binary Authorization Policy Reference: <a href=\"https://cloud.google.com/binary-authorization/docs/policy-yaml-reference\">https://cloud.google.com/binary-authorization/docs/policy-yaml-reference</a> for guidance.<br>Import the policy file into Binary Authorization:<br><code>gcloud container binauthz policy import {yaml_policy}</code>",
    "severity": "High",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that anonymous authentication is enabled on nodes in your Amazon EKS clusters. This poses a risk of unauthorized access to your cluster where an attacker can access resources without authenticating. We recommend disabling anonymous requests on nodes in your Amazon EKS clusters.",
    "displayName": "Anonymous authentication should be disabled on nodes in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cbb7eb4c-dbc2-458e-a15b-65233cbc0fbb",
    "implementationEffort": null,
    "name": "cbb7eb4c-dbc2-458e-a15b-65233cbc0fbb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to disable anonymous authentication: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"authentication\": { \"anonymous\": { \"enabled\": false } }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that unauthorized requests are allowed on nodes in your Amazon EKS clusters. This poses a risk of unauthorized access to your cluster where an attacker can access resources without going through authorization. We recommend enabling explicit request authorization in your cluster.",
    "displayName": "Explicit request authorization should be enabled on nodes in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7586e01d-021f-479e-986b-a137916c9d19",
    "implementationEffort": null,
    "name": "7586e01d-021f-479e-986b-a137916c9d19",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to require explicit request authorization: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following sections: <pre><code>\"authentication\": { \"webhook\": { \"enabled\": true } } </code></pre> <pre><code>\"authorization\": { \"mode\": \"Webhook\" }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that a client certificate file is not configured and authentication using client certificates is not enabled on nodes in your Amazon EKS clusters. This poses a risk of unauthorized access and potential manipulation of the kubelet. Without proper authentication, attackers can potentially execute commands or perform actions with the same privileges as the kubelet itself. We recommend enabling client certificate authentication on nodes in your Amazon EKS clusters.",
    "displayName": "Client certificate authentication should be enabled on nodes in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/69c1d788-fa42-4ba6-a71b-96826e26d3a8",
    "implementationEffort": null,
    "name": "69c1d788-fa42-4ba6-a71b-96826e26d3a8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable client certificate authentication: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"authentication\": { \"x509\": { \"clientCAFile\": \"[path-to-client-ca-file]\" } }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the idle timeout is disabled on nodes in your Amazon EKS clusters. This poses a risk of denial-of-service attacks, inactive connections, and port exhaustion. We recommend configuring an idle timeout on nodes in your clusters.",
    "displayName": "Idle timeout should be configured on nodes in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bf969d7d-dc0d-4b40-9b0e-e4a7e6cc97ba",
    "implementationEffort": null,
    "name": "bf969d7d-dc0d-4b40-9b0e-e4a7e6cc97ba",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to configure an idle timeout: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"streamingConnectionIdleTimeout\": \"4h0m0s\" </code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that iptables are being managed manually on nodes in your Amazon EKS clusters. This poses a risk of overly permissive or restrictive network policies which can allow unauthorized access for attackers or block necessary communication. We recommend enabling the makeIPTablesUtilChains configuration option to allow kubelet to manage iptables in your Amazon EKS clusters.",
    "displayName": "Automatic iptables management should be enabled on nodes in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7ef93dbd-feae-4fdd-bea9-5fecbbaa8384",
    "implementationEffort": null,
    "name": "7ef93dbd-feae-4fdd-bea9-5fecbbaa8384",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable the automatic management of iptables: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"makeIPTablesUtilChains\": true</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Network Denial of Service"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the event recording limit is not configured on nodes in your Amazon EKS clusters. This poses a risk of insufficient logging where an attacker can perform malicious activities without being detected due to inadequate event recording. We recommend setting the eventRecordQPS argument to an appropriate value for your cluster.",
    "displayName": "Event recording limit should be configured on nodes in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/775b22a7-ddea-4f7a-91a0-7f8df81de24b",
    "implementationEffort": null,
    "name": "775b22a7-ddea-4f7a-91a0-7f8df81de24b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to set an event recording limit on nodes in your cluster: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"eventRecordQPS\": [value]</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Indicator Removal on Host"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that client certificate rotation is not enabled on kubelets in your Amazon EKS clusters. This poses a risk of client certificates expiring without being replaced, potentially leading to extended service disruptions and violating availability within the CIA (Confidentiality, Integrity, and Availability) security triad. We recommend enabling certificate rotation on kubelets to mitigate this risk.",
    "displayName": "Client certificate rotation should be enabled on kubelets in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9d152691-254d-414d-b4cb-0e4626785ba0",
    "implementationEffort": null,
    "name": "9d152691-254d-414d-b4cb-0e4626785ba0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/13/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable client certificate rotation on kubelets in your EKS clusters:  1. SSH into each worker node. 2. Edit the kubelet config file and set \"rotateCertificates\" to \"true\". 3. Restart the kubelet service. <br>Note: Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Persistence",
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials",
      "Account Manipulation",
      "Create or Modify System Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that server certificate rotation is not enabled on your Amazon EKS clusters. This poses a risk of the kubelet suffering downtime due to an expired certificate. We recommend enabling the RotateKubeletServerCertificate setting on your Amazon EKS clusters.",
    "displayName": "Server certificate rotation should be enabled on nodes in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e4ceea88-fee1-4904-a801-5a7fae68c695",
    "implementationEffort": null,
    "name": "e4ceea88-fee1-4904-a801-5a7fae68c695",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable kubelet server certificate rotation: 1. SSH into each worker node. 2. Edit the kubelet config file and add the following section: <pre><code>\"featureGates\": { \"RotateKubeletServerCertificate\": true }</code></pre> Your cloud service provider manages this part of the Kubernetes infrastructure and does not provide a method for administrators to remediate this issue. Please contact your cloud service provider for further assistance addressing this issue.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the cluster admin role is being used in your Amazon EKS clusters. This poses a risk of an attacker gaining full control over every resource in the cluster. We recommend removing the cluster admin role binding from all entities in your clusters.",
    "displayName": "The cluster admin role should not be used in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fc97d3cd-158b-46a3-bfe9-522a872d35d5",
    "implementationEffort": null,
    "name": "fc97d3cd-158b-46a3-bfe9-522a872d35d5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/09/2024"
    },
    "remediationDescription": "To remove the \"cluster-admin\" role from principals in your Amazon EKS clusters: 1. In the AWS CLI, run the following command to obtain a list of cluster role bindings with the \"cluster-admin\" role: <pre><code> kubectl get clusterrolebindings -o=custom-columns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].name</code></pre> 2. Remove the unnecessary cluster role bindings to the \"cluster-admin\" role by running the following command : <code>kubectl delete clusterrolebinding [name]</code> 3. Obtain a list of role bindings with the \"cluster-admin\" role by running the command:<pre><code> kubectl get rolebindings --all-namespaces -o=custom-columns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].name</code></pre> 4. Run the following command to remove unnecessary role bindings to the \"cluster-admin\" role: <code>kubectl delete rolebinding [rolebinding-name] -n [namespace]</code><br> Note: Carefully review the cluster role bindings and role bindings before deleting them, as some may be essential for the operation of the cluster. <br>For more information, follow the instructions in <a target=\"_blank\" href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/#rolebinding-and-clusterrolebinding\">Kubernetes RBAC</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Defense Evasion"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Access Token Manipulation",
      "Masquerading"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that user accounts in your Amazon EKS clusters have get, list, or watch access to secret objects. This poses a risk, as attackers with access to these user accounts could gain additional access to the Kubernetes cluster or external resources. This access would allow them to view data contained in secret objects. We recommend removing get, list, and watch access to secret objects in your clusters.",
    "displayName": "Access to secret objects should be restricted in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8927d84c-dc26-4277-ab79-fe0f31f0d8f9",
    "implementationEffort": null,
    "name": "8927d84c-dc26-4277-ab79-fe0f31f0d8f9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/09/2024"
    },
    "remediationDescription": "To remove get, watch, and list access to secret objects in your Amazon EKS clusters:<br>Remediation steps for Roles:<br>1. Identify current RoleBindings: <code>kubectl get rolebindings --all-namespaces</code>. 2. Review the role definition: <code> kubectl describe role [role-name] -n [namespace]</code>. 3. If you find a RoleBinding that grants pod creation access, you can either edit or delete it: <code>kubectl edit rolebinding [rolebinding-name] -n [namespace]</code>. 4. Remove or modify the rules that allow \"get,watch,list\" on \"secrets\" resource. 5. Apply the updated role <code>kubectl apply -f restricted-role.yaml</code>.<br>Remediation steps for ClusterRoles:<br>1. Identify current ClusterRoleBindings <code>kubectl get clusterrolebindings</code>. 2. Review the ClusterRole definitions: <code>kubectl describe clusterrole [clusterrole-name]</code>. 3. If you find a ClusterRoleBinding that grants pod creation access, you can either edit or delete it: <code> kubectl edit clusterrolebinding [clusterrolebinding-name]</code>. 4. Remove or modify the rules that allow \"get,watch,list\" on \"secrets\" resource. 5. Apply the updated cluster role: <code>kubectl apply -f restricted-role.yaml</code>.<br>For more details, follow the instructions in <a target=\"_blank\" href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\">Kubernetes RBAC</a>.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified the use of wildcard characters in roles in your Amazon EKS clusters. This poses a risk as overly permissive rules may inadvertently grant permission to unauthorized users and expose sensitive resources. We recommend specifying exact resources and actions in roles to ensure your clusters remain secure.",
    "displayName": "Wildcards in roles should be removed in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ac53f75a-7831-45b0-b254-87831e3b7d28",
    "implementationEffort": null,
    "name": "ac53f75a-7831-45b0-b254-87831e3b7d28",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "To update role permissions in your Amazon EKS clusters: 1. In the AWS CLI, run the following command to identify roles using wildcards: <pre><code> kubectl get roles --all-namespaces -o json | jq '.items[] | select(.rules[]? | (.resources[]? == \"*\" or .verbs[]? == \"*\")) | .metadata.namespace + \"/\" + .metadata.name</code></pre> 2. Assess the requirement for the permissions in each role identified (Note: ignore any roles in the kube-system or eks-* namespaces). 3. Run the following command to apply any changes to roles: <pre><code> kubectl apply -f [path-to-your-role-yaml-file]</code></pre> For more details, follow the instructions in <a target=\"_blank\" href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\">Kubernetes RBAC</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Persistence"
    ],
    "techniques": [
      "Valid Accounts",
      "Create or Modify System Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified the use of wildcard characters in cluster roles in your Amazon EKS clusters. This poses a risk as overly permissive rules may inadvertently grant permission to unauthorized users and expose sensitive resources. We recommend specifying exact resources and actions in cluster roles to ensure your clusters remain secure.",
    "displayName": "Wildcards in cluster roles should be removed in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2d553b48-b15e-4b99-b1c6-670d9e882a4b",
    "implementationEffort": null,
    "name": "2d553b48-b15e-4b99-b1c6-670d9e882a4b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "To update cluster role permissions in your Amazon EKS clusters: 1. In the AWS CLI, run the following command to identify cluster roles using wildcards: <pre><code>kubectl get clusterroles -o json | jq '.items[] | select(.rules[]? | (.resources[]? == \"*\" or .verbs[]? == \"*\")) | .metadata.name'</code></pre> 2. Assess the requirement for the permissions in each cluster role identified (Note: ignore any cluster roles in the kube-system or eks-* namespaces). 3. Run the following command to apply changes to cluster roles: <pre><code> kubectl apply -f [path-to-your-clusterrole-yaml-file]</code></pre> For more details, follow the instructions in <a target=\"_blank\" href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/\">Kubernetes RBAC</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Persistence"
    ],
    "techniques": [
      "Valid Accounts",
      "Create or Modify System Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that non-system roles are authorized to create pods in your Amazon EKS clusters. This poses a risk of unauthorized access leading to data breaches, privilege escalation, and lateral movement within the cluster. We recommend adhering to the principle of least privilege by removing the create pod permission from non-system roles in your clusters.",
    "displayName": "Access to create pods should be restricted on Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a022693c-cfae-43a5-86d7-9bec995fdd9c",
    "implementationEffort": null,
    "name": "a022693c-cfae-43a5-86d7-9bec995fdd9c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/09/2024"
    },
    "remediationDescription": "To remove role access to create pod permissions: 1. In the AWS CLI, run the following command to identify RoleBindings that have access to create pods:<pre><code>kubectl get roles --all-namespaces -o json | jq -r ' .items[] | select(.rules[]? | select(.resources and (.resources | index(\"pods\")) and .verbs and (.verbs | index(\"create\")))) | \"Namespace: \\(.metadata.namespace) - Role: \\(.metadata.name)\" ' | while read -r line; do namespace=$(echo \"$line\" | awk '{print $2}'); role=$(echo \"$line\" | awk '{print $4}'); echo \"$line\"; kubectl get rolebindings -n \"$namespace\" -o json | jq --arg role \"$role\" -r ' .items[] | select(.roleRef.name == $role) | .metadata.name ' | while read -r binding; do echo \" RoleBinding: $binding\"; done; done</code></pre> 2. Run the following command to identify ClusterRoleBindings that have access to create pods:<pre><code>kubectl get clusterroles -o json | jq -r ' .items[] | select(.rules[]? | select(.resources and (.resources | index(\"pods\")) and .verbs and (.verbs | index(\"create\")))) | \"ClusterRole: \\(.metadata.name)\" ' | while read -r line; do cluster_role=$(echo \"$line\" | awk '{print $2}'); echo \"$line\"; kubectl get clusterrolebindings -o json | jq --arg role \"$cluster_role\" -r ' .items[] | select(.roleRef.name == $role) | .metadata.name ' | while read -r binding; do echo \" ClusterRoleBinding: $binding\"; done; done</code></pre> 3. Run the following command to remove unnecessary ClusterRoleBindings: <pre><code>kubectl delete clusterrolebinding [clusterrolebinding-name]</code></pre> 4. Run the following command to remove unnecessary RoleBindings: <pre><code>kubectl delete rolebinding [rolebinding-name] --namespace [namespace]</code></pre>For more details, follow the instructions in <a href=\"https://kubernetes.io/docs/reference/access-authn-authz/rbac/#default-roles-and-role-bindings\">default roles and role bindings</a>.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation",
      "Defense Evasion"
    ],
    "techniques": [
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism",
      "Masquerading"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified the use of default service accounts in your Amazon EKS clusters. Kubernetes creates default service accounts for each namespace, which are not tied to any specific workload and may have broad permissions. This poses a risk of unauthorized access to cluster resources. We recommend using custom service accounts with the required privileges and disabling automatic mounting of service account access tokens in pods to mitigate these risks.",
    "displayName": "Default service accounts should not be actively used in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0ea77e8b-f497-49b7-b96d-6327b9027e31",
    "implementationEffort": null,
    "name": "0ea77e8b-f497-49b7-b96d-6327b9027e31",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "To create custom service accounts and remove permissions from the default service accounts in your Amazon EKS clusters: 1. In the AWS CLI, run the following command to create a service account: <pre><code>kubectl create serviceaccount [service-account-name] -n [namespace]</code></pre> 2. To bind the necessary roles to the newly created service account and verify it has the required permissions, run the following command: <pre><code>kubectl create rolebinding [rolebinding-name] --serviceaccount=[namespace]:[service-account-name] --clusterrole=[cluster-role] -n [namespace]</code></pre> 3. To edit the default service account configuration to disable automatic mounting of service account tokens, run the following command: <pre><code>kubectl edit serviceaccount default -n [namespace]</code></pre> 4. Add the following line to the configuration: <pre>\"automountServiceAccountToken: false\"</pre> 5. Apply this change to the default service accounts in all namespaces, except the namespaces needed for the Kubernetes system to function. <br> For more details, follow the instructions in <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/\">configure service accounts for pods</a>.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation",
      "Defense Evasion"
    ],
    "techniques": [
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism",
      "Masquerading"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that service account tokens are automatically mounted inside pods in your Amazon EKS clusters. This poses a risk of a privilege escalation attack where an attacker can compromise a single pod in the cluster and gain additional access to the Kubernetes cluster and its resources. We recommend disabling the automounting of service account tokens inside pods to ensure your clusters remain secure.",
    "displayName": "Service account tokens should be mounted only where necessary in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/63c86656-c485-47fa-ad2d-e93945d6cab2",
    "implementationEffort": null,
    "name": "63c86656-c485-47fa-ad2d-e93945d6cab2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/03/2024"
    },
    "remediationDescription": "To disable automount of service account tokens in pods in your Amazon EKS clusters: 1. In the AWS CLI, run the following command to identify pods that have the service account token mounted: <pre><code>kubectl get pods --all-namespaces -o json | jq '.items[] | select(.spec.automountServiceAccountToken == null or .spec.automountServiceAccountToken == true) | {name: .metadata.name, namespace: .metadata.namespace}'</code></pre> 2. Update the pod manifests for the identified resources (Note: Do not make any changes to pods in the kube-system or eks-* namespaces) using the following configuration: \"spec: automountServiceAccountToken: false\" 3. Run the following command to apply the changes to updated pods: <pre><code>kubectl apply -f [path_to_your_pod_manifest.yaml]</code></pre> 4. Update all service account manifests using the following configuration: \"automountServiceAccountToken: false\" 5. Run the following command to apply the changes to the identified service accounts: <pre><code>kubectl apply -f [path_to_your_service_account_manifest.yaml]</code></pre> For more details, follow the instructions in <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/\">configure service accounts</a>.",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the admission of privileged containers is permitted in your Amazon EKS clusters. This poses a risk, as privileged containers have access to all Linux kernel capabilities and devices. A container running with full privileges can perform nearly all actions that the host can do. We recommend minimizing the admission and use of privileged containers in Amazon EKS clusters.",
    "displayName": "Admission of privileged containers should be minimized in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a81fa0f-9e61-4fbe-b6cb-50d985d9be26",
    "implementationEffort": null,
    "name": "1a81fa0f-9e61-4fbe-b6cb-50d985d9be26",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/22/2024"
    },
    "remediationDescription": "To minimize the admission and use of privileged containers: 1. Navigate to AWS CLI and identify the deployments containing privileged containers with the following command: <pre> <code> kubectl get deployments --all-namespaces -o json | jq '.items[] | select(.metadata.namespace != \"kube-system\" and .spec.template.spec.containers[]?.securityContext?.privileged == true) | {deployment:.metadata.name, namespace: .metadata.namespace, container:.spec.template.spec.containers[].name}' </code> </pre> 2. Set <code>privileged: false</code> under \"securityContext\" for \"spec.containers\" in the deployment YAML files. 3. Apply the changes using the following command: <code>kubectl apply -f [your-deployment-file.yaml]</code> 4. Apply a pod security admission policy to the namespaces with the following command: <code>kubectl label --overwrite ns [NAMESPACE] pod-security.kubernetes.io/enforce=restricted</code> <br> Refer to <a target=\"_blank\" href=\"https://kubernetes.io/docs/concepts/security/pod-security-admission/\">Kubernetes pod security admission</a> for more details.",
    "severity": "High",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that containers are permitted to share the host process ID namespace in your Amazon EKS clusters. This poses a risk, as a container running in the host's PID namespace can inspect processes running outside the container. If the container also has access to ptrace capabilities, this can be used to escalate privileges outside of the container. We recommend minimizing the admission of containers that share the host process ID namespace in your Amazon EKS clusters.",
    "displayName": "Admission of containers that share the host process ID namespace should be minimized on Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/08ac479b-f002-4673-801c-81bc7bd7f440",
    "implementationEffort": null,
    "name": "08ac479b-f002-4673-801c-81bc7bd7f440",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/24/2024"
    },
    "remediationDescription": "To minimize the admission of containers that share the host process ID namespace: 1. Navigate to AWS CLI and identify the pods sharing the host process ID namespace with the following command: <pre> <code> kubectl get pods --all-namespaces -o json | jq '.items[] | select(.metadata.namespace != \"kube-system\" and .spec.hostPID == true) | {pod: .metadata.name, namespace: .metadata.namespace, container: .spec.containers[].name} </code> </pre> 2. Delete the pods using the following command: <code> kubectl delete pod [name-of-the-pod] </code> 3. Set <code>hostPID: false </code> or remove \"hostPID\" under \"spec\" in the pod YAML files. 4. Apply the changes using the following command: <code>kubectl apply -f [your-pod-file.yaml] </code> 5. Apply a pod security admission policy to the namespaces with the following command: <code>kubectl label --overwrite ns [NAMESPACE] pod-security.kubernetes.io/enforce=baseline</code> <br> Refer to <a target=\"_blank\" href=\"https://kubernetes.io/docs/concepts/security/pod-security-admission/\">Kubernetes pod security admission</a> for more details.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that containers are permitted to share the host IPC namespace in your Amazon EKS clusters. This poses a risk, as a container in this namespace can interact with external processes and access host resources. If compromised, sensitive data on the host could be exposed, or the host itself could potentially be taken over. We recommend minimizing the use of containers that share the host IPC namespace in your Amazon EKS clusters.",
    "displayName": "Admission of containers that share the host IPC namespace should be minimized on Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9529559c-d4f5-4f88-9b77-fd42c29c097c",
    "implementationEffort": null,
    "name": "9529559c-d4f5-4f88-9b77-fd42c29c097c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/24/2024"
    },
    "remediationDescription": "To minimize the admission of containers that share the host IPC namespace: 1. Navigate to the AWS CLI and identify the pods sharing the host IPC namespace with the following command: <pre> <code> kubectl get pods --all-namespaces -o json | jq '.items[] | select(.metadata.namespace != \"kube-system\" and .spec.hostIPC == true) | {pod: .metadata.name, namespace: .metadata.namespace, container: .spec.containers[].name}' </code> </pre> 2. Delete the pods using the following command: <code> kubectl delete pod [name-of-the-pod] </code> 3. Set \"hostIPC\" to false or remove \"hostIPC\" under \"spec\" in the pod YAML files. 4. Apply the changes using the following command: <code>kubectl apply -f [your-pod-file.yaml] </code> 5. Apply a pod security admission policy to the namespaces with the following command: <code>kubectl label --overwrite ns [NAMESPACE] pod-security.kubernetes.io/enforce=baseline</code> <br> Refer to <a target=\"_blank\" href=\"https://kubernetes.io/docs/concepts/security/pod-security-admission/\">Kubernetes pod security admission</a> for more details.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that containers are permitted to share the host network namespace in your Amazon EKS clusters. This poses a risk as this configuration enables interception of network traffic between pods. If compromised, attackers could gather sensitive information, disrupt communications, or escalate privileges to affect the host system. We recommend restricting the admission of containers that share the host network namespace in your Amazon EKS clusters.",
    "displayName": "Admission of containers that share the host network namespace should be minimized on Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b652b7d2-9065-4c4e-8f1d-11418041211e",
    "implementationEffort": null,
    "name": "b652b7d2-9065-4c4e-8f1d-11418041211e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/24/2024"
    },
    "remediationDescription": "To minimize the admission of containers that share the host network namespace: 1. Navigate to the AWS CLI and identify the pods sharing the host network namespace with the following command: <pre> <code> kubectl get pods --all-namespaces -o json | jq '.items[] | select(.metadata.namespace != \"kube-system\" and .spec.hostNetwork == true) | {pod: .metadata.name, namespace: .metadata.namespace, container: .spec.containers[].name}' </code> </pre> 2. Delete the pods using the following command: <code> kubectl delete pod [name-of-the-pod] </code> 3. Set \"hostNetwork\" to false or remove \"hostNetwork\" under \"spec\" in the pod YAML files. 4. Apply the changes using the following command: <code>kubectl apply -f [your-pod-file.yaml] </code> 5. Apply a pod security admission policy to the namespaces with the following command: <pre><code>kubectl label --overwrite ns [NAMESPACE] pod-security.kubernetes.io/enforce=baseline</code></pre> Refer to <a target=\"_blank\" href=\"https://kubernetes.io/docs/concepts/security/pod-security-admission/\">Kubernetes pod security admission</a> for more details.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that privilege escalation is enabled for containers in your Amazon EKS clusters. This poses a risk of processes running in a container obtaining greater privileges than their parent processes. We recommend disabling privilege escalation for containers in your Amazon EKS clusters.",
    "displayName": "Privilege escalation should be disabled for containers in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/40d0f699-2551-4214-9944-556c72811700",
    "implementationEffort": null,
    "name": "40d0f699-2551-4214-9944-556c72811700",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/22/2024"
    },
    "remediationDescription": "To disable privilege escalation for containers in your Amazon EKS clusters: 1. Navigate to the AWS CLI and identify the pods with AllowPrivilegeEscalation set to true with the following command: <pre><code> kubectl get pods --all-namespaces -o json | jq '.items[] | select(.metadata.namespace != \"kube-system\" and .spec.containers[].securityContext.allowPrivilegeEscalation == true) | {pod: .metadata.name, namespace: .metadata.namespace, container: .spec.containers[].name}' </code></pre> 2. Delete the identified pods using the following command: <code>kubectl delete pod [name-of-the-pod] </code> 3. Set \"allowPrivilegeEscalation\" to false or remove \"allowPrivilegeEscalation\" under \"spec.securityContext\" in the pod YAML files. 4. Apply the changes using the following command: <code> kubectl apply -f [your-pod-file.yaml] </code> 5. Apply a pod security admission policy to the namespaces with the following command: <code>kubectl label --overwrite ns [NAMESPACE] pod-security.kubernetes.io/enforce=baseline</code> <br> Refer to <a target=\"_blank\" href=\"https://kubernetes.io/docs/concepts/security/pod-security-admission/\">Kubernetes pod security admission</a> for more details.",
    "severity": "High",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that network policies are not enabled for the namespaces in your Amazon EKS clusters. Network policies are an application-centric construct which allow you to specify how a pod is allowed to communicate with various network entities over the network. Namespaces without network policies expose the pods to the risk of unauthorized access. This means that a compromised pod could access sensitive data or disrupt other pods. We recommend defining and enforcing network policies for all namespaces in your Amazon EKS clusters to mitigate these risks.",
    "displayName": "Network policies should be defined for all namespaces in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/58dcd4eb-31b3-44da-bc71-23572b437fd7",
    "implementationEffort": null,
    "name": "58dcd4eb-31b3-44da-bc71-23572b437fd7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/09/2024"
    },
    "remediationDescription": "To configure network policies for the namespaces in your Amazon EKS cluster: 1. Verify that a network plugin is configured in your cluster. For more information, visit the <a target=\"_blank\" href=\"https://docs.aws.amazon.com/eks/latest/userguide/cni-network-policy-configure.html\">Kubernetes network policies for EKS</a>. 2. Create a YAML manifest file of kind: \"NetworkPolicy\". 3. Define egress & ingress policies for your cluster resources. 4. Set your cluster name in the \"namespace\" property within the metadata. 5. Apply the network policy in your cluster by executing the following command:<code> kubectl apply -f [YAML file name] </code> 6. Verify that the network policy has been applied correctly by listing the network policies in your namespace.<br>For more information, visit the <a target=\"_blank\" href=\"https://kubernetes.io/docs/concepts/services-networking/network-policies/\">Kubernetes network policies documentation</a>.",
    "severity": "Medium",
    "tactics": [
      "Command and Control",
      "Defense Evasion"
    ],
    "techniques": [
      "Protocol Tunneling",
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that secrets are configured as environment variables in your Amazon EKS clusters. This poses a risk of exposing sensitive information through logs. Given that applications frequently log environment variables in debug outputs, the likelihood of inadvertently exposing secrets is significantly high. We recommend mounting the secrets as data volumes in your Amazon EKS clusters to mitigate these risks.",
    "displayName": "Secrets should be mounted as data volumes on Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6d220408-950f-4c10-acad-618dc56c892f",
    "implementationEffort": null,
    "name": "6d220408-950f-4c10-acad-618dc56c892f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/11/2024"
    },
    "remediationDescription": "To mount Kubernetes secrets as data volumes in your Amazon EKS cluster resources: 1. Open the deployment or pod YAML manifest files deployed in your Amazon EKS clusters and verify it has an entry for \"secretKeyRef\". 2. Edit the YAML file to remove the \"env\" section. 3. Add \"volumeMounts\" and \"volumes\" sections in your YAML file and provide the values for mount path, secret names etc. 4. To apply the changes in your cluster, use the command : <code>kubectl apply -f [YOUR_YAML_FILE]</code><br> For more details, follow the instructions in <a target=\"_blank\" href=\"https://kubernetes.io/docs/tasks/inject-data-application/distribute-credentials-secure/#create-a-pod-that-has-access-to-the-secret-data-through-a-volume\">access secret data through a volume</a>.",
    "severity": "Low",
    "tactics": [
      "Defense Evasion",
      "Credential Access"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the default namespace is being used in your Amazon EKS clusters. This poses a risk of unauthorized access to your cluster resources, as the default namespace is accessible to everyone with cluster access. Using the default namespace also makes it difficult to apply RBAC and security controls to the specific cluster resources. We recommend placing your resources in custom namespaces within your Amazon EKS clusters to mitigate these risks.",
    "displayName": "The default namespace should not be used in Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/847c9688-034e-48b8-9d3e-fefd80fa0e86",
    "implementationEffort": null,
    "name": "847c9688-034e-48b8-9d3e-fefd80fa0e86",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/11/2024"
    },
    "remediationDescription": "To create new namespaces and deploy resources within them in your Amazon EKS clusters: 1. In the AWS CLI, log into your Amazon EKS cluster. 2. Execute the following command to get the default namespace pod details: <code>kubectl get pods</code> 3. Create a namespace: <code>kubectl create namespace [enter-namespace-name]</code> 4. Run the following command to deploy your kubernetes resources in the namespace: <code>kubectl apply -f [YAML-file-name] --namespace=[namespace-name]</code> 5. To delete a pod in the default namespace, run the following command: <code>kubectl delete pod [pod-name] -n default</code><br> For more details, follow the instructions in <a href=\"https://kubernetes.io/docs/concepts/overview/working-with-objects/namespaces/\">namespaces in Kubernetes</a>.",
    "severity": "Low",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that vulnerability scanning is not configured for images deployed to your Amazon EKS clusters. This poses a risk of data breaches and unauthorized access to your services due to unscanned images containing vulnerabilities. Without image scanning, there is a risk of exposing applications to potential attacks. We recommend implementing image scanning to ensure that vulnerabilities are identified and addressed before deployment.",
    "displayName": "Image vulnerability scanning should be configured on images deployed to Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2163f67f-3d95-4731-bb44-e78ea1489298",
    "implementationEffort": null,
    "name": "2163f67f-3d95-4731-bb44-e78ea1489298",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "To configure AWS ECR for image scanning : 1. Navigate to the AWS CLI and run the following command: <pre><code>aws ecr put-image-scanning-configuration --repository-name $REPO_NAME --image-scanning-configuration scanOnPush=true --region $REGION_CODE</code></pre> 2. In the AWS Management Console, navigate to your ECR page. 3. From the navigation bar, choose the Region where you have images to scan. 4. In the navigation pane, choose \"Repositories\". 5. On the \"Repositories\" page, choose the repository that contains the image to scan. 6. On the \"Images\" page, select the image to scan and then choose \"Scan\".<br> For more information, refer to <a target=\"_blank\" href=\"https://docs.aws.amazon.com/AmazonECR/latest/userguide/imagescanning.html/\">Amazon ECR image scanning</a>.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Supply Chain Compromise"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the cluster node service account is being used on your Amazon EKS clusters. This poses a risk as use of the cluster node's IAM Service account violates the principle of least privilege on a multi-tenant node. We recommend configuring a dedicated service account in your Amazon EKS clusters.",
    "displayName": "Dedicated service accounts should be configured on Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/04825c22-02be-40c1-9180-3134576dd2c7",
    "implementationEffort": null,
    "name": "04825c22-02be-40c1-9180-3134576dd2c7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/09/2024"
    },
    "remediationDescription": "You must have an existing IAM OpenID Connect (OIDC) provider for your cluster. To verify your OIDC Provider: 1. Navigate to your cluster and in the \"Details\" section on the \"Overview\" tab, note the value of the \"OpenID Connect provider URL\". 2. Open the <a target=\"_blank\" href=\"https://console.aws.amazon.com/iam/\">IAM console</a>. 3. Choose \"Identity Providers\" under \"Access management\". 4. If a Provider is listed that matches the URL for your cluster, then you already have a provider for your cluster. If a provider is not listed that matches the URL for your cluster, then you must create one. <br> To configure a Kubernetes service account to assume an AWS Identity and Access Management (IAM) role: 1. Create an IAM policy. 2. Create an IAM role and associate it with a Kubernetes service account. 3. Confirm that the role and service account are configured correctly. <br> For more details, follow the instructions in <a target=\"_blank\" href=\"https://docs.aws.amazon.com/eks/latest/userguide/iam-roles-for-service-accounts.html\">IAM roles for service accounts</a>.",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Valid Accounts",
      "Deobfuscate/Decode Files or Information"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that access to the control plane of your Amazon EKS clusters is not restricted. This poses a security risk, as unrestricted access can lead to unauthorized control and attacks. We recommend enabling authorized networks to allowlist necessary IPs. Note that strict allowlisting may limit access for some users or applications.",
    "displayName": "Access to the control plane should be restricted on Amazon EKS cluster nodes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/28922969-156b-47c3-b78e-56fea77594bc",
    "implementationEffort": null,
    "name": "28922969-156b-47c3-b78e-56fea77594bc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "To secure the control plane for your clusters: 1. In the AWS Management console, navigate to your EKS clusters. 2. Select a cluster and navigate to the \"Networking\" tab. 3. Click on \"Manage Networking\". 4. In the \"Cluster Endpoint Access\" section, select the \"Private\" option. 5. Click on \"Save Changes\". <br> For more detailed information, refer to <a target=\"_blank\" href=\"https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html\">EKS cluster endpoint</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that public access is enabled for your Amazon EKS cluster endpoints. This poses a risk of unauthorized access and exposes your cluster to internet-based cyber-attacks, such as distributed denial of service (DDoS) attacks. Restricting cluster endpoint access to the internal network can significantly mitigate these risks and reduce the attack surface. We recommend enabling private access for your Amazon EKS cluster endpoints to protect against potential external threats.",
    "displayName": "Public access should be disabled for Amazon EKS cluster endpoints",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8b4cdaf9-9f80-4a72-af34-99fa13f4fe89",
    "implementationEffort": null,
    "name": "8b4cdaf9-9f80-4a72-af34-99fa13f4fe89",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "To enable a private endpoint for your Amazon EKS clusters: 1. In the AWS Management Console, navigate to your EKS clusters. 2. Select a cluster and navigate to the \"Networking\" tab. 3. Click on \"Manage endpoint access\". 4. In the cluster endpoint access section, select \"Private\" option. 5. Click on \"Save Changes\". For more details, you can refer to <a target=\"_blank\" href=\"https://docs.aws.amazon.com/eks/latest/userguide/cluster-endpoint.html/\">private EKS cluster endpoint documentation</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that public access is enabled on the nodes within your Amazon EKS clusters. This poses a risk of exposing your nodes to the internet, which attackers could exploit to carry out malicious activities. Private nodes provide additional layer of security by restricting access to internal entities. We recommend securing your EKS cluster nodes by placing them in private subnets to mitigate these risks.",
    "displayName": "Public access should be disabled on Amazon EKS cluster nodes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1820e7c0-1fc5-44ff-943e-59a93943909c",
    "implementationEffort": null,
    "name": "1820e7c0-1fc5-44ff-943e-59a93943909c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/10/2024"
    },
    "remediationDescription": "To secure your Amazon EKS clusters with private nodes: 1. In the AWS Management Console, navigate to your EKS clusters. 2. Select a cluster and navigate to the \"Compute\" tab. 3. Click the \"Add node group\" button in the \"Node Groups\" section. 4. In the \"Specify networking\" step, add a private subnet for your node group. 5. Fill in the required information and click \"Create\". 6. Migrate workloads from the old node group to the new node group. 7. Delete the old node group.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that pods have unrestricted communication on your Amazon EKS clusters. This poses a risk of unregulated traffic and security vulnerabilities since network policies act as firewalls, controlling pod communications and preventing unauthorized connections. We recommend enabling network policies to secure traffic between the pods in your EKS clusters.",
    "displayName": "Network policies should be enabled for Amazon EKS clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/419ce87f-8416-4cdd-b375-bd07222f473c",
    "implementationEffort": null,
    "name": "419ce87f-8416-4cdd-b375-bd07222f473c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/17/2024"
    },
    "remediationDescription": "To enable network policies on your Amazon EKS clusters: 1. In the AWS CloudShell, run the following command to modify the policy enforcement settings for pods:<pre><code>kubectl edit daemonset -n kube-system aws-node</code></pre> 2. Set the \"NETWORK_POLICY_ENFORCING_MODE\" environment variable to \"strict\". 3. Set the port numbers in the following command arguments: <pre><code>- args:\n\t- --metrics-bind-addr=:8162\n\t- --health-probe-bind-addr=:8163</code></pre> 4. Run the following command to configure your cluster to use Kubernetes network policies: <pre><code>aws eks update-addon --cluster-name my-cluster --addon-name vpc-cni--addon-version v1.14.0-eksbuild.3 --service-account-role-arn arn:aws:iam::123456789012:role/AmazonEKSVPCCNIRole --resolve-conflicts PRESERVE --configuration-values '{\"enableNetworkPolicy\": \"true\"}'</code></pre> 5. Create a YAML manifest file of kind \"NetworkPolicy\" with ingress & egress rules and apply it to your cluster.<br>For more details, refer to <a target=\"_blank\" href=\"https://docs.aws.amazon.com/eks/latest/userguide/cni-network-policy-configure.html#cni-network-policy-configure-policy\">restrict pod network traffic</a> and <a target=\"_blank\" href=\"https://kubernetes.io/docs/concepts/services-networking/network-policies/\">network policies</a>.",
    "severity": "Medium",
    "tactics": [
      "Command and Control",
      "Defense Evasion"
    ],
    "techniques": [
      "Protocol Tunneling",
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that anonymous authentication is enabled on nodes in your AKS clusters. This poses a risk of unauthorized access to your cluster where an attacker can access resources without authenticating. We recommend disabling anonymous requests on nodes in your clusters.",
    "displayName": "Anonymous authentication should be disabled on nodes in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/29e9792f-0913-4c74-adc0-1aa05863b97c",
    "implementationEffort": null,
    "name": "29e9792f-0913-4c74-adc0-1aa05863b97c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to disable anonymous authentication: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"authentication\": { \"anonymous\": { \"enabled\": false } }</code></pre> AKS manages this part of the infrastructure and does not provide a method for administrators to remediate this issue. For further assistance addressing this issue, contact AKS.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Persistence"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that unauthorized requests are allowed on nodes in your AKS clusters. This poses a risk of unauthorized access to your cluster where an attacker can access resources without going through authorization. We recommend enabling explicit request authorization in your AKS cluster.",
    "displayName": "Explicit request authorization should be enabled on nodes in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/689f9ab7-5434-4664-8c02-e94c8d8e47f9",
    "implementationEffort": null,
    "name": "689f9ab7-5434-4664-8c02-e94c8d8e47f9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to require explicit request authorization: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following sections: <pre><code>\"authentication\": { \"webhook\": { \"enabled\": true } } </code></pre> <pre><code>\"authorization\": { \"mode\": \"Webhook\" }</code></pre> AKS manages this part of the infrastructure and does not provide a method for administrators to remediate this issue. For further assistance addressing this issue, contact AKS.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Persistence"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that a client certificate file is not configured and authentication using client certificates is not enabled on nodes in your AKS clusters. This poses a risk of unauthorized access and potential manipulation of the kubelet. Without proper authentication, attackers can potentially execute commands or perform actions with the same privileges as the kubelet itself. We recommend enabling client certificate authentication on nodes in your AKS clusters.",
    "displayName": "Client certificate authentication should be enabled on nodes in Azure Kubernetes Services (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/83733586-9f9a-42dc-9049-90a276e2fe38",
    "implementationEffort": null,
    "name": "83733586-9f9a-42dc-9049-90a276e2fe38",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable client certificate authentication: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"authentication\": { \"x509\": { \"clientCAFile\": \"[path-to-client-ca-file]\" } }</code></pre> AKS manages this part of the infrastructure and does not provide a method for administrators to remediate this issue. For further assistance addressing this issue, contact AKS.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Exfiltration"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exfiltration Over Alternative Protocol"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the idle timeout is disabled on nodes in your AKS clusters. This poses a risk of denial-of-service attacks, inactive connections, and port exhaustion. We recommend configuring an idle timeout on nodes in your clusters.",
    "displayName": "Idle timeout should be configured on nodes in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8a3cb15a-cd98-4615-b510-bc5f416644af",
    "implementationEffort": null,
    "name": "8a3cb15a-cd98-4615-b510-bc5f416644af",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to configure an idle timeout: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"streamingConnectionIdleTimeout\": \"4h0m0s\"</code></pre> AKS manages this part of the infrastructure and does not provide a method for administrators to remediate this issue. For further assistance addressing this issue, contact AKS.",
    "severity": "Medium",
    "tactics": [
      "Impact",
      "Persistence"
    ],
    "techniques": [
      "Network Denial of Service",
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that iptables are being managed manually on nodes in your AKS clusters. This poses a risk of overly permissive or restrictive network policies which can allow unauthorized access for attackers or block necessary communication. We recommend enabling the makeIPTablesUtilChains configuration option to allow kubelet to manage iptables in your AKS clusters.",
    "displayName": "Automatic iptables management should be enabled on nodes in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ebf866af-4278-4c1e-a105-b2ba3845c22c",
    "implementationEffort": null,
    "name": "ebf866af-4278-4c1e-a105-b2ba3845c22c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable the automatic management of iptables: 1. SSH into each worker node. 2. Edit the kubelet config file and add or update the following section: <pre><code>\"makeIPTablesUtilChains\": true</code></pre> AKS manages this part of the infrastructure and does not provide a method for administrators to remediate this issue. For further assistance addressing this issue, contact AKS.",
    "severity": "Low",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Deobfuscate/Decode Files or Information",
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Security relevant information should be captured. The eventRecordQPS on the Kubelet configuration can be used to limit the rate at which events are gathered and sets the maximum event creations per second. Setting this too low could result in relevant events not being logged, however the unlimited setting of 0 could result in a denial of service on the kubelet",
    "displayName": "Ensure that the --eventRecordQPS argument is set to 0 or a level which ensures appropriate event capture",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ac5f7926-b7d2-4305-8737-f6ce208b50f2",
    "implementationEffort": null,
    "name": "ac5f7926-b7d2-4305-8737-f6ce208b50f2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "<b>Remediation Method 1:</b><br>If modifying the Kubelet config file, edit the kubelet-config.json file<br><code>/etc/kubernetes/kubelet/kubelet-config.json</code> and set the below parameter to 5 or a value greater or equal to 0<br><code>\"eventRecordQPS\": 5</code><br>Check that <code>/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</code> does not define an executable argument for <code>eventRecordQPS</code> because this would override your Kubelet config.<br><br><b>Remediation Method 2:</b><br>If using executable arguments, edit the kubelet service file<br><b>/etc/systemd/system/kubelet.service.d/10-kubelet-args.conf</b> on each worker node and add the below parameter at the end of the <code>KUBELET_ARGS</code> variable string.<br><code>--eventRecordQPS=5</code><br><br><b>Remediation Method 3:</b><br>If using the api configz endpoint consider searching for the status of <code>\"eventRecordQPS\"</code> by extracting the live configuration from the nodes running kubelet.<br>**See detailed step-by-step configmap procedures in Reconfigure a <a href='https://kubernetes.io/docs/tasks/administer-cluster/reconfigure-kubelet/'> Node's Kubelet in a Live Cluster</a>, and then rerun the curl statement from audit process to check for kubelet configuration changes<br><code>kubectl proxy --port=8001 &<br>export HOSTNAME_PORT=localhost:8001 (example host and port number)<br>export NODE_NAME=ip-192.168.31.226.aks.internal (example node name from \"kubectl get nodes\")<br>curl -sSL \"http://${HOSTNAME_PORT}/api/v1/nodes/${NODE_NAME}/proxy/configz\"</code><br><br><b>For all three remediations:</b><br>Based on your system, restart the kubelet service and check status<br><code>systemctl daemon-reload<br>systemctl restart kubelet.service<br>systemctl status kubelet -l</code>",
    "severity": "Low",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that server certificate rotation is not enabled on your AKS clusters. This poses a risk of the kubelet suffering downtime due to an expired certificate. We recommend enabling the RotateKubeletServerCertificate setting on your AKS clusters.",
    "displayName": "Server certificate rotation should be enabled on nodes in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/250248d1-640a-46dc-8fd7-e6ea559352bc",
    "implementationEffort": null,
    "name": "250248d1-640a-46dc-8fd7-e6ea559352bc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/19/2024"
    },
    "remediationDescription": "CIS documentation recommends the following steps to enable kubelet server certificate rotation: 1. SSH into each worker node. 2. Edit the kubelet config file and add the following section: <pre><code>\"featureGates\": { \"RotateKubeletServerCertificate\": true }</code></pre> AKS manages this part of the infrastructure and does not provide a method for administrators to remediate this issue. For further assistance addressing this issue, contact AKS.",
    "severity": "Low",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that the cluster admin role is being used in your AKS clusters. This poses a risk of an attacker gaining full control over every resource in the cluster. We recommend removing the cluster admin role binding from all entities in your clusters.",
    "displayName": "The cluster admin role should not be used in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aebc1af4-4efd-43df-8f76-4c3fa43c54f4",
    "implementationEffort": null,
    "name": "aebc1af4-4efd-43df-8f76-4c3fa43c54f4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/10/2024"
    },
    "remediationDescription": "To remove the \"cluster-admin\" role from principals in your AKS clusters: 1. To list the all the cluster roles in your cluster, on the Azure CLI, execute the command: <pre><code>kubectl get clusterrolebindings -o=custom-columns=NAME:.metadata.name,ROLE:.roleRef.name,SUBJECT:.subjects[*].name</code></pre> 2. If a subject does not need admin access to your Kubernetes cluster, downgrade the rolebinding to non-admin role by updating its ClusterRoleBinding YAML file 3. Apply the settings by running the command: <code>kubectl apply -f [YAML FILE]</code>",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Create or Modify System Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that user accounts in your AKS clusters have get, list, or watch access to secret objects. This poses a risk, as attackers with access to these user accounts could gain additional access to the Kubernetes cluster or external resources. This access would allow them to view data contained in secret objects. We recommend removing get, list, and watch access to secret objects in your clusters.",
    "displayName": "Access to secret objects should be restricted on Azure Kubernetes Services (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b8e2c296-bef4-4bc1-be90-ad3693dd07e5",
    "implementationEffort": null,
    "name": "b8e2c296-bef4-4bc1-be90-ad3693dd07e5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/16/2024"
    },
    "remediationDescription": "To remove access to secret objects in your AKS clusters:<br>If using Azure RBAC to access secrets in AKS, follow the below steps: 1. Login into the Azure CLI. 2. Identify the role assignments that grant access to secrets from the roledefinitionId by executing the command: <pre><code>az role definition list --scope /subscriptions/{subscription-id}/resourceGroups/{resource-group-name}/providers/Microsoft.ContainerService/managedClusters/{aks-cluster-name}</code></pre> 3. Review the role definitions with role actions <code>Microsoft.ContainerService/managedCluster/*/read</code> or <code>Microsoft.ContainerService/managedClusters/secrets/read</code> 4. Remove unnecessary roles, assigned users, groups or Microsoft Entra ID service principals by executing the command: <pre><code>az role assignment delete --assignee {account-id} --scope /subscriptions/{subscription-id}/resourceGroups/{resource-group-name}/providers/Microsoft.ContainerService/managedClusters/{aks-cluster-name}</code></pre><br>If using Kubernetes RBAC to define roles in AKS: 1. Login into the Kubernetes cluster 2. Identify the roles that have access to secrets by executing the commands: <pre><code>kubectl get rolebindings --all-namespaces -o wide</code></pre> and <pre><code>kubectl get clusterrolebindings -o wide</code></pre> 3. To remove the unnecessary rolebindings and clusterrolebindings execute the commands: <pre><code>kubectl delete rolebinding {rolebinding-name} --namespace {namespace}</code></pre> and <pre><code>kubectl delete clusterrolebinding {clusterrolebinding-name}</code></pre>",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials",
      "Credentials from Password Stores"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified roles or cluster roles which provide wildcard access to actions and objects in your AKS clusters. This poses a risk of inadvertent access to be granted when new resources are deployed to Kubernetes API, either as a custom resource definition or in later versions of the product. We recommend eliminating the use of wildcards in roles and cluster roles in your AKS clusters and assigning more specific permissions to enforce the principle of least privilege.",
    "displayName": "Wildcards in roles should be removed in Azure Kubernetes Services (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7cbed021-8a74-4edb-af5d-4b7faa7a6345",
    "implementationEffort": null,
    "name": "7cbed021-8a74-4edb-af5d-4b7faa7a6345",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/30/2024"
    },
    "remediationDescription": "To remove the wildcard entries in roles or cluster roles in your clusters: 1. Login to the Azure CLI and execute the following command: <code>az aks get-credentials --resource-group [your_resource_group] --name [your_cluster_name]</code> 2. Run the following command to get the roles:  <code>kubectl get roles --all-namespaces -o yaml</code> 3. Check if wildcard characters are used. If so, copy the output into a YAML file and where possible replace wildcard characters with specific objects or actions. 4. To apply the changes, run the command: <code>kubectl apply -f [YAML File name]</code> 5. To check for wildcard characters in cluster roles, run the command: <code>kubectl get clusterroles -o yaml</code> 6. If there are wildcard characters, copy the output into a YAML file and where possible replace wildcard with specific objects or actions. 7. To apply the changes execute the command: <code>kubectl apply -f [YAML File name]</code><br>To explore other options on using network policies in AKS, <a href=\"https://learn.microsoft.com/en-us/security/benchmark/azure/security-controls-v2-privileged-access#pa-7-follow-just-enough-administration-least-privilege-principle\">follow least privilege in Azure Kubernetes Service</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Persistence"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation",
      "Valid Accounts",
      "Create or Modify System Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that non-system roles are authorized to create pods in your AKS clusters. This poses a risk of unauthorized access leading to data breaches, privilege escalation, and lateral movement within the cluster. We recommend adhering to the principle of least privilege by removing the create pod permission from non-system roles in your clusters.",
    "displayName": "Permissions to create pods should be restricted on Azure Kubernetes Services (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/20de8576-d6ca-478b-bd25-8a5e2710e192",
    "implementationEffort": null,
    "name": "20de8576-d6ca-478b-bd25-8a5e2710e192",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/19/2024"
    },
    "remediationDescription": "To protect your AKS clusters:<br>If you are using Azure RBAC to create pods in AKS, follow these steps: 1. Login to the Azure CLI. 2. Identify the role assignments that grant access to create pods by executing the following command: <pre><code>az role definition list --scope /subscriptions/{subscription-id}/resourceGroups/[resource-group-name]/providers/Microsoft.ContainerService/managedClusters/[aks-cluster-name]</code></pre> 3. Identify the role definitions having role actions \"Microsoft.ContainerService/managedClusters/pods/create\" or \"Microsoft.ContainerService/managedClusters/*/create\". 4. Remove unnecessary roles assigned to users, groups or Microsoft Entra ID service principals by executing the following command: <pre><code>az role assignment delete --assignee [account-id] --scope /subscriptions/[subscription-id]/resourceGroups/[resource-group-name]/providers/Microsoft.ContainerService/managedClusters/[aks-cluster-name]</code></pre><br> If using Kubernetes RBAC to define roles in AKS, follow these steps: 1. Login to the Kubernetes CLI. 2. Identify the roles that can create pods by executing the commands: <code>kubectl get rolebindings --all-namespaces -o wide</code> and <code>kubectl get clusterrolebindings -o wide</code> 3. Remove the unnecessary RoleBindings and ClusterRoleBindings by executing the commands: <pre><code>kubectl delete rolebinding [rolebinding-name] --namespace [namespace]</code></pre> and <pre><code>kubectl delete clusterrolebinding [clusterrolebinding-name]</code></pre>",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Defense Evasion"
    ],
    "techniques": [
      "Access Token Manipulation",
      "Abuse Elevation Control Mechanism",
      "Masquerading"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified the use of default service accounts in your AKS clusters. Default service accounts often have broad permissions, which risks granting unnecessary permissions to any applications using them. Using default service accounts also makes it difficult to audit and review granted permissions in your cluster. We recommend configuring applications to use explicit service accounts with minimum necessary permissions to mitigate these risks.",
    "displayName": "Default service accounts should not be used on Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9651750d-075f-4327-956f-87fc2cf81238",
    "implementationEffort": null,
    "name": "9651750d-075f-4327-956f-87fc2cf81238",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/19/2024"
    },
    "remediationDescription": "To implement custom service accounts and modify default service account configurations in your AKS clusters: 1. In the Azure CLI, run the following command to create a service account: <code>kubectl create serviceaccount [service-account-name] -n [namespace]</code> 2. To bind the necessary roles to the newly created service account and verify it has the required permissions, run the command: <code>kubectl create rolebinding [rolebinding-name] --serviceaccount=[namespace]:[service-account-name] --clusterrole=[cluster-role] -n [namespace]</code> 3. To edit the default service account configuration to disable automatic mounting of service account tokens, run the command: <code>kubectl edit serviceaccount default -n [namespace]</code> 4. Add the following line to the configuration: \"automountServiceAccountToken: false\". 5. Apply this change to the default service accounts in all namespaces, except the namespaces needed for the Kubernetes system to function. <br> For more details, follow the instructions in <a href=\"https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/\">configure service accounts for Pods</a>.",
    "severity": "Medium",
    "tactics": [
      "Defense Evasion",
      "Persistence"
    ],
    "techniques": [
      "Valid Accounts",
      "Access Token Manipulation",
      "Account Manipulation",
      "Modify Authentication Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that some pods in your AKS clusters have automatically mounted service account tokens. This poses a risk of privilege escalation attacks, as attackers could potentially misuse these mounted tokens. Pods with mounted service account tokens can potentially access other cluster resources without explicit authorization. We recommend setting \"automountServiceAccountToken\" to \"false\" in your service accounts and pods to mitigate this risk.",
    "displayName": "Service account tokens should not be automatically mounted in Azure Kubernetes Service (AKS) cluster pods",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c299e102-6f99-476a-8084-190b11a5d5bf",
    "implementationEffort": null,
    "name": "c299e102-6f99-476a-8084-190b11a5d5bf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/30/2024"
    },
    "remediationDescription": "To disable the automatic mounting of service account tokens in AKS pods and service accounts: 1. Identify the service accounts with automountServiceAccountToken enabled by running the following command in a command shell: <code>kubectl get sa --all-namespaces -o yaml</code> 2. Edit the service account by setting the automountServiceAccountToken value to false. To apply your changes, run: <code>kubectl apply -f [YOUR_SA_YAML_FILE_PATH]</code> 3. Identify the pods with automountServiceAccountToken enabled by running: <code>kubectl get pods --all-namespaces -o yaml</code> 4. Edit the pod by setting the automountServiceAccountToken value to false. To apply your changes, run: <code>kubectl apply -f [YOUR_POD_YAML_FILE_PATH]</code> <br>Repeat these steps for each service account and pod that needs updating, except the namespaces needed for the kubernetes system to function. <br>For additional details, please refer to: <a href='https://kubernetes.io/docs/tasks/configure-pod-container/configure-service-account/'>configure service accounts for pods</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Lateral Movement"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation",
      "Access Token Manipulation",
      "Exploitation of Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that network policies are not configured on your AKS clusters. This poses a risk of unwanted traffic gaining access to your cluster resources. A network policy is an ordered set of rules to provide granular control on the traffic entering or egressing a pod.  We recommend configuring network policies with your CNI plugins in your AKS clusters to mitigate these risks.",
    "displayName": "CNI plugins should be configured on Azure Kubernetes Services (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c4f7b05b-042d-423d-9a91-06067d005046",
    "implementationEffort": null,
    "name": "c4f7b05b-042d-423d-9a91-06067d005046",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/29/2024"
    },
    "remediationDescription": "To enable network policies in your AKS clusters, we recommend choosing one of the three Azure-provided Network Policy engines: Cilium, Azure Network Policy, or Calico: To install Cilium: 1. Log in to the Azure CLI and run the following command to upgrade an existing cluster to Azure CNI Powered by Cilium: <pre><code>az aks update --resource-group [enter_your_resource_group_name_here] --name [enter_your_cluster_name_here] --network-dataplane cilium</code></pre> 2. Create a YAML manifest file of kind \"NetworkPolicy\" or \"CiliumNetworkPolicy\" with ingress and egress rules and apply it to your cluster.<br>To explore other options on using network policies in AKS, refer to <a href=\"https://learn.microsoft.com/en-us/azure/aks/use-network-policies\">how to secure traffic between pods</a>.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Execution"
    ],
    "techniques": [
      "Exploitation for Client Execution",
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified namespaces without network policies in your AKS clusters. This poses a risk of unauthorized access and potential data breaches due to unrestricted traffic to your pods. Network policy is an ordered set of rules to regulate traffic between the pods. We recommend enabling network policy for each namespace in your AKS clusters to restrict ingress and egress traffic between the pods.",
    "displayName": "Network policies should be defined for namespaces in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/28a4913d-f9df-4633-b8b7-cd92a416e9e6",
    "implementationEffort": null,
    "name": "28a4913d-f9df-4633-b8b7-cd92a416e9e6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/01/2024"
    },
    "remediationDescription": "To implement network policies in your existing AKS clusters: 1. Create a YAML file of kind \"NetworkPolicy\" and define the ingress and egress policies for each namespace in your AKS cluster. 2. Apply the network policy in your cluster by executing following command: <code>kubectl apply -f [YAML file name]</code> <br> For additional details, please refer to: <a href='https://learn.microsoft.com/en-us/azure/aks/use-network-policies'>network policies in AKS</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Valid Accounts",
      "Exploit Public-Facing Application",
      "Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that private endpoint access is disabled for the control plane in your AKS clusters. This poses a risk of unauthorized access to your clusters' control plane. Private endpoint access ensures that all communication between nodes and the API server stays within the virtual network, providing better protection from external threats. We recommend enabling private endpoint access for the control plane in your AKS clusters.",
    "displayName": "Private endpoint access should be enabled for the control plane in Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f634fbd5-e431-465b-8ebf-c43dcebc01c6",
    "implementationEffort": null,
    "name": "f634fbd5-e431-465b-8ebf-c43dcebc01c6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/04/2024"
    },
    "remediationDescription": "To restrict access to the control plane and disable public access to your AKS clusters, follow these steps: 1. In the Azure CLI, run the following command to restrict cluster access to authorized IPs.<pre><code>az aks update --resource-group [enter-your-resource-group-name] --name [enter-your-cluster-name] --api-server-authorized-ip-ranges [comma-separated-list-of-allowed-ips]</code></pre> 2. Run the following command to disable public endpoint access to your cluster.<pre><code>az aks update --name [enter-your-cluster-name] --resource-group [enter-your-resource-group-name] --disable-public-fqdn</code></pre>For more details, follow the instructions in <a href=\"https://learn.microsoft.com/en-us/azure/aks/api-server-authorized-ip-ranges?tabs=azure-cli\">authorized IP ranges</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Discovery"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Network Sniffing",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that a public endpoint is enabled in your private AKS clusters. This poses a risk of external access to the Kubernetes API beyond the node's virtual network, which increases the risk of exposing your cluster to unauthorized entities. This exposure could also enable attackers to gather information about the API and cluster version, heightening the potential for exploitation. We recommend disabling public endpoints in your private AKS clusters to mitigate these risks.",
    "displayName": "Public endpoints should be disabled on private Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3b2226f2-4351-4463-aecd-3245eb7cf4ea",
    "implementationEffort": null,
    "name": "3b2226f2-4351-4463-aecd-3245eb7cf4ea",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/17/2024"
    },
    "remediationDescription": "To secure your AKS clusters with private endpoints: 1. In Azure Cloud Shell, run the following command to disable public FQDN on your existing cluster: <code>az aks update --name [private-cluster-name] --resource-group [private-cluster-resource-group] --disable-public-fqdn</code> 2. Run the following command to create a private endpoint in your virtual network: <code>az network private-endpoint create --name [private-endpoint-name] --resource-group [resource_group] --vnet-name [vnet_name] --subnet [subnet_name] --private-connection-resource-id [aks_resource_id] --group-id managedCluster --connection-name [connection_name]</code> 3. Create a private DNS zone to handle the DNS resolution for the private endpoint: <code>az network private-dns zone create --resource-group [resource_group] --name [dns_zone_name]</code> 4. Link the newly created private DNS zone to your virtual network: <code>az network private-dns link vnet create --resource-group [resource_group] --zone-name [dns_zone_name] --name [link_name] --virtual-network [vnet_name] --registration-enabled false</code> <br> For additional information and guidance, please refer to the <a href=\"https://learn.microsoft.com/en-us/azure/aks/private-clusters\">Azure guide on private clusters.</a> It's important to note that the use of private endpoints incurs separate charges. For details on Azure Private Endpoint pricing, <a href=\"https://azure.microsoft.com/en-us/pricing/details/private-link/\">click here to learn more.</a>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Discovery"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Network Service Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that public IP addresses are enabled on your Azure Kubernetes Service (AKS) cluster nodes. This poses a risk of exposing your nodes to the internet which can be exploited by attackers to perform malicious activities. Private nodes provide an additional layer of security for your pods by restricting access to internal entities. We recommend securing your AKS cluster with private nodes to mitigate these risks.",
    "displayName": "Private nodes should be configured on Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/95c6c1e8-e6da-4714-8b98-90eaf6831e69",
    "implementationEffort": null,
    "name": "95c6c1e8-e6da-4714-8b98-90eaf6831e69",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/30/2024"
    },
    "remediationDescription": "To secure your AKS clusters with private nodes: 1. In Azure Cloud Shell, run the following command to create a new cluster with private nodes: <pre><code>az aks create --resource-group [private-cluster-resource-group] --name [private-cluster-name] --load-balancer-sku standard --enable-private-cluster --network-plugin azure --vnet-subnet-id [subnet-id] --docker-bridge-address [ip-address] --dns-service-ip --service-cidr</code></pre> For more details, follow the instructions in <a href=\"https://learn.microsoft.com/en-us/azure/aks/private-clusters?tabs=azure-portal\">create a private AKS cluster</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Valid Accounts",
      "Command and Scripting Interpreter"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for Cloud identified that network policy is not enabled in your AKS clusters. Network policy consists of a set of ordered rules that govern the traffic flow between pods. This poses a risk of compromising your clusters' security by allowing unrestricted traffic, which may result in unauthorized access and potential data breaches. We recommend enabling network policies to control both ingress and egress traffic within your AKS clusters to safeguard your environment.",
    "displayName": "Network policy should be enabled for Azure Kubernetes Service (AKS) clusters",
    "id": "/providers/Microsoft.Security/assessmentMetadata/252353b9-105e-4910-ac86-270e469c72e8",
    "implementationEffort": null,
    "name": "252353b9-105e-4910-ac86-270e469c72e8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/09/2024"
    },
    "remediationDescription": "To implement network policy with Calico in your existing AKS clusters: 1. In Azure Cloud Shell, run the following command to install Calico in your cluster: <code>az aks update --resource-group [resource_group] --name [cluster_name] --network-policy calico</code> 2. Create a YAML file of kind \"NetworkPolicy\" and define the ingress and egress policies for your cluster resources. 3. Enable kubectl connection to your cluster by executing the following command: <code>az aks get-credentials --resource-group [resouce-group] --name [cluster-name]</code> 4. Apply the network policy in your cluster by executing the following command: <code>kubectl apply -f [YAML file name]</code> <br> To explore other options for configuring network policies in AKS, please refer to Azure documentation on <a href=\"https://learn.microsoft.com/en-us/azure/aks/use-network-policies/\">network policies in AKS</a>.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Privilege Escalation"
    ],
    "techniques": [
      "Network Sniffing",
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Secure Boot should be enabled on supported Linux virtual machines to guard against the installation of malware-based rootkits and boot kits.<br> Secure Boot ensures that only signed operating systems and drivers are allowed to run, providing an additional layer of security.<br> If Secure Boot is not enabled, the system may be vulnerable to attacks that could compromise the integrity of the operating system and installed drivers.<br> This recommendation is specifically applicable to Linux virtual machines that have the Azure Monitor Agent installed.<br>",
    "displayName": "Linux virtual machines should use Secure Boot",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0396b18c-41aa-489c-affd-4ee5d1714a59",
    "implementationEffort": "Low",
    "name": "0396b18c-41aa-489c-affd-4ee5d1714a59",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Enabling Secure Boot will trigger an immediate system reboot. To enable it:<br>1. From Azure Virtual Machines, open your machine.<br>2. From the VM details page, open the 'Configuration' tab and select 'Secure boot'.<br>3. Select 'Save'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ElevationOfPrivilege",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enforcing kernel module signature validation on supported Linux virtual machines is a key security measure to prevent the execution of malicious or unauthorized code in kernel mode.<br> This validation ensures that only trusted kernel modules are allowed to run, thereby mitigating potential security risks.<br> If this is not enforced, the system could be vulnerable to attacks that could compromise the integrity and security of the virtual machine.<br> This recommendation is applicable only to Linux virtual machines that have the Azure Monitor Agent installed.<br>",
    "displayName": "Linux virtual machines should enforce kernel module signature validation",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e2f798b8-621a-4d46-99d7-1310e09eba26",
    "implementationEffort": "Low",
    "name": "e2f798b8-621a-4d46-99d7-1310e09eba26",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Enforcing kernel module signature validation requires a system reboot. To enforce it:<br>1. From Azure Virtual Machines, open your machine.<br>2. Run:<pre><code>sudo azsecd remediate -r enforce-kernelmodule-ci</code></pre>3. Restart the VM.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ElevationOfPrivilege",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Restarting machines is necessary to apply security configuration updates and protect against vulnerabilities.<br> This is particularly applicable to Linux virtual machines with the Azure Monitor Agent installed.<br> If not done, the system may remain exposed to potential security threats.<br> It's crucial to regularly restart these machines to ensure the latest security configurations are in effect and the system is safeguarded against known vulnerabilities.<br>",
    "displayName": "Machines should be restarted to apply security configuration updates",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d79a60ef-d490-484e-91ed-f45ceb0e7cfb",
    "implementationEffort": "Low",
    "name": "d79a60ef-d490-484e-91ed-f45ceb0e7cfb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To restart the machine:<br>1. From Azure Virtual Machines, open your machine.<br>2. Select 'Restart'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ElevationOfPrivilege",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Guest attestation is a process that assesses the trustworthiness of boot components in virtual machines, aiming to detect potential compromises such as bootkit or rootkit infections.<br> This is achieved by sending a trusted log to an attestation server.<br> This recommendation is particularly applicable to Trusted Launch and Confidential virtual machines that have the Guest Attestation extension installed.<br> If the guest attestation status is not healthy, it indicates potential security threats that could compromise the integrity and security of the virtual machines.<br>",
    "displayName": "Virtual machines guest attestation status should be healthy",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b7604066-ed76-45f9-a5c1-c97e4812dc55",
    "implementationEffort": "Moderate",
    "name": "b7604066-ed76-45f9-a5c1-c97e4812dc55",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "1. Scan your machine to ensure it isn't infected with malicious software.<br>2. Verify across your organization whether components of your operating system have been manually replaced.<br>3. Verify that a TPM device is installed on your machine: on Windows, run the PowerShell command \"Get-tpm\" as admin, and on Linux, use \"ls /dev/tpm0\" (with \"/dev/tpm0\" returning).<br>4. Remove any untrusted software or drivers with admin access.<br>5. Restart your machine in normal mode.<br>6. If all else fails, securely back up your data and create a new machine from a known-good image.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to enable all advanced threat protection types on your SQL servers. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.",
    "displayName": "All advanced threat protection types should be enabled in SQL server advanced data security settings",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f7010359-8d21-4598-a9f2-c3e81a17141e",
    "implementationEffort": "Low",
    "name": "f7010359-8d21-4598-a9f2-c3e81a17141e",
    "partnerData": null,
    "plannedDeprecationDate": "12/2022",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e756b945-1b1b-480b-8de8-9a0859d5f7ad",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To set advanced threat protection types to 'All' on SQL servers:<br>1. Select the SQL server.<br>2. Make sure that 'Advanced data security' is set to 'On'.<br>3. Under 'Advanced threat protection types', mark the check box for 'all'.<br>4. click OK.<br>5. Select 'Save'.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Credential Access",
      "Collection"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Valid Accounts",
      "Brute Force",
      "Data from Information Repositories"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It is recommended to enable all advanced threat protection types on your SQL managed instances. Enabling all types protects against SQL injection, database vulnerabilities, and any other anomalous activities.",
    "displayName": "All advanced threat protection types should be enabled in SQL managed instance advanced data security settings",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ebe970fe-9c27-4dd7-a165-1e943d565e10",
    "implementationEffort": "Low",
    "name": "ebe970fe-9c27-4dd7-a165-1e943d565e10",
    "partnerData": null,
    "plannedDeprecationDate": "12/2022",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bda18df3-5e41-4709-add9-2554ce68c966",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To set advanced threat protection types to 'All' on a managed instance:<br>1. Select the SQL server.<br>2. Make sure that 'Advanced data security' is set to 'On'.<br>3. Under 'Advanced threat protection types', mark the check box for 'all'.<br>4. click OK.<br>5. Select 'Save'.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Credential Access",
      "Collection"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Valid Accounts",
      "Brute Force",
      "Data from Information Repositories"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Defender for Cloud identified that remote debugging is enabled for your Web App, which can expose sensitive information. It is recommended to disable remote debugging in production environments.",
    "displayName": "Remote debugging should be turned off for Web Applications",
    "id": "/providers/Microsoft.Security/assessmentMetadata/64b8637e-4e1d-76a9-0fc9-c1e487a97ed8",
    "implementationEffort": "Low",
    "name": "64b8637e-4e1d-76a9-0fc9-c1e487a97ed8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/cb510bfd-1cba-4d9f-a230-cb0976f4bb71",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To ensure the Remote debugging is set to \"Off\" in production environments:<br>1.\tIn the Azure portal, navigate to your Web Application.<br>2. From the menu, open the Configuration settings page.<br>3. Locate the Debugging configuration.<br>4. Set the Remote debugging to \"Off\" to avoid exposing sensitive debug information.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Credential Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Brute Force"
    ],
    "threats": [
      "DataExfiltration",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Cross-Origin Resource Sharing (CORS) should not allow all domains to access your web application. Allow only required domains to interact with your web app.",
    "displayName": "CORS should not allow every resource to access Web Applications",
    "id": "/providers/Microsoft.Security/assessmentMetadata/df4d1739-47f0-60c7-1706-3731fea6ab03",
    "implementationEffort": "Low",
    "name": "df4d1739-47f0-60c7-1706-3731fea6ab03",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/5744710e-cc2f-4ee8-8809-3b11e89f4bc9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To allow only required domains to interact with your web app, we recommend the following steps:<br>1. Go to the app service CORS page<br>2. Remove the \"*\" defined and instead specify explicit origins that should be allowed to make cross-origin calls<br>3. Click Save",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "MaliciousInsider",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Defender for Cloud identified that this Azure Web App is not accessible only over HTTPS. This poses a risk of man-in-the-middle attacks where data in transit could be compromised. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
    "displayName": "Web Application should only be accessible over HTTPS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1b351b29-41ca-6df5-946c-c190a56be5fe",
    "implementationEffort": "Low",
    "name": "1b351b29-41ca-6df5-946c-c190a56be5fe",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a4af4a39-4135-47fb-b175-47fbdf85311d",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To redirect all HTTP traffic to HTTPS, we recommend the following steps:<br>1. In the Azure portal, navigate to your Web App.<br>2. From the left menu, select 'Configuration'.<br>3. Go to the 'General settings' tab.<br>4. Find the 'HTTPS Only' toggle and set it to 'On'.<br>5. Click 'Save' to apply the changes.<br><br>This setting ensures all traffic to your Web App is encrypted using TLS/SSL, protecting your data in transit from network layer eavesdropping attacks.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Defender for Cloud identified that remote debugging is enabled for your Function, which can expose sensitive information. It is recommended to disable remote debugging in production environments.",
    "displayName": "Remote debugging should be turned off for Function App",
    "id": "/providers/Microsoft.Security/assessmentMetadata/093c685b-56dd-13a3-8ed5-887a001837a2",
    "implementationEffort": "Low",
    "name": "093c685b-56dd-13a3-8ed5-887a001837a2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/0e60b895-3786-45da-8377-9c6b4b6ac5f9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To ensure the Remote debugging is set to \"Off\" in production environments:<br>1.\tIn the Azure portal, navigate to your Azure Function.<br>2.\tFrom the menu, open the Configuration settings page.<br>3. Locate the Debugging configuration.<br>4. Set the Remote debugging to \"Off\" to avoid exposing sensitive debug information.",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Credential Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Brute Force"
    ],
    "threats": [
      "DataExfiltration",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Cross-Origin Resource Sharing (CORS) should not allow all domains to access your Function app. Allow only required domains to interact with your Function app.",
    "displayName": "CORS should not allow every resource to access Function Apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7b3d4796-9400-2904-692b-4a5ede7f0a1e",
    "implementationEffort": "Low",
    "name": "7b3d4796-9400-2904-692b-4a5ede7f0a1e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/0820b7b9-23aa-4725-a1ce-ae4558f718e5",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To allow only required domains to interact with your web app, we recommend the following steps:<br>1. Go to the app service CORS page<br>2. Remove the \"*\" defined and instead specify explicit origins that should be allowed to make cross-origin calls<br>3. Click Save",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "MaliciousInsider",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Defender for Cloud identified that this Azure Function is not accessible only over HTTPS. This poses a risk of man-in-the-middle attacks where data in transit could be compromised. Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
    "displayName": "Function App should only be accessible over HTTPS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cb0acdc6-0846-fd48-debe-9905af151b6d",
    "implementationEffort": "Low",
    "name": "cb0acdc6-0846-fd48-debe-9905af151b6d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6d555dd1-86f2-4f1c-8ed7-5abae7c6cbab",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To redirect all HTTP traffic to HTTPS, we recommend the following steps:<br>1. In the Azure portal, navigate to your Function App.<br>2. From the left menu, select 'Configuration'.<br>3. Go to the 'General settings' tab.<br>4. Find the 'HTTPS Only' toggle and set it to 'On'.<br>5. Click 'Save' to apply the changes.<br><br>This setting ensures all traffic to your Function App is encrypted using TLS/SSL, protecting your data in transit from network layer eavesdropping attacks.",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Remote debugging requires inbound ports to be opened on an API app. Remote debugging should be turned off.",
    "displayName": "Remote debugging should be turned off for API App",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9172da4e-9571-6e33-2b5b-d742847f3be7",
    "implementationEffort": "Low",
    "name": "9172da4e-9571-6e33-2b5b-d742847f3be7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/e9c8d085-d9cc-4b17-9cdc-059f1f01f19e",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To turn off remote debugging, we recommend the following steps:<br>1. Go to the app service applications settings page<br>2. In the remote debugging toggle select Off<br>3. Click Save",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Credential Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Brute Force"
    ],
    "threats": [
      "DataExfiltration",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Cross-Origin Resource Sharing (CORS) should not allow all domains to access your API app. Allow only required domains to interact with your API app.",
    "displayName": "CORS should not allow every resource to access API Apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e40df93c-7a7c-1b0a-c787-9987ceb98e54",
    "implementationEffort": "Low",
    "name": "e40df93c-7a7c-1b0a-c787-9987ceb98e54",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/358c20a6-3f9e-4f0e-97ff-c6ce485e2aac",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To allow only required domains to interact with your web app, we recommend the following steps:<br>1. Go to the app service CORS page<br>2. Remove the \"*\" defined and instead specify explicit origins that should be allowed to make cross-origin calls<br>3. Click Save",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "MaliciousInsider",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Use of HTTPS ensures server/service authentication and protects data in transit from network layer eavesdropping attacks.",
    "displayName": "API App should only be accessible over HTTPS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bf82a334-13b6-ca57-ea75-096fc2ffce50",
    "implementationEffort": "Low",
    "name": "bf82a334-13b6-ca57-ea75-096fc2ffce50",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b7ddfbdc-1260-477d-91fd-98bd9be789a6",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To redirect all HTTP traffic to HTTPS, we recommend the following steps:<br>1. Go to the API App custom domains page<br>2. In the HTTPS Only toggle select On",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enable transparent data encryption to protect data-at-rest and meet compliance requirements",
    "displayName": "Transparent Data Encryption on SQL databases should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/651967bf-044e-4bde-8376-3e08e0600105",
    "implementationEffort": "Moderate",
    "name": "651967bf-044e-4bde-8376-3e08e0600105",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17k78e20-9358-41c9-923c-fb736d382a12",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable transparent data encryption on your SQL databases:<br>1. Select the SQL database.<br>2. Under Data encryption, select On.<br>3. Select 'Save'.",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enable auditing on your SQL Server to track database activities across all databases on the server and save them in an audit log.",
    "displayName": "Auditing on SQL server should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/94208a8b-16e8-4e5b-abbd-4e81c9d02bee",
    "implementationEffort": "Low",
    "name": "94208a8b-16e8-4e5b-abbd-4e81c9d02bee",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6fb4358-5bf4-4ad7-ba82-2cd2f41ce5e9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable SQL server auditing:<br>1. Go to 'SQL servers' page in the Azure portal and select your SQL server.<br>2. From the top left menu, select 'Auditing' and choose 'Enable Azure SQL Auditing'.<br>3. Select one of the options to store the Audit logs and follow the instructions.<br>4. Select 'Save'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "To reduce the potential for breaches by compromised owner accounts, we recommend limiting the number of owner accounts to a maximum of 3",
    "displayName": "A maximum of 3 owners should be designated for subscriptions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6f90a6d6-d4d6-0794-0ec1-98fa77878c2e",
    "implementationEffort": "Low",
    "name": "6f90a6d6-d4d6-0794-0ec1-98fa77878c2e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4f11b553-d42e-4e3a-89be-32ca364cad4c",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To remove owner permissions from user accounts on your subscription:<br>Click a subscription from the list of subscriptions below or click 'Take action' if you are coming from a specific subscription.<br>The Access control (IAM) page opens.<br>1. Click the Role assignments tab and set the 'Role' filter to 'Owner'.<br>2. Select the owners you want to remove.<br>3. Click Remove.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "AccountBreach",
      "ElevationOfPrivilege",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Designate more than one subscription owner in order to have administrator access redundancy.",
    "displayName": "There should be more than one owner assigned to subscriptions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2c79b4af-f830-b61e-92b9-63dfa30f16e4",
    "implementationEffort": "Low",
    "name": "2c79b4af-f830-b61e-92b9-63dfa30f16e4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/09024ccc-0c5f-475e-9457-b7c0d9ed487b",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To add another account with owner permissions to your subscription:<br>Click a subscription from the list of subscriptions below or click 'Take action' if you are coming from a specific subscription.<br>The Access control (IAM) page opens.<br>1. Click 'Add' to open the Add role assignment pane.<br>If you don't have permissions to assign roles, the Add role assignment option will be disabled<br>1. In the 'Role' drop-down list, select the Owner role.<br>2. In the Select list, select a user.<br>3. Select 'Save'.",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Signed Binary Proxy Execution"
    ],
    "threats": [
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.",
    "displayName": "SQL servers should have vulnerability assessment configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1db4f204-cb5a-4c9c-9254-7556403ce51c",
    "implementationEffort": "Low",
    "name": "1db4f204-cb5a-4c9c-9254-7556403ce51c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ef2a8f2a-b3d9-49cd-a8a8-9a3aaaf647d9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable vulnerability assessment on SQL servers:<br>1. Select the SQL server<br>2. Open 'Microsoft Defender for Cloud' under 'Security'<br>3. Make sure Microsoft Defender for Cloud's status is 'enabled at the server-level' or 'enabled at the subscription-level'<br>4. Open '(Configure)'<br>5. If a warning appears that vulnerability assessment is not configured then click on the 'Enable' button to remediate.<br>For more information: https://aka.ms/SQLVANewExperienceTroubleshooting<br>6. Run a manual scan on one of your databases. The recommendation will be remediated once the first database scan results appear",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Persistence",
      "Credential Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "SQL Stored Procedures",
      "Unsecured Credentials"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL is a unified package that provides advanced SQL security capabilities. It surfaces and mitigates potential database vulnerabilities, and detects anomalous activities that could indicate a threat to your database. Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "displayName": "Microsoft Defender for SQL should be enabled for unprotected Azure SQL servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/400a6682-992c-4726-9549-629fbc3b988f",
    "implementationEffort": "Low",
    "name": "400a6682-992c-4726-9549-629fbc3b988f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/abfb4388-5bf4-4ad7-ba82-2cd2f41ceae9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Microsoft Defender for SQL on SQL servers: 1. Select the SQL server. 2. Under 'Defender for Cloud', set Microsoft Defender for SQL to 'On'. 3. Under 'Vulnerability Assessment Settings', configure a storage account for storing vulnerability assessment scan results and set 'Periodic recurring scans' to 'On'. 4. Select 'Save'. <br>Note: Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL provides functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate threats to SQL databases, discovering and classifying sensitive data. Once enabled, the protection status indicates that the resource is actively monitored. Even when Defender is enabled, multiple configuration settings should be validated on the agent, machine, workspace and SQL server to ensure active protection.",
    "displayName": "Microsoft Defender for SQL status should be protected for Arc-enabled SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/08d649c8-5458-46dd-a13c-e1c5c7b1687c",
    "implementationEffort": "Moderate",
    "name": "08d649c8-5458-46dd-a13c-e1c5c7b1687c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/938c4981-c2c9-4168-9cd6-972b8675f906",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "11/15/2022"
    },
    "remediationDescription": "To troubleshoot protection issues with <a href='https://docs.microsoft.com/azure/defender-for-cloud/quickstart-enable-database-protections#enable-database-protection-on-your-subscription'>Microsoft Defender for Cloud</a>, verify that the agent is installed and connected to the enabled workspace (either default or custom workspace).<br>Also, verify from the workspace blade that the Defender solutions are installed. Inspect the Log Analytics workspace logs for the Defender heartbeat logs and examine the failure errors.<br>Ensure that the SQL Server is up and running, and that you can connect to it.<br>For more information on how to troubleshoot, visit this <a href='https://go.microsoft.com/fwlink/?linkid=2202816'>page</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation",
      "Persistence",
      "Defense Evasion",
      "Exfiltration",
      "Command and Control",
      "Lateral Movement"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Privilege Escalation",
      "Valid Accounts",
      "Modify Registry",
      "Server Software Component"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL Servers on Machines plan, provides comprehensive protection for Microsoft SQL Server instances installed on Azure, AWS, GCP, as well as on-premises machines. It is designed to identify and remediate potential database vulnerabilities, as well as to detect anomalous activities that may indicate threats to SQL databases.<br>The recommendation \"the status of Microsoft SQL Servers on Machines should be protected\" specifies the protection status for SQL virtual machines (VMs) and Arc-enabled SQL Servers that have the plan enabled.<br>It helps to identify non-compliant SQL servers:<br><br> 1. SQL servers that are not protected, along with the associated reasons for failure.<br> 2. SQL servers that are protected by the legacy Log Analytics framework (MMA/AMA agent).<br><br>Please note that this recommendation is listing the running SQL servers that have the plan enabled. The non-running SQL servers are classified as \"Not applicable\".",
    "displayName": "The status of Microsoft SQL Servers on Machines should be protected",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6aa015ac-db09-41bc-93a7-56064957dd9f",
    "implementationEffort": "Moderate",
    "name": "6aa015ac-db09-41bc-93a7-56064957dd9f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/20/2025"
    },
    "remediationDescription": "Manual remediation:<br> 1. Identify the unhealthy SQL servers under subscriptions that have onboarded to the SQL servers on machines plan.<br> 2. Check the unhealthy reason.<br> 3. Use <a href='https://aka.ms/DfSQLnewtroubleshooting'>this</a> user guide to troubleshoot.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation",
      "Persistence",
      "Defense Evasion",
      "Exfiltration",
      "Command and Control",
      "Lateral Movement"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Privilege Escalation",
      "Valid Accounts",
      "Modify Registry",
      "Server Software Component"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Provision an Azure AD administrator for your SQL server to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services.",
    "displayName": "SQL servers should have an Azure Active Directory administrator provisioned",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f0553104-cfdb-65e6-759c-002812e38500",
    "implementationEffort": "Moderate",
    "name": "f0553104-cfdb-65e6-759c-002812e38500",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f314764-cb73-4fc9-b863-8eca98ac36e9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To provision an Azure AD administrator for SQL server, see <a target='blank' href='https://docs.microsoft.com/azure/sql-database/sql-database-aad-authentication-configure'>Configure and manage Azure Active Directory authentication with SQL Database, Managed Instance, or SQL Data Warehouse</a>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": [
      "MaliciousInsider",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Virtual Machines (classic) was deprecated and these VMs should be migrated to Azure Resource Manager.<br>Because Azure Resource Manager now has full IaaS capabilities and other advancements, we deprecated the management of IaaS virtual machines (VMs) through Azure Service Manager (ASM) on February 28, 2020. This functionality will be fully retired on March 1, 2023.<br><br>To view all affected classic VMs make sure to select all your Azure subscriptions under 'directories + subscriptions' tab.<br><br>Available resources and information about this tool & migration:<br><a href='https://docs.microsoft.com/azure/virtual-machines/classic-vm-deprecation?toc=/azure/virtual-machines/windows/toc.json&bc=/azure/virtual-machines/windows/breadcrumb/toc.json'>Overview of Virtual machines (classic) deprecation, step by step process for migration & available Microsoft resources.</a><br><a href='https://docs.microsoft.com/azure/virtual-machines/migration-classic-resource-manager-deep-dive?toc=/azure/virtual-machines/windows/toc.json&bc=/azure/virtual-machines/windows/breadcrumb/toc.json'>Details about Migrate to Azure Resource Manager migration tool.</a><br><a href='https://docs.microsoft.com/azure/virtual-machines/windows/migration-classic-resource-manager-ps'>Migrate to Azure Resource Manager migration tool using PowerShell.</a>",
    "displayName": "Virtual machines should be migrated to new Azure Resource Manager resources",
    "id": "/providers/Microsoft.Security/assessmentMetadata/12018f4f-3d10-999b-e4c4-86ec25be08a1",
    "implementationEffort": "Moderate",
    "name": "12018f4f-3d10-999b-e4c4-86ec25be08a1",
    "partnerData": null,
    "plannedDeprecationDate": "05/2024",
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1d84d5fb-01f6-4d12-ba4f-4a26081d403d",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To migrate virtual machines to new ARM resources: <br>1. Go to the Virtual machines (classic) Portal Blade.<br>2. Under <b>Subscriptions</b>, select all available subscriptions to get full list of affected classic VMs.<br>3. Click on <b>Migrate to ARM.</b><br>4. Click on <b>Validate</b>. If validate failed, use the suggested methods in the error messages or at <a href='https://docs.microsoft.com/azure/virtual-machines/windows/migration-classic-resource-manager-overview#unsupported-features-and-configurations'>Migration Overview document</a> to fix the errors.<br>5. Click on <b>Prepare</b>. If prepare failed, use the suggested methods in the error messages or at <a href='https://docs.microsoft.com/azure/virtual-machines/windows/migration-classic-resource-manager-overview#unsupported-features-and-configurations'>Migration Overview document</a> to fix the errors.<br>6. View migrated virtual machines at <b>Virtual Machines</b> Portal Blade and Test their operation.<br>7. (Optional) Click on <b>Abort</b> to rollback migration.<br>8. Click on <b>Commit</b>. Commit finalizes the migration and cannot be rolled back.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Data Lake Analytics should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c6dad669-efd7-cd72-61c5-289935607791",
    "implementationEffort": "Low",
    "name": "c6dad669-efd7-cd72-61c5-289935607791",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c95c74d9-38fe-4f0d-af86-0c7d626a315c",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Data Lake Analytics diagnostics:<br>1. Go to Data Lake Analytics and click on your subscription.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Vulnerability assessment can discover, track, and help you remediate potential database vulnerabilities.",
    "displayName": "SQL managed instances should have vulnerability assessment configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c42fc28d-1703-45fc-aaa5-39797f570513",
    "implementationEffort": "Low",
    "name": "c42fc28d-1703-45fc-aaa5-39797f570513",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b7aa243-30e4-4c9e-bca8-d0d3022b634a",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable vulnerability assessment on a managed instance:<br>1. Select the SQL managed instance.<br>2. Make sure that 'Advanced data security' is set to 'On'.<br>3. Under 'Vulnerability assessment settings', set 'Periodic recurring scans' to 'On', and configure a storage account for storing vulnerability assessment scan results.<br>4. Select 'Save'.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Persistence",
      "Credential Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "SQL Stored Procedures",
      "Unsecured Credentials"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL is a unified package that provides advanced SQL security capabilities. It surfaces and mitigates potential database vulnerabilities, and detects anomalous activities that could indicate a threat to your database. Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "displayName": "Microsoft Defender for SQL should be enabled for unprotected SQL Managed Instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ff6dbca8-d93c-49fc-92af-dc25da7faccd",
    "implementationEffort": "Low",
    "name": "ff6dbca8-d93c-49fc-92af-dc25da7faccd",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abfb7388-5bf4-4ad7-ba99-2cd2f41cebb9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Microsoft Defender for SQL on managed SQL servers:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>Microsoft Defender for SQL</b> to <b>On</b>.<br>3. Under 'Vulnerability Assessment Settings', configure a storage account for storing vulnerability assessment scan results and set <b>Periodic recurring scans</b> to <b>On</b>.<b>4. Select <b>Save</b>.<br>Note: Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enable only connections via SSL to Redis Cache. Use of secure connections ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
    "displayName": "Redis Cache should allow access only via SSL",
    "id": "/providers/Microsoft.Security/assessmentMetadata/35b25be2-d08a-e340-45ed-f08a95d804fc",
    "implementationEffort": "Low",
    "name": "35b25be2-d08a-e340-45ed-f08a95d804fc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22bee202-a82f-4305-9a2a-6d7f44d4dedb",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable only SSL connections to your Redis Cache, we recommend the following steps:<br>1. Go to the Redis Caches, and select your redis cache.<br>2. Select 'Advanced settings'.<br>3. For 'Allow access only via SSL', click 'Yes' and then click 'Save'.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IoT"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in IoT Hub should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/77785808-ce86-4e40-b45f-19110a547397",
    "implementationEffort": "Low",
    "name": "77785808-ce86-4e40-b45f-19110a547397",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/383856f8-de7f-44a2-81fc-e5135b5c2aa4",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable IoT Hub diagnostics:<br>1. Go to the Event Hub namespace.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Batch accounts should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/32771b45-220c-1a8b-584e-fdd5a2584a66",
    "implementationEffort": "Low",
    "name": "32771b45-220c-1a8b-584e-fdd5a2584a66",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/428256e6-1fac-4f48-a757-df34c2b3336d",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Batch diagnostics:<br>1. Go to Batch and click on your subscription.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Azure Stream Analytics should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f11b27f2-8c49-5bb4-eff5-e1e5384bf95e",
    "implementationEffort": "Low",
    "name": "f11b27f2-8c49-5bb4-eff5-e1e5384bf95e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9be5368-9bf5-4b84-9e0a-7850da98bb46",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Stream Analytics diagnostics:<br>1. Go to Stream Analytics and click on your subscription.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Service Bus should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f19ab7d9-5ff2-f8fd-ab3b-0bf95dcb6889",
    "implementationEffort": "Low",
    "name": "f19ab7d9-5ff2-f8fd-ab3b-0bf95dcb6889",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f8d36e2f-389b-4ee4-898d-21aeb69a0f45",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Service Bus diagnostics:<br>1. Go to the Service Bus.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "It is important to enable encryption of Automation account variable assets when storing sensitive data.",
    "displayName": "Automation account variables should be encrypted",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b12bc79e-4f12-44db-acda-571820191ddc",
    "implementationEffort": "High",
    "name": "b12bc79e-4f12-44db-acda-571820191ddc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/3657f5a0-770e-44a3-b44e-9431ba1e9735",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "You should encrypt Automation Account Variables that store sensitive data. This step can only be taken at creation time.<br> If you have Automation Account Variables storing sensitive data that are not already encrypted, then you will need to delete them and recreate them as encrypted variables.<br> To apply encryption of the Automation account variable assets, in the Azure CLI - run the following command: Set-AzAutomationVariable -AutomationAccountName '{AutomationAccountName}' -Encrypted $true -Name '{VariableName}' -ResourceGroupName '{ResourceGroupName}' -Value '{Value}' <br> Read more <a href=\"https://docs.microsoft.com/powershell/module/az.automation/set-azautomationvariable?view=azps-1.4.0\">here</a>",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Azure Data Lake Store should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ad5bbaeb-7632-5edf-f1c2-752075831ce8",
    "implementationEffort": "Low",
    "name": "ad5bbaeb-7632-5edf-f1c2-752075831ce8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/057ef27e-665e-4328-8ea3-04b3122bd9fb",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Data Lake Store diagnostics:<br>1. Go to Data Lake Store and click on your subscription.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable logs for Azure AI services resources. This enables you to recreate activity trails for investigation purposes, when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Azure AI services resources should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dea5192e-1bb3-101b-b70c-4646546f5e1e",
    "implementationEffort": "Low",
    "name": "dea5192e-1bb3-101b-b70c-4646546f5e1e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b4d1c4e-934c-4703-944c-27c82c06bebb",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable diagnostic logs for Azure AI services resources:<ol><li>In the Azure portal, open Azure AI Services.<li>Select the relevant resource.<li>From the left-side bar, under \"Monitoring\", select \"Diagnostic settings\". <li>Click \"+ Add diagnostic setting\".<li>Choose the relevant categories you would like to log.<li>Select one of the destination options to store the diagnostics logs and insert relevant details.<li>Enter a Diagnostic setting name.<li>Click \"Save\".<li>Make sure your diagnostic setting has a Diagnostic Settings Retention Rule for 1 year, or create one (see note below)</ol>Learn more at:<a href=\"https://aka.ms/AI-Search/IPFirewall\" target=\"_blank\">https://aka.ms/AI-Search/IPFirewall</a><br><br>Note:<br>It is recommended to set retention of 1 year for the logs.<br>If you select the storage account option, make sure to set the retention to 1 year via the storage account lifecycle management.<br>Learn more at:<a href=\"https://aka.ms/storage/lifecycle-management\" target=\"_blank\">https://aka.ms/storage/lifecycle-management</a><br>If you select the log analytics option, make sure you set the retention to 1 year via the usage and estimated costs.<br>Learn more at:<a href=\"https://aka.ms/log-analytics/data-retention\" target=\"_blank\">https://aka.ms/log-analytics/data-retention</a>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Perform Client authentication only via Azure Active Directory in Service Fabric",
    "displayName": "Service Fabric clusters should only use Azure Active Directory for client authentication",
    "id": "/providers/Microsoft.Security/assessmentMetadata/03afeb6f-7634-adb3-0a01-803b0b9cb611",
    "implementationEffort": "Moderate",
    "name": "03afeb6f-7634-adb3-0a01-803b0b9cb611",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b54ed75b-3e1a-44ac-a333-05ba39b99ff0",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable client authentication using Azure Active Directory follow the instructions to <a target='_blank' href='https://docs.microsoft.com/azure/service-fabric/service-fabric-cluster-creation-setup-aad'>Set up Azure Active Directory for client authentication</a>.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": [
      "MaliciousInsider",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Service Fabric provides three levels of protection (None, Sign and EncryptAndSign) for node-to-node communication using a primary cluster certificate. Set the protection level to ensure that all node-to-node messages are encrypted and digitally signed.",
    "displayName": "Service Fabric clusters should have the ClusterProtectionLevel property set to EncryptAndSign",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7f04fc0c-4a3d-5c7e-ce19-666cb871b510",
    "implementationEffort": "Low",
    "name": "7f04fc0c-4a3d-5c7e-ce19-666cb871b510",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/617c02be-7f02-4efd-8836-3180d47b6c68",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To set 'ClusterProtectionLevel' inside Service Fabric ARM template to 'EncryptAndSign':<br>1. Go to the Service fabric cluster.<br>2. Click on 'Custom fabric settings'.<br>3. Click 'Add new', set the 'Security' section and update the 'ClusterProtectionLevel' property to 'EncryptAndSign'.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Event Hub should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1597605a-0faf-5860-eb74-462ae2e9fc21",
    "implementationEffort": "Low",
    "name": "1597605a-0faf-5860-eb74-462ae2e9fc21",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83a214f7-d01a-484b-91a9-ed54470c9a6a",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Event Hub diagnostics:<br>1. Go to the Event Hub namespace.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable diagnostic logs in your Kubernetes services and retain them up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs.",
    "displayName": "Diagnostic logs in Kubernetes services should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bb318338-de6a-42ff-8428-8274c897d564",
    "implementationEffort": "Low",
    "name": "bb318338-de6a-42ff-8428-8274c897d564",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/245fc9df-fa96-4414-9a0b-3738c2f7341c",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "10/07/2021"
    },
    "remediationDescription": "To enable diagnostics logs in one of your Kubernetes services: 1. Go to Kubernetes services and select one of your Kubernetes clusters. 2. From the left menu, open the diagnostic settings and select Add diagnostic setting. 3. Select one of the options to store the diagnostics logs and follow the instructions.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To ensure you can recreate activity trails for investigation purposes when a security incident occurs or your network is compromised, enable logging. If your diagnostic logs aren't being sent to a Log Analytics workspace, Azure Storage account, or Azure Event Hub, ensure you've configured diagnostic settings to send platform metrics and platform logs to the relevant destinations. Learn more in Create diagnostic settings to send platform logs and metrics to different destinations.",
    "displayName": "Diagnostic logs in Logic Apps should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/91387f44-7e43-4ecc-55f0-46f5adee3dd5",
    "implementationEffort": "Low",
    "name": "91387f44-7e43-4ecc-55f0-46f5adee3dd5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34f95f76-5386-4de7-b824-0d8478470c9d",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable diagnostics for a logic app: 1. Open Azure Logic Apps and select the logic app. 2. From the menu, select Diagnostic settings. 3. Select Edit setting if you have an existing setting or select Add diagnostic setting to create a new configuration. 4. Select the options to define what to log and where to store it. 5. Save your settings.<br>Note :  If you use storage accounts, we recommend setting a retention for the logs. To ensure the recommendation evaluates the retention dates across all resources, open the ASC default initiative assignment and set the parameter \"Required retention (in days) for logs..\" to the desired retention dates that you want the recommendation to evaluate.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To benefit from new capabilities in Azure Resource Manager, you can migrate existing deployments from the Classic deployment model. Resource Manager enables security enhancements such as: stronger access control (RBAC), better auditing, ARM-based deployment and governance, access to managed identities, access to key vault for secrets, Azure AD-based authentication and support for tags and resource groups for easier security management. <a target='_blank' href='https://docs.microsoft.com/azure/virtual-machines/windows/migration-classic-resource-manager-overview'>Learn more</a>",
    "displayName": "Storage accounts should be migrated to new Azure Resource Manager resources",
    "id": "/providers/Microsoft.Security/assessmentMetadata/47bb383c-8e25-95f0-c2aa-437add1d87d3",
    "implementationEffort": "Moderate",
    "name": "47bb383c-8e25-95f0-c2aa-437add1d87d3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/37e0d2fe-28a5-43d6-a273-67d37d1f5606",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To migrate storage accounts to new ARM resources : <br>1. Go to the Storage Account<br>2. Click on <b>Migrate to ARM</b> and follow the instructions.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Enable logs and retain them for up to a year. This enables you to recreate activity trails for investigation purposes when a security incident occurs or your network is compromised.",
    "displayName": "Diagnostic logs in Key Vault should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/88bbc99c-e5af-ddd7-6105-6150b2bfa519",
    "implementationEffort": "Low",
    "name": "88bbc99c-e5af-ddd7-6105-6150b2bfa519",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cf820ca0-f99e-4f3e-84fb-66e913812d21",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Key Vault diagnostics:<br>1. Go to Key Vault and click on your subscription.<br>2. Click <b>Diagnostic settings</b> and then click <b>Turn on diagnostics</b>.<br>3. Select one of the options to store the diagnostics logs and follow the instructions. <br>Note : We recommend setting a retention for the logs. If you select the storage account option , make sure to set the retention to 1 year.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Review the settings of network access in your storage account firewall settings. We recommended configuring network rules so that only applications from allowed networks can access the storage account. To allow connections from specific internet or on-premise clients, access can be granted to traffic from specific Azure virtual networks or to public internet IP address ranges.",
    "displayName": "Access to storage accounts with firewall and virtual network configurations should be restricted",
    "id": "/providers/Microsoft.Security/assessmentMetadata/45d313c3-3fca-5040-035f-d61928366d31",
    "implementationEffort": "Low",
    "name": "45d313c3-3fca-5040-035f-d61928366d31",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/34c877ad-507e-4c82-993e-3452a6e0ad3c",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. In your storage account, go to 'Firewalls and virtual networks'.<br>2. Under 'Allow access from', choose 'Selected networks'.<br>3. Configure the relevant virtual networks and IP ranges that should be allowed to access your storage account.<br>4. Configure <a target='_blank' href='https://docs.microsoft.com/azure/storage/common/storage-network-security#exceptions'>\"Allow trusted Microsoft services to access your storage account\"</a>.",
    "severity": "Low",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Secure transfer is an option that forces your storage account to accept requests only from secure connections (HTTPS). Use of HTTPS ensures authentication between the server and the service and protects data in transit from network layer attacks such as man-in-the-middle, eavesdropping, and session-hijacking.",
    "displayName": "Secure transfer to storage accounts should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1c5de8e1-f68d-6a17-e0d2-ec259c42768c",
    "implementationEffort": "Low",
    "name": "1c5de8e1-f68d-6a17-e0d2-ec259c42768c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/404c3081-a854-4457-ae30-26a93ef643f9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable secure transfer required:<br>1. In your storage account, go to the 'Configuration' page.<br>2. Enable 'Secure transfer required'.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To ensure secure configurations of in-guest settings of your machine, install the Guest Configuration extension. In-guest settings that the extension monitors include the configuration of the operating system, application configuration or presence, and environment settings. Once installed, in-guest policies will be available such as 'Windows Exploit guard should be enabled'. <a href='https://aka.ms/gcpol'>Learn more</a>.",
    "displayName": "Guest Configuration extension should be installed on machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6c99f570-2ce7-46bc-8175-cde013df43bc",
    "implementationEffort": "Low",
    "name": "6c99f570-2ce7-46bc-8175-cde013df43bc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/ae89ebca-1c92-4898-ac2c-9f63decb045c",
    "preview": null,
    "publishDates": {
      "ga": "09/01/2024",
      "public": "06/01/2021"
    },
    "remediationDescription": "1. Register your subscription to Guest Configuration resource provider. 2. Install the Guest Configuration extension on your machine. 3. Enable a system-assigned managed identity, if one doesn't exist. Learn more in <a href='https://docs.microsoft.com/azure/governance/policy/concepts/guest-configuration#enable-guest-configuration'>Enable Guest Configuration</a>.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The Guest Configuration extension requires a system assigned managed identity. Azure virtual machines in the scope of this policy will be non-compliant when they have the Guest Configuration extension installed but do not have a system assigned managed identity. <a href='https://aka.ms/gcpol'>Learn more</a>",
    "displayName": "Virtual machines' Guest Configuration extension should be deployed with system-assigned managed identity",
    "id": "/providers/Microsoft.Security/assessmentMetadata/69133b6b-695a-43eb-a763-221e19556755",
    "implementationEffort": "Low",
    "name": "69133b6b-695a-43eb-a763-221e19556755",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d26f7642-7545-4e18-9b75-8c9bbdee3a9a",
    "preview": null,
    "publishDates": {
      "ga": "09/01/2024",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable a system-assigned managed identity, deploy the 'Enable a system-assigned managed identity' initiative: 1. Register the resource provider. 2. Deploy requirements for Azure virtual machines. Learn more about configuring the Guest Configuration prerequisites in <a href='https://docs.microsoft.com/azure/governance/policy/concepts/guest-configuration#enable-guest-configuration'>Enable Guest Configuration</a>.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Windows Defender Exploit Guard uses the Azure Policy Guest Configuration agent. Exploit Guard has four components that are designed to lock down devices against a wide variety of attack vectors and block behaviors commonly used in malware attacks while enabling enterprises to balance their security risk and productivity requirements (Windows only).",
    "displayName": "Windows Defender Exploit Guard should be enabled on machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/22489c48-27d1-4e40-9420-4303ad9cffef",
    "implementationEffort": "Moderate",
    "name": "22489c48-27d1-4e40-9420-4303ad9cffef",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/bed48b13-6647-468e-aa2f-1af1d3f4dd40",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "1. <a href='https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/enable-controlled-folders'>Enable controlled folder access</a>.<br>2. Configure the following attack surface reduction rules: 'Block executable content from email client and webmail', 'Block untrusted and unsigned processes that run from USB', 'Block credential stealing from the Windows local security authority subsystem (lsass.exe)', ' Block all Office applications from creating child processes', 'Block JavaScript or VBScript from launching downloaded executable content', 'Block execution of potentially obfuscated scripts ', 'Block Office applications from creating executable content', 'Block Office communication application from creating child processes', 'Block Win32 API calls from Office macros', 'Block Adobe Reader from creating child processes', 'Block Office applications from injecting code into other processes'.<br>Learn more in <a href='https://docs.microsoft.com/windows/security/threat-protection/microsoft-defender-atp/attack-surface-reduction'>Use attack surface reduction rules to prevent malware infection</a>.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Credential Access",
      "Defense Evasion",
      "Privilege Escalation",
      "Lateral Movement",
      "Initial Access"
    ],
    "techniques": [
      "Exploitation for Client Execution",
      "Exploitation for Credential Access",
      "Exploitation for Defense Evasion",
      "Exploitation for Privilege Escalation",
      "Taint Shared Content",
      "Exploitation of Remote Services",
      "Exploit Public-Facing Application",
      "Drive-by Compromise"
    ],
    "threats": [
      "ThreatResistance",
      "DataSpillage",
      "DataExfiltration",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Ensure your certificates do not have a validity period that exceeds 12 months.",
    "displayName": "Validity period of certificates stored in Azure Key Vault should not exceed 12 months",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fc84abc0-eee6-4758-8372-a7681965ca44",
    "implementationEffort": null,
    "name": "fc84abc0-eee6-4758-8372-a7681965ca44",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a075868-4c26-42ef-914c-5bc007359560",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To remediate you must create a new version of the certificate. Ensure that your application or service will be able to get a new version of the certificate before proceeding. Select a key vault from the list below. The list of certificates with a validity period that exceeds 12 months will appear. From the Azure Portal, open Azure Key Vault and select the vault with the certificate that needs to be replaced. Select the relevant certificate and the certificate details page opens. 1. On the certificate details page, select \"+ New Version\". The \"Create a Certificate\" pane opens. 2. Change the \"Validity period (in months)\" field to 12 or less. 3. Select \"Create\". 4. Ensure that you have set up auto-renewal, or have a process to renew your certificate prior to expiration.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Credentials from Password Stores"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Anonymous public read access to containers and blobs in Azure Storage is a convenient way to share data, but might present security risks. To prevent data breaches caused by undesired anonymous access, Microsoft recommends preventing public access to a storage account unless your scenario requires it.",
    "displayName": "Storage account public access should be disallowed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/51fd8bb1-0db4-bbf1-7e2b-cfcba7eb66a6",
    "implementationEffort": "Low",
    "name": "51fd8bb1-0db4-bbf1-7e2b-cfcba7eb66a6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/4fa4b6c0-31ca-4c0d-b10d-24b96f62a751",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To prevent public access to containers and blobs in your storage account:<br>1. In the Azure portal, navigate to your storage account.<br>2. From the settings menu, select \"Configuration\".<br>3. Set \"Allow Blob anonymous access\" to \"Disabled\".<br><a href=\"https://aka.ms/StorageAccountPublicAccess\" target=\"_blank\">Learn more about public access</a><br>Note: It might take several minutes after remediation completes until the resource appears in the 'healthy resources' tab.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL on machines extends the protections for your Azure-native SQL Servers to fully support hybrid environments and protects SQL servers (all supported versions) hosted in Azure, other cloud environments, and on-premises machines.<br>It's not enough to enable this optional Azure Defender plan on a subscription: it must also be enabled on the workspace. Until you enable the plan on the workspace too, it won't protect your SQL servers and you won't be charged for the plan. <br> Learn more in <a href='https://docs.microsoft.com/en-us/azure/security-center/defender-for-sql-usage'>Enable Azure Defender for SQL servers on machines</a>.",
    "displayName": "Microsoft Defender for SQL on machines should be enabled on workspaces",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e9c320f1-03a0-4d2b-9a37-84b3bdc2e281",
    "implementationEffort": "Low",
    "name": "e9c320f1-03a0-4d2b-9a37-84b3bdc2e281",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/29/2021"
    },
    "remediationDescription": "To enable Microsoft Defender for SQL on machines on the identified workspaces, select the workspaces and select <b>Remediate</b>.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "The best way to authenticate to Azure services is by using Role-Based Access Control (RBAC). RBAC allows you to maintain the minimum privilege principle and supports the ability to revoke permissions as an effective method of response when compromised. You can configure your Azure Cosmos DB account to enforce RBAC as the only authentication method. When the enforcement is configured, all other methods of access will be denied (primary/secondary keys and access tokens).",
    "displayName": "Azure Cosmos DB accounts should use Azure Active Directory as the only authentication method",
    "id": "/providers/Microsoft.Security/assessmentMetadata/14acab4e-ad95-11ec-b909-0242ac120002",
    "implementationEffort": "Low",
    "name": "14acab4e-ad95-11ec-b909-0242ac120002",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5450f5bd-9c72-4390-a9c4-a7aba4edfdd2",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "06/01/2022"
    },
    "remediationDescription": "Change your resource authentication method to RBAC. After RBAC is enabled, edit the configuration settings to enforce RBAC as the only authentication method. <br> <ol type=\"A\"><li><u> Change the resources' authentication method from primary key to Azure Active Directory (AAD): </u></li><br><ol><li>Map all the resources that currently access to the Azure Cosmos DB account with keys or access tokens.</li> <li>Create an Azure Active Directory (AAD) identity for each of these resources:</li><ol type=\"a\"><li> For Azure resources, you can <a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview\">create a managed identity</a> . You may <a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/active-directory/managed-identities-azure-resources/overview#managed-identity-types\">choose between system-assigned and user-assigned managed identities</a>.</li><li>For non-Azure resources, <a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/active-directory/develop/howto-create-service-principal-portal\">create an AAD identity</a>. </li></ol><li> Grant each AAD identity the minimum permission it requires. When possible, we recommend you use one of the <a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/how-to-setup-rbac#built-in-role-definitions\">2 built-in role definitions</a>: Cosmos DB Built-in Data Reader or Cosmos DB Built-in Data Contributor. </li> <li>Validate that the new resource is functioning correctly. After new permissions are granted to identities, it may take a few hours until they propagate. When all resources are working correctly with the new identities, continue to the next step. </li></ol><br><a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/how-to-setup-rbac#built-in-role-definitions\">You can read more about configuring role-based access control with Azure Active Directory for your Azure Cosmos DB account</a>. <br> <br> <li><u> Enforce RBAC as the only authentication method:</u> <br> You may choose one of the two options listed below: </li><ol><li>You can use the <code>az resource update</code> powershell  command:<br><code>$cosmosdbname = \"cosmos-db-account-name\"</code> <br> <code>$resourcegroup = \"resource-group-name\"</code><br><code>$cosmosdb = az cosmosdb show --name $cosmosdbname --resource-group $resourcegroup | ConvertFrom-Json</code><br><br><code>az resource update --ids $cosmosdb.id --set properties.disableLocalAuth=true --latest-include-preview</code></li> <br> <li>Deploy these changes in your ARM template <a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/cosmos-db/how-to-setup-rbac#disable-local-auth\">to enforce RBAC as the only authentication method</a>.<br><br><a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/architecture/guide/azure-resource-manager/advanced-templates/update-resource\">You can read more about using ARM templates on existing resources</a>.</li><br></ol>After these changes have been implemented, all access attempts that use primary/secondary key or access tokens authentication will be denied.<br></ol>",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Microsoft Defender for APIs brings new discovery, protection, detection, & response coverage to monitor for common API based attacks & security misconfigurations.<br>Note that after enabling this plan, you will need to complete the onboarding process by remediating a recommendation allowing you to select which APIs you would like to onboard. <br><a target=\"_blank\" href=\"https://aka.ms/apiSecurityOnboarding\">Learn more about the onboarding process here.</a>",
    "displayName": "Microsoft Defender for APIs should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/96946040-1b25-4dc4-b845-4f341b3fcaab",
    "implementationEffort": "High",
    "name": "96946040-1b25-4dc4-b845-4f341b3fcaab",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/7926a6d1-b268-4586-8197-e8ae90c877d7",
    "preview": null,
    "publishDates": {
      "ga": "11/14/2023",
      "public": "04/24/2023"
    },
    "remediationDescription": "To enable this plan on a subscription: 1. From Defender for Cloud's Environment settings page, select the relevant subscription. 2. In the Defender plans page, set APIs to On.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Credential Access",
      "Privilege Escalation",
      "Execution",
      "Defense Evasion",
      "Exfiltration",
      "Discovery",
      "Command and Control",
      "Initial Access",
      "Lateral Movement",
      "Impact"
    ],
    "techniques": [
      "Hijack Execution Flow",
      "Modify Authentication Process",
      "Boot or Logon Initialization Scripts",
      "Scheduled Task/Job",
      "Account Manipulation",
      "Office Application Startup",
      "OS Credential Dumping",
      "Obfuscated Files or Information",
      "Exfiltration Over Alternative Protocol",
      "Process Injection",
      "Command and Scripting Interpreter",
      "Exploitation for Privilege Escalation",
      "Indicator Removal on Host",
      "Valid Accounts",
      "System Information Discovery",
      "Account Discovery",
      "Ingress Tool Transfer",
      "Modify Registry",
      "Create Account",
      "Deobfuscate/Decode Files or Information",
      "Drive-by Compromise",
      "Indirect Command Execution",
      "Exploitation for Client Execution",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Signed Binary Proxy Execution",
      "File and Directory Permissions Modification",
      "Service Stop",
      "Create or Modify System Process",
      "Event Triggered Execution",
      "Boot or Logon Autostart Execution",
      "Abuse Elevation Control Mechanism",
      "Steal or Forge Kerberos Tickets",
      "Impair Defenses",
      "Remote Service Session Hijacking",
      "Hide Artifacts",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Brute Force",
      "Masquerading",
      "User Execution",
      "Subvert Trust Controls",
      "Compromise Client Software Binary"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender Cloud Security Posture Management (CSPM) provides enhanced posture capabilities and a new intelligent cloud security graph to help identify, prioritize, and reduce risk. Defender CSPM is available in addition to the free foundational security posture capabilities turned on by default in Defender for Cloud.",
    "displayName": "Microsoft Defender CSPM should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e0e431eb-22b3-4f34-ae0d-5ec229fc28e7",
    "implementationEffort": "High",
    "name": "e0e431eb-22b3-4f34-ae0d-5ec229fc28e7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f90fc71-a595-4066-8974-d4d0802e8ef0",
    "preview": true,
    "publishDates": {
      "ga": "05/22/2023",
      "public": "05/22/2023"
    },
    "remediationDescription": "To enable this plan in an Azure subscription or AWS account: 1. From Defender for Cloud's Environment settings page, select the relevant subscription / account. 2. In the Defender plans page, set Defender CSPM to On.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Credential Access",
      "Privilege Escalation",
      "Execution",
      "Defense Evasion",
      "Exfiltration",
      "Discovery",
      "Command and Control",
      "Initial Access",
      "Lateral Movement",
      "Impact"
    ],
    "techniques": [
      "Hijack Execution Flow",
      "Modify Authentication Process",
      "Boot or Logon Initialization Scripts",
      "Scheduled Task/Job",
      "Account Manipulation",
      "Office Application Startup",
      "OS Credential Dumping",
      "Obfuscated Files or Information",
      "Exfiltration Over Alternative Protocol",
      "Process Injection",
      "Command and Scripting Interpreter",
      "Exploitation for Privilege Escalation",
      "Indicator Removal on Host",
      "Valid Accounts",
      "System Information Discovery",
      "Account Discovery",
      "Ingress Tool Transfer",
      "Modify Registry",
      "Create Account",
      "Deobfuscate/Decode Files or Information",
      "Drive-by Compromise",
      "Indirect Command Execution",
      "Exploitation for Client Execution",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Signed Binary Proxy Execution",
      "File and Directory Permissions Modification",
      "Service Stop",
      "Create or Modify System Process",
      "Event Triggered Execution",
      "Boot or Logon Autostart Execution",
      "Abuse Elevation Control Mechanism",
      "Steal or Forge Kerberos Tickets",
      "Impair Defenses",
      "Remote Service Session Hijacking",
      "Hide Artifacts",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Brute Force",
      "Masquerading",
      "User Execution",
      "Subvert Trust Controls",
      "Compromise Client Software Binary"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "API Management subscriptions should be scoped to a product or an individual API instead of all APIs, which could result in an excessive data exposure.",
    "displayName": "API Management subscriptions should not be scoped to all APIs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/44aae697-8cc1-4ed1-a136-44a644bfd51f",
    "implementationEffort": null,
    "name": "44aae697-8cc1-4ed1-a136-44a644bfd51f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3aa03346-d8c5-4994-a5bc-7652c2a2aef1",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To remove Subscriptions at the All APIs scope: 1. In the Azure portal, find your API Management Resource 2. Navigate to the Subscriptions blade 3. For any subscriptions listed with a Scope of All APIs, change the scope of the Subscription to API or Subscription or suspend or delete the Subscription.",
    "severity": "Medium",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Man-in-the-Middle"
    ],
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To improve the API security, API Management should validate the backend server certificate for all API calls. Enable SSL certificate thumbprint and name validation.",
    "displayName": "API Management calls to API backends should not bypass certificate thumbprint or name validation",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e0905114-2b51-4728-ab31-550f2058ec6c",
    "implementationEffort": null,
    "name": "e0905114-2b51-4728-ab31-550f2058ec6c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/92bb331d-ac71-416a-8c91-02f2cb734ce4",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To enable certificate chain and certificate name validation: 1. In the Azure portal, find your API Management Resource 2. Navigate to the Backends blade 3. Select the backend from the Backends list 4. Select the Properties blade 5. Check the Validate certificate chain and Validate certificate name boxes 6. Select 'Save.'",
    "severity": "Medium",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Man-in-the-Middle"
    ],
    "threats": [
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To ensure security of data in transit, APIs should be available only through encrypted protocols, like HTTPS or WSS. Avoid using unsecured protocols, such as HTTP or WS. <br><b>Related OWASP API Security Top 10 Risks: </b><a href=\"https://owasp.org/API-Security/editions/2023/en/0xa8-security-misconfiguration/\" target=\"_blank\" rel=\"noreferrer noopener\">(API8:2023)</a> Security Misconfiguration",
    "displayName": "API Management APIs should use only encrypted protocols",
    "id": "/providers/Microsoft.Security/assessmentMetadata/741b141d-8111-4d86-a4e0-f74b06270a74",
    "implementationEffort": null,
    "name": "741b141d-8111-4d86-a4e0-f74b06270a74",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee7495e7-3ba7-40b6-bfee-c29e22cc75d4",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To set an API to HTTPS or WSS only for API Management Apis: 1. In the Azure portal, find your API Management Resource 2. Navigate to APIs and select the API 4. Select Settings 5. Under URL Scheme, select HTTPS for HTTP Apis, WSS for WebSocket Apis.",
    "severity": "High",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Man-in-the-Middle"
    ],
    "threats": [
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Named values are a collection of name and value pairs in each API Management service. Secret values can be stored either as encrypted text in API Management (custom secrets) or by referencing secrets in Azure Key Vault. To improve security of API Management and secrets, reference secret named values from Azure Key Vault. Azure Key Vault supports granular access management and secret rotation policies. <br><b>Related OWASP API Security Top 10 Risks: </b><a href=\"https://owasp.org/API-Security/editions/2023/en/0xa8-security-misconfiguration/\" target=\"_blank\" rel=\"noreferrer noopener\">(API8:2023)</a> Security Misconfiguration",
    "displayName": "API Management secret named values should be stored in Azure Key Vault",
    "id": "/providers/Microsoft.Security/assessmentMetadata/93b78b68-5f3f-46b2-acf1-c3e9e6e646d1",
    "implementationEffort": null,
    "name": "93b78b68-5f3f-46b2-acf1-c3e9e6e646d1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f1cc7827-022c-473e-836e-5a51cae0b249",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To utilize secrets stored in Key Vault in API Management: 1. In the Azure portal, find your API Management Resource 2. Navigate to the Named Values blade 3. Select 'Add' to create a new Named Value 4. Select 'Type' of Key Vault 5. Select the Key Vault and Secret associated with the Named Value. Learn more at: https://docs.microsoft.com/azure/api-management/api-management-howto-properties?tabs=azure-portal#key-vault-secrets",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataSpillage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "The direct management REST API in Azure API Management bypasses Azure Resource Manager role-based access control, authorization, and throttling mechanisms, thus increasing the vulnerability of your service. <br><b>Related OWASP API Security Top 10 Risks: </b><a href=\"https://owasp.org/API-Security/editions/2023/en/0xa4-unrestricted-resource-consumption/\" target=\"_blank\" rel=\"noreferrer noopener\">(API4:2023)</a> Unrestricted Resource Consumption",
    "displayName": "API Management direct management endpoint should not be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e2aeced9-6ef0-410e-b948-4aaa65ded9a7",
    "implementationEffort": null,
    "name": "e2aeced9-6ef0-410e-b948-4aaa65ded9a7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b741306c-968e-4b67-b916-5675e5c709f4",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To disable direct management of your API Management instance: 1. In the Azure portal, find your API Management Resource 2. Navigate to the Management API blade 3. Set Enable Management REST API to 'No.'",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To improve the security of API Management services, restrict connectivity to service configuration endpoints, like direct access management API, Git configuration management endpoint, or self-hosted gateways configuration endpoint. <br><b>Related OWASP API Security Top 10 Risks: </b><a href=\"https://owasp.org/API-Security/editions/2023/en/0xa8-security-misconfiguration/\" target=\"_blank\" rel=\"noreferrer noopener\">(API8:2023)</a> Security Misconfiguration",
    "displayName": "API Management should disable public network access to the service configuration endpoints",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e50066b7-731c-40c4-a325-9551154ee5ce",
    "implementationEffort": null,
    "name": "e50066b7-731c-40c4-a325-9551154ee5ce",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/df73bd95-24da-4a4f-96b9-4e8b94b402bd",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To disable public endpoints for API Management Service use API Management REST API: https://learn.microsoft.com/rest/api/apimanagement/tenant-access/update and set the `enabled` property for the corresponding tenant access resource to `false`. Valid tenant access resource names are: `access` for Management API endpoint, `gitaccess` for GIT configuration endpoint, `gatewayaccess` for self-hosted gateway configuration endpoint.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To prevent service secrets from being shared with read-only users, the minimum API version should be set to 2019-12-01 or higher.",
    "displayName": "API Management minimum API version should be set to 2019-12-01 or higher",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b9f2fa58-7571-4e7f-978f-5d224a011c89",
    "implementationEffort": null,
    "name": "b9f2fa58-7571-4e7f-978f-5d224a011c89",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/549814b6-3212-4203-bdc8-1548d342fb67",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To set the minimum API version of your API Management instance: 1. In the Azure portal, find your API Management Resource 2. Navigate to the Management API blade 3. Select Management API settings 4. Under Prevent users with read-only permissions from accessing service secrets, select 'Yes' 5. Select 'Save.'",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataSpillage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Calls from API Management to backends should use some form of authentication, whether via certificates or credentials. Does not apply to Service Fabric backends. <br><b>Related OWASP API Security Top 10 Risks: </b><a href=\"https://owasp.org/API-Security/editions/2023/en/0xa2-broken-authentication/\" target=\"_blank\" rel=\"noreferrer noopener\">(API2:2023)</a> Broken Authentication, <a href=\"https://owasp.org/API-Security/editions/2023/en/0xa8-security-misconfiguration/\" target=\"_blank\" rel=\"noreferrer noopener\">(API8:2023)</a> Security Misconfiguration",
    "displayName": "API Management calls to API backends should be authenticated",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2fd6b6c3-f52b-464d-a301-0d81c7b4839c",
    "implementationEffort": null,
    "name": "2fd6b6c3-f52b-464d-a301-0d81c7b4839c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c15dcc82-b93c-4dcb-9332-fbf121685b54",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "04/23/2023"
    },
    "remediationDescription": "To enable authentication for your backends 1. In the Azure portal, find your API Management Resource 2. Navigate to the Backends blade 3. Select the backend from the Backends list 4. Select the Authorization credentials blade 5. Enter authorization credentials in the query paraemters, client certificates, or Authorization header.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Azure API Management stv1 compute platform will be retired on 31 August 2024 and these instances should be migrated to stv2 compute platform for continued support. Learn more at https://learn.microsoft.com/azure/api-management/breaking-changes/stv1-platform-retirement-august-2024",
    "displayName": "Azure API Management platform version should be stv2",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e5f60ef8-3fcc-4fb5-bee7-7aaeb44c1509",
    "implementationEffort": null,
    "name": "e5f60ef8-3fcc-4fb5-bee7-7aaeb44c1509",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1dc2fc00-2245-4143-99f4-874c937f13ef",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "12/01/2023"
    },
    "remediationDescription": "The migration steps from platform version stv1 to stv2 depend on the service configuration. Learn how to migrate your instances here:  https://learn.microsoft.com/azure/api-management/migrate-stv1-to-stv2.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Ensure that all Azure Local machines meet the Secured-core requirements.",
    "displayName": "Azure Local machines should meet Secured-core requirements",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7a9de0cb-4c14-4528-a783-5123a6787dc9",
    "implementationEffort": null,
    "name": "7a9de0cb-4c14-4528-a783-5123a6787dc9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5e6bf724-0154-49bc-985f-27b2e07e636b",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "31/01/2024"
    },
    "remediationDescription": "To enable the Secured-core server requirements: <br>1. From the Azure Local instance page, go to Windows Admin Center and select Connect. <br>2. Go to the Security extension and select Secured-core. <br>3. Select any setting that is not enabled and click Enable.",
    "severity": "Low",
    "tactics": [
      "Credential Access",
      "Persistence"
    ],
    "techniques": [
      "OS Credential Dumping"
    ],
    "threats": [
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "At a minimum, apply the Microsoft WDAC base policy in enforced mode on all Azure Local machines. Applied Windows Defender Application Control (WDAC) policies must be consistent across machines in the same system.",
    "displayName": "Azure Local machines should have consistently enforced application control policies",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ce488796-a2d4-401f-a688-b3f4a1137921",
    "implementationEffort": null,
    "name": "ce488796-a2d4-401f-a688-b3f4a1137921",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/dad3a6b9-4451-492f-a95c-69efc6f3fada",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "31/01/2024"
    },
    "remediationDescription": "To enforce WDAC policies: <br>1. From the Azure Local instance page, go to Windows Admin Center and select Connect. <br>2. Go to the Security extension and select Windows Defender Application Control. <br>3. Select one or more policy and click Set to Enforced.",
    "severity": "High",
    "tactics": [
      "Execution"
    ],
    "techniques": [
      "Command and Scripting Interpreter",
      "User Execution"
    ],
    "threats": [
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Use BitLocker to encrypt the OS and data volumes on Azure Local instances.",
    "displayName": "Azure Local instances should have encrypted volumes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3ae946fb-cc91-4074-aa0d-09f0a09751fe",
    "implementationEffort": null,
    "name": "3ae946fb-cc91-4074-aa0d-09f0a09751fe",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ee8ca833-1583-4d24-837e-96c2af9488a4",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "31/01/2024"
    },
    "remediationDescription": "To enable Bitlocker encryption on cluster volumes: <br>1. From the Azure Local instance page, go to Windows Admin Center and select Connect. <br>2. To encrypt OS boot volumes, go to the Security extension and select Azure Local system security. <br>3. Select Bitlocker for OS boot nodes and click Enable. <br>4. For cluster data volumes, go to the Volumes tool and select the Inventory tab. <br>5. Select an individual volume and click Settings. <br>6. Check the Use encryption checkbox in the Encryption section and click Save.",
    "severity": "High",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Data from Information Repositories",
      "Data from Local System"
    ],
    "threats": [
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Protect data on the Azure Local machines network and on virtual machine network connections.",
    "displayName": "Host and VM networking should be protected on Azure Local instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1e001767-5bd6-423f-9640-f61efa3d77c6",
    "implementationEffort": null,
    "name": "1e001767-5bd6-423f-9640-f61efa3d77c6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/36f0d6bc-a253-4df8-b25b-c3a5023ff443",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "31/01/2024"
    },
    "remediationDescription": "To enable signing for external SMB traffic: <br>1. From the Azure Local instance page, go to Windows Admin Center and select Connect. <br>2. Go to the Security extension and select Azure Local system security. <br>3. Select Signing for external SMB traffic and click Enable.",
    "severity": "Low",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": [
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL is a unified package that provides advanced SQL security capabilities. It surfaces and mitigates potential database vulnerabilities, and detects anomalous activities that could indicate a threat to your database. Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "displayName": "Microsoft Defender for SQL should be enabled for unprotected PostgreSQL flexible servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bf2541d8-2d82-4cf3-a4e8-ed1137c90773",
    "implementationEffort": "Low",
    "name": "bf2541d8-2d82-4cf3-a4e8-ed1137c90773",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/d38668f5-d155-42c7-ab3d-9b57b50f8fbf",
    "preview": null,
    "publishDates": {
      "ga": "04/04/2024",
      "public": "04/04/2024"
    },
    "remediationDescription": "To enable Microsoft Defender for SQL on PostgreSQL flexible servers: 1. Select the SQL server. 2. Under 'Defender for Cloud', set Microsoft Defender for SQL to 'On'. 3. Select 'Save'. <br>Note: Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL is a unified package that provides advanced SQL security capabilities. It surfaces and mitigates potential database vulnerabilities, and detects anomalous activities that could indicate a threat to your database. Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "displayName": "Microsoft Defender for SQL should be enabled for unprotected MySQL flexible servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/41f5d060-b585-4780-918e-c31fe9821d02",
    "implementationEffort": "Low",
    "name": "41f5d060-b585-4780-918e-c31fe9821d02",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/3bc8a0d5-38e0-4a3d-a657-2cb64468fc34",
    "preview": null,
    "publishDates": {
      "ga": "08/01/2024",
      "public": "08/01/2024"
    },
    "remediationDescription": "To enable Microsoft Defender for SQL on MySQL flexible servers: 1. Select the SQL server. 2. Under 'Defender for Cloud', set Microsoft Defender for SQL to 'On'. 3. Select 'Save'. <br>Note: Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Defender for Cloud identified identities that are assigned with privileged admin roles at the resource group or subscription level without a time limit. Privileged admin roles are roles that can perform sensitive operations on the resource, such as Owner, Contributor, Role-Based Access Control Administrator, and User Access Administrator. It is recommended to use Just-in-Time access through Microsoft Entra Privileged Identity Management (PIM) as well as other protective measures to mitigate the risk of unnecessary or unauthorized access. Granting permanent access can be risky, as it could result in human error or hardware hacks.",
    "displayName": "Privileged roles should not have permanent access at the subscription and resource group level",
    "id": "/providers/Microsoft.Security/assessmentMetadata/706b33f0-129e-4ed0-a179-f450b9ee4145",
    "implementationEffort": "Moderate",
    "name": "706b33f0-129e-4ed0-a179-f450b9ee4145",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/01/2024"
    },
    "remediationDescription": "1. Sign in to the <a href='https://entra.microsoft.com'>Microsoft Entra admin center</a> as a <a href='https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference#global-administrator'>Global Administrator</a>. <br> 2. To switch directories where you want to use Privileged Identity Management, select your user name in the upper right corner of the Microsoft Entra admin center. <br> 3. Browse to Identity governance > Privileged Identity Management. <br> Make sure the first person to use PIM in your organization is assigned to the <a href='https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference#security-administrator'>Security Administrator</a> and <a href='https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/permissions-reference#privileged-role-administrator'>Privileged Role Administrator</a> roles. <br> <em>If you don't have Microsoft Entra Privileged Identity Management in your organization, you can use <a href='https://learn.microsoft.com/en-us/powershell/module/microsoft.graph.identity.directorymanagement/get-mgdirectoryrolemember'>Microsoft Graph PowerShell</a>.</em> <br> 4. Under Privileged Identity management, click on My roles -> Active assignments. <br> 5.Review all assignments that are at the subscription/resource group level for high privileged roles (Owner, Contributor, Role-Based Access Control Administrator). Delete the assignments.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Valid Accounts",
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Defender for Cloud identified Service Principals that are assigned with privileged roles at the resource group or subscription level. Privileged admin roles are roles that can perform sensitive operations on the resource, such as, Owner, Contributor or User Access Administrator. Service principals play a crucial role in managing Azure resources efficiently and securely, eliminating the need for human intervention. <br> It is important to follow the <a href='https://en.wikipedia.org/wiki/Principle_of_least_privilege'>principle of least privilege</a>, grant only the minimum level of access necessary for a given service principal to perform their duties. <br> Admins and privileged access are primary target of hackers. For best practices when using privileged administrator role assignments, see <a href='https://learn.microsoft.com/en-us/azure/role-based-access-control/best-practices#limit-privileged-administrator-role-assignments'>Best practices for Azure RBAC</a>. For a list of available roles in Azure RBAC, see <a href='https://learn.microsoft.com/en-us/azure/role-based-access-control/built-in-roles'>Azure's built-in roles</a>.",
    "displayName": "Service Principals should not be assigned with administrative roles at the subscription and resource group level",
    "id": "/providers/Microsoft.Security/assessmentMetadata/effc9a76-a5a6-40ac-b20d-59dc45bddf99",
    "implementationEffort": "Moderate",
    "name": "effc9a76-a5a6-40ac-b20d-59dc45bddf99",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/01/2024"
    },
    "remediationDescription": "To view Role Assignments on your Subscription / Resource Group <br>1. Go to Azure Portal -> Navigate to Subscription / Resource Group <br>2. Click on the Access control (IAM) -> Click on Role assignments <br>3. Click on 'view assignments' under 'Privileged' <br>4. Look for assignment type 'App' or search by name on the affected identity <br>5. Remove access to the administrative roles (Owner, Contributor or User Access Administrator) at the subscription and resource group level, and follow <a href='https://learn.microsoft.com/en-us/azure/role-based-access-control/best-practices'>best practices for Azure RBAC</a> <em>NOTE: Perform thorough validation before safely removing the critical roles that are assigned</em>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL is a unified package that provides advanced SQL security capabilities. It identifies potential database vulnerabilities, helps you mitigate those vulnerabilities, and detects anomalous activities that could indicate compromises to your database. Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-defender-for-cloud\">pricing details per region</a>.",
    "displayName": "Microsoft Defender for SQL should be enabled for unprotected Azure Synapse workspaces",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ae7329f0-b676-4c8b-8c69-45f4e29ba304",
    "implementationEffort": "Low",
    "name": "ae7329f0-b676-4c8b-8c69-45f4e29ba304",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/d31e5c31-63b2-4f12-887b-e49456834fa1",
    "preview": null,
    "publishDates": {
      "ga": "15/04/2024",
      "public": "15/04/2024"
    },
    "remediationDescription": "To enable Microsoft Defender for SQL on Synapse workspaces: 1. In the Azure portal, open the SQL Synapse workspace. 2. Under 'Defender for Cloud', set Microsoft Defender for SQL to 'On'. 3. Under 'Vulnerability Assessment Settings', configure a storage account for storing vulnerability assessment scan results and set 'Periodic recurring scans' to 'On'. 4. Select 'Save'. Note: Microsoft Defender for SQL is billed as shown on <a target=\"_blank\" href=\"https://aka.ms/pricing-defender-for-cloud\">pricing details per region</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud identified Virtual Networks without enabled flow logs. Enabling flow logs allows to log information about IP traffic flowing through virtual network. It can be used for optimizing network flows, monitoring throughput, verifying compliance, detecting intrusions and more. Without Flow Logs it is not possible to know the current state of the network, who's connecting, and where users are connecting from.",
    "displayName": "Flows logs should be enabled on Virtual Networks",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d76e3798-ff8d-4f0f-996c-12e275a58b9f",
    "implementationEffort": "Low",
    "name": "d76e3798-ff8d-4f0f-996c-12e275a58b9f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/cd6f7aff-2845-4dab-99f2-6d1754a754b0",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "30/01/2025"
    },
    "remediationDescription": "To enable Flow Log on Virtual Network:<br>1. In the Azure portal, navigate to your virtual network.<br>2. Under 'Monitoring', select 'Virtual network flow logs'.<br>3. Select '+ Create' or 'Create flow log' blue button.<br><br>For more details, follow <a href='https://learn.microsoft.com/en-us/azure/network-watcher/vnet-flow-logs-portal/'>the instructions</a>. <br><br>Important: Flow Logs are billed separately from virtual networks and Defender for Cloud. Learn more about <a href='https://azure.microsoft.com/en-us/pricing/details/network-watcher/'>Network Watcher pricing</a>.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Restricting internet exposure to specific IPs or IP ranges reduces the risk of bad actors accessing your database from outside the organization.",
    "displayName": "Azure PostgreSQL flexible server should restrict public access ranges",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fbcf37c1-ab27-41b2-a195-1f340afdfefb",
    "implementationEffort": null,
    "name": "fbcf37c1-ab27-41b2-a195-1f340afdfefb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "08/01/2025",
      "public": "06/01/2025"
    },
    "remediationDescription": "To reduce the risk of excessive internet exposure for your Azure PostgreSQL flexible server:<br>1. In Azure Portal, open your Azure PostgreSQL Flexible Server.<br>2. Click on 'Networking' on the left pane.<br>3. In the 'Firewall Rules' section, locate the rules table.<br>4. Identify the rule where 'Start IP address' is 0.0.0.0 and 'End IP address' is 255.255.255.255.<br>5. Remove the rule and click 'Save'.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Restricting internet exposure to specific IPs or IP ranges reduces the risk of bad actors accessing your database from outside the organization.",
    "displayName": "Azure MySQL flexible server should restrict public access ranges",
    "id": "/providers/Microsoft.Security/assessmentMetadata/88dcc8c7-8002-455a-adc8-7831021cb99a",
    "implementationEffort": null,
    "name": "88dcc8c7-8002-455a-adc8-7831021cb99a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "08/01/2025",
      "public": "06/01/2025"
    },
    "remediationDescription": "To reduce the risk of excessive internet exposure for your Azure MySQL flexible server:<br>1. In Azure Portal, open your Azure MySQL Flexible Server.<br>2. Click on 'Networking' on the left pane.<br>3. In the 'Firewall Rules' section, locate the rules table.<br>4. Identify the rule where 'Start IP address' is 0.0.0.0 and 'End IP address' is 255.255.255.255.<br>5. Remove the rule and click 'Save'.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Infrastructure Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Azure Backup is a cost-effective data protection solution native to Azure that safeguards data on Azure virtual machines.<br> It creates recovery points stored in geo-redundant recovery vaults, allowing for the restoration of either the entire VM or specific files.<br> If Azure Backup is not enabled, data loss may occur without the possibility of recovery, posing a significant risk to business continuity and data integrity.<br>",
    "displayName": "Azure Backup should be enabled for virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f2f595ec-5dc6-68b4-82ef-b63563e9c610",
    "implementationEffort": null,
    "name": "f2f595ec-5dc6-68b4-82ef-b63563e9c610",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/013e242c-8828-4970-87b3-ab247555486d",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "1. To enable Azure Backup for a virtual machine, navigate to the virtual machine on the Azure portal and select 'Backup' from the menu. In the screen that appears, choose whether to backup the machine to a new or existing Recovery Services vault in the same location and subscription. Learn more at https://aka.ms/AzureVMBackupDoc 2. To enable Azure Backup for multiple virtual machines, assign the policy 'Configure backup on VMs of a location to an existing central Vault in the same location' to the relevant scope. This policy can be assigned to one subscription-location pair at a time. Learn more at http://aka.ms/AzureBackupVMGovernance. Charges are based on the number and size of VMs being protected. Learn more about pricing at https://azure.microsoft.com/pricing/details/backup/",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Disk Wipe",
      "Defacement",
      "Data Encrypted for Impact",
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Defender for Cloud identified that Managed Identity (System-assigned or User-assigned) is not enabled in the Identity settings of your Azure Functions. <br> This poses a risk of compromised secrets and reduced security when accessing Azure resources. Properly configuring Managed Identity ensures secure, automated credential management.<br>",
    "displayName": "Managed identity should be enabled on function apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/23aa9cbe-c2fb-6a2f-6c97-885a6d48c4d1",
    "implementationEffort": null,
    "name": "23aa9cbe-c2fb-6a2f-6c97-885a6d48c4d1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0da106f2-4ca3-48e8-bc85-c638fe6aea8f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable and configure a Managed Identity:<br>1. In the Azure portal, navigate to your Azure Function.<br>2. From the left menu, select Identity.<br>3. Enable and configure a System-assigned or User-assigned Managed Identity for secure, credential-less access to resources.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Database for MariaDB allows the option to set up geo-redundant backup storage.<br> This means that data is stored not only in the server's host region, but also replicated to a paired region.<br> This provides recovery options in the event of a region failure.<br> However, this configuration can only be set up when creating a server.<br> If not enabled, the database may be at risk of data loss in case of a regional outage.<br> Therefore, we recommend enabling geo-redundant backup for enhanced data protection.<br>",
    "displayName": "Geo-redundant backup should be enabled for Azure Database for MariaDB",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2ce368b5-7882-89fd-6645-885b071a2409",
    "implementationEffort": null,
    "name": "2ce368b5-7882-89fd-6645-885b071a2409",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0ec47710-77ff-4a3d-9181-6aa50af424d0",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure your Azure Database for MariaDB server with geo-redundant backup during server creation, select the 'Geo-Redundant' option for the server in the Compute + Storage configuration.<br>For more information, see: <a href=\"https://go.microsoft.com/fwlink/?linkid=2086853\" target=\"_blank\">https://go.microsoft.com/fwlink/?linkid=2086853</a>",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction",
      "Data Encrypted for Impact",
      "Defacement",
      "Disk Wipe"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Defender for Cloud identified that Managed Identity (System-assigned or User-assigned) is not enabled in the Identity settings of your Web Apps.<br> This poses a risk of compromised secrets and reduced security when accessing Azure resources. Properly configuring Managed Identity ensures secure, automated credential management.<br>",
    "displayName": "Managed identity should be enabled on web apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4a3d7cd3-f17c-637a-1ffc-614a01dd03cf",
    "implementationEffort": null,
    "name": "4a3d7cd3-f17c-637a-1ffc-614a01dd03cf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2b9ad585-36bc-4615-b300-fd4435808332",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable and configure a Managed Identity:<br>1. In the Azure portal, navigate to your Web App.<br>2. From the left menu, select Identity.<br>3. Enable and configure a System-assigned or User-assigned Managed Identity for secure, credential-less access to resources.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Database for PostgreSQL provides the option to set up geo-redundant backup storage.<br> This means that data is stored not only in the server's host region, but also replicated to a paired region.<br> This redundancy provides recovery options in the event of a regional failure.<br> However, it's important to note that this configuration can only be set up when creating a server.<br> If geo-redundant backup is not enabled, the database may be at risk of data loss in case of a region failure.<br>",
    "displayName": "Geo-redundant backup should be enabled for Azure Database for PostgreSQL",
    "id": "/providers/Microsoft.Security/assessmentMetadata/95592ab0-ddc8-660d-67f3-6df1fadfe7ec",
    "implementationEffort": null,
    "name": "95592ab0-ddc8-660d-67f3-6df1fadfe7ec",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/48af4db5-9b8b-401c-8e74-076be876a430",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure your Azure Database for PostgreSQL server with geo-redundant backup during server creation, select the 'Geo-Redundant' option for the server in the Compute + Storage configuration.<br>For more information, see: <a href=\"https://go.microsoft.com/fwlink/?linkid=867615\" target=\"_blank\">https://go.microsoft.com/fwlink/?linkid=867615</a>",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction",
      "Data Encrypted for Impact",
      "Defacement",
      "Disk Wipe"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Web apps should be configured to request an SSL certificate for all incoming requests.<br> This is done using client certificates, which ensure that only clients with a valid certificate can access the app.<br> If this is not implemented, unauthorized clients may be able to access the app, potentially leading to security breaches and data leaks.<br> Therefore, it is crucial to enforce this security measure to protect the app and its data.<br>",
    "displayName": "Web apps should request an SSL certificate for all incoming requests",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ca4e6a5a-3a9a-bad3-798a-d420a1d9bd6d",
    "implementationEffort": null,
    "name": "ca4e6a5a-3a9a-bad3-798a-d420a1d9bd6d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5bb220d9-2698-4ee4-8404-b9c30c9df609",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To set Client Certificates for your Web App:<br>1. Navigate to Azure App Service 2. Select Configuration 3. Go to the General Settings tab 4. Set Incoming Client Certificates to Require.<br>For more information, visit here: <a href=\"https://aka.ms/auth-tls\" target=\"_blank\">https://aka.ms/auth-tls</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Trusted Relationship"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Database for MySQL provides the option to set up geo-redundant backup storage.<br> This means that data is stored not only in the server's host region, but also replicated to a paired region.<br> This setup provides recovery options in the event of a regional failure.<br> If geo-redundant backup is not enabled, the risk of data loss increases significantly in the event of a regional outage.<br> It's important to note that this configuration can only be set up when creating a server.<br>",
    "displayName": "Geo-redundant backup should be enabled for Azure Database for MySQL",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8ad68a2f-c6b1-97b5-41b5-174359a33688",
    "implementationEffort": null,
    "name": "8ad68a2f-c6b1-97b5-41b5-174359a33688",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82339799-d096-41ae-8538-b108becf0970",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure your Azure Database for MySQL server with geo-redundant backup during server creation, select the 'Geo-Redundant' option for the server in the Compute + Storage configuration.<br>For more information, see: <a href=\"https://go.microsoft.com/fwlink/?linkid=867608\" target=\"_blank\">https://go.microsoft.com/fwlink/?linkid=867608</a>",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction",
      "Data Encrypted for Impact",
      "Defacement",
      "Disk Wipe"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "The Transport Layer Security (TLS) protocol provides secure communication between web applications and servers.<br>\nUsing outdated versions of TLS can expose the system to vulnerabilities and potential attacks.<br>\nBy updating to the latest version, you can ensure the highest level of security for your API apps.<br>",
    "displayName": "TLS should be updated to the latest version for API apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5a659d57-117d-bb18-65f6-54e51da1bb9b",
    "implementationEffort": null,
    "name": "5a659d57-117d-bb18-65f6-54e51da1bb9b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8cb6aa8b-9e41-4f4e-aa25-089a7ac2581e",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To update your API app to the latest TLS version:<br>1. Navigate to Azure App Service 2. Select TLS/SSL settings 3. Under the Protocol Settings section, choose the latest Minimum TLS Version.<br>For more information on managing TLS/SSL settings, visit here: <a href=\"https://aka.ms/add-tls\" target=\"_blank\">https://aka.ms/add-tls</a>",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Enabling diagnostic logs in App Service is a crucial step for maintaining a secure and transparent system.<br> These logs provide a detailed record of activities, which can be invaluable for investigating security incidents or network compromises.<br> If diagnostic logs are not enabled, it may be difficult to identify and resolve security issues, potentially leading to prolonged system vulnerabilities and increased risk of data breaches.<br>",
    "displayName": "Diagnostic logs in App Service should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/40394a2c-60fb-7cc5-1944-065772e94f05",
    "implementationEffort": null,
    "name": "40394a2c-60fb-7cc5-1944-065772e94f05",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/91a78b24-f231-4a8a-8da9-02c35b2b6510",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable resource logs for an App Service: 1. Navigate to your App Service. 2. Go to 'Diagnostic Settings' tab. 3. Enable necessary auditing services for your specified apps. For more information, please go to <a href=\"https://aka.ms/enabling-diagnostic-settings\" target=\"_blank\">https://aka.ms/enabling-diagnostic-settings</a>.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Using a managed identity in API apps on Azure significantly enhances authentication security.<br>\nManaged identities provide an identity for the Azure resource in Azure AD, which is used to obtain Azure AD tokens, eliminating the need for developers to manage credentials.<br>\nWithout this, the management of credentials could become complex and potentially lead to security vulnerabilities.<br>\nTherefore, we recommend to use managed identities in API apps to ensure secure and efficient authentication.<br>",
    "displayName": "Managed identity should be used in API apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cc6d1865-7617-3cb2-cf7d-4cfc01ece1df",
    "implementationEffort": null,
    "name": "cc6d1865-7617-3cb2-cf7d-4cfc01ece1df",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c4d441f8-f9d9-4a9e-9cef-e82117cb3eef",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To create a managed identity for your API app:<br>1. Go to the App Service for your API app 2. Scroll to the Settings group in the left navigation 3. Select Identity 4. Use System assigned or User assigned identity following the steps described in this doc: <a href=\"https://aka.ms/managed-identity\" target=\"_blank\">https://aka.ms/managed-identity</a>",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SSL, or Secure Sockets Layer, encrypts the data stream between the server and client applications, providing protection against 'man in the middle' attacks.<br> If SSL enforcement is not enabled, the data transmitted between your database server and client applications could be vulnerable to interception and unauthorized access.<br> Therefore, it is crucial to always enable SSL when accessing your database server to ensure secure communication.<br>",
    "displayName": "Enforce SSL connection should be enabled for PostgreSQL database servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1fde2073-a488-17e9-9534-5a3b23379b4b",
    "implementationEffort": null,
    "name": "1fde2073-a488-17e9-9534-5a3b23379b4b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d158790f-bfb0-486c-8631-2dc6b4e8e6af",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enforce the use of SSL-based encrypted connections for all traffic to your Azure Database for PostgreSQL:<br>1. Select your Azure Database for PostgreSQL. 2. In Connection Security, set Enforce SSL connection to 'Enabled'.<br>For more information, see: <a href=\"https://go.microsoft.com/fwlink/?linkid=848213\" target=\"_blank\">https://go.microsoft.com/fwlink/?linkid=848213</a>",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enforcing SSL connections for Azure Database for MySQL servers is a critical security measure.<br> SSL encryption helps protect against 'man in the middle' attacks by encrypting the data stream between the server and the application.<br> If SSL is not enforced, the data transmitted between the server and client applications could be vulnerable to interception and unauthorized access.<br> Therefore, it is strongly recommend to always enable SSL for accessing your database server.<br>",
    "displayName": "Enforce SSL connection should be enabled for MySQL database servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1f6d29f6-4edb-ea39-042b-de8f123ddd39",
    "implementationEffort": null,
    "name": "1f6d29f6-4edb-ea39-042b-de8f123ddd39",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e802a67a-daf5-4436-9ea6-f6d821dd0c5d",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enforce the use of SSL-based encrypted connections for all traffic to your Azure Database for MySQL:<br>1. Select your Azure Database for MySQL. 2. In Connection Security, set Enforce SSL connection to 'Enabled'.<br>For more information, see: <a href=\"https://go.microsoft.com/fwlink/?linkid=848211\" target=\"_blank\">https://go.microsoft.com/fwlink/?linkid=848211</a>",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Upgrading to the latest version of TLS (Transport Layer Security) for web apps is a critical security measure.<br>\nThe latest version of TLS provides enhanced encryption and security features, protecting data during transmission.<br>\nIf not updated, the web app could be susceptible to various security threats, including data breaches and man-in-the-middle attacks.<br>\nTherefore, it is strongly advised to keep TLS updated to the latest version to ensure secure data transmission.<br>",
    "displayName": "TLS should be updated to the latest version for web apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2a54c352-7ca4-4bae-ad46-47ecd9595bd2",
    "implementationEffort": null,
    "name": "2a54c352-7ca4-4bae-ad46-47ecd9595bd2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f0e6e85b-9b9f-4a4b-b67b-f730d42f1b0b",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To update your web app to the latest TLS version:<br>1. Navigate to Azure App Service  2. Select TLS/SSL settings 3. Under the Protocol Settings section, choose the latest Minimum TLS Version.<br>For more information on managing TLS/SSL settings, visit here: <a href=\"https://aka.ms/add-tls\" target=\"_blank\">https://aka.ms/add-tls</a>",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "It's important to regularly update the TLS software used in function apps to the latest version.<br>\nThe Transport Layer Security (TLS) protocol provides secure communication between web applications and servers.<br>\nUsing outdated versions of TLS can expose the function apps to vulnerabilities and potential cyber attacks.<br>\nTherefore, we recommend to always use the latest version of TLS to ensure the highest level of security and data protection.<br>",
    "displayName": "TLS should be updated to the latest version for function apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/15be5f3c-e0a4-c0fa-fbff-8e50339b4b22",
    "implementationEffort": null,
    "name": "15be5f3c-e0a4-c0fa-fbff-8e50339b4b22",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f9d614c5-c173-4d56-95a7-b4437057d193",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To update your function app to the latest TLS version:<br>1. Navigate to Azure App Service  2. Select TLS/SSL settings 3. Under the Protocol Settings section, choose the latest Minimum TLS Version.<br>For more information on managing TLS/SSL settings, visit here: <a href=\"https://aka.ms/add-tls\" target=\"_blank\">https://aka.ms/add-tls</a>",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "It's important to regularly update the PHP software used in API apps to the latest version.<br> Newer versions often include security fixes and additional functionalities.<br> If not updated, the API apps may be exposed to security vulnerabilities present in older versions, potentially leading to breaches.<br> Additionally, staying updated allows the apps to benefit from the new features and improvements introduced in the latest versions.<br>",
    "displayName": "PHP should be updated to the latest version for API apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6b86d069-b3c3-b4d7-47c7-e73ddf786a63",
    "implementationEffort": null,
    "name": "6b86d069-b3c3-b4d7-47c7-e73ddf786a63",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1bc1795e-d44a-4d48-9b3b-6fff0fd5f9ba",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To set the PHP version for your API app, follow the instructions to show and set the version using the Azure CLI outlined in this document: <a href=\"https://aka.ms/configure-php\" target=\"_blank\">https://aka.ms/configure-php</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "It's important to regularly update Java for API apps to the latest version.<br> New versions often include security fixes for identified vulnerabilities and may also introduce additional functionality.<br> If Java is not updated, the API apps could be exposed to security risks due to potential flaws in older versions.<br> Additionally, they may miss out on the benefits of new features and improvements offered in the latest versions.<br>",
    "displayName": "Java should be updated to the latest version for API apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/08a3b009-0178-ee60-e357-e7ee5aea59c7",
    "implementationEffort": null,
    "name": "08a3b009-0178-ee60-e357-e7ee5aea59c7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/88999f4c-376a-45c8-bcb3-4058f713cf39",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To set the latest Java version for your API app:<br>1. Navigate to Azure App Service 2. Go to Configuration 3. Select the latest Java version in the JVM drop down.<br>For more information, visit here: <a href=\"https://aka.ms/configure-java\" target=\"_blank\">https://aka.ms/configure-java</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "It's important to regularly update the Python software used in API apps to the latest version.<br>\nNewer versions often include security fixes and additional functionalities.<br>\nIf not updated, the API apps may be exposed to security vulnerabilities present in older versions, potentially leading to breaches.<br>\nStaying updated ensures the apps benefit from the latest security patches and features.<br>",
    "displayName": "Python should be updated to the latest version for API apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c2c90d64-38e2-e984-1457-7f4a98168c72",
    "implementationEffort": null,
    "name": "c2c90d64-38e2-e984-1457-7f4a98168c72",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/74c3584d-afae-46f7-a20a-6f8adba71a16",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To set the Python version for your API app, follow the instructions to show and set the version using the Azure CLI outlined in this document: <a href=\"https://aka.ms/configure-python\" target=\"_blank\">https://aka.ms/configure-python</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": " This configuration ensures secure communication by allowing access only from known networks and blocking all other IP addresses, including those within Azure.<br> If not enabled, the PostgreSQL servers could be exposed to potential threats from unknown networks, leading to unauthorized access or data breaches.<br> Therefore, it's crucial to configure a private endpoint connection for enhanced security.<br>",
    "displayName": "Private endpoint should be enabled for PostgreSQL servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c5b83aed-f53d-5201-8ffb-1f9938de410a",
    "implementationEffort": null,
    "name": "c5b83aed-f53d-5201-8ffb-1f9938de410a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0564d078-92f5-4f97-8398-b9f58a51f70b",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure Private Link for Azure Database for PostgreSQL:<br>1. Navigate to your Azure Database for PostgreSQL. 2. Select Private Endpoint Connections in the left-hand pane 3. Click on \"+Private Endpoint\" and follow the instructions provided <a href=\"https://docs.microsoft.com/azure/postgresql/howto-configure-privatelink-portal\" target=\"_blank\">https://docs.microsoft.com/azure/postgresql/howto-configure-privatelink-portal</a>. <br>For more information, see: <a href=\"https://aka.ms/pgprivatelink\" target=\"_blank\">https://aka.ms/pgprivatelink</a>",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Private endpoints allow secure communication by providing private connectivity and limiting access to traffic from known networks only.<br>\nWithout this configuration, the server could be exposed to access from unknown and potentially malicious IP addresses, including those within Azure.<br>\nThis could lead to unauthorized access or data breaches.<br>\nTherefore, it is crucial to enable a private endpoint for MariaDB servers to enhance security.<br>",
    "displayName": "Private endpoint should be enabled for MariaDB servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ca9b93fe-6f1f-676c-2f31-d20f88fdbe56",
    "implementationEffort": null,
    "name": "ca9b93fe-6f1f-676c-2f31-d20f88fdbe56",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a1302fb-a631-4106-9753-f3d494733990",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure Private Link for Azure Database for MariaDB:<br>1. Navigate to your Azure Database for MariaDB. 2. Select Private Endpoint Connections in the left-hand pane 3. Click on \"+Private Endpoint\" and follow the instructions provided <a href=\"https://docs.microsoft.com/azure/mariadb/howto-configure-privatelink-portal\" target=\"_blank\">https://docs.microsoft.com/azure/mariadb/howto-configure-privatelink-portal</a>.<br>For more information, see: <a href=\"https://aka.ms/mariadbprivatelink\" target=\"_blank\">https://aka.ms/mariadbprivatelink</a>",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enabling private endpoint connections for Azure Database for MySQL servers is a key security measure.<br> This configuration secures communication by allowing access only from known networks and blocking all other IP addresses, including those within Azure.<br> If not enabled, the MySQL servers could be exposed to potential threats and unauthorized access from unknown networks.<br> Therefore, it's crucial to configure a private endpoint connection to maintain a secure environment.<br>",
    "displayName": "Private endpoint should be enabled for MySQL servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cec4922b-1eb3-cb74-660b-ffad9b9ac642",
    "implementationEffort": null,
    "name": "cec4922b-1eb3-cb74-660b-ffad9b9ac642",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7595c971-233d-4bcf-bd18-596129188c49",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure Private Link for Azure Database for MySQL:<br>1. Navigate to your Azure Database for MySQL. 2. Select Private Endpoint Connections in the left-hand pane 3. Click on \"+Private Endpoint\" and follow the instructions provided <a href=\"https://docs.microsoft.com/azure/mysql/howto-configure-privatelink-portal\" target=\"_blank\">https://docs.microsoft.com/azure/mysql/howto-configure-privatelink-portal</a>.<br>For more information, see: <a href=\"https://aka.ms/mysqlprivatelink\" target=\"_blank\">https://aka.ms/mysqlprivatelink</a>",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL servers should be configured with an audit log retention period of at least 90 days.<br>\nThis is to ensure that audit logs are available for a sufficient period of time for review and analysis in case of any security incidents.<br>\nIf the retention period is less than 90 days, there may not be enough data available for a thorough investigation, potentially hindering the identification and resolution of security issues.<br>\nTherefore, we recommend setting the audit retention for SQL servers to a minimum of 90 days.<br>",
    "displayName": "Audit retention for SQL servers should be set to at least 90 days",
    "id": "/providers/Microsoft.Security/assessmentMetadata/620671b8-6661-273a-38ac-4574967750ec",
    "implementationEffort": null,
    "name": "620671b8-6661-273a-38ac-4574967750ec",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/89099bee-89e0-4b26-a5f4-165451757743",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure auditing retention on your Azure SQL server or Azure Synapse server:<br>1.From the Azure portal, select the Azure SQL Server or Azure Synapse resource. 2.From the menu, select Auditing. 3.Select Storage details. 4.To set a new retention period of 90 days or higher, manually enter a value or move the slider for Retention (Days). 5.Select OK.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "FTPS, or FTP Secure, provides an additional layer of security by encrypting the file transfer process.<br> This helps safeguard sensitive data from unauthorized access.<br> If this measure isn't implemented, the apps could be at risk of data breaches and unauthorized access, which could compromise user data and the integrity of the system.<br> Therefore, we recommend enabling FTPS enforcement.<br>",
    "displayName": "FTPS should be required in function apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/972a6579-f38f-c0b9-1b4b-a5bbeba3ab5b",
    "implementationEffort": null,
    "name": "972a6579-f38f-c0b9-1b4b-a5bbeba3ab5b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/399b2637-a50f-4f95-96f8-3a145476eb15",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To ensure enforcement of FTPS only for your function app:<br>1. Navigate to the Configurations for your Function app.<br>2. Select Configuration, and go to the General Settings tab.<br>3. Select the General Settings tab.<br>4. Under the FTP state section, select FTPS only.<br>For more information, visit here: <a href=\"https://aka.ms/deploy-ftp\" target=\"_blank\">https://aka.ms/deploy-ftp</a><br>Learn more about <a href=\"https://docs.microsoft.com/en-us/azure/azure-functions/functions-deployment-technologies#deployment-technology-availability\" target=\"_blank\">Azure Functions Deployment Technology Availability</a>",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "FTPS, or FTP Secure, provides an additional layer of security by encrypting the file transfer process.<br> This helps safeguard sensitive data from unauthorized access.<br> If this measure isn't implemented, the apps could be at risk of data breaches and unauthorized access, which could compromise user data and the integrity of the system.<br> Therefore, we recommend enabling FTPS enforcement.<br>",
    "displayName": "FTPS should be required in web apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/19beaa2a-a126-b4dd-6d35-617f6cc83fca",
    "implementationEffort": null,
    "name": "19beaa2a-a126-b4dd-6d35-617f6cc83fca",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4d24b6d4-5e53-4a4f-a7f4-618fa573ee4b",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To ensure enforcement of FTPS only for your web app:<br>1. Go to the App Service for your API app 2. Select Configuration, and go to the General Settings tab 3. In FTP state, select FTPS only.<br>For more information, visit here: <a href=\"https://aka.ms/deploy-ftp\" target=\"_blank\">https://aka.ms/deploy-ftp</a>",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "FTPS, or FTP Secure, provides an additional layer of security by encrypting the file transfer process.<br> This helps safeguard sensitive data from unauthorized access.<br> If this measure isn't implemented, the apps could be at risk of data breaches and unauthorized access, which could compromise user data and the integrity of the system.<br> Therefore, we recommend enabling FTPS enforcement.<br>",
    "displayName": "FTPS should be required in API apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/67fc622b-4ce6-8c52-08ae-9f830036b757",
    "implementationEffort": null,
    "name": "67fc622b-4ce6-8c52-08ae-9f830036b757",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9a1b8c48-453a-4044-86c3-d8bfd823e4f5",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To ensure enforcement of FTPS only for your API app:<br>1. Go to the App Service for your API app 2. Select Configuration, and go to the General Settings tab 3. In FTP state, select FTPS only.<br>For more information, visit here: <a href=\"https://aka.ms/deploy-ftp\" target=\"_blank\">https://aka.ms/deploy-ftp</a>",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Enabling Client Certificates in function apps is a security measure that ensures only clients with valid certificates can access the app.<br> This feature requests a certificate for incoming requests, acting as a form of authentication.<br> If this is not enabled, the app could be exposed to unauthorized access, potentially leading to data breaches or other security incidents.<br> Therefore, we recommend enabling incoming client certificates for function apps to maintain a secure environment.<br>",
    "displayName": "Function apps should have Client Certificates (Incoming client certificates) enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c2ab4bea-c663-3259-a4cd-03a8feb02825",
    "implementationEffort": null,
    "name": "c2ab4bea-c663-3259-a4cd-03a8feb02825",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/eaebaea7-8013-4ceb-9d14-7eb32271373c",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To set Client Certificates for your Function App: 1. Navigate to your App Service 2. Select Configuration 3. Go to the General Settings tab 4. Set Incoming Client Certificates to Require For more information, visit here: https://aka.ms/auth-tls",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Trusted Relationship"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Enabling purge protection on key vaults is a critical security measure to prevent permanent data loss.<br> This feature enforces a mandatory retention period for soft-deleted key vaults, making them immune to purging during this period.<br> Without this protection, a malicious insider could potentially delete and purge key vaults, leading to irreversible data loss.<br> Therefore, it's important to activate purge protection to safeguard against such insider threats.<br>",
    "displayName": "Key vaults should have deletion protection enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4ed62ae4-5072-f9e7-8d94-51c76c48159a",
    "implementationEffort": null,
    "name": "4ed62ae4-5072-f9e7-8d94-51c76c48159a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b60c0b2-2dc2-4e1c-b5c9-abbed971de53",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable purge protection for your key vault:  1. Log in to the Azure portal and select your key vault. 2. Click on the 'Properties' tab. 3. Select the radio button corresponding to \"Enable purge protection\". 4. Select 'Save'. Soft delete is a pre-requisite for purge protection, if you have not already enabled this option, please select the radio button corresponding to \"Enable soft delete\" first. Please visit https://aka.ms/keyvaultsoftdelete for detailed configuration steps.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Setting up email notifications for high severity security alerts ensures that subscription owners are promptly notified in the event of a potential breach.<br> If this is not enabled, owners may not be aware of critical security incidents in a timely manner, which could lead to severe consequences, including data loss or system compromise.<br> Therefore, it is highly recommend to enable this feature.<br>",
    "displayName": "Email notification to subscription owner for high severity alerts should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9f97e78d-88ee-a48d-abe2-5ef12954e7ea",
    "implementationEffort": null,
    "name": "9f97e78d-88ee-a48d-abe2-5ef12954e7ea",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0b15565f-aa9e-48ba-8619-45960f2c314d",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure email notifications: 1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Email notifications</b> page, select the recipients and notification types.<br>3. Select <b>Save</b>.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Azure Private Link provides a secure connection between your virtual network and Azure services, eliminating the need for a public IP address.<br> It manages the connectivity over the Azure backbone network.<br> By assigning private endpoints to your container registries, you can prevent data leakage risks.<br> Therefore, we recommend using private link for container registries to ensure secure and private connectivity.<br>",
    "displayName": "Container registries should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/13e7d036-6903-821c-6018-962938929bf0",
    "implementationEffort": null,
    "name": "13e7d036-6903-821c-6018-962938929bf0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e8eef0a8-67cf-4eb4-9386-14b0e78733d4",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private links for a registry: 1. Ensure the registry's SKU is set to Premium (SKUs can be upgraded) 2. In the Private endpoints tab, under Network Settings, add basic endpoint information such as name and region 3. On the next page, add registry resource information (such as: name, resource type and subscription) 4. On the next page, add networking and private dns configuration. 5. Create the private endpoint resource. For more information, see: https://aka.ms/acr/privatelink",
    "severity": "Medium",
    "tactics": [
      "Persistence"
    ],
    "techniques": [
      "Implant Container Image"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This configuration ensures that the database can only be accessed from a private endpoint, thereby preventing access from any public address space outside of the Azure IP range.<br> If left enabled, it could allow logins that match IP or virtual network-based firewall rules, potentially leading to unauthorized access and data breaches.<br> Therefore, it is crucial to disable public network access to maintain a secure environment.<br>",
    "displayName": "Public network access should be disabled for MySQL servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d5d090f1-7d5c-9b38-7344-0ede8343276d",
    "implementationEffort": null,
    "name": "d5d090f1-7d5c-9b38-7344-0ede8343276d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d9844e8a-1437-4aeb-a32c-0c992f056095",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "By default, Azure Database for MySQL is provisioned with no access from any IP sources. To further enhance network security and configure your Azure Database for MySQL server to deny all public network access and allow connections ONLY through private endpoints: 1.  Select the Azure Database for MySQL. 2. In Connection security, set deny public network access to 'Yes'. For details, see: https://go.microsoft.com/fwlink/?linkid=2120014.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys for encrypting data at rest provides increased transparency, control over the TDE Protector, enhanced security with an HSM-backed external service, and promotes separation of duties.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>",
    "displayName": "[Enable if required] SQL managed instances should use customer-managed keys to encrypt data at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/06ac6ef4-1e66-1334-5418-6e79ab444ce0",
    "implementationEffort": null,
    "name": "06ac6ef4-1e66-1334-5418-6e79ab444ce0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/048248b0-55cd-46da-b1ff-39efd52db260",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure your own encryption key for SQL Server Transparent Data encryption: 1. Select the SQL server. 2. On the Transparent data encryption page, select Customer-managed key. 3. For Key selection method, choose Select a key or Enter a key identifier if you have one. 4. If you chose Select a key, configure the desired Key vault and Key. For more information, see this article:  https://docs.microsoft.com/azure/sql-database/transparent-data-encryption-byok-azure-sql",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys for encrypting data at rest provides more control over the key lifecycle, including rotation and management.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] MySQL servers should use customer-managed keys to encrypt data at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6b51b7f7-cbed-75bf-8a02-43384bf47562",
    "implementationEffort": null,
    "name": "6b51b7f7-cbed-75bf-8a02-43384bf47562",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/83cef61d-dbd1-4b20-a4fc-5fbc7da10833",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Azure automatically encrypts data at rest with service-managed keys. To use a customer-managed key to protect and control access to the key that encrypts your data: 1. Create a key vault with soft delete and purge protection enabled. 2. Create your own encryption key or use the Azure Key Vault API to generate a key. 3. Grant the Azure Database for MySQL access to the key vault with the get, wrapKey, and unwrapKey permissions by using its unique managed identity.  4. Select the Azure Database for MySQL, go to data encryption, and pass the key vault and key information. Learn more https://aka.ms/mysqlbyok",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys for encrypting data at rest provides more control over the key lifecycle, including rotation and management.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] PostgreSQL servers should use customer-managed keys to encrypt data at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/19d45f8f-245c-852e-dbf9-d4aab4758b1f",
    "implementationEffort": null,
    "name": "19d45f8f-245c-852e-dbf9-d4aab4758b1f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/18adea5e-f416-4d0f-8aa8-d24321e3e274",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Azure automatically encrypts data at rest with service-managed keys. To use a customer-managed key to protect and control access to the key that encrypts your data: 1. Create a key vault with soft delete and purge protection enabled. 2. Create your own encryption key or use the Azure Key Vault API to generate a key. 3. Grant the Azure Database for PostgreSQL access to the key vault with the get, wrapKey, and unwrapKey permissions by using its unique managed identity.  4. Select the Azure Database for PostgreSQL, go to data encryption, and pass the key vault and key information. Learn more https://aka.ms/postgresqlbyok",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This configuration ensures that the database can only be accessed from a private endpoint, thereby preventing access from any public address space outside of Azure IP range.<br> If this is not done, the database may be vulnerable to unauthorized access and potential data breaches.<br> It's important to note that this configuration also denies all logins that match IP or virtual network-based firewall rules.<br>",
    "displayName": "Public network access should be disabled for MariaDB servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ab153e43-2fb5-0670-2117-70340851ea9b",
    "implementationEffort": null,
    "name": "ab153e43-2fb5-0670-2117-70340851ea9b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fdccbe47-f3e3-4213-ad5d-ea459b2fa077",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "By default, Azure Database for MariaDB is provisioned with no access from any IP sources. To further enhance network security and configure your Azure Database for MariaDB server to deny all public network access and allow connections ONLY through private endpoints: 1. Select  the Azure Database for MariaDB. 2. In Connection security, set deny public network access to 'Yes'. For more information, see: https://go.microsoft.com/fwlink/?linkid=2119542",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys for encrypting data at rest provides increased transparency, control, and security.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] SQL servers should use customer-managed keys to encrypt data at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a93e945-3675-aef6-075d-c661498e1046",
    "implementationEffort": null,
    "name": "1a93e945-3675-aef6-075d-c661498e1046",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0d134df8-db83-46fb-ad72-fe0c9428c8dd",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure your own encryption key for SQL Server Transparent Data encryption: 1. Select the SQL server. 2. On the Transparent data encryption page, select Customer-managed key. 3. For Key selection method, choose Select a key or Enter a key identifier if you have one. 4. If you chose Select a key, configure the desired Key vault and Key. For more information, see this article:  https://docs.microsoft.com/azure/sql-database/transparent-data-encryption-byok-azure-sql",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Deploying Azure Cache for Redis within a Virtual Network (VNet) enhances security by providing isolation and restricting access.<br> This setup ensures that the cache instance is not publicly addressable and can only be accessed from within the VNet.<br> This includes access from virtual machines and applications.<br> Without this configuration, the cache instance could be exposed to potential threats and unauthorized access.<br> Therefore, for optimal security, we recommend housing Azure Cache for Redis within a VNet .<br>",
    "displayName": "Azure Cache for Redis should reside within a virtual network",
    "id": "/providers/Microsoft.Security/assessmentMetadata/be264018-593c-1162-bd5e-b74a39396652",
    "implementationEffort": null,
    "name": "be264018-593c-1162-bd5e-b74a39396652",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7d092e0a-7acd-40d2-a975-dca21cae48c4",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Injection into your custom Virtual Network/Subnet can only be done at cache creation time, so take these steps to mitigate: 1. Create and configure a new VNet-injected cache into your custom subnet for the Azure Cache for Redis.  2. Either embed your client application into the same virtual network or allow access for your client application to communicate with the cache instance within your subnet using NSG rules. Follow the guidance here: https://aka.ms/redis/vnet-faq 3. If necessary, export the data from your instance and import it into the new Azure Cache for Redis instance. Learn more about the import/export feature here: https://aka.ms/redis/import-export.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Setting a security contact to receive email notifications from Defender for Cloud is important to ensure prompt response to potential security breaches in your subscriptions.<br> This contact will be notified whenever there's a security issue, allowing for immediate action.<br> If this is not set, your organization may not be aware of breaches in a timely manner, potentially leading to prolonged exposure and increased damage.<br>",
    "displayName": "Subscriptions should have a contact email address for security issues",
    "id": "/providers/Microsoft.Security/assessmentMetadata/77758c9d-8a56-5f54-6ff7-69a762ca6004",
    "implementationEffort": null,
    "name": "77758c9d-8a56-5f54-6ff7-69a762ca6004",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4f4f78b8-e367-4b10-a341-d9a4ad5cf1c7",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To set up a security contact:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Email notifications</b> page, select the recipients and notification types.<br>3. Select <b>Save</b>.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management, and is often required to meet compliance standards.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] Container registries should be encrypted with a customer-managed key (CMK)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/af560c4d-9c05-e073-b9f1-f7a94958ff25",
    "implementationEffort": null,
    "name": "af560c4d-9c05-e073-b9f1-f7a94958ff25",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5b9159ae-1701-4a6f-9a7a-aa9c8ddd0580",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Azure automatically encrypts registry Contents. To encrypt a registry using a customer-managed key (CMK): 1. Create a user-assigned managed identity. 2. Create a Key Vault with soft delete and purge protection enabled. 3. Give the Managed Identity (Get, Unwrap and Wrap) Key Permissions to the key vault by adding a key vault Access Policy. 4. Create a key for encryption. 5. Create the registry: enable customer-managed key, add the managed identity, and provid the created key's version. For more information, see: https://aka.ms/acr/cmk",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Private Link is a service that allows your virtual network to connect to Azure services without using a public IP address.<br> This enhances security by reducing exposure to potential threats.<br> By mapping private endpoints to your app configuration instances, data leakage risks are minimized.<br> If not used, your app configuration may be exposed to potential data breaches.<br> Therefore, we recommend using Azure Private Link for App Configuration.<br>",
    "displayName": "App Configuration should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8318c3a1-fcac-2e1d-9582-50912e5578e5",
    "implementationEffort": null,
    "name": "8318c3a1-fcac-2e1d-9582-50912e5578e5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ca610c1d-041c-4332-9d88-7ed3094967c7",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private link for Azure App Configuration: 1. In the Azure portal, open the App Configuration instance. 2. Navigate to Settings --> Private endpoint connections 3. Click on Add and configure the private endpoint. For details, see https://aka.ms/appconfig/private-endpoint",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enabling email notifications for high severity alerts in Defender for Cloud is a crucial step in maintaining a secure environment.<br> This feature ensures that the relevant personnel in your organization are promptly notified in the event of a potential security breach.<br> If not enabled, there could be delays in responding to critical security incidents, potentially leading to more severe consequences.<br> Therefore, we recommend enabling this feature to ensure timely response to high severity alerts.<br>",
    "displayName": "Email notification for high severity alerts should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3869fbd7-5d90-84e4-37bd-d9a7f4ce9a24",
    "implementationEffort": null,
    "name": "3869fbd7-5d90-84e4-37bd-d9a7f4ce9a24",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6e2593d9-add6-4083-9c9b-4b7d2188c899",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure email notifications: 1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Email notifications</b> page, select the recipients and notification types.<br>3. In the 'Notification type' area, ensure mails are sent regarding security alerts from severity 'high'.<br>4. Select <b>Save</b>.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This configuration ensures that the database can only be accessed from a private endpoint, thereby preventing access from any public address space outside of Azure IP range.<br> If left enabled, it could allow logins that match IP or virtual network-based firewall rules, potentially leading to unauthorized access and data breaches.<br> Therefore, it is crucial to disable public network access to maintain a secure database environment.<br>",
    "displayName": "Public network access should be disabled for PostgreSQL servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b34f9fe7-80cd-6fb3-2c5b-951993746ca8",
    "implementationEffort": null,
    "name": "b34f9fe7-80cd-6fb3-2c5b-951993746ca8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b52376f7-9612-48a1-81cd-1ffe4b61032c",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "By default, Azure Database for PostgreSQL is provisioned with no access from any IP sources. To further enhance network security and configure your Azure Database for PostgreSQL server to deny all public network access and allow connections only through private endpoints: 1. Select the Azure Database for PostgreSQL. 2. In Connection security, set deny public network access to 'Yes'. For more information, see: https://go.microsoft.com/fwlink/?linkid=2120015.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Azure container registries are, by default, accessible from any network over the internet.<br> This poses a potential security risk as it leaves the registries vulnerable to threats.<br> To mitigate this, we recommend to restrict access to specific public IP addresses or address ranges.<br> If a registry lacks an IP/firewall rule or a configured virtual network, it will be flagged as an unhealthy resource.<br> Implementing network rules for container registries can significantly enhance their security posture.<br> Failure to do so may expose the registries to unauthorized access and potential cyber threats.<br>",
    "displayName": "Container registries should not allow unrestricted network access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9b828565-a0ed-61c2-6bf3-1afc99a9b2ca",
    "implementationEffort": null,
    "name": "9b828565-a0ed-61c2-6bf3-1afc99a9b2ca",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d0793b48-0edc-4296-a390-4c75d1bdfd71",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable VNet/Firewall rules for a registry: 1. In the Azure Portal, navigate to your registry in the Azure portal 2. Under Networking settings, on the Public access tab, select allow public access from 'Selected networks' instead of 'All Networks' 3. Under Firewall, enter a public IP address, such as the public IP address of a VM in a virtual network. Or, enter an address range in CIDR notation that contains the VM's IP address 4. Select save. For more information, see: https://aka.ms/acr/portal/public-network and https://aka.ms/acr/vnet.",
    "severity": "Medium",
    "tactics": [
      "Persistence"
    ],
    "techniques": [
      "Implant Container Image"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using Azure Private Link for Event Grid domains enhances security by allowing your virtual network to connect to Azure services without using a public IP address.<br> This method of connectivity, handled over the Azure backbone network, reduces the risk of data leakage.<br> If not used, there could be potential exposure of sensitive data.<br> Therefore, we recommend using private link for Azure Event Grid domains to ensure secure and private connectivity.<br>",
    "displayName": "Azure Event Grid domains should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bef092f5-bea7-3df3-1ee8-4376dd9c111e",
    "implementationEffort": null,
    "name": "bef092f5-bea7-3df3-1ee8-4376dd9c111e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9830b652-8523-49cc-b1b3-e17dce1127ca",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private link connections for your Azure Event Grid Domain resource: 1. In the Azure portal, find your Event Grid Domain resource. 2. Navigate to Settings --> Networking, 3. Select \"+ Public network access\" and choose \"+ Private endpoints only\" to restrict access only via private endpoint connections, 4. Select \"+ Private endpoint connections\" to configure the values. For details, see https://aka.ms/asrs/privatelink.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Private Link is a service that allows your virtual network to connect to Azure services without using a public IP address.<br> This enhances security by handling the connectivity over the Azure backbone network.<br> By using private endpoints mapped to your topics, you can protect against data leakage risks.<br> Therefore, we recommend using private link for Azure Event Grid topics to ensure secure and private connectivity.<br>",
    "displayName": "Azure Event Grid topics should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bdac9c7b-b9b8-f572-0450-f161c430861c",
    "implementationEffort": null,
    "name": "bdac9c7b-b9b8-f572-0450-f161c430861c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/4b90e17e-8448-49db-875e-bd83fb6f804f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private link connections for your Azure Event Grid Topic resource: 1. In the Azure portal, find your Event Grid Topic resource. 2. Navigate to Settings --> Networking, 3. Select \"+ Public network access\" and choose \"+ Private endpoints only\" to restrict access only via private endpoint connections, 4. Select \"+ Private endpoint connections\" to configure the values. For details, see https://aka.ms/asrs/privatelink.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management.<br>This is particularly relevant for organizations with related compliance requirements.<br>This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br>If not enabled, the data will be encrypted using platform-managed keys.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] Azure AI Services resources should encrypt data at rest with a customer-managed key (CMK)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/18bf29b3-a844-e170-2826-4e95d0ba4dc9",
    "implementationEffort": null,
    "name": "18bf29b3-a844-e170-2826-4e95d0ba4dc9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/67121cc7-ff39-4ab8-b7e3-95b84dab487d",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "The process to enable customer-managed keys for Azure AI services varies by resource type, please follow instructions detailed in the following link to identify the right process for your relevant resource: <a href=\"https://aka.ms/AzureAIServices/CMK\" target=\"_blank\">https://aka.ms/AzureAIServices/CMK</a><br><br>Note: When using a customer-managed key, the costs for your subscription will be higher. To estimate the cost, use the <a href=\"https://azure.microsoft.com/pricing/calculator/\" target=\"_blank\">Azure pricing calculator</a>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Private Link provides a secure connection between your virtual network and Azure services, eliminating the need for a public IP address.<br> It manages the connectivity over the Azure backbone network.<br> By assigning private endpoints to your SignalR resources, you can prevent data leakage risks.<br> Therefore, we recommend using Azure Private Link for Azure SignalR Service to ensure secure and private connectivity.<br>",
    "displayName": "Azure SignalR Service should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b6f84d18-0137-3176-6aa1-f4d9ac95155c",
    "implementationEffort": null,
    "name": "b6f84d18-0137-3176-6aa1-f4d9ac95155c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/53503636-bcc9-4748-9663-5348217f160f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private link connections for your Azure SignalR service resource: 1.. Find your SignalR resource in the Azure portal, 2. Navigate to Settings --> Private endpoint connections, 3 Click \"+ Private endpoint\" to configure the values. Learn more here: https://aka.ms/asrs/privatelink.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management, and is often required to meet compliance standards.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] Azure Cosmos DB accounts should use customer-managed keys to encrypt data at rest",
    "id": "/providers/Microsoft.Security/assessmentMetadata/814df446-7128-eff0-9177-fa52ac035b74",
    "implementationEffort": null,
    "name": "814df446-7128-eff0-9177-fa52ac035b74",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1f905d99-2ab7-462c-a6b0-f709acca6c8f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable customer-managed keys on an Azure Cosmos DB account, create an encryption key in Azure Key Vault then pass the key identifier when creating the account. For details, see https://aka.ms/cosmosdb-cmk.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "For additional scrutiny of incoming traffic and to reduce the exposure to external threats, deploy Azure Web Application Firewall (WAF).<br> WAF offers centralized protection against common exploits and vulnerabilities like SQL injection, Cross-Site Scripting, and local and remote file executions.<br> It also enables you to restrict access to web applications based on countries, IP address ranges, and other http(s) parameters through custom rules.<br>",
    "displayName": "Web Application Firewall (WAF) should be enabled for Application Gateway",
    "id": "/providers/Microsoft.Security/assessmentMetadata/efe75f01-6fff-5d9d-08e6-092b98d3fb3f",
    "implementationEffort": null,
    "name": "efe75f01-6fff-5d9d-08e6-092b98d3fb3f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/564feb30-bf6a-4854-b4bb-0d2d2d1e6c66",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Azure Web Application Firewall is a paid solution, refer to https://aka.ms/applicationgateway-pricing for full pricing details. To manually add an Azure Web Application Firewall to Azure Application Gateway: 1. If you want to use an existing Azure Web Application Firewall for Azure Application Gateway policy, proceed to Step 2. Otherwise, open the Azure Web Application Firewall service and select 'add'. 3. On the Basics tab, in 'Policy for', select 'Regional WAF (Application Gateway)'. Customize the Azure Web Application Firewall as required. To finish, select 'Review + create' and 'create' the Azure Web Application Firewall. 4. Go to the Azure Application Gateway and select the Azure Application Gateway that does not have an Azure Web Application Firewall. 5. From the left sidebar, select settings, and select 'Web application firewall'. If your current tier is not 'WAF V2' change your tier to 'WAF V2'. There are differences in pricing when changing WAF tiers, refer to https://aka.ms/applicationgateway-pricing for full details. 6. Return to the Web Application Firewall created earlier. Select 'Associated application gateways on the sidebar'. 7. Select 'Associate an application gateway' and add your application gateway. To save the changes, Select 'Save'. An Azure Web Application Firewall is now protecting your application gateway resource. For details, see  https://aka.ms/applicationgateway-waf.",
    "severity": "Low",
    "tactics": [
      "Discovery",
      "Command and Control",
      "Reconnaissance",
      "Initial Access"
    ],
    "techniques": [
      "Network Service Scanning",
      "Application Layer Protocol",
      "Active Scanning",
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "For additional scrutiny of incoming traffic and to reduce the exposure to external threats, deploy Azure Web Application Firewall (WAF).<br> WAF offers centralized protection against common exploits and vulnerabilities like SQL injection, Cross-Site Scripting, and local and remote file executions.<br> It also enables you to restrict access to web applications based on countries, IP address ranges, and other http(s) parameters through custom rules.<br>",
    "displayName": "Web Application Firewall (WAF) should be enabled for Azure Front Door Service service",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0c02a769-03f1-c4d7-85a5-db5dca505c49",
    "implementationEffort": null,
    "name": "0c02a769-03f1-c4d7-85a5-db5dca505c49",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/055aa869-bc98-4af8-bafc-23f1ab6ffe2c",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Azure Web Application Firewall is a paid solution, refer to  https://aka.ms/frontdoor-pricing for full pricing details. To manually add an Azure Web Application Firewall to your Azure Front Door Service  1. If you want to use an existing Azure Web Application Firewall for Azure Front Door Service policy, proceed to Step 2. Otherwise, open the Azure Web Application Firewall service and select 'add'. 3. On the Basics tab, in 'Policy for', select 'Global WAF (Front Door)' and in 'Policy state' select 'Enabled'. Customize the Azure Web Application Firewall as  required. To finish, select 'Review + create' and 'create' the Azure Web Application Firewall. 4. Go to the Front Door service and select the Front Door service that does not have an Azure Web Application Firewall. 5. From the left sidebar, select 'Web application firewall'. 6. Select the frontend to which you're adding an Azure Web Application Firewall policy. Select 'Apply policy'. From the dropdown, select the Azure Web Application Firewall policy. Select 'Add'. 7. To save the Azure Web Application Firewall for the chosen frontend, select 'Save'. An Azure Web Application Firewall will now be applied to the Azure Front Door Service. For details, see https://aka.ms/waf-frontdoor-tutorial",
    "severity": "Low",
    "tactics": [
      "Discovery",
      "Command and Control",
      "Reconnaissance",
      "Initial Access"
    ],
    "techniques": [
      "Network Service Scanning",
      "Application Layer Protocol",
      "Active Scanning",
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "It's important to audit VM Image Builder templates that lack a virtual network configuration.<br> Without this configuration, a public IP is automatically created and used, which could expose resources directly to the internet, thereby increasing the potential attack surface.<br> To mitigate this risk, use private links in VM Image Builder templates to ensure a secure and private connection.<br>",
    "displayName": "VM Image Builder templates should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f6b0e473-eb23-c3be-fe61-2ae3e8309530",
    "implementationEffort": null,
    "name": "f6b0e473-eb23-c3be-fe61-2ae3e8309530",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2154edb9-244f-4741-9970-660785bccdaa",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private link connection when building VM Image Builder templates, add vnetConfig to templates. For details,  see http://aka.ms/azvmimagebuildertmplref.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Private links in a storage account are important for enforcing secure communication.<br> They provide private connectivity to the storage account, ensuring that data is securely transmitted and protected from potential threats.<br> If a private link connection is not used, the storage account may be exposed to risks such as data breaches or unauthorized access.<br>",
    "displayName": "Storage account should use a private link connection",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cdc78c07-02b0-4af0-1cb2-cb7c672a8b0a",
    "implementationEffort": null,
    "name": "cdc78c07-02b0-4af0-1cb2-cb7c672a8b0a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6edd7eda-6dd8-40f7-810d-67160c639cd9",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enforce secure communications for your storage accounts, add a private endpoint as described here: https://aka.ms/connectprivatelytostorageaccount.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management, and the ability to cryptographically erase data. It is often required to meet compliance standards.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] Storage accounts should use customer-managed key (CMK) for encryption",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ca98bba7-719e-48ee-e193-0b76766cdb07",
    "implementationEffort": null,
    "name": "ca98bba7-719e-48ee-e193-0b76766cdb07",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6fac406b-40ca-413b-bf8e-0bf964659c25",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable customer-managed keys on your storage accounts, create an encryption key in your key vault then pass the key identifier to the storage account. For details,  see https://aka.ms/storageencryptionkeys.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Virtual network injection helps isolate the cloud from the internet, reduce the risk of external threats, and enables interaction with systems in on-premises data centers or other Azure services in different virtual networks.<br> It also provides control over inbound and outbound network communications.<br>",
    "displayName": "Azure Spring Cloud should use network injection",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4c768356-5ad2-e3cc-c799-252b27d3865a",
    "implementationEffort": null,
    "name": "4c768356-5ad2-e3cc-c799-252b27d3865a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/af35e2a4-ef96-44e7-a9ae-853dd97032c4",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Virtual network injection brings the following benefits to your Azure Spring Cloud instances: 1. Isolates Azure Spring Cloud from the internet. 2. Enables Azure Spring Cloud to interact with systems in either on- premises data centers or Azure services in other virtual networks. 3. Provides greater control over inbound and outbound network communications for Azure Spring Cloud.",
    "severity": "Medium",
    "tactics": [
      "Lateral Movement",
      "Discovery",
      "Exfiltration",
      "Command and Control",
      "Initial Access",
      "Impact",
      "Collection"
    ],
    "techniques": [
      "Remote Services",
      "Network Service Scanning",
      "Exfiltration Over Alternative Protocol",
      "Proxy",
      "Non-Application Layer Protocol",
      "External Remote Services",
      "Trusted Relationship",
      "Exploitation of Remote Services",
      "Traffic Signaling",
      "Remote Access Software",
      "Domain Trust Discovery",
      "Non-Standard Port",
      "Lateral Tool Transfer",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This method is preferred over IP-based filtering, which can leave your storage accounts vulnerable to threats if public IPs gain access.<br> If IP-based filtering is not disabled, your storage accounts could be exposed to potential threats, compromising the security of your data.<br>",
    "displayName": "Storage accounts should restrict network access using virtual network rules",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ad4f3ff1-30eb-5042-16ed-27198f640b8d",
    "implementationEffort": null,
    "name": "ad4f3ff1-30eb-5042-16ed-27198f640b8d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2a1a9cdf-e04d-429a-8416-3bfb72a1b26f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To protect your storage account from potential threats using virtual network rules: 1. In the Azure portal,  open your storage account. 2. From the left sidebar, select 'Networking'. 3.  From the 'Allow access from' section, select 'Selected networks'. 4. Add a Virtual network under the 'Virtual networks' section. Do not add allowed IP ranges/ or addresses in the firewall. This is to prevent public IPs from accessing your storage account. For details, see: https://aka.ms/storagenetworksecurity.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management. It is often required to meet compliance standards.<br> This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements.<br> If not enabled, the data will be encrypted using platform-managed keys.<br> This is particularly relevant for organizations with related compliance requirements.<br>To implement this, update the 'Effect' parameter in the Security Policy for the applicable scope.<br>",
    "displayName": "[Enable if required] Azure Machine Learning workspaces should be encrypted with a customer-managed key (CMK)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bbd14f11-6228-4588-82a4-517b8d77b23f",
    "implementationEffort": null,
    "name": "bbd14f11-6228-4588-82a4-517b8d77b23f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ba769a63-b8cc-4b2d-abf6-ac33c7204be8",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To setup CMK on Azure Machine Learning workspaces, follow the instructions. here: https://aka.ms/azureml-workspaces-cmk",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Private Link provides a secure connection between your virtual network and Azure services, eliminating the need for a public IP address.<br> It ensures that the connectivity between the consumer and services is handled over the Azure backbone network.<br> By mapping private endpoints to your Azure Machine Learning workspaces, you can protect against data leakage risks.<br>",
    "displayName": "Azure Machine Learning workspaces should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/692343df-7e70-b082-7b0e-67f97146cea3",
    "implementationEffort": null,
    "name": "692343df-7e70-b082-7b0e-67f97146cea3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/40cec1dd-a100-4920-b15b-3024fe8901ab",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private link on Azure Machine Learning workspaces, follow the instructions here: https://aka.ms/azureml-workspaces-privatelink.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Resource logs enable recreating activity trails to use for investigation purposes when a security incident occurs or when your network is compromised.",
    "displayName": "Resource logs in Azure Machine Learning Workspaces should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1b663c6e-6432-4517-9a2b-49f5008e652f",
    "implementationEffort": "Low",
    "name": "1b663c6e-6432-4517-9a2b-49f5008e652f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/afe0c3be-ba3b-4544-ba52-0c99672a8ad6",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To enable Azure Machine Learning diagnostics: 1. Navigate to your Azure Machine Learning Workspace and open the Diagnostic settings blade. 2. Select \"Add diagnostic setting\". 3. Specify a name for the diagnostic settings. 4. Select one or more categories of logs to collect. 5. Configure the log destination. 6. Select \"Save\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling public network access improves security by ensuring that the Machine Learning Workspaces aren't exposed on the public internet. You can control exposure of your workspaces by creating private endpoints instead. Learn more at: https://learn.microsoft.com/azure/machine-learning/how-to-configure-private-link?view=azureml-api-2&tabs=azure-portal.",
    "displayName": "Azure Machine Learning Workspaces should disable public network access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a78ee063-e419-42a9-8d8f-8ec1a94f6b3e",
    "implementationEffort": "Low",
    "name": "a78ee063-e419-42a9-8d8f-8ec1a94f6b3e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/438c38d2-3772-465a-a9cc-7a6666a275ce",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To disable public network access: 1. Navigate to your Azure Machine Learning Workspace and open the Networking blade. 2. In the \"Public access\" tab, for \"Public network access\" select \"Disabled\" 3. Select \"Save\".<br>For more details, see https://learn.microsoft.com/azure/machine-learning/how-to-configure-private-link?tabs=azure-portal&view=azureml-api-2#enable-public-access.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Virtual Networks provide enhanced security and isolation for your Azure Machine Learning Compute Clusters and Instances, as well as subnets, access control policies, and other features to further restrict access. When a compute is configured with a virtual network, it is not publicly addressable and can only be accessed from virtual machines and applications within the virtual network.",
    "displayName": "Azure Machine Learning Computes should be in a virtual network",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0b712179-f61f-4e80-9286-f7eed8f08a47",
    "implementationEffort": "Moderate",
    "name": "0b712179-f61f-4e80-9286-f7eed8f08a47",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7804b5c7-01dc-4723-969b-ae300cc07ff1",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To create a new compute in a virtual network: 1. Navigate to [Azure Machine Learning Studio](https://ml.azure.com/) and open the [Compute](https://ml.azure.com/compute) blade. 2. Under the tab either \"Compute instances\" or \"Compute clusters\", select \"New\". 3. Under \"Advanced Settings\", toggle \"Enable virtual network\" and select a VNet. 4. Finish configuring the compute and select \"Save\".<br>For more details see https://learn.microsoft.com/azure/machine-learning/how-to-secure-training-vnet?view=azureml-api-2&tabs=azure-studio%2Crequired.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling local authentication methods improves security by ensuring that Machine Learning Computes require Azure Active Directory identities exclusively for authentication. Learn more at: https://aka.ms/azure-ml-aad-policy.",
    "displayName": "Azure Machine Learning Computes should have local authentication methods disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/51740d72-1ff9-455d-ace0-c7384e903168",
    "implementationEffort": "Low",
    "name": "51740d72-1ff9-455d-ace0-c7384e903168",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e96a9a5f-07ca-471b-9bc5-6a0f33cbd68f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To create a new compute with local authentication disabled: 1. Navigate to [Azure Machine Learning Studio](https://ml.azure.com/) and open the [Compute](https://ml.azure.com/compute) blade. 2. Under the tab either \"Compute instances\" or \"Compute clusters\", select \"New\". 3. Under \"Advanced Settings\", leave the toggle \"Enable SSH access\" off. 4. Finish configuring the compute and select \"Save\".<br>For more information, see https://aka.ms/azure-ml-aad-policy.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Ensure Azure Machine Learning compute instances run on the latest available operating system. Security is improved and vulnerabilities reduced by running with the latest security patches. For more information, visit http://aka.ms/azureml-ci-updates/.",
    "displayName": "Azure Machine Learning compute instances should be recreated to get the latest software updates",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ce998c5a-e92a-4893-bbdd-4e1c940363a3",
    "implementationEffort": "Moderate",
    "name": "ce998c5a-e92a-4893-bbdd-4e1c940363a3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f110a506-2dcb-422e-bcea-d533fc8c35e2",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To update the OS image of an Azure Machine Learning Compute Instance, create a new compute instance. For more information, visit https://aka.ms/azureml-ci-updates.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism"
    ],
    "threats": [
      "ElevationOfPrivilege",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Resource logs enable recreating activity trails to use for investigation purposes when a security incident occurs or when your network is compromised.",
    "displayName": "Resource logs in Azure Databricks Workspaces should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a59cd763-dbb7-4918-a5e5-b933705c8f74",
    "implementationEffort": "Low",
    "name": "a59cd763-dbb7-4918-a5e5-b933705c8f74",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/138ff14d-b687-4faa-a81c-898c91a87fa2",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To enable Azure Databricks diagnostics on a premium workspace: 1. Navigate to your Azure Databricks Workspace and open the Diagnostic settings blade. 2. Select \"Add diagnostic setting\". 3. Specify a name for the diagnostic settings. 4. Select one or more categories of logs to collect. 5. Configure the log destination. 6. Select \"Save\".",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling public network access improves security by ensuring that the resource isn't exposed on the public internet. You can control exposure of your resources by creating private endpoints instead. Learn more at: https://learn.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/private-link.",
    "displayName": "Azure Databricks Workspaces should disable public network access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9f6b22c2-61e5-4c4b-ab83-f5a88387bff4",
    "implementationEffort": "High",
    "name": "9f6b22c2-61e5-4c4b-ab83-f5a88387bff4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e7849de-b939-4c50-ab48-fc6b0f5eeba2",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "It is not currently possible to modify public IP settings for an Azure Databricks Workspace after provisioning it. To create a new workspace with public network access disabled on initial configuration: 1. Navigate to the Azure Portal. 2. Navigate to Azure Databricks. 3. Select the Create button. 4. In the Networking tab of the create flow, select Yes for both the secure cluster connectivity and virtual network options. 5. Select the Review and Create button.<br>For more information see https://learn.microsoft.com/azure/databricks/security/network/.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling public IP of clusters in Azure Databricks Workspaces improves security by ensuring that the clusters aren't exposed on the public internet. Learn more at: https://learn.microsoft.com/azure/databricks/security/secure-cluster-connectivity.",
    "displayName": "Azure Databricks Clusters should disable public IP",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a85bc138-587d-4867-8faa-b2a814cfcf72",
    "implementationEffort": "High",
    "name": "a85bc138-587d-4867-8faa-b2a814cfcf72",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/51c1490f-3319-459c-bbbc-7f391bbed753",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "It is not currently possible to modify public IP settings for an Azure Databricks Workspace after provisioning it. To create a new workspace with public IP disabled on initial configuration: 1. Navigate to the Azure Portal. 2. Navigate to Azure Databricks. 3. Select the Create button. 4. In the Networking tab of the create flow, select Yes for the secure cluster connectivity. 5. Select the Review and Create button.<br>For more information see https://learn.microsoft.com/azure/databricks/security/secure-cluster-connectivity. If public IP for clusters is disabled, and if public network access has also been disabled on the workspace, users should consider the Azure Private Link documentation at: https://learn.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/private-link.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Virtual Networks provide enhanced security and isolation for your Azure Databricks Workspaces, as well as subnets, access control policies, and other features to further restrict access. Learn more at: https://docs.microsoft.com/azure/databricks/administration-guide/cloud-configurations/azure/vnet-inject.",
    "displayName": "Azure Databricks Workspaces should be in a virtual network",
    "id": "/providers/Microsoft.Security/assessmentMetadata/889df0ba-a5a2-47a0-a16d-6111b5879cce",
    "implementationEffort": "High",
    "name": "889df0ba-a5a2-47a0-a16d-6111b5879cce",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9c25c9e4-ee12-4882-afd2-11fb9d87893f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To create virtual network injection workspace: 1. Navigate to the Azure Portal. 2. Navigate to Azure Databricks. 3. Select the Create button. 4. In the Networking tab of the create flow, select Yes for both the secure cluster connectivity and virtual network options. 5. Select the Review and Create button.<br>For more information see https://learn.microsoft.com/azure/databricks/security/network/.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to Azure Databricks workspaces, you can reduce data leakage risks. Learn more about private links at: https://aka.ms/adbpe.",
    "displayName": "Azure Databricks Workspaces should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/28ca6fb2-f3b0-4494-bcfb-6600b30fec50",
    "implementationEffort": "Low",
    "name": "28ca6fb2-f3b0-4494-bcfb-6600b30fec50",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/258823f2-4595-4b52-b333-cc96192710d8",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/24/2023"
    },
    "remediationDescription": "To configure Private Endpoints for Databricks workspace: 1. Navigate to your Databricks workspace instance. 2. Select \"Networking\" blade in the left-hand pane. 3. In \"Private endpoint connections\" select \"+ Private endpoint\".<br>Learn more about Private Endpoints in https://aka.ms/adbpe.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Private link provides a way to connect Key Vault to your Azure resources without sending traffic over the public internet. Private link provides defense in depth protection against data exfiltration.",
    "displayName": "Private endpoint should be configured for Key Vault",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2e96bc2f-1972-e471-9e70-ae58d41e9d2a",
    "implementationEffort": null,
    "name": "2e96bc2f-1972-e471-9e70-ae58d41e9d2a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5f0bc445-3935-4915-9981-011aa2b46147",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "For detailed steps, see https://aka.ms/akvprivatelink.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Key vault's firewall prevents unauthorized traffic from reaching your key vault and provides an additional layer of protection for your secrets. Enable the firewall to make sure that only traffic from allowed networks can access your key vault.",
    "displayName": "Firewall should be enabled on Key Vault",
    "id": "/providers/Microsoft.Security/assessmentMetadata/52f7826a-ace7-3107-dd0d-4875853c1576",
    "implementationEffort": null,
    "name": "52f7826a-ace7-3107-dd0d-4875853c1576",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/55615ac9-af46-4a59-874e-391cc3dfb490",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "1. Navigate to your Key Vault -> Settings -> Networking<br>2. Under \"Firewalls and virtual networks\", configure the access settings:<br><br>Allow access from:<br>- Allow public access from all networks<br>- Allow public access from specific virtual networks and IP addresses (recommended)<br>- Disable public access<br><br>3. For secure configuration, select \"Allow public access from specific virtual networks and IP addresses\"<br><br>Virtual networks<br>- Only networks you choose can access this key vault.<br><br>Firewall<br>- Add IP ranges to allow access from the internet or your on-premises networks.<br><br>Exception<br>- Enabling access to resources requires you allow trusted Microsoft services to bypass firewall<br>- Check: \"Allow trusted Microsoft services to bypass this firewall\"<br><br>4. Click Save to apply your changes",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Cryptographic keys should have a defined expiration date and not be permanent. Keys that are valid forever provide a potential attacker with more time to compromise the key. It is a recommended security practice to set expiration dates on cryptographic keys.",
    "displayName": "Key Vault keys should have an expiration date",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1aabfa0d-7585-f9f5-1d92-ecb40291d9f2",
    "implementationEffort": null,
    "name": "1aabfa0d-7585-f9f5-1d92-ecb40291d9f2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/152b15f7-8e1f-4c1f-ab71-8c010ba5dbc0",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable an expiration date on your key: 1. Log in to the Azure portal and select your key vault. 2. Open the 'Keys' tab. 3. Find all keys in the table that do not have an expiration date. 4. Select a key. 5. Select the current version of the key. 6. Select the box corresponding to 'Set expiration date'. 7. Select 'Save'.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Credentials from Password Stores",
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Secrets should have a defined expiration date and not be permanent. Secrets that are valid forever provide a potential attacker with more time to compromise them. It is a recommended security practice to set expiration dates on secrets.",
    "displayName": "Key Vault secrets should have an expiration date",
    "id": "/providers/Microsoft.Security/assessmentMetadata/14257785-9437-97fa-11ae-898cfb24302b",
    "implementationEffort": null,
    "name": "14257785-9437-97fa-11ae-898cfb24302b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/98728c90-32c7-4049-8429-847dc0f4fe37",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable an expiration date on your secret: 1. Log in to the Azure portal and select your key vault. 2. Click on the 'Secrets' tab. 3. Find all secrets in the table that do not have an expiration date. 4. Click on a secret. 5. Click the current version of the secret. 6. Check the box corresponding to 'Set expiration date'. 7. Select 'Save'.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Credentials from Password Stores",
      "Account Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Azure Private Link lets you connect your virtual networks to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to key vault, you can reduce data leakage risks. Learn more about private links at: https://aka.ms/akvprivatelink.",
    "displayName": "Azure Key Vaults should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f6b59724-4a05-aa38-33e2-25f15eecf00b",
    "implementationEffort": null,
    "name": "f6b59724-4a05-aa38-33e2-25f15eecf00b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a6abeaec-4d90-4a02-805f-6b26c4d3fbe9",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable private endpoint for your key vault: 1. Log in to the Azure Portal and select your key vault. 2. Click the 'Networking' tab. 3. Select the 'Private Endpoint Connections' tab. 4. Click '+ Private Endpoint'. Please visit https://aka.ms/akvprivatelink for detailed configuration steps.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Deleting a key vault without soft delete enabled permanently deletes all secrets, keys, and certificates stored in the key vault. Accidental deletion of a key vault can lead to permanent data loss. Soft delete allows you to recover an accidentally deleted key vault for a configurable retention period.",
    "displayName": "Key vaults should have soft delete enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/78211c00-15a9-336e-17c4-0b48613dadf4",
    "implementationEffort": null,
    "name": "78211c00-15a9-336e-17c4-0b48613dadf4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1e66c121-a66a-4b1f-9b83-0fd99bf0fc2d",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable soft delete protection for your key vault: 1. Log in to the Azure portal and select your key vault. 2. Click on the 'Properties' tab. 3. Select the radio button corresponding to \"Enable soft delete\". 4. Enter a retention period in days. Select 'Save'. Please visit https://aka.ms/keyvaultsoftdelete for detailed configuration steps.",
    "severity": "High",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Destruction"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Although SSH itself provides an encrypted connection, using passwords with SSH still leaves the VM vulnerable to brute-force attacks. The most secure option for authenticating to an Azure Linux virtual machine over SSH is with a public-private key pair, also known as SSH keys. Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/virtual-machines/linux/create-ssh-keys-detailed\">Detailed steps: Create and manage SSH keys for authentication to a Linux VM in Azure</a>.",
    "displayName": "Authentication to Linux machines should require SSH keys",
    "id": "/providers/Microsoft.Security/assessmentMetadata/22441184-2f7b-d4a0-e00b-4c5eaef4afc9",
    "implementationEffort": null,
    "name": "22441184-2f7b-d4a0-e00b-4c5eaef4afc9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/630c64f9-8b6b-4c64-b511-6544ceff6fd6",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To use SSH for authentication to your Linux virtual machine: 1. Create an SSH key pair for the Linux virtual machine. 2. Disable password authentication in the Linux virtual machine's configuration. 3. Update the SSH key in your Azure Resource Manager template (replace the admin password with the adminSSHKey parameter) or via the Azure CLI (with the --generate-ssh-keys command). Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/virtual-machines/linux/mac-create-ssh-keys\">Create and use an SSH public-private key pair for Linux VMs in Azure</a>.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Private endpoint connections enforce secure communication by enabling private connectivity to Azure SQL Database.",
    "displayName": "Private endpoint connections on Azure SQL Database should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/75396512-3323-9be4-059d-32ecb113c3de",
    "implementationEffort": null,
    "name": "75396512-3323-9be4-059d-32ecb113c3de",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/7698e800-9299-47a6-b3b6-5a0fee576eed",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Private Endpoint Connections: 1. Open Azure SQL Database and browse to the server blade 2. Navigate to Security --> Private endpoint connections blade via the navigation menu 3.  Select the \"+ Private Endpoint\" button 4. Follow the instructions here: https://docs.microsoft.com/azure/azure-sql/database/private-endpoint-overview#how-to-set-up-private-link-for-azure-sql-database.",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling the public network access property improves security by ensuring your Azure SQL Database can only be accessed from a private endpoint. This configuration denies all logins that match IP or virtual network based firewall rules.",
    "displayName": "Public network access on Azure SQL Database should be disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/22e93e92-4a31-b4cd-d640-3ef908430aa6",
    "implementationEffort": null,
    "name": "22e93e92-4a31-b4cd-d640-3ef908430aa6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1b8ca024-1d5c-4dec-8995-b1a932b41780",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To disable Public Network Access: 1. Open Azure SQL Database and browse to the server blade 2. Navigate to Security --> Firewalls and virtual networks blade via the navigation menu on the left. 3. Select Deny Public Network Access control and change the value to Yes.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Client certificates allow for the app to request a certificate for incoming requests. Only clients that have a valid certificate will be able to reach the app.",
    "displayName": "Ensure API app has Client Certificates Incoming client certificates set to On",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ce2768c3-a7c7-1bbf-22cd-f9db675a9807",
    "implementationEffort": null,
    "name": "ce2768c3-a7c7-1bbf-22cd-f9db675a9807",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0c192fe8-9cbb-4516-85b3-0ade8bd03886",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To set Client Certificates for your API App: 1. Navigate to your App Service 2. Select Configuration 3. Go to the General Settings tab 4. Set Incoming Client Certificates to Require For more information, visit here: https://aka.ms/auth-tls",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Trusted Relationship"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To protect the privacy of information communicated over the Internet, your servers should use the latest version of the industry-standard cryptographic protocol, Transport Layer Security (TLS). TLS secures communications over a network by using security certificates to encrypt a connection between machines.",
    "displayName": "Windows servers should be configured to use secure communication protocols",
    "id": "/providers/Microsoft.Security/assessmentMetadata/87448ec1-55f6-3746-3f79-0f35beee76b4",
    "implementationEffort": null,
    "name": "87448ec1-55f6-3746-3f79-0f35beee76b4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/5752e6d6-1206-46d8-8ab1-ecc2f71a8112",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To ensure your windows server is using secure communication protocol: 1. Enable Guest Configuration extension and system assigned identity: https://docs.microsoft.com/azure/virtual-machines/extensions/guest-configuration 2. Enable TLS on your machine. For Windows Server 2008 R2, Windows Server 2012, or Windows 7, install the update at https://support.microsoft.com/help/3140245. For Windows 2012 R2 Server or later, no updates are necessary. 3. Update the Windows and WinHTTP registry keys (or verify that they're correct) according to the information here: https://docs.microsoft.com/dotnet/framework/network-programming/tls#configuring-schannel-protocols-in-the-windows-registry.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "By restricting network access, you can ensure that only allowed networks can access the service. This can be achieved by configuring network rules so that only applications from allowed networks can access the Azure AI service.",
    "displayName": "Azure AI Services resources should restrict network access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f738efb8-005f-680d-3d43-b3db762d6243",
    "implementationEffort": null,
    "name": "f738efb8-005f-680d-3d43-b3db762d6243",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/037eea7a-bd0a-46c5-9a66-03aea78705d3",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "There are different kinds of resources that belong to Azure AI Services. Please see instructions below to fix your resource.<br><br><u>Manual remediation for <b>Azure AI Services (Cognitive Services) resource types (Azure OpenAI etc):</b></u><ol><li>In the Azure portal, open Azure AI Services.<li>Select the relevant resource.<li>From the left-side bar, under \"Resource Management\", select \"Networking\".<li>In \"Firewalls and virtual networks\", select \"Selected Networks and Private Endpoints\" or \"Disabled\".<ol><li>If you enabled the exception under \"Selected Networks and Private Endpoints\", you might want to change the trusted Azure services list. For more information: <a href=\"https://aka.ms/AI/TrustedAzureServices\" target=\"_blank\">https://aka.ms/AI/TrustedAzureServices</a></li></ol><li>Save all changes.</ol>Learn more at: <a href=\"https://aka.ms/AI/VirtualNetworks\" target=\"_blank\">https://aka.ms/AI/VirtualNetworks</a><br><br><u>Manual remediation for <b>AI Search</b>:</u><ol><li>In the Azure portal, open Azure AI services.<li>Select the relevant AI Search resource.<li>From the left-side bar, under \"Settings\", select \"Networking\".<li>In \"Public Access\", select \"Selected Networks\" or \"Disabled\".<li>Save all changes.</ol>Learn more at: <a href=\"https://aka.ms/AI-Search/IPFirewall\" target=\"_blank\">https://aka.ms/AI-Search/IPFirewall</a>",
    "severity": "Medium",
    "tactics": [
      "Lateral Movement",
      "Discovery",
      "Exfiltration",
      "Command and Control",
      "Initial Access",
      "Impact",
      "Collection"
    ],
    "techniques": [
      "Remote Services",
      "Network Service Scanning",
      "Exfiltration Over Alternative Protocol",
      "Proxy",
      "Non-Application Layer Protocol",
      "External Remote Services",
      "Trusted Relationship",
      "Exploitation of Remote Services",
      "Traffic Signaling",
      "Remote Access Software",
      "Domain Trust Discovery",
      "Non-Standard Port",
      "Lateral Tool Transfer",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This policy audits any Cognitive Services account not using customer owned storage nor data encryption. For each Cognitive Services account with storage, use either customer owned storage or enable data encryption.",
    "displayName": "Cognitive Services accounts should use customer owned storage or enable data encryption",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aa395469-1687-78a7-bf76-f4614ef72977",
    "implementationEffort": null,
    "name": "aa395469-1687-78a7-bf76-f4614ef72977",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/11566b39-f7f7-4b82-ab06-68d8700eb0a4",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable encryption for Cognitive Services: 1. In the Azure portal, open Cognitive Services, 2. Select an item from the list, and open the \"encryption\" page, 3. Setup encryption using either Microsoft-managed keys or customer-managed keys. Learn more about configuration customer-managed keys for Cognitive Services in https://go.microsoft.com/fwlink/?linkid=2121321. To request access to bring your own storage, fill out and submit the request form from https://aka.ms/cogsvc-cmk.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This policy audits any Cognitive Services account not using data encryption. For each Cognitive Services account with storage, should enable data encryption with either customer managed or Microsoft managed key.",
    "displayName": "Cognitive Services accounts should enable data encryption",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cdcf4f71-60d3-540b-91e3-aa19792da364",
    "implementationEffort": null,
    "name": "cdcf4f71-60d3-540b-91e3-aa19792da364",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2bdd0062-9d75-436e-89df-487dd8e4b3c7",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable encryption for Cognitive Services: 1. In the Azure portal, open Cognitive Services, 2. Select an item from the list, and open the \"encryption\" page, 3. Setup encryption using either Microsoft-managed keys or customer-managed keys. Learn more about configuration customer-managed keys for Cognitive Services in https://go.microsoft.com/fwlink/?linkid=2121321.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Virtual Network deployment provides enhanced security, isolation and allows you to place your API Management service in a non-internet routable network that you control access to. These networks can then be connected to your on-premises networks using various VPN technologies, which enables access to your backend services within the network and/or on-premises. The developer portal and API gateway, can be configured to be accessible either from the Internet or only within the virtual network.",
    "displayName": "API Management services should use a virtual network",
    "id": "/providers/Microsoft.Security/assessmentMetadata/74e7dcff-317f-9635-41d2-ead5019acc99",
    "implementationEffort": null,
    "name": "74e7dcff-317f-9635-41d2-ead5019acc99",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ef619a2c-cc4d-4d03-b2ba-8c94a834d85b",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2023",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Virtual Network on API Management Service: 1. In the Azure portal, open API Management services, 2. Select the desired service from the list, and open the \"Virtual Network\" page, 3. Setup virtual network along with desired type of virtual network. Learn more about configuring virtual network for API Management Services at https://aka.ms/apim-vnet",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Cloud Service Discovery"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Firewall rules should be defined on your Azure Cosmos DB accounts to prevent traffic from unauthorized sources. Accounts that have at least one IP rule defined with the virtual network filter enabled are deemed compliant. Accounts disabling public access are also deemed compliant.",
    "displayName": "Azure Cosmos DB accounts should have firewall rules",
    "id": "/providers/Microsoft.Security/assessmentMetadata/276b1952-c364-852b-11e5-657f0fa34dc6",
    "implementationEffort": null,
    "name": "276b1952-c364-852b-11e5-657f0fa34dc6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/862e97cf-49fc-4a5c-9de4-40d4e2e7c8eb",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure your Azure Cosmos DB firewall and add IP rules: 1. Go to the \"Firewall and virtual networks\" section of your Cosmos DB account. 2. Select \"Selected networks\". 3. Add the IP addresses or ranges you want to allow. For more details, follow the instructions in https://aka.ms/cosmosdb-firewall",
    "severity": "Medium",
    "tactics": [
      "Command and Control",
      "Discovery",
      "Exfiltration",
      "Initial Access",
      "Reconnaissance"
    ],
    "techniques": [
      "Fallback Channels",
      "Remote System Discovery",
      "Network Service Scanning",
      "Exfiltration Over Alternative Protocol",
      "Non-Application Layer Protocol",
      "External Remote Services",
      "Traffic Signaling",
      "Remote Access Software",
      "Non-Standard Port",
      "Gather Victim Network Information",
      "Active Scanning"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Network Watcher is a regional service that enables you to monitor and diagnose conditions at a network scenario level in, to, and from Azure. Scenario level monitoring enables you to diagnose problems at an end-to-end network level view. Network diagnostic and visualization tools available with Network Watcher help you understand, diagnose, and gain insights to your network in Azure.",
    "displayName": "Network Watcher should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f1f2f7dc-7bd5-18bf-c403-cbbdb7ec3d68",
    "implementationEffort": null,
    "name": "f1f2f7dc-7bd5-18bf-c403-cbbdb7ec3d68",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b6e2945c-0b7b-40f5-9233-7a5323b5cdc6",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Network Watcher: 1. Navigate to the Network Watcher page on the Azure portal 2. Select the relevant subscription and click on the region drop down 3. For any regions that are listed as Disabled, enable them by selecting \"Enable network watcher\" in the context menu For more information, visit here: https://docs.microsoft.com/azure/network-watcher/network-watcher-create",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for Resource Manager automatically monitors the resource management operations in your organization. Defender for Cloud detects threats and alerts you about suspicious activity. Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/defender-for-resource-manager-introduction?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Introduction to Microsoft Defender for Resource Manager</a>. Enabling this Defender plan results in charges. Learn about the pricing details per region on Defender for Cloud's pricing page: https://azure.microsoft.com/services/defender-for-cloud/#pricing.",
    "displayName": "Microsoft Defender for Resource Manager should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f0fb2a7e-16d5-849f-be57-86db712e9bd0",
    "implementationEffort": null,
    "name": "f0fb2a7e-16d5-849f-be57-86db712e9bd0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c3d20c29-b36d-48fe-808b-99a87530ad99",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Microsoft Defender for Resource Manager on your subscription: 1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>Resource Manager</b> to <b>On</b>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Discovery",
      "Credential Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation",
      "Permission Groups Discovery",
      "Account Discovery",
      "Cloud Service Discovery",
      "Credentials from Password Stores",
      "Impair Defenses",
      "Cloud Infrastructure Discovery",
      "Cloud Service Dashboard"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable virtual TPM device on supported virtual machines to facilitate Measured Boot and other OS security features that require a TPM. Once enabled, vTPM can be used to attest boot integrity. This assessment only applies to trusted launch enabled virtual machines.",
    "displayName": "vTPM should be enabled on supported virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/861bbc73-0a55-8d1d-efc6-e92d9e1176e0",
    "implementationEffort": null,
    "name": "861bbc73-0a55-8d1d-efc6-e92d9e1176e0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c30f9cd-b84c-49cc-aa2c-9288447cc3b3",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Enabling vTPM will trigger an immediate SYSTEM REBOOT. To enable it: 1. Select the VM. 2. On the VM page, navigate to the 'Configuration' tab. 3. On the 'Configuration' page, check 'vTPM'. 4. Click 'Save'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Enable Secure Boot on supported Windows virtual machines to mitigate against malicious and unauthorized changes to the boot chain. Once enabled, only trusted bootloaders, kernel and kernel drivers will be allowed to run. This assessment applies to Trusted Launch and Confidential Windows virtual machines.",
    "displayName": "Secure Boot should be enabled on supported Windows virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/69ad830b-d98c-b1cf-2158-9d69d38c7093",
    "implementationEffort": null,
    "name": "69ad830b-d98c-b1cf-2158-9d69d38c7093",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/97566dd7-78ae-4997-8b36-1c7bfe0d8121",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Enabling Secure Boot will trigger an immediate SYSTEM REBOOT. To enable it: 1. Select the VM. 2. On the VM page, navigate to the 'Configuration' tab. 3. On the 'Configuration' page, check 'Secure boot'. 4. Click 'Save'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Install Guest Attestation extension on supported Linux virtual machines to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Linux virtual machines.",
    "displayName": "Guest Attestation extension should be installed on supported Linux virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e94a7421-fc27-7a4d-e9ba-2ba01384cacd",
    "implementationEffort": null,
    "name": "e94a7421-fc27-7a4d-e9ba-2ba01384cacd",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/672fe5a1-2fcd-42d7-b85d-902b6e28c6ff",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To install Guest Attestation extension on supported Linux virtual machines: 1. In the Azure portal, open Cloud Shell. 2. Run the following Azure CLI command: 'az vm extension set --name GuestAttestation --publisher Microsoft.Azure.Security.LinuxAttestation --vm-name MyVM --resource-group MyResourceGroup'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Install Guest Attestation extension on supported Linux virtual machine scale sets to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Linux virtual machine scale sets.",
    "displayName": "Guest Attestation extension should be installed on supported Linux virtual machine scale sets",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a9a53f4f-26b6-3d68-33f3-2ec1f2452b5d",
    "implementationEffort": null,
    "name": "a9a53f4f-26b6-3d68-33f3-2ec1f2452b5d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a21f8c92-9e22-4f09-b759-50500d1d2dda",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To install Guest Attestation extension on supported Linux virtual machine scale sets: 1. In the Azure portal, open Cloud Shell. 2. Run the following Azure CLI command: 'az vmss extension set --name GuestAttestation --publisher Microsoft.Azure.Security.LinuxAttestation' --vmss-name MyVMSS --resource-group MyResourceGroup'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Install Guest Attestation extension on supported virtual machines to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Windows virtual machines.",
    "displayName": "Guest Attestation extension should be installed on supported Windows virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/874b14bd-b49e-495a-88c6-46acb89b0a33",
    "implementationEffort": null,
    "name": "874b14bd-b49e-495a-88c6-46acb89b0a33",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1cb4d9c2-f88f-4069-bee0-dba239a57b09",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To install Guest Attestation extension on supported Windows virtual machines: 1. In the Azure portal, open Cloud Shell. 2. Run the following Azure CLI command: 'az vm extension set --name GuestAttestation --publisher Microsoft.Azure.Security.WindowsAttestation --vm-name MyVM --resource-group MyResourceGroup'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Install Guest Attestation extension on supported virtual machine scale sets to allow Microsoft Defender for Cloud to proactively attest and monitor the boot integrity. Once installed, boot integrity will be attested via Remote Attestation. This assessment applies to Trusted Launch and Confidential Windows virtual machine scale sets.",
    "displayName": "Guest Attestation extension should be installed on supported Windows virtual machine scale sets",
    "id": "/providers/Microsoft.Security/assessmentMetadata/02e8ca50-0e7e-cc34-0b91-215af2904248",
    "implementationEffort": null,
    "name": "02e8ca50-0e7e-cc34-0b91-215af2904248",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f655e522-adff-494d-95c2-52d4f6d56a42",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To install Guest Attestation extension on supported Windows virtual machine scale sets: 1. In the Azure portal, open Cloud Shell. 2. Run the following Azure CLI command: 'az vmss extension set --name GuestAttestation --publisher Microsoft.Azure.Security.WindowsAttestation' --vmss-name MyVMSS --resource-group MyResourceGroup'.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Although a virtual machine's OS and data disks are encrypted-at-rest by default using platform managed keys; resource disks (temp disks), data caches, and data flowing between Compute and Storage resources are not encrypted. Use Azure Disk Encryption or EncryptionAtHost to remediate. <br> To compare encryption offerings, visit <a target=\"_blank\" href=\"https://aka.ms/diskencryptioncomparison\">link.</a> <br>This policy uses Guest Configuration and requires two pre-requisites to be deployed to the policy assignment scope. For details, visit <a target=\"_blank\" href=\"https://aka.ms/gcpol\">guest config onboarding</a>.",
    "displayName": "Linux virtual machines should enable Azure Disk Encryption or EncryptionAtHost.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a40cc620-e72c-fdf4-c554-c6ca2cd705c0",
    "implementationEffort": "Low",
    "name": "a40cc620-e72c-fdf4-c554-c6ca2cd705c0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ca88aadc-6e2b-416c-9de2-5a0f01d1693f",
    "preview": null,
    "publishDates": {
      "ga": "04/29/2024",
      "public": "03/15/2023"
    },
    "remediationDescription": "To enable Encryption At Host on your virtual machines, visit onboarding instructions for <a target=\"_blank\" href=\"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-enable-host-based-encryption-portal?tabs=azure-powershell\">EncryptionAtHost</a>.<br> To enable Azure Disk Encryption on your virtual machines, visit onboarding instructions for <a target=\"_blank\" href=\"https://learn.microsoft.com/en-us/azure/virtual-machines/linux/disk-encryption-linux\">Azure Disk Encryption</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Although a virtual machine's OS and data disks are encrypted-at-rest by default using platform managed keys; resource disks (temp disks), data caches, and data flowing between Compute and Storage resources are not encrypted. Use Azure Disk Encryption or EncryptionAtHost to remediate. <br> To compare encryption offerings, visit <a target=\"_blank\" href=\"https://aka.ms/diskencryptioncomparison\">link.</a> <br>This policy uses Guest Configuration and requires two pre-requisites to be deployed to the policy assignment scope. For details, visit <a target=\"_blank\" href=\"https://aka.ms/gcpol\">guest config onboarding</a>.",
    "displayName": "Windows virtual machines should enable Azure Disk Encryption or EncryptionAtHost.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0cb5f317-a94b-6b80-7212-13a9cc8826af",
    "implementationEffort": "Low",
    "name": "0cb5f317-a94b-6b80-7212-13a9cc8826af",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3dc5edcd-002d-444c-b216-e123bbfa37c0",
    "preview": null,
    "publishDates": {
      "ga": "04/29/2024",
      "public": "03/15/2023"
    },
    "remediationDescription": "To enable Encryption At Host on your virtual machines, visit onboarding instructions for <a target=\"_blank\" href=\"https://learn.microsoft.com/en-us/azure/virtual-machines/disks-enable-host-based-encryption-portal?tabs=azure-powershell\">EncryptionAtHost</a>.<br> To enable Azure Disk Encryption on your virtual machines, visit onboarding instructions for <a target=\"_blank\" href=\"https://learn.microsoft.com/en-us/azure/virtual-machines/windows/disk-encryption-windows\">Azure Disk Encryption</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling local authentication methods and allowing only Azure Active Directory Authentication improves security by ensuring that Azure SQL Databases can exclusively be accessed by Azure Active Directory identities. Learn more at: aka.ms/adonlycreate.",
    "displayName": "Azure SQL Database should have Azure Active Directory Only Authentication enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c076bfee-3834-4685-8ab5-17f5207c827e",
    "implementationEffort": null,
    "name": "c076bfee-3834-4685-8ab5-17f5207c827e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/abda6d70-9778-44e7-84a8-06713e6db027",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/14/2023"
    },
    "remediationDescription": "To disable local authentication methods and only allow Azure Active Directory authentication: 1. Find your Azure Sql server in the portal. 2. Navigate to Azure Active Directory in the left navigation pane. 3. Select \"Set admin\" if Azure Active Directory admin is not already set. 4. Check the \"Support only Azure Active Directory authentication for this server\" box and press \"Save\". See https://learn.microsoft.com/en-us/azure/azure-sql/database/authentication-azure-ad-only-authentication-tutorial?WT.mc_id=Portal-Microsoft_Azure_Security for further details.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Provision an Azure AD administrator for your Azure Database for PostgreSQL to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services.",
    "displayName": "Azure Database for PostgreSQL should have an Azure Active Directory administrator provisioned",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b20d1b00-11a8-4ce7-b477-4ea6e147c345",
    "implementationEffort": null,
    "name": "b20d1b00-11a8-4ce7-b477-4ea6e147c345",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b4dec045-250a-48c2-b5cc-e0c4eec8b5b4",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/26/2023"
    },
    "remediationDescription": "To enable Azure Active Directory Authentication for Azure PostgreSQL server: 1. In Azure Portal, open your Azure PostgreSQL Server. 2. Click on 'Active Directory admin' on the left pane. 3. Click on 'Set admin', select an Azure Active directory admin and click 'Save'. For more information see https://aka.ms/postgresqlazureadauth.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling local authentication methods and allowing only Azure Active Directory Authentication improves security by ensuring that Azure SQL Managed Instances can exclusively be accessed by Azure Active Directory identities. Learn more at: aka.ms/adonlycreate.",
    "displayName": "Azure SQL Managed Instance authentication mode should be Azure Active Directory Only",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e2750e59-9a37-4ad5-b584-013932d9682d",
    "implementationEffort": null,
    "name": "e2750e59-9a37-4ad5-b584-013932d9682d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/78215662-041e-49ed-a9dd-5385911b3a1f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/26/2023"
    },
    "remediationDescription": "To enable Azure Active Directory Only Authentication for Azure SQL Managed Instance: 1. Use the following CLI commands: 'az sql mi ad-only-auth enable --resource-group myresource --name myserver' 2. Use the following Powershell commands 'Enable-AzSqlInstanceActiveDirectoryOnlyAuthentication -InstanceName myinstance -ResourceGroupName myresource' 3. More details on https://aka.ms/adonlymanage.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Active Directory (AAD) only authentication methods improves security by ensuring that Synapse Workspaces exclusively require AAD identities for authentication. Learn more at: https://aka.ms/Synapse.",
    "displayName": "Azure Synapse Workspace authentication mode should be Azure Active Directory Only",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3320d1ac-0ebe-41ab-b96c-96fb91214c5c",
    "implementationEffort": null,
    "name": "3320d1ac-0ebe-41ab-b96c-96fb91214c5c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/2158ddbe-fefa-408e-b43f-d4faef8ff3b8",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/26/2023"
    },
    "remediationDescription": "To Enable azureADOnlyAuthentication settings in Synapse Workspace: \n1. Select workspace from the list below.\n\nTo enable Azure AD Only Authentication: \na. In the workspace page, under settings section, click on Azure Active Directory.\nb. In Azure Active Directory setting's page, under Azure Active Directory authentication only section, select 'Support only Azure Active Directory authentication for this workspace'. Learn more at https://aka.ms/synapse.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Provision an Azure AD administrator for your Azure Database for MySQL to enable Azure AD authentication. Azure AD authentication enables simplified permission management and centralized identity management of database users and other Microsoft services.",
    "displayName": "Azure Database for MySQL should have an Azure Active Directory administrator provisioned",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8af8a87b-7aa6-4c83-b22b-36801896177b",
    "implementationEffort": null,
    "name": "8af8a87b-7aa6-4c83-b22b-36801896177b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/146412e9-005c-472b-9e48-c87b72ac229e",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/10/2023"
    },
    "remediationDescription": "To enable Azure Active Directory Authentication for Azure MySQL server: 1. In Azure Portal, open your Azure MySQL Server. 2. Click on 'Active Directory admin' on the left pane. 3. Click on 'Set admin', select an Azure Active directory admin and click 'Save'. For more information see https://aka.ms/mysqlazureadauth.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling local authentication methods and allowing only Azure Active Directory Authentication improves security by ensuring that Azure MySQL flexible server can exclusively be accessed by Azure Active Directory identities.",
    "displayName": "Azure MySQL flexible server should have Azure Active Directory Only Authentication enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/02fb778d-fd6c-4770-81ca-abec3cf36634",
    "implementationEffort": null,
    "name": "02fb778d-fd6c-4770-81ca-abec3cf36634",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/40e85574-ef33-47e8-a854-7a65c7500560",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/07/2023"
    },
    "remediationDescription": "To enable Azure Active Directory Only Authentication for Azure MySQL flexible server: 1. In Azure Portal, open your Azure MySQL Flexible Server. 2. Click on 'Authentication' on the left pane. 3. In 'Assign access to' under the 'Authentication' section select the 'Azure Active Directory authentication only' option and click 'Save'. 4. To complete the configuration, once the change is deployed you will need to go to the 'Select identity' section and supply a user assigned managed identity with the permissions User.Read.All, GroupMember.Read.All and Application.Read.ALL. 5. Assign an Azure AD admin under the 'Azure Active Directory Administrators (Azure AD Admins)' section and click 'Save'. For more information see https://aka.ms/mysqlflexibleserverazureadauth.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Key access (local authentication) is recommended to be disabled for security. Azure OpenAI Studio, typically used in development/testing, requires key access and will not function if key access is disabled. After disabling, Microsoft Entra ID becomes the only access method, which allows maintaining minimum privilege principle and granular control.</br>Learn more at: <a href=\"https://aka.ms/AI/auth\" target=\"_blank\">https://aka.ms/AI/auth</a>",
    "displayName": "Azure AI Services resources should have key access disabled (disable local authentication)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/13b10b36-aa99-4db6-b00c-dcf87c4761e6",
    "implementationEffort": null,
    "name": "13b10b36-aa99-4db6-b00c-dcf87c4761e6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/71ef260a-8f18-47b7-abcb-62d0673d94dc",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "There are different kinds of resources that belong to Azure AI Services. Please see instructions below to fix your resource.<br><br><u>Manual remediation for <b>Azure AI Services (Cognitive Services) resource types (Azure OpenAI etc):</b></u><ul><li>Option 1:<br><ol>Execute the following PowerShell command:<br>Set-AzCognitiveServicesAccount -ResourceGroupName &lt;yourResourceGroupName&gt; -Name &lt;yourAzureAIResourceName&gt; -DisableLocalAuth $true.</ul><ul><li>Option 2:<ol>Using ARM/Bicep/TerraForm template: update the relevant Azure AI services template, such that \"disableLocalAuth\" is set to true.</ul>Learn more at:<a href=\"https://aka.ms/AI/DisableLocalAuth\" target=\"_blank\">https://aka.ms/AI/DisableLocalAuth</a><br><br><u>Manual remediation for <b> Azure AI Search</b>:</u><ul><li>Option 1:<br><ol><li>In the Azure portal, open Azure AI Services.<li>Select the relevant AI Search resource.<li>From the left-side bar, under \"Settings\", select \"Keys\".<li>Select Role-Based access control.<li>Save you changes.</ul><ul><li>Option 2:<ol>Execute the following PowerShell command:<br>Set-AzSearchService -ResourceGroupName &lt;yourResourceGroupName&gt; -Name &lt;yourAzureAISearchResourceName&gt; -DisableLocalAuth $true.</ul><ul><li>Option 3:<br><ol>Using ARM/Bicep/TerraForm template: update AI Search template, such that \"disableLocalAuth\" is set to true.</ul>Learn more at:<a href=\"https://aka.ms/AI-Search/DisableKeyAuthentication\" target=\"_blank\">https://aka.ms/AI-Search/DisableKeyAuthentication</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination.<br>The Private Link platform reduces data leakage risks by handling the connectivity between the consumer and services over the Azure backbone network.<br>Learn more about private links at: <a href=\"https://aka.ms/AzurePrivateLink/Overview\" target=\"_blank\">https://aka.ms/AzurePrivateLink/Overview</a><br>",
    "displayName": "Azure AI Services resources should use Azure Private Link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/67279c29-fa4c-4f09-ae59-cb1491565995",
    "implementationEffort": null,
    "name": "67279c29-fa4c-4f09-ae59-cb1491565995",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d6759c02-b87f-42b7-892e-71b3f471d782",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "09/07/2024"
    },
    "remediationDescription": "There are different kinds of resources that belong to Azure AI Services. To secure your resources, follow the relevant instructions below.<br><br><u>Manual remediation for <b>Azure AI Services</b> (Cognitive Services) resource types (Azure OpenAI etc):</u><ol><li>In the Azure portal, open Azure AI Services.<li>Select the relevant resource.<li>From the left-side bar, under \"Resource Management\", select \"Networking\".<li>In \"Private endpoint connections\" select \"+ Private endpoint\".</ol>Learn more about Private Endpoints for AI Services in <a href=\"https://aka.ms/AzureAIServices/PrivateLink\" target=\"_blank\">https://aka.ms/AzureAIServices/PrivateLink</a><br><br><u>Manual remediation for <b>Azure AI Search</b>:</u><ol><li>In the Azure portal, open Azure AI services.<li>Select the relevant AI Search resource.<li>From the left-side bar, under \"Settings\", select \"Networking\".<li>In \"Private endpoint connections\", select \"+ Create a private endpoint\".</ol>Learn more about Private Endpoints for Azure AI Search in <a href=\"https://aka.ms/AISearch/PrivateLink\" target=\"_blank\">https://aka.ms/AISearch/PrivateLink</a>",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Use encryption at host to get end-to-end encryption for your virtual machine and virtual machine scale set data. Encryption at host enables encryption at rest for your temporary disk and OS/data disk caches. Temporary and ephemeral OS disks are encrypted with platform-managed keys when encryption at host is enabled. OS/data disk caches are encrypted at rest with either customer-managed or platform-managed key, depending on the encryption type selected on the disk. Learn more at https://aka.ms/vm-hbe.",
    "displayName": "Virtual machines and virtual machine scale sets should have encryption at host enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/efbbd784-656d-473a-9863-ea7693bfcd2a",
    "implementationEffort": null,
    "name": "efbbd784-656d-473a-9863-ea7693bfcd2a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc4d8e41-e223-45ea-9bf5-eada37891d87",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "To enable encryption at host on virtual machines and virtual machine scale sets in the Azure Portal: 1. On new instances, navigate to the Disks tab in the create. 2. Enable the option for encryption at host. 3. On existing instances, stop/deallocate the instance. 4. Visit the Disks menu item. 5. Click 'Additional settings' and enable encryption at host. See https://aka.ms/vm-hbe for detailed steps.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Data Encrypted for Impact"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling public network access improves security by ensuring that your CosmosDB account isn't exposed on the public internet. Creating private endpoints can limit exposure of your CosmosDB account. Learn more at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints#blocking-public-network-access-during-account-creation.",
    "displayName": "Azure Cosmos DB should disable public network access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/334a182c-7c2c-41bc-ae1e-55327891ab50",
    "implementationEffort": null,
    "name": "334a182c-7c2c-41bc-ae1e-55327891ab50",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/797b37f7-06b8-444c-b1ad-fc62867f335a",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "To disable Public Network Access: 1. In the Azure portal, open Cloud Shell. 2. Run the following Azure CLI command: 'az cosmosdb update -g MyResourceGroup -n MyDbAccount --enable-public-network false'. For details, see https://docs.microsoft.com/cli/azure/cosmosdb?view=azure-cli-latest#az_cosmosdb_update.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Private Link lets you connect your virtual network to Azure services without a public IP address at the source or destination. The Private Link platform handles the connectivity between the consumer and services over the Azure backbone network. By mapping private endpoints to your CosmosDB account, data leakage risks are reduced. Learn more about private links at: https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints.",
    "displayName": "CosmosDB accounts should use private link",
    "id": "/providers/Microsoft.Security/assessmentMetadata/80dc29d6-9887-4071-a66c-e763376c2de3",
    "implementationEffort": null,
    "name": "80dc29d6-9887-4071-a66c-e763376c2de3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/58440f8a-10c5-4151-bdce-dfbaad4a20b7",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "To configure Private Link for Azure Cosmos DB: 1. Navigate to your Azure CosmosDB. 2. Select Private Endpoint Connections in the left-hand pane 3. Click on '+ Private Endpoint'. For more information, see https://docs.microsoft.com/azure/cosmos-db/how-to-configure-private-endpoints",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Impact",
      "Collection",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Data Manipulation",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Disabling local authentication methods improves security by ensuring that VPN Gateways use only Azure Active Directory identities for authentication. Learn more about Azure AD authentication at https://docs.microsoft.com/azure/vpn-gateway/openvpn-azure-ad-tenant",
    "displayName": "VPN gateways should use only Azure Active Directory (Azure AD) authentication for point-to-site users",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f949db47-2ea9-417d-a56f-3bb477ad574f",
    "implementationEffort": null,
    "name": "f949db47-2ea9-417d-a56f-3bb477ad574f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/21a6bc25-125e-4d13-b82d-2e19b7208ab7",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "To enable Azure Active Directory (Azure AD) authentication for remote users: 1. Verify your AAD tenant and create the minimum set of AD tenant users. 2. Sign in to the Azure Portal as a Global Administrator and provide Admin consent to the Azure VPN. 3. Enable Azure AD authentication on the VPN gateway by navigating to Point-to-site configuration and picking OpenVPN (SSL) as the Tunnel type, and selecting Azure Active Directory as the Authentication type. 4. Create and download the profile by clicking on the Download VPN client link and update the Azure VPN client application and all users that need to connect. For full instructions and details, see https://docs.microsoft.com/azure/vpn-gateway/openvpn-azure-ad-tenant",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Setting TLS version to 1.2 or newer improves security by ensuring your Azure SQL Database can only be accessed from clients using TLS 1.2 or newer. Using versions of TLS less than 1.2 is not recommended since they have well documented security vulnerabilities.",
    "displayName": "Azure SQL Database should be running TLS version 1.2 or newer",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8e9a37b9-2828-4c8f-a24e-7b0ab0e89c78",
    "implementationEffort": null,
    "name": "8e9a37b9-2828-4c8f-a24e-7b0ab0e89c78",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/32e6bbec-16b6-44c2-be37-c5b672d103cf",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "Steps to set minimal TLS version to 1.2: 1. Open Azure SQL Database and browse to the server pane: 2. Navigate to Security --> Firewalls and virtual networks pane via the left hand navigation menu: 3. Click on Minimal TLS Version control and select 1.2 as the value.: 4. Click Save",
    "severity": "Medium",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling public network access (public endpoint) on Azure SQL Managed Instances improves security by ensuring that they can only be accessed from inside their virtual networks or via Private Endpoints. To learn more about public network access, visit https://aka.ms/mi-public-endpoint.",
    "displayName": "Azure SQL Managed Instances should disable public network access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a2624c52-2937-400c-af9d-3bf2d97382bf",
    "implementationEffort": null,
    "name": "a2624c52-2937-400c-af9d-3bf2d97382bf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9dfea752-dd46-4766-aed1-c355fa93fb91",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "To disable Public Network Access for Azure SQL Managed Instance: 1. Open Azure SQL Managed Instance and browse to the Networking blade. 2. Select Public endpoint (data): Disable. 3. Click Save.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Audit requirement of Azure Active Directory (Azure AD) to authorize requests for your storage account. By default, requests can be authorized with either Azure Active Directory credentials, or by using the account access key for Shared Key authorization. Of these two types of authorization, Azure AD provides superior security and ease of use over Shared Key, and is recommended by Microsoft.",
    "displayName": "Storage accounts should prevent shared key access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3b363842-30f5-4056-980d-3a40fa5de8b3",
    "implementationEffort": null,
    "name": "3b363842-30f5-4056-980d-3a40fa5de8b3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8c6a50c6-9ffd-4ae7-986f-5fa6111f9a54",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/03/2023"
    },
    "remediationDescription": "To disable shared key access for your storage account: 1. Navigate to your storage account in Azure Portal. 2. Set Configuration -> Setting -> Allow shared key access to disabled. For more information, see the documentation https://docs.microsoft.com/azure/storage/common/shared-key-authorization-prevent?tabs=portal#remediate-authorization-via-shared-key.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling local authentication methods and requiring Microsoft Entra authentication improves security by ensuring that Azure Database for PostgreSQL flexible server can be accessed by Microsoft Entra identities only.",
    "displayName": "Azure Database for PostgreSQL flexible server should have Microsoft Entra authentication only enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5d19e32c-489d-407c-9549-15d9ea36a8e0",
    "implementationEffort": null,
    "name": "5d19e32c-489d-407c-9549-15d9ea36a8e0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fa498b91-8a7e-4710-9578-da944c68d1fe",
    "preview": null,
    "publishDates": {
      "ga": "10/09/2024",
      "public": "07/15/2024"
    },
    "remediationDescription": "To configure Microsoft Entra authentication for Azure Database for PostgreSQL flexible server: 1. In the Azure portal, open your Azure Database for PostgreSQL flexible server. 2. Select 'Authentication' on the left pane. 3. In 'Assign access to' under the 'Authentication' section select the 'Microsoft Entra authentication only' option and select 'Save'. 5. Assign an Entra admin under the 'Microsoft Entra Admins' section and select 'Save'. For more information see https://aka.ms/postgresqlflexibleserverentraauth",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IoT"
    ],
    "description": "The use of identical authentication credentials across multiple devices connected to the IoT Hub poses a significant security risk.<br>\nThis practice could allow an illegitimate device to impersonate a legitimate one, or enable an attacker to impersonate a device.<br>\nIf not addressed, this could lead to unauthorized access and potential manipulation of the IoT Hub and connected devices.<br>\nIt is crucial to use unique authentication credentials for each device to prevent such security breaches.<br>",
    "displayName": "Identical Authentication Credentials",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9d07b7e6-2986-4964-a76c-b2689604e212",
    "implementationEffort": "High",
    "name": "9d07b7e6-2986-4964-a76c-b2689604e212",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review the devices in question and make sure they are all valid. Replace any duplicated credentials and make sure all device authentication credentials are unique.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IoT"
    ],
    "description": "The IP Filter Configuration should be set to deny all traffic by default, and only allow specific traffic as defined by rules.<br> This approach means that only authorized traffic can access the system, reducing the risk of unauthorized access or potential attacks.<br> If this policy is not implemented, the system could be exposed to unnecessary risks, including potential data breaches and system compromise.<br>",
    "displayName": "Default IP Filter Policy should be Deny",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5a3d6cdd-8eb3-46d2-ba11-d24a0d47fe65",
    "implementationEffort": "Moderate",
    "name": "5a3d6cdd-8eb3-46d2-ba11-d24a0d47fe65",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "Add a default rule at the end of the defined rules list to deny all inbound traffic. Make sure any rules defined above it only allow wanted traffic through.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IoT"
    ],
    "description": "An IP Filter rule with a large IP range is overly permissive and can expose IoT hub to potential threats.<br>\nThis could allow malicious actors to gain unauthorized access to the IoT hub.<br>\nBy narrowing down the IP range, you can limit the potential attack surface and enhance the security of the IoT hub.<br>\nIt's crucial to review and adjust the IP Filter rule to ensure it's not overly broad.<br>",
    "displayName": "IP Filter rule large IP range",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d8326952-60bb-40fb-b33f-51e662708a88",
    "implementationEffort": "Moderate",
    "name": "d8326952-60bb-40fb-b33f-51e662708a88",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review the rule in question and verify source IP range is as small as it needs to be for necessary traffic to go through.",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Protect your subnet from potential threats by restricting access to it with a network security group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your subnet. When an NSG is associated with a subnet, the ACL rules apply to all the VM instances and integrated services in that subnet, but don't apply to internal traffic inside the subnet. To secure resources in the same subnet from one another, enable NSG directly on the resources as well.<br>Note that the following subnet types will be listed as not applicable: GatewaySubnet, AzureFirewallSubnet, AzureBastionSubnet.",
    "displayName": "Subnets should be associated with a network security group",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eade5b56-eefd-444f-95c8-23f29e5d93cb",
    "implementationEffort": "Moderate",
    "name": "eade5b56-eefd-444f-95c8-23f29e5d93cb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e71308d3-144b-4262-b144-efdc3cc90517",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Network Security Groups on your subnets:<br>1. Select a subnet to enable NSG on.<br>2. Click the 'Network security group' section.<br>3. Follow the steps and select an existing network security group to attach to this specific subnet.",
    "severity": "Low",
    "tactics": [
      "Lateral Movement",
      "Discovery",
      "Exfiltration",
      "Command and Control",
      "Initial Access",
      "Impact",
      "Credential Access",
      "Collection"
    ],
    "techniques": [
      "Remote Services",
      "Network Service Scanning",
      "Exfiltration Over Alternative Protocol",
      "Non-Application Layer Protocol",
      "Trusted Relationship",
      "Remote Access Software",
      "Domain Trust Discovery",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Non-Standard Port",
      "Data from Configuration Repository",
      "External Remote Services"
    ],
    "threats": [
      "MaliciousInsider",
      "DataSpillage",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud has discovered virtual networks with Application Gateway or Azure Firewall resources that are unprotected by the DDoS protection service. These resources contain public IPs. Enable mitigation of network volumetric and protocol attacks.",
    "displayName": "Azure DDoS Protection Standard should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e3de1cc0-f4dd-3b34-e496-8b5381ba2d70",
    "implementationEffort": "Low",
    "name": "e3de1cc0-f4dd-3b34-e496-8b5381ba2d70",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a7aca53f-2ed4-4466-a25e-0b45ade68efd",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. Select a virtual network to enable the DDoS protection service standard on.<br>2. Select the Standard option.<br>3. Click 'Save'.",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service",
      "Network Denial of Service"
    ],
    "threats": [
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute",
      "Networking"
    ],
    "description": "Defender for Cloud has identified some overly-permissive inbound rules for management ports in your Network Security Group. Enable just-in-time access control to protect your VM from internet-based brute-force attacks. Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/just-in-time-access-overview?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Understanding just-in-time (JIT) VM access</a>.",
    "displayName": "Management ports of virtual machines should be protected with just-in-time network access control",
    "id": "/providers/Microsoft.Security/assessmentMetadata/805651bc-6ecd-4c73-9b55-97a19d0582d0",
    "implementationEffort": "Moderate",
    "name": "805651bc-6ecd-4c73-9b55-97a19d0582d0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/b0f33259-77d7-4c9e-aac6-3aabcfae693c",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable just-in-time VM access:<br><ul><li>Select one or more VMs from the list below and select \"Remediate\", or select \"Take action\" if you've arrived from a recommendation for a specific VM.</li><li>On the \"JIT VM access configuration\" page, define the ports for which the just-in-time VM access will be applicable.<ul><li>To add additional ports, select the \"Add\" button on the top left, or select an existing port and edit it.</li><li>On the \"Add port configuration\" pane, enter the required parameters.</li></ul></li><li>Select \"Save\".</li></ul>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Credential Access"
    ],
    "techniques": [
      "External Remote Services",
      "Brute Force"
    ],
    "threats": [
      "MaliciousInsider",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Open remote management ports are exposing your VM to a high level of risk from Internet-based attacks. These attacks attempt to brute force credentials to gain admin access to the machine.",
    "displayName": "Management ports should be closed on your virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bc303248-3d14-44c2-96a0-55f5c326b5fe",
    "implementationEffort": "Moderate",
    "name": "bc303248-3d14-44c2-96a0-55f5c326b5fe",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/22730e10-96f6-4aac-ad84-9383d35b5917",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "We recommend that you edit the inbound rules of some of your virtual machines, to restrict access to specific source ranges.<br>To restrict access to your virtual machines:<br>1. Select a VM to restrict access to.<br>2. In the 'Networking' blade, click on each of the rules that allow management ports (for example, RDP-3389, WINRM-5985, SSH-22).<br>3. Either change the 'Action' property to 'Deny', or, improve the rule by applying a less permissive range of source IP ranges.<br>4. Click 'Save'. <br>Use Defender for Cloud's Just-in-time (JIT) virtual machine (VM) access to lock down inbound traffic to your Azure VMs by demand. Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/just-in-time-access-overview?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Understanding just-in-time (JIT) VM access</a>.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": [
      "ThreatResistance",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud has discovered that IP forwarding is enabled on some of your virtual machines. Enabling IP forwarding on a virtual machine's NIC allows the machine to receive traffic addressed to other destinations. IP forwarding is rarely required (e.g., when using the VM as a network virtual appliance), and therefore, this should be reviewed by the network security team.",
    "displayName": "IP forwarding on your virtual machine should be disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c3b51c94-588b-426b-a892-24696f9e54cc",
    "implementationEffort": "Low",
    "name": "c3b51c94-588b-426b-a892-24696f9e54cc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bd352bd5-2853-4985-bf0d-73806b4a5744",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "We recommend you edit the IP configurations of the NICs belonging to some of your virtual machines.<br>To disable IP forwarding:<br>1. Select a VM from the list below, or click 'Take action' if you've arrived from a specific VM's recommendation blade.<br>2. In the 'Networking' blade, click on the NIC link ('Network Interface' in the top left).<br>3. In the 'IP configurations' blade, set the 'IP forwarding' field to 'Disabled'.<br>4. Click 'Save'.",
    "severity": "Medium",
    "tactics": [
      "Collection"
    ],
    "techniques": [
      "Man-in-the-Middle"
    ],
    "threats": [
      "DataSpillage",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud has identified some of your network security groups' inbound rules to be too permissive. Inbound rules should not allow access from 'Any' or 'Internet' ranges. This can potentially enable attackers to target your resources.",
    "displayName": "All network ports should be restricted on network security groups associated to your virtual machine",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3b20e985-f71f-483b-b078-f30d73936d43",
    "implementationEffort": "Low",
    "name": "3b20e985-f71f-483b-b078-f30d73936d43",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9daedab3-fb2d-461e-b861-71790eead4f6",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "We recommend that you edit the inbound rules of some of your virtual machines, to restrict access to specific source ranges.<br>To restrict access to your virtual machines:<br>1. Select a VM to restrict access to.<br>2. In the 'Networking' blade, click the Network Security Group with overly permissive rules.<br>3. In the 'Network security group' blade, click on each of the rules that are overly permissive.<br>4. Improve the rule by applying less permissive source IP ranges.<br>5. Apply the suggested changes and click 'Save'.<br>If some or all of these virtual machines do not need to be accessed directly from the Internet, then you can also consider removing the public IP associated to them.",
    "severity": "High",
    "tactics": [
      "Lateral Movement",
      "Discovery",
      "Exfiltration",
      "Execution",
      "Command and Control",
      "Initial Access",
      "Impact",
      "Credential Access",
      "Collection"
    ],
    "techniques": [
      "Remote Services",
      "Network Service Scanning",
      "Exfiltration Over Alternative Protocol",
      "Software Deployment Tools",
      "Proxy",
      "Non-Application Layer Protocol",
      "Trusted Relationship",
      "Remote Access Software",
      "Domain Trust Discovery",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Lateral Tool Transfer",
      "Non-Standard Port",
      "Data from Configuration Repository",
      "External Remote Services"
    ],
    "threats": [
      "MaliciousInsider",
      "DataSpillage",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Protect your VM from potential threats by restricting access to it with a network security group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your VM from other instances, in or outside the same subnet.<br>To keep your machine as secure as possible, the VM access to the internet must be restricted and an NSG should be enabled on the subnet.<br>VMs with 'High' severity are internet-facing VMs.",
    "displayName": "Internet-facing virtual machines should be protected with network security groups",
    "id": "/providers/Microsoft.Security/assessmentMetadata/483f12ed-ae23-447e-a2de-a67a10db4353",
    "implementationEffort": "Moderate",
    "name": "483f12ed-ae23-447e-a2de-a67a10db4353",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f6de0be7-9a8a-4b8a-b349-43cf02d22f7c",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To protect a virtual machine with a Network Security Group:<br>1. Select a VM from the list below, or click \"Take action\" if you've arrived from a recommendation for a specific VM.<br>2. Assign the relevant NSG to the NIC or subnet for the VM you're protecting: <br>&emsp;&emsp;a. To assign the NSG to the VM's subnet (recommended): <br />&emsp;&emsp;&emsp;&emsp;i. In the Networking page, select the 'Virtual network/subnet'. <br />&emsp;&emsp;&emsp;&emsp;ii. Open the \"Subnets\" menu. <br />&emsp;&emsp;&emsp;&emsp;iii. Select the subnet where your VM is deployed. <br />&emsp;&emsp;&emsp;&emsp;iv. Select the Network Security Group to assign to the subnet and click \"Save\".<br>&emsp;&emsp;b. To assign the NSG to the NIC:<br>&emsp;&emsp;&emsp;&emsp;i. In the Networking page, select the network interface that's associated with the selected VM.<br>&emsp;&emsp;&emsp;&emsp;ii. In the Network interfaces page, select the 'Network security group' menu item.<br>&emsp;&emsp;&emsp;&emsp;iii. Click 'Edit' at the top of the page.<br>&emsp;&emsp;&emsp;&emsp;iv. Follow the on-screen instructions and select the Network Security Group to assign to this NIC.<br><a target=\"_blank\" href=\"https://docs.microsoft.com/azure/virtual-network/security-overview\">Learn more</a>.",
    "severity": "High",
    "tactics": [
      "Lateral Movement",
      "Discovery",
      "Exfiltration",
      "Execution",
      "Command and Control",
      "Initial Access",
      "Impact",
      "Credential Access",
      "Collection"
    ],
    "techniques": [
      "Remote Services",
      "Network Service Scanning",
      "Exfiltration Over Alternative Protocol",
      "Software Deployment Tools",
      "Proxy",
      "Non-Application Layer Protocol",
      "Trusted Relationship",
      "Remote Access Software",
      "Domain Trust Discovery",
      "Network Denial of Service",
      "Endpoint Denial of Service",
      "Man-in-the-Middle",
      "Lateral Tool Transfer",
      "Non-Standard Port",
      "Data from Configuration Repository",
      "External Remote Services"
    ],
    "threats": [
      "MaliciousInsider",
      "DataSpillage",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Protect your non-internet-facing virtual machine from potential threats by restricting access to it with a network security group (NSG). NSGs contain a list of Access Control List (ACL) rules that allow or deny network traffic to your VM from other instances, whether or not they're on the same subnet.<br>Note that to keep your machine as secure as possible, the VM's access to the internet must be restricted and an NSG should be enabled on the subnet.",
    "displayName": "Non-internet-facing virtual machines should be protected with network security groups",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a9341235-9389-42f0-a0bf-9bfb57960d44",
    "implementationEffort": "Moderate",
    "name": "a9341235-9389-42f0-a0bf-9bfb57960d44",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bb91dfba-c30d-4263-9add-9c2384e659a6",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To protect a virtual machine with a network security group:<br>1. Select a VM from the list below, or select \"Take action\" if you've arrived from a recommendation for a specific VM.<br>2. Assign the relevant NSG to the NIC or subnet for the VM you're protecting: <br>&emsp;&emsp;a. To assign the NSG to the VM's subnet (recommended): <br />&emsp;&emsp;&emsp;&emsp;i. In the Networking page, select the 'Virtual network/subnet'. <br />&emsp;&emsp;&emsp;&emsp;ii. Open the \"Subnets\" menu. <br />&emsp;&emsp;&emsp;&emsp;iii. Select the subnet where your VM is deployed. <br />&emsp;&emsp;&emsp;&emsp;iv. Select the network security group to assign to the subnet and select \"Save\".<br>&emsp;&emsp;b. To assign the NSG to the NIC:<br>&emsp;&emsp;&emsp;&emsp;i. In the Networking page, select the network interface that's associated with the selected VM.<br>&emsp;&emsp;&emsp;&emsp;ii. In the Network interfaces page, select the 'Network security group' menu item.<br>&emsp;&emsp;&emsp;&emsp;iii. Select 'Edit' at the top of the page.<br>&emsp;&emsp;&emsp;&emsp;iv. Follow the on-screen instructions and select the network security group to assign to this NIC.<br><a target=\"_blank\" href=\"https://docs.microsoft.com/azure/virtual-network/security-overview\">Learn more</a>.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "MaliciousInsider",
      "DataSpillage",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud regularly checks your connected machines to ensure they're running vulnerability assessment tools. Use this recommendation to deploy a vulnerability assessment solution.",
    "displayName": "Machines should have a vulnerability assessment solution",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ffff0522-1e88-47fc-8382-2a80ba848f5d",
    "implementationEffort": "Low",
    "name": "ffff0522-1e88-47fc-8382-2a80ba848f5d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To deploy a vulnerability assessment solution, in the \"Unhealthy resources\" tab, select the resources, then select \"Remediate\". Read the remediation details in the confirmation box, insert the relevant parameters if required and approve the remediation. Note: It can take several hours after remediation completes to see the resources in the 'Healthy resources' tab",
    "severity": "Medium",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Some of your virtual networks aren't protected with a firewall. Use Azure Firewall to restrict access to your virtual networks and prevent potential threats. <a target=\"_blank\" href=\"https://azure.microsoft.com/pricing/details/azure-firewall\">Learn more about Azure Firewall</a>.",
    "displayName": "Virtual networks should be protected by Azure Firewall",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f67fb4ed-d481-44d7-91e5-efadf504f74a",
    "implementationEffort": "Moderate",
    "name": "f67fb4ed-d481-44d7-91e5-efadf504f74a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc5e4038-4584-4632-8c85-c0448d374b2c",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To protect your virtual networks with Azure Firewall: <br>1. From the list below, select a network. Or select <b>Take action</b> if you've arrived here from a specific virtual network page. <br>2. Follow the <a target=\"_blank\" href=\"https://azure.microsoft.com/pricing/details/azure-firewall/\">Azure Firewall deployment instructions</a>. Make sure to configure all default routes properly.<br><b>Important:</b> Azure Firewall is billed separately from Defender for Cloud. <a target=\"_blank\" href=\"https://azure.microsoft.com/pricing/details/azure-firewall\">Learn more about Azure Firewall pricing</a>.",
    "severity": "Low",
    "tactics": [
      "Command and Control",
      "Discovery",
      "Exfiltration",
      "Initial Access",
      "Reconnaissance"
    ],
    "techniques": [
      "Fallback Channels",
      "Remote System Discovery",
      "Network Service Scanning",
      "Exfiltration Over Alternative Protocol",
      "Non-Application Layer Protocol",
      "External Remote Services",
      "Traffic Signaling",
      "Remote Access Software",
      "Non-Standard Port",
      "Gather Victim Network Information",
      "Active Scanning"
    ],
    "threats": [
      "MaliciousInsider",
      "DataSpillage",
      "DataExfiltration"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To ensure periodic assessments for missing system updates are triggered automatically, the AssessmentMode property should be set to 'AutomaticByPlatform'. <a target=\"_blank\" href=\"https://aka.ms/aumv2documentation\">Learn more.</a>",
    "displayName": "Machines should be configured to periodically check for missing system updates",
    "id": "/providers/Microsoft.Security/assessmentMetadata/90386950-71ca-4357-a12e-486d1679427c",
    "implementationEffort": "Low",
    "name": "90386950-71ca-4357-a12e-486d1679427c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/bd876905-5b84-4f73-ab2d-2e7a7c4568d9",
    "preview": null,
    "publishDates": {
      "ga": "04/20/2023",
      "public": "11/30/2022"
    },
    "remediationDescription": "To enable the periodic assessment property: <br>1. In the Azure portal, go to <a target=\"_blank\" href=\"https://aka.ms/umc-preview\">\"Azure Update Manager\"</a>, and select \"Machines\". <br>2. Select the relevant machines, and then select \"Update settings\". <br>3. Select \"Periodic assessment\" and follow the steps to complete the settings.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Microsoft Defender for Cloud includes Microsoft Defender for Key Vault, providing an additional layer of security intelligence.<br>Microsoft Defender for Key Vault detects unusual and potentially harmful attempts to access or exploit Key Vault accounts.<br>Important: Protections from this plan are charged as shown on the <b>Defender plans</b> page. If you don't have any key vaults in this subscription, you won't be charged. If you later create key vaults on this subscription, they'll automatically be protected and charges will begin. Learn about the <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.<br>Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/defender-for-key-vault-introduction?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Introduction to Microsoft Defender for Key Vault</a>.",
    "displayName": "Microsoft Defender for Key Vault should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b1af52e4-e968-4e2b-b6d0-6736c9651f0a",
    "implementationEffort": "High",
    "name": "b1af52e4-e968-4e2b-b6d0-6736c9651f0a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/0e6763cc-5078-4e64-889d-ff4d9a839047",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable Microsoft Defender for Key Vault on all key vaults in a subscription:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>Key Vault</b> to <b>On</b>.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Discovery"
    ],
    "techniques": [
      "Credentials from Password Stores"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL is a unified package that provides advanced SQL security capabilities.<br>It includes functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate a threat to your database, and discovering and classifying sensitive data.<br>Important: Protections from this plan are charged as shown on the <b>Defender plans</b> page. If you don't have any Azure SQL Database servers in this subscription, you won't be charged. If you later create Azure SQL Database servers on this subscription, they'll automatically be protected and charges will begin. Learn about the <a target=\"_blank\" href=\"https://aka.ms/pricing-security-center\">pricing details per region</a>.<br>Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/defender-for-sql-introduction?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Introduction to Microsoft Defender for SQL</a>.",
    "displayName": "Microsoft Defender for Azure SQL Database servers should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/58d72d9d-0310-4792-9a3b-6dd111093cdb",
    "implementationEffort": "High",
    "name": "58d72d9d-0310-4792-9a3b-6dd111093cdb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/7fe3b40f-802b-4cdd-8bd4-fd799c948cc2",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable this plan on all Azure SQL Database servers in a subscription:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>Azure SQL Database servers</b> to <b>On</b>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation",
      "Defense Evasion",
      "Persistence",
      "Collection"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Privilege Escalation",
      "Modify Registry",
      "Valid Accounts",
      "Brute Force",
      "Data from Information Repositories",
      "Server Software Component"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for SQL is a unified package that provides advanced SQL security capabilities.<br>It includes functionality for surfacing and mitigating potential database vulnerabilities, detecting anomalous activities that could indicate a threat to your database, and discovering and classifying sensitive data.<br><br>Important: Remediating this recommendation will result in charges for protecting your SQL servers on machines. If you don't have any SQL servers on machines in this subscription, no charges will be incurred.<br>If you create any SQL servers on machines on this subscription in the future, they will automatically be protected and charges will begin at that time.<br> <a href='https://docs.microsoft.com/azure/azure-sql/database/advanced-data-security'>Learn more about Microsoft Defender for SQL servers on machines.</a>",
    "displayName": "Microsoft Defender for SQL servers on machines should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6ac66a74-761f-4a59-928a-d373eea3f028",
    "implementationEffort": "High",
    "name": "6ac66a74-761f-4a59-928a-d373eea3f028",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/6581d072-105e-4418-827f-bd446d56421b",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable this plan on all SQL servers on machines in a subscription:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>SQL servers on machines</b> to <b>On</b>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation",
      "Defense Evasion",
      "Persistence",
      "Collection"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Privilege Escalation",
      "Modify Registry",
      "Valid Accounts",
      "Brute Force",
      "Data from Information Repositories",
      "Server Software Component"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "<a target=\"_blank\" href=\"https://learn.microsoft.com/azure/defender-for-cloud/defender-for-storage-introduction\">Microsoft Defender for Storage</a> detects potential threats to your storage accounts. It helps prevent the three major impacts on your data and workload: malicious file uploads, sensitive data exfiltration, and data corruption.<br><br>The new Defender for Storage plan includes <a target=\"_blank\" href=\"https://learn.microsoft.com/azure/defender-for-cloud/defender-for-storage-malware-scan\">Malware Scanning</a> and <a target=\"_blank\" href=\"https://learn.microsoft.com/azure/defender-for-cloud/defender-for-storage-data-sensitivity\">Sensitive Data Threat Detection</a>. This plan also provides a predictable pricing structure (per storage account) for control over coverage and costs.<br><br>With a simple agentless setup at scale, when enabled at the subscription level, all existing and newly created storage accounts under that subscription will be automatically protected. You can also exclude specific storage accounts from protected subscriptions.<br><br>Notes:<ol type=\"1\"><li>Malware Scanning is charged on a per-gigabyte basis for scanned data. To ensure cost predictability, a monthly malware scanning cap of 5TB is established for each storage account's scanned data volume, calculated per month.</li><li>If you already have a Defender for Storage (classic) policy enabled and want to migrate to the new plan, disable that policy. You can see classic policies <a target=\"_blank\" href=\"https://learn.microsoft.com/azure/storage/common/azure-defender-storage-configure?toc=%2Fazure%2Fdefender-for-cloud%2Ftoc.json&tabs=enable-subscription#set-up-microsoft-defender-for-storage\">here</a>.</li></ol>Learn more about the pricing and cost controls <a target=\"_blank\" href=\"https://learn.microsoft.com/azure/defender-for-cloud/defender-for-storage-introduction#pricing-and-cost-controls\">here</a>.",
    "displayName": "Microsoft Defender for Storage plan should be enabled with Malware Scanning and Sensitive Data Threat Detection",
    "id": "/providers/Microsoft.Security/assessmentMetadata/26f0d5bb-1398-49be-83c5-7161c2e39d8b",
    "implementationEffort": "High",
    "name": "26f0d5bb-1398-49be-83c5-7161c2e39d8b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/640d2586-54d2-465f-877f-9ffc1d2109f4",
    "preview": null,
    "publishDates": {
      "ga": "08/15/2023",
      "public": "08/15/2023"
    },
    "remediationDescription": "To enable this plan across all Azure Storage accounts within a subscription, please follow the steps outlined below:<ol type=\"1\"><li>Navigate to the Azure portal and select 'Defender for Cloud'.</li><li>Once on the 'Defender for Cloud' page, choose 'Environment Settings' and select the relevant subscription.</li><li>On the 'Defender plans' page, enable Defender for Storage by toggling the 'Storage' plan to 'On'.</li><li>If the Defender for Storage (classic) plan is already enabled, locate the 'New plan available' button under the pricing column and click on it. Then, in the side menu, select 'Upgrade subscription'.</li><li>To save these changes, click' Save' in the 'Defender plans' menu.</li></ol><b>Note:</b> To enable Malware Scanning and Sensitive Data Threat Detection, you need either Owner or specific roles with appropriate data actions. For Activity Monitoring, 'Security Admin' permissions are required. Make sure you have these before proceeding.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Lateral Movement",
      "Command and Control",
      "Impact",
      "Collection",
      "Exfiltration"
    ],
    "techniques": [
      "Valid Accounts",
      "Taint Shared Content",
      "Ingress Tool Transfer",
      "Data Destruction",
      "Data from Cloud Storage Object",
      "Transfer Data to Cloud Account"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Microsoft Defender for App Service leverages the scale of the cloud, and the visibility that Azure has as a cloud provider, to monitor for common web app attacks.<br>Microsoft Defender for App Service can discover attacks on your applications and identify emerging attacks.<br><br>Important: Remediating this recommendation will result in charges for protecting your App Service plans. If you don't have any App Service plans in this subscription, no charges will be incurred.<br>If you create any App Service plans on this subscription in the future, they will automatically be protected and charges will begin at that time.<br>Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/defender-for-app-service-introduction?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Protect your web apps and APIs</a>.",
    "displayName": "Microsoft Defender for App Service should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0876ef51-fee7-449d-ba1e-f2662c7e43c6",
    "implementationEffort": "High",
    "name": "0876ef51-fee7-449d-ba1e-f2662c7e43c6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/2913021d-f2fd-4f3d-b958-22354e2bdbcb",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable this plan on all App Service plans in a subscription:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>App Service</b> to <b>On</b>.",
    "severity": "High",
    "tactics": [
      "Credential Access",
      "Collection",
      "Discovery",
      "Defense Evasion",
      "Execution",
      "Privilege Escalation",
      "Command and Control",
      "Initial Access",
      "Lateral Movement",
      "Impact",
      "Persistence",
      "Resource Development",
      "Reconnaissance"
    ],
    "techniques": [
      "OS Credential Dumping",
      "Data from Local System",
      "Query Registry",
      "Obfuscated Files or Information",
      "Masquerading",
      "Windows Management Instrumentation",
      "Scheduled Task/Job",
      "Process Injection",
      "Input Capture",
      "Process Discovery",
      "Command and Scripting Interpreter",
      "Exploitation for Privilege Escalation",
      "Account Discovery",
      "Ingress Tool Transfer",
      "Screen Capture",
      "Audio Capture",
      "Access Token Manipulation",
      "Deobfuscate/Decode Files or Information",
      "Drive-by Compromise",
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "User Execution",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Domain Trust Discovery",
      "Resource Hijacking",
      "Create or Modify System Process",
      "Boot or Logon Autostart Execution",
      "Unsecured Credentials",
      "Steal or Forge Kerberos Tickets",
      "Inter-Process Communication",
      "Phishing",
      "Hijack Execution Flow",
      "Compromise Infrastructure",
      "Search Victim-Owned Websites",
      "Active Scanning"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Microsoft Defender for Containers provides hardening, vulnerability assessment and run-time protections for your Azure, hybrid, and multi-cloud Kubernetes environments.<br>You can use this information to quickly remediate security issues and improve the security of your containers.<br><br>Important: Remediating this recommendation will result in charges for protecting your Kubernetes clusters. If you don't have any Kubernetes clusters in this subscription, no charges will be incurred.<br>If you create any Kubernetes clusters on this subscription in the future, they will automatically be protected and charges will begin at that time.<br>Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/container-security?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Introduction to Microsoft Defender for Containers</a>.",
    "displayName": "Microsoft Defender for Containers should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e599a9fe-30e3-47c6-a173-8b4b6d9d3255",
    "implementationEffort": "High",
    "name": "e599a9fe-30e3-47c6-a173-8b4b6d9d3255",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/1c988dd6-ade4-430f-a608-2a3e5b0a6d38",
    "preview": null,
    "publishDates": {
      "ga": "11/01/2021",
      "public": "11/01/2021"
    },
    "remediationDescription": "To enable this plan on all Kubernetes clusters in a subscription:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>Containers</b> to <b>On</b>.",
    "severity": "High",
    "tactics": [
      "Defense Evasion",
      "Privilege Escalation",
      "Persistence",
      "Initial Access"
    ],
    "techniques": [
      "Indicator Removal on Host",
      "Exploitation for Privilege Escalation",
      "Implant Container Image",
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "DataExfiltration",
      "MaliciousInsider",
      "AccountBreach",
      "ElevationOfPrivilege",
      "DenialOfService",
      "DataSpillage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Microsoft Defender for servers provides real-time threat protection for your server workloads and generates hardening recommendations as well as alerts about suspicious activities.<br>You can use this information to quickly remediate security issues and improve the security of your servers.<br><br>Important: Remediating this recommendation will result in charges for protecting your servers. If you don't have any servers in this subscription, no charges will be incurred.<br>If you create any servers on this subscription in the future, they will automatically be protected and charges will begin at that time.<br>Learn more in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/defender-for-servers-introduction?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Introduction to Microsoft Defender for servers</a>.",
    "displayName": "Microsoft Defender for servers should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/56a6e81f-7413-4f72-9a1b-aaeeaa87c872",
    "implementationEffort": "High",
    "name": "56a6e81f-7413-4f72-9a1b-aaeeaa87c872",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/4da35fc9-c9e7-4960-aec9-797fe7d9051d",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To enable this plan on all servers in a subscription:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>Servers</b> to <b>On</b>.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Credential Access",
      "Privilege Escalation",
      "Execution",
      "Defense Evasion",
      "Exfiltration",
      "Discovery",
      "Command and Control",
      "Initial Access",
      "Lateral Movement",
      "Impact"
    ],
    "techniques": [
      "Hijack Execution Flow",
      "Modify Authentication Process",
      "Boot or Logon Initialization Scripts",
      "Scheduled Task/Job",
      "Account Manipulation",
      "Office Application Startup",
      "OS Credential Dumping",
      "Obfuscated Files or Information",
      "Exfiltration Over Alternative Protocol",
      "Process Injection",
      "Command and Scripting Interpreter",
      "Exploitation for Privilege Escalation",
      "Indicator Removal on Host",
      "Valid Accounts",
      "System Information Discovery",
      "Account Discovery",
      "Ingress Tool Transfer",
      "Modify Registry",
      "Create Account",
      "Deobfuscate/Decode Files or Information",
      "Drive-by Compromise",
      "Indirect Command Execution",
      "Exploitation for Client Execution",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Signed Binary Proxy Execution",
      "File and Directory Permissions Modification",
      "Service Stop",
      "Create or Modify System Process",
      "Event Triggered Execution",
      "Boot or Logon Autostart Execution",
      "Abuse Elevation Control Mechanism",
      "Steal or Forge Kerberos Tickets",
      "Impair Defenses",
      "Remote Service Session Hijacking",
      "Hide Artifacts",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Brute Force",
      "Masquerading",
      "User Execution",
      "Subvert Trust Controls",
      "Compromise Client Software Binary"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for open-source relational databases identifies and alerts on anomalous activities that could indicate attempts to exploit databases.<br> Enabling this plan will incur charges for any open-source relational databases on the subscription.<br>If there are no open-source relational databases in the subscription, no charges will be applied.<br>Future databases created under this subscription will  automatically be protected, and charges will apply from that point.<br> If this plan is not enabled, the databases may be vulnerable to harmful access or exploitation attempts.",
    "displayName": "Microsoft Defender for open-source relational databases should be enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b6a28450-dd5d-4ba4-8806-245e20ef6632",
    "implementationEffort": "High",
    "name": "b6a28450-dd5d-4ba4-8806-245e20ef6632",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policyDefinitions/0a9fbe0d-c5c4-4da8-87d8-f4fd77338835",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/19/2021"
    },
    "remediationDescription": "To enable Microsoft Defender for open-source relational databases on your subscription:<br>1. From Defender for Cloud's <b>Environment settings</b> page, select the relevant subscription.<br>2. In the <b>Defender plans</b> page, set <b>Open-source relational databases</b> to <b>On</b>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The xp_cmdshell extended stored procedure spawns a Windows command shell, passing in a string for execution. This rule checks that no users (except users with the CONTROL SERVER permission like members of the sysadmin server role) have permission to execute the xp_cmdshell extended stored procedure.",
    "displayName": "Execute permissions on xp_cmdshell from all users (except dbo) should be revoked for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/48fad5ca-f530-41bb-9454-c6002bd1085c",
    "implementationEffort": "Moderate",
    "name": "48fad5ca-f530-41bb-9454-c6002bd1085c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke EXECUTE permission on xp_cmdshell to all users (except dbo)",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft periodically releases Cumulative Updates (CUs) for each version of SQL Server. This rule checks whether the latest CU has been installed for the particular version of SQL Server being used.",
    "displayName": "Latest updates should be installed for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fb8ee986-4557-4bb6-9bf7-626abdaa1b72",
    "implementationEffort": "Moderate",
    "name": "fb8ee986-4557-4bb6-9bf7-626abdaa1b72",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Install the latest SQL Server CU corresponding to your version of SQL Server. Visit <a href='https://technet.microsoft.com/en-us/sqlserver/ff803383.aspx'>here</a> to find and download the required CU.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The guest user permits access to a database for any logins that are not mapped to a specific database user. This rule checks that no database roles are assigned to the Guest user.",
    "displayName": "Database user GUEST should not be a member of any role in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/24b8d8dd-4e2e-4cdf-9fb0-b480401a54e0",
    "implementationEffort": "Moderate",
    "name": "24b8d8dd-4e2e-4cdf-9fb0-b480401a54e0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove the special user GUEST from all roles.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Ad-hoc distributed queries use the 'OPENROWSET' and 'OPENDATASOURCE' functions to connect to remote data sources that use OLE DB. This rule checks that ad-hoc distributed queries are disabled.",
    "displayName": "Ad-hoc distributed queries should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5ab112c3-4d3e-42b6-b6dc-562564052b65",
    "implementationEffort": "Moderate",
    "name": "5ab112c3-4d3e-42b6-b6dc-562564052b65",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the 'ad hoc distributed queries' feature on SQL Server",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The CLR allows managed code to be hosted by and run in the Microsoft SQL Server environment. This rule checks that CLR is disabled.",
    "displayName": "CLR should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1c0d864f-aa29-4459-afa5-809f49380b3b",
    "implementationEffort": "Moderate",
    "name": "1c0d864f-aa29-4459-afa5-809f49380b3b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable CLR hosting on SQL Server",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The CLR allows managed code to be hosted by and run in the Microsoft SQL Server environment.<br>CLR strict security treats SAFE and EXTERNAL_ACCESS assemblies as if they were marked UNSAFE and requires all assemblies be signed by a certificate or asymmetric key with a corresponding login that has been granted UNSAFE ASSEMBLY permission in the master database.<br>This rule checks that CLR is disabled.",
    "displayName": "CLR should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ee9b8a8c-2db6-4584-87a5-8567784b4733",
    "implementationEffort": "Moderate",
    "name": "ee9b8a8c-2db6-4584-87a5-8567784b4733",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable CLR hosting on SQL Server",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Assemblies marked as UNSAFE are required to be signed by a certificate or asymmetric key with a corresponding login that has been granted UNSAFE ASSEMBLY permission in the master database. Trusted assemblies may bypass this requirement.",
    "displayName": "Untracked trusted assemblies should be removed for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/04cd2847-1ef5-4f97-be26-9907e3a4b08d",
    "implementationEffort": "Moderate",
    "name": "04cd2847-1ef5-4f97-be26-9907e3a4b08d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove unwanted assemblies and set the rest as baseline",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Cross database ownership chaining is an extension of ownership chaining, except it does cross the database boundary. This rule checks that this option is disabled for all databases except for 'master', 'msdb' and 'tempdb'. For 'master', 'msdb' and 'tempdb' cross database ownership chaining is enabled by default.",
    "displayName": "Database ownership chaining should be disabled for all databases except for 'master', 'msdb' and 'tempdb' on SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4ce5114e-d749-4569-b4e0-24853b1422a4",
    "implementationEffort": "Moderate",
    "name": "4ce5114e-d749-4569-b4e0-24853b1422a4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable DB_CHANING option for all databases that do not absolutely require it and set a baseline for the remaining databases that have a justification to make use of database chaining.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The guest user permits access to a database for any logins that are not mapped to a specific database user. This rule checks that the guest user cannot connect to any database.",
    "displayName": "Principal GUEST should not have access to any user SQL database",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9a330556-d9f3-43e5-bade-ca4170e10374",
    "implementationEffort": "Moderate",
    "name": "9a330556-d9f3-43e5-bade-ca4170e10374",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove all permissions granted to GUEST, especially the connect permission",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This rule checks that remote dedicated admin connections are disabled if they are not being used for clustering to reduce attack surface area. SQL Server provides a dedicated administrator connection (DAC). The DAC lets an administrator access a running server to execute diagnostic functions or Transact-SQL statements, or to troubleshoot problems on the server and it becomes an attractive target to attack when it is enabled remotely.",
    "displayName": "Remote Admin Connections should be disabled unless specifically required for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5b979ba8-b33f-40a6-88f0-aa05f90fbf1f",
    "implementationEffort": "Moderate",
    "name": "5b979ba8-b33f-40a6-88f0-aa05f90fbf1f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable remote dedicated admin connections. A good alternative would be to access box directly and use DAC instead of RDAC.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Default trace provides troubleshooting assistance to database administrators by ensuring that they have the log data necessary to diagnose problems the first time they occur. This rule checks that the default trace is enabled.",
    "displayName": "Default trace should be enabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b19610cf-e5f6-4490-83c0-132c9af68e66",
    "implementationEffort": "Moderate",
    "name": "b19610cf-e5f6-4490-83c0-132c9af68e66",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Set the 'default trace enabled' option on SQL Server to 1",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "CHECK_POLICY option enables verifying SQL logins against the domain policy. This rule checks that CHECK_POLICY option is enabled for all SQL logins.",
    "displayName": "CHECK_POLICY should be enabled for all SQL logins for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/045516fd-3ec2-4d3f-a519-30f971f1e45f",
    "implementationEffort": "Moderate",
    "name": "045516fd-3ec2-4d3f-a519-30f971f1e45f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "In order to fix, you must call ALTER LOGIN [target_login_name] WITH CHECK_POLICY = ON.<br>Please notice that the password policy cannot be applied retroactively, so it is highly recommended  that you force affected users to rotate their password.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Password expiration policies are used to manage the lifespan of a password. When SQL Server enforces password expiration policy, users are reminded to change old passwords, and accounts that have expired passwords are disabled. This rule checks that password expiration policy is enabled for all SQL logins.",
    "displayName": "Password expiration check should be enabled for all SQL logins on SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a14a9bb7-237c-4dae-9b36-e8b63d47539c",
    "implementationEffort": "Moderate",
    "name": "a14a9bb7-237c-4dae-9b36-e8b63d47539c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Enable the password policy for expiration check on the affected logins.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "A database principal that is mapped to the sa account can be exploited by an attacker to elevate permissions to sysadmin.",
    "displayName": "Database principals should not be mapped to the sa account in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3cd5e6e8-71bb-40c4-8a08-204959e91a23",
    "implementationEffort": "Moderate",
    "name": "3cd5e6e8-71bb-40c4-8a08-204959e91a23",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Change the login associated with the offending user and investigate why this user exists.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The AUTO_CLOSE option specifies whether the database shuts down gracefully and frees resources after the last user disconnects. Regardless of its benefits it can cause denial of service by aggressively opening and closing the database, thus it is important to keep this feature disabled. This rule checks that this option is disabled on the current database.",
    "displayName": "AUTO_CLOSE should be disabled for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f5b406da-9b07-4ea5-931e-a15194a61fcf",
    "implementationEffort": "Moderate",
    "name": "f5b406da-9b07-4ea5-931e-a15194a61fcf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the AUTO_CLOSE option on the affected databases.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The BUILTIN\\Administrators group contains the Windows Local Administrators group. In old versions of Microsoft SQL Server, this group has administrator rights by default. This rule checks that this group is removed from SQL Server.",
    "displayName": "BUILTIN\\Administrators should be removed as a server login for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2b31ae5a-28ce-42a7-b80c-6430056978b3",
    "implementationEffort": "Moderate",
    "name": "2b31ae5a-28ce-42a7-b80c-6430056978b3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Removing the BUILTIN\\Administrators well known group from SQL server principals, and grant instead permissions based on other Windows group memberships.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "'sa' is a well-known account with principal Id 1. This rule verifies that the 'sa' account is renamed and disabled",
    "displayName": "Account with default name 'sa' should be renamed and disabled on SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f9be60bc-423f-4462-adb4-e1be62a9ff39",
    "implementationEffort": "Moderate",
    "name": "f9be60bc-423f-4462-adb4-e1be62a9ff39",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Rename the default sysadmin (sa) account and disable it.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Every SQL Server login belongs to the public server role. When a server principal has not been granted or denied specific permissions on a securable object, the user inherits the permissions granted to public on that object. This rule displays a list of all securable objects or columns that are accessible to all users through the PUBLIC role.",
    "displayName": "Excessive permissions should not be granted to PUBLIC role on objects or columns in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6aed60ee-9f8a-47f1-a9d1-0305e0ed03ed",
    "implementationEffort": "Moderate",
    "name": "6aed60ee-9f8a-47f1-a9d1-0305e0ed03ed",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke unnecessary permissions granted to PUBLIC",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "'sa' is a well-known account with principal Id 1. This rule verifies that the 'sa' account is disabled",
    "displayName": "'sa' login should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b1ce48d9-cd89-4d75-84a0-d0dc5505a898",
    "implementationEffort": "Moderate",
    "name": "b1ce48d9-cd89-4d75-84a0-d0dc5505a898",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the well-known sysadmin account 'sa'. Instead use Windows-based groups to grant permissions to DBA and other administrative roles.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "xp_cmdshell spawns a Windows command shell and passes it a string for execution. This rule checks that xp_cmdshell is disabled.",
    "displayName": "xp_cmdshell should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eadae6a8-e9f4-4173-8c12-6f64703f9d01",
    "implementationEffort": "Moderate",
    "name": "eadae6a8-e9f4-4173-8c12-6f64703f9d01",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the 'xp_cmdshell' feature on the server.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Service Broker provides queuing and reliable messaging for SQL Server. Service Broker is used both for applications that use a single SQL Server instance and applications that distribute work across multiple instances. Service Broker endpoints provide options for transport security and message forwarding. This rule enumerates all the service broker endpoints. You should remove those that are not used.",
    "displayName": "Unused service broker endpoints should be removed for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/76052b85-52f4-4a0f-9f14-ad8e78426578",
    "implementationEffort": "Moderate",
    "name": "76052b85-52f4-4a0f-9f14-ad8e78426578",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Validate that you need to open the affected SSB endpoints. If not, remove them.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This rule checks that Database Mail is disabled when no database mail profile is configured. Database Mail can be used for sending e-mail messages from the SQL Server Database Engine and is disabled by default. If you are not using this feature, it is recommended to disable it to reduce the surface area.",
    "displayName": "Database Mail XPs should be disabled when it is not in use on SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/be5465f2-79a8-45aa-bf95-f6106bed0a57",
    "implementationEffort": "Moderate",
    "name": "be5465f2-79a8-45aa-bf95-f6106bed0a57",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable Database mail XP feature",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Server level permissions are associated with a server level object to regulate which users can gain access to the object. This rule checks that there are no server level permissions granted directly to logins.",
    "displayName": "Server permissions shouldn't be granted directly to principals for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8f04b48b-b199-45d8-9e5e-c07705a3be2e",
    "implementationEffort": "Moderate",
    "name": "8f04b48b-b199-45d8-9e5e-c07705a3be2e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke permissions granted to users directly. Instead use Windows groups or server roles to grant permissions, and manage role memberships instead.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Database users may share the same name as a server login. This rule validates that there are no such users to avoid confusion.",
    "displayName": "Database users shouldn't share the same name as a server login for Model SQL database",
    "id": "/providers/Microsoft.Security/assessmentMetadata/da61956e-b092-4acd-8b89-a78ddc6e6a46",
    "implementationEffort": "Moderate",
    "name": "da61956e-b092-4acd-8b89-a78ddc6e6a46",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "You should rename the affected users or logins to avoid the confusion. This requires updating all applications which are using those as credentials as well.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "When 'Scan for startup procs' is enabled, SQL Server scans for and runs all automatically run stored procedures defined on the server. If this option is enabled, SQL Server scans for and runs all automatically run stored procedures defined on the server. This rule checks that this option is disabled.",
    "displayName": "'Scan for startup stored procedures' option should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3f03bcc2-d66c-4b12-b3bc-406b2cfe3cd5",
    "implementationEffort": "Moderate",
    "name": "3f03bcc2-d66c-4b12-b3bc-406b2cfe3cd5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable this option. NOTE: Some features such as replication may require it.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "There are two possible authentication modes: Windows Authentication mode and mixed mode. Mixed mode means that SQL Server enables both Windows authentication and SQL Server authentication. This rule checks that the authentication mode is set to Windows Authentication.",
    "displayName": "Authentication mode should be Windows Authentication for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a89c44c5-0c04-4098-bd15-c617443995b6",
    "implementationEffort": "Moderate",
    "name": "a89c44c5-0c04-4098-bd15-c617443995b6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "After making sure that SQL Authentication is not absolutely required, set the server authentication setting to 'Windows Authentication mode'.<br>For more details please visit <a href='https://msdn.microsoft.com/en-us/library/ms144284.aspx'>here</a><br>NOTE: You will need to restart SQL Server for this setting to take effect.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server Login auditing configuration enables administrators to track the users logging into SQL Server instances. If the user chooses to count on 'Login auditing' to track users logging into SQL Server instances then it is important to enable it for both successful and failed login attempts.",
    "displayName": "Auditing of both successful and failed login attempts (default trace) should be enabled when 'Login auditing' is set up to track logins for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/96dd0622-2d0d-49ad-9042-d92a228b0e1f",
    "implementationEffort": "Moderate",
    "name": "96dd0622-2d0d-49ad-9042-d92a228b0e1f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Set the 'Login Auditing' setting for SQL Server to 'Both failed and successful logins'. For detailed information, please visit <a href='https://msdn.microsoft.com/en-us/library/ms175850.aspx'>here</a>.<br>The user must restart the SQL server for the remediation to take effect",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server uses the SQL Server Browser service to enumerate instances of the Database Engine installed on the computer. This enables client applications to browse for a server, and helps clients distinguish between multiple instances of the Database Engine on the same computer. This rule checks that the SQL instance is hidden.",
    "displayName": "SQL Server instance shouldn't be advertised by the SQL Server Browser service for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0fccb942-d1e9-47c7-87cd-c98bcfd8e339",
    "implementationEffort": "Moderate",
    "name": "0fccb942-d1e9-47c7-87cd-c98bcfd8e339",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Hide your SQL instance. For more details please visit <a href='https://msdn.microsoft.com/en-us/library/ms179327.aspx'>here</a>.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Each SQL Server Error log will have all the information related to failures / errors that has occurred since SQL Server was last restarted or since the last time you have recycled the error logs. This rule checks that the maximum numner of error logs is 12 or more.",
    "displayName": "Maximum number of error logs should be 12 or more for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/31e24118-a540-4b40-bef1-952de1af23cb",
    "implementationEffort": "Moderate",
    "name": "31e24118-a540-4b40-bef1-952de1af23cb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Configure the 'SQL Server logs file' setting on SQL Server and make sure the maximum number of error logs before they are overwritten is set to 12 (or higher).<br>For details, please visit <a href='https://msdn.microsoft.com/en-us/library/ms177285.aspx'>here</a>",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Permissions are rules associated with a securable object to regulate which users can gain access to the object. This rule checks that there are no DB permissions granted directly to users.",
    "displayName": "Database permissions shouldn't be granted directly to principals for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f644db73-c0ef-4e1c-846a-5ccf9280b4c1",
    "implementationEffort": "Moderate",
    "name": "f644db73-c0ef-4e1c-846a-5ccf9280b4c1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke permissions granted to users directly. Instead use Windows groups or server roles to grant permissions, and manage role memberships instead.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Every SQL Server login belongs to the public server role. When a server principal has not been granted or denied specific permissions on a securable object, the user inherits the permissions granted to public on that object. This displays a list of all permissions that are granted to the PUBLIC role.",
    "displayName": "Excessive permissions should not be granted to PUBLIC role in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3f2a3bd7-5f36-4d4e-a0a9-f19933ec5bd9",
    "implementationEffort": "Moderate",
    "name": "3f2a3bd7-5f36-4d4e-a0a9-f19933ec5bd9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke any unnecessary permissions granted to PUBLIC, but avoid changing permissions granted out of the box.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Each database includes a user called GUEST. Permissions granted to GUEST are inherited by users who have access to the database, but who do not have a user account in the database. This rule checks that all permissions have been revoked from the GUEST user.",
    "displayName": "Principal GUEST should not be granted permissions in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6cbd7126-7091-43f5-8f30-e59cf1a7b6b6",
    "implementationEffort": "Moderate",
    "name": "6cbd7126-7091-43f5-8f30-e59cf1a7b6b6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke any unnecessary permissions granted to the special account GUEST",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Each database includes a user called GUEST. Permissions granted to GUEST are inherited by users who have access to the database, but who do not have a user account in the database. This rule checks that all permissions have been revoked from the GUEST user.",
    "displayName": "Principal GUEST should not be granted permissions on objects or columns in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/063d0390-42cf-4bb5-82a0-72071e1a612f",
    "implementationEffort": "Moderate",
    "name": "063d0390-42cf-4bb5-82a0-72071e1a612f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke any unnecessary permissions granted to the special account GUEST",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Mirroring endpoints, which are used for Always On Synchronization, as well as Service Broker endpoints support different encryption algorithms, including no encryption. This rule checks that any existing endpoint requires AES encryption.",
    "displayName": "AES encryption should be required for any Existing Mirroring or SSB endpoint on SQL Databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e2d0fab5-f6fd-4d2b-8725-5fd15099fd70",
    "implementationEffort": "Moderate",
    "name": "e2d0fab5-f6fd-4d2b-8725-5fd15099fd70",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Change the affected endpoints to accept only AES connections",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Each database includes a user called GUEST. Permissions granted to GUEST are inherited by users who have access to the database, but who do not have a user account in the database. This rule checks that all permissions have been revoked from the GUEST user.",
    "displayName": "GUEST user should not be granted permissions on SQL database securables",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2115ef5d-2c98-484b-ac79-2883371be4a6",
    "implementationEffort": "Moderate",
    "name": "2115ef5d-2c98-484b-ac79-2883371be4a6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke any unnecessary permissions granted to the special account GUEST",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The TRUSTWORTHY database property is used to indicate whether the instance of SQL Server trusts the database and the contents within it. If this option is enabled, database modules (for example, user-defined functions or stored procedures) that use an impersonation context can access resources outside the database. This rule verifies that the TRUSTWORTHY bit is disabled on all databases, except MSDB.",
    "displayName": "The Trustworthy bit should be disabled on all databases except MSDB for SQL Databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4711c18c-eac4-488d-a9dd-91e0286df063",
    "implementationEffort": "Moderate",
    "name": "4711c18c-eac4-488d-a9dd-91e0286df063",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the trustworthy bit (TWbit) from all affected databases.<br>If you need to use functionality that is controlled by the TWbit, it is recommended to use digital signatures to enable the functionality instead of enabling the TWbit on the database.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The 'dbo', or database owner, is a user account that has implied permissions to perform all activities in the database. Members of the sysadmin fixed server role are automatically mapped to dbo. This rule checks that dbo is not the only account allowed to access this database. Please note that on a newly created clean database this rule will fail until additional roles are created.",
    "displayName": "'dbo' user should not be used for normal service operation in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/211f976f-cac2-4e3d-8d79-744a85eedc92",
    "implementationEffort": "Moderate",
    "name": "211f976f-cac2-4e3d-8d79-744a85eedc92",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Create users with low privileges to access the DB and any data stored in it with the appropriate set of permissions.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Model database is used as the template for all databases created on the instance of SQL Server. Modifications made to the model database, such as database size, collation, recovery model, and other database options, are applied to any databases created afterward. This rule checks that dbo is the only account allowed to access the model database.",
    "displayName": "Model database should only be accessible by  Only 'dbo' should have access to Model SQL database",
    "id": "/providers/Microsoft.Security/assessmentMetadata/27f8f855-c834-4611-be7c-d8f443cf17ce",
    "implementationEffort": "Moderate",
    "name": "27f8f855-c834-4611-be7c-d8f443cf17ce",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove users that have access to Model database",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Transparent data encryption (TDE) helps to protect the database files against information disclosure by performing real-time encryption and decryption of the database, associated backups, and transaction log files 'at rest', without requiring changes to the application. This rule checks that TDE is enabled on the database.",
    "displayName": "Transparent data encryption should be enabled for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aede6ed5-32a2-489f-94b1-85767847b595",
    "implementationEffort": "Moderate",
    "name": "aede6ed5-32a2-489f-94b1-85767847b595",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Enable TDE on the affected database. Please follow the instructions <a href='https://docs.microsoft.com/en-us/sql/relational-databases/security/encryption/transparent-data-encryption'>here</a>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft SQL Server can use Secure Sockets Layer (SSL) or Transport Layer Security (TLS) to encrypt data that is transmitted across a network between an instance of SQL Server and a client application. This rule checks that all connections to the SQL Server are encrypted through TLS.",
    "displayName": "Database communication using TDS should be protected through TLS for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b13ff618-06ab-4cd4-a181-9d56eb6dc76a",
    "implementationEffort": "Moderate",
    "name": "b13ff618-06ab-4cd4-a181-9d56eb6dc76a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Force encyption on the client applications.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server uses encryption keys to help secure data, credentials, and connection information that is stored in a server database. SQL Server has two kinds of keys: symmetric and asymmetric. This rule checks that Database Encryption Symmetric Keys use AES algorithm.",
    "displayName": "Database Encryption Symmetric Keys should use AES algorithm in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/df777b52-0d5e-434b-953a-0285f83478c7",
    "implementationEffort": "Moderate",
    "name": "df777b52-0d5e-434b-953a-0285f83478c7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Regenerate the DEK using AES",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Cell-Level Encryption (CLE) allows you to encrypt your data using symmetric and asymmetric keys. This rule checks that Cell-Level Encryption symmetric keys use AES algorithm.",
    "displayName": "Cell-Level Encryption keys should use AES algorithm in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b3d7132d-1fe7-4408-91ae-dc3a188bfd26",
    "implementationEffort": "Moderate",
    "name": "b3d7132d-1fe7-4408-91ae-dc3a188bfd26",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Create AES keys, re-encrypt the data using the new key, and drop the affected keys.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Certificate keys are used in RSA and other encryption algorithms to protect data. These keys need to be of enough length to secure the user's data. This rule checks that the key's length is at least 2048 bits for all certificates.",
    "displayName": "Certificate keys should use at least 2048 bits for SQL Databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a56a8c1-e013-49d0-8295-e60407730b94",
    "implementationEffort": "Moderate",
    "name": "1a56a8c1-e013-49d0-8295-e60407730b94",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Create new certificates, re-encrypt the data/sign-data using the new key, and drop the affected keys.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Database asymmetric keys are used in many encryption algorithms, these keys need to be of enough length to secure the encrypted data, this rule checks that all asymmetric keys stored in the database are of length of at least 2048 bits",
    "displayName": "Asymmetric keys' length should be at least 2048 bits in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/becd2bef-27ac-4d8b-8e2a-73dfbfc7a4f5",
    "implementationEffort": "Moderate",
    "name": "becd2bef-27ac-4d8b-8e2a-73dfbfc7a4f5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Create new asymmetric Keys, re-encrypt the data/sign-data using the new key, and drop the affected keys.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "FILESTREAM integrates the SQL Server Database Engine with an NTFS file system by storing varbinary(max) binary large object (BLOB) data as files on the file system. Transact-SQL statements can insert, update, query, search, and back up FILESTREAM data. Enabling Filestream on SQL server exposes additional NTFS streaming API which increases its attack surface and makes it prone to malicious attacks. This rule checks that Filestream is disabled.",
    "displayName": "Filestream should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fe3db657-719e-4134-9de4-e9110e67d23f",
    "implementationEffort": "Moderate",
    "name": "fe3db657-719e-4134-9de4-e9110e67d23f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "1. Use SQL Server configuration Manager to disable this feature<br>2. Set the filestream access level to 0 to effectively disable it - Use Remediation script",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disable the deprecated server configuration 'Replication XPs' to limit the attack surface area. This is an internal only configuration setting.",
    "displayName": "Server configuration 'Replication XPs' should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/848680cd-73d9-4a5f-8f02-b58b32c00f96",
    "implementationEffort": "Moderate",
    "name": "848680cd-73d9-4a5f-8f02-b58b32c00f96",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable replication XPs on the system",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "A database user that exists on a database, but has no corresponding login in master database or as an external resource (i.e. Windows user) is referred to as an orphaned user and it should either be removed or remapped to a valid login. This rule checks that there are no orphaned users.",
    "displayName": "Orphaned users should be removed from SQL server databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d2f665b3-3cb5-460e-8d52-eb92a57067aa",
    "implementationEffort": "Moderate",
    "name": "d2f665b3-3cb5-460e-8d52-eb92a57067aa",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Drop the orphaned users or remap them to a different login.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Database ownership metadata is stored in two locations - in the master database and in the database itself. This stored metadata can sometimes become out of sync. For instance, when a database has been restored from a different server, or when the server principal stored as dbo no longer exists for some reason, the data stored in the database and the data stored in the master database will be out of sync.",
    "displayName": "The database owner information in the database should match the respective database owner information in the master database for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ff38d4d1-f98b-4f49-b096-e40ad8898b01",
    "implementationEffort": "Moderate",
    "name": "ff38d4d1-f98b-4f49-b096-e40ad8898b01",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Use ALTER AUTHORIZATION ON DATABASE DDL-command against the database to specify a new server principal that should be the owner of the database",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "An application role is a database principal that enables an application to run with its own user-like permissions. Application roles enable that only users connecting through a particular application can access specific data. Application roles are password-based (which applications typically hardcode) and not permission based, which exposes the database to approle impersonation by password-guessing. This rule checks that no application roles are defined in the database.",
    "displayName": "Application roles should not be used in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/123285d4-ef1f-4543-a3ae-3f8656563b38",
    "implementationEffort": "Moderate",
    "name": "123285d4-ef1f-4543-a3ae-3f8656563b38",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove the application roles. Use users without login as a permission-based replacement",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "When SQL Server has been configured to 'scan for startup procs', the server will scan master DB for stored procedures marked as auto-start. This rule checks that there are no SPs marked as auto-start.",
    "displayName": "There should be no SPs marked as auto-start for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7c009298-050f-4ec6-b9ec-2f7761ed031f",
    "implementationEffort": "Moderate",
    "name": "7c009298-050f-4ec6-b9ec-2f7761ed031f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove the startup property on the affected modules.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To easily manage the permissions in your databases, SQL Server provides several roles which are security principals that group other principals. They are like groups in the Microsoft Windows operating system. Database accounts and other SQL Server roles can be added into database-level roles. Each member of a fixed-database role can add other users to that same role. This rule checks that no user-defined roles are members of fixed roles",
    "displayName": "User-defined database roles should not be members of fixed roles in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/31c5a284-c8cd-47c3-9242-2429ed5adf7c",
    "implementationEffort": "Moderate",
    "name": "31c5a284-c8cd-47c3-9242-2429ed5adf7c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove user defined roles from fixed-database roles",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "CLR assemblies can be used to execute arbitrary code on SQL Server process. This rule checks that there are no user-defined CLR assemblies in the database",
    "displayName": "User CLR assemblies should not be defined in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e34cd505-f157-4dce-84d8-5d38dfb2cb6f",
    "implementationEffort": "Moderate",
    "name": "e34cd505-f157-4dce-84d8-5d38dfb2cb6f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Drop assemblies from the affected databases",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Database owners can perform all configuration and maintenance activities on the database, and can also drop databases in SQL Server. Tracking database owners is important to avoid having excessive permission for some principals. Create a baseline which defines the expected database owners for the database. This rule checks whether the database owners are as defined in the baseline.",
    "displayName": "Database owners should be as expected for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f7fde937-a0b2-47a5-89ae-fcb475df5b82",
    "implementationEffort": "Moderate",
    "name": "f7fde937-a0b2-47a5-89ae-fcb475df5b82",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Keep track of database owners. Remove unnecessary database owners to avoid granting excessive permissions or update the baseline to reflect the approved list of owners.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server auditing configuration enables administrators to track the users logging into SQL Server instances that they're responsible for. This rule checks that auditing is enabled for both successful and failed login attempts.",
    "displayName": "Auditing of both successful and failed login attempts should be enabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2b9eafde-304b-471b-8d9a-7a4966e40db8",
    "implementationEffort": "Moderate",
    "name": "2b9eafde-304b-471b-8d9a-7a4966e40db8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Create and enable a new SERVER AUDIT SPECIFICATION that will audit FAILED_LOGIN_GROUP & SUCCESSFUL_LOGIN_GROUP events. This SERVER AUDIT SPECIFICATION must target a valid SERVER AUDIT object that is enabled.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server auditing configuration enables adminstrators to track users logging to SQL Server instances that they're responsible for. This rules checks that auditing is enabled for both successful and failed login attempts for contained DB authentication.",
    "displayName": "Auditing of both successful and failed login attempts for contained DB authentication should be enabled for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e0710b96-f76a-435f-8e0d-3a18703c19a7",
    "implementationEffort": "Moderate",
    "name": "e0710b96-f76a-435f-8e0d-3a18703c19a7",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Create and enable a new SERVER AUDIT SPECIFICATION that will audit FAILED_LOGIN_GROUP & SUCCESSFUL_LOGIN_GROUP events. This SERVER AUDIT SPECIFICATION must target a valid SERVER AUDIT object that is enabled.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Contained users are users that exist within the database, and do not require a login mapping. This rule checks that contained users use Windows Authentication.",
    "displayName": "Contained users should use Windows Authentication in SQL Server databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/25cdb02c-6bd8-4444-8318-9df003edc170",
    "implementationEffort": "Moderate",
    "name": "25cdb02c-6bd8-4444-8318-9df003edc170",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove all contained users with password.<br>All affected applications will have to switch to Windows authentication, or create logins with password policy enforcement in order to connect to the DB.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "PolyBase is a technology that accesses and combines both non-relational and relational data, all from within SQL Server. Polybase network encryption option configures SQL Server to encrypt control and data channels when using Polybase. This rule verifies that this option is enabled.",
    "displayName": "Polybase network encryption should be enabled for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6ef039e5-8219-4d20-ab60-7f5c3bad95de",
    "implementationEffort": "Moderate",
    "name": "6ef039e5-8219-4d20-ab60-7f5c3bad95de",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Enable polybase network encryption (default)",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The SQL Server Extensible Key Management (EKM) enables third-party EKM / Hardware Security Modules (HSM) vendors to register their modules in SQL Server. When registered, SQL Server users can use the encryption keys stored on EKM modules. This rule displays a list of EKM providers being used in the system.",
    "displayName": "Create a baseline of External Key Management Providers for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b8a39ba4-f129-4656-a089-27ff4c5361d6",
    "implementationEffort": "Moderate",
    "name": "b8a39ba4-f129-4656-a089-27ff4c5361d6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Create a base for EKM providers being used in the system. Remove old versions of providers when no longer needed.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "When the Force Encryption option for the Database Engine is enabled, all communications between client and server is encrypted regardless of whether the 'Encrypt connection' option (such as from SSMS) is checked or not. This rule checks that Force Encryption option is enabled.",
    "displayName": "Force encryption should be enabled for TDS for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5765385f-4da2-4a26-a89e-7cf66a14ad8d",
    "implementationEffort": "Moderate",
    "name": "5765385f-4da2-4a26-a89e-7cf66a14ad8d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Change the ForceEncryption setting on SQL Server Control Manager. For More information please visit <a href='https://support.microsoft.com/en-us/help/316898/how-to-enable-ssl-encryption-for-an-instance-of-sql-server-by-using-mi'>here</a>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Every SQL Server login belongs to the public server role. When a server principal has not been granted or denied specific permissions on a securable object, the user inherits the permissions granted to public on that object. This rule checks that server permissions granted to public is minimized.",
    "displayName": "Server Permissions granted to public should be minimized for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b58b2914-1aec-4469-ae64-21e0078b1729",
    "implementationEffort": "Moderate",
    "name": "b58b2914-1aec-4469-ae64-21e0078b1729",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke any unecessary permissions",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "User-defined roles are security principals defined by the user to group principals to easily manage permissions. Monitoring these roles is important to avoid having excessive permissions. Create a baseline which defines expected membership for each user-defined role. This rule checks whether all memberships for user-defined roles are as defined in the baseline",
    "displayName": "All memberships for user-defined roles should be intended in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e8b826e1-d31b-4545-8a0c-8f640d4ad5d3",
    "implementationEffort": "Moderate",
    "name": "e8b826e1-d31b-4545-8a0c-8f640d4ad5d3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Keep track of role membership and remove unnecessary members from roles to avoid granting excessive permissions or update baseline to comply with new changes",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Orphan database roles are user-defined roles that have no members. It is recommended to eliminate orphaned roles as they are not needed on the system. This rule checks whether there are any orphan roles",
    "displayName": "Orphan database roles should be removed from SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7f5bd587-ba14-49ce-801a-f2613ccc3584",
    "implementationEffort": "Moderate",
    "name": "7f5bd587-ba14-49ce-801a-f2613ccc3584",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Drop the unnecessary roles.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Auditing an instance of the SQL Server Database Engine or an individual database involves tracking and logging events that occur on the Database Engine. The SQL Server Audit object collects a single instance of server or database-level actions and groups of actions to monitor. This rule checks that there is at least one active audit in the system.",
    "displayName": "There should be at least 1 active audit in the system for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c4671054-a31b-4e7e-8393-c62381a933b9",
    "implementationEffort": "Moderate",
    "name": "c4671054-a31b-4e7e-8393-c62381a933b9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Follow the instruction <a href='https://msdn.microsoft.com/en-us/library/cc280448.aspx'>here</a>",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Every SQL Server securable has permissions associated with it that can be granted to principals. Permissions can be scoped at the server level (assigned to logins and server roles) or at the database level (assigned to database users and database roles). These rules check that only a minimal set of principals are granted ALTER or ALTER ANY USER database-scoped permissions.",
    "displayName": "Minimal set of principals should be granted ALTER or ALTER ANY USER database-scoped permissions in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/08c9b451-08a5-418d-9d2c-fc75197aab44",
    "implementationEffort": "Moderate",
    "name": "08c9b451-08a5-418d-9d2c-fc75197aab44",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke permissions from principals where not needed. It is recommended to have at most 1 principal granted a specific permission.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This rule checks which principals are granted EXECUTE permission on objects or columns to ensure this permission is granted to a minimal set of principals. Every SQL Server securable has permissions associated with it that can be granted to principals.<br>Permissions can be scoped at the server level (assigned to logins and server roles) or at the database level (assigned to database users, database roles or application roles). The EXECUTE permission applies to both stored procedures and scalar functions, which can be used in computed columns.",
    "displayName": "Minimal set of principals should be granted EXECUTE permission on objects or columns in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3bee4ca7-e768-497f-ac60-032225a93ff2",
    "implementationEffort": "Moderate",
    "name": "3bee4ca7-e768-497f-ac60-032225a93ff2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke permissions from principals where not needed. It is recommended to have at most 1 principal granted a specific permission.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Threat Detection provides a layer of security, which detects potential vulnerabilities and anomalous activity in databases, such as SQL injection attacks and unusual behavior patterns. When a potential threat is detected, Threat Detection sends an actionable real-time alert by email and in Azure Security Center, which includes clear investigation and remediation steps for the specific threat. For more information please visit <a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-threat-detection'>here</a>.<br>This check verifies that SQL Threat Detection is enabled",
    "displayName": "SQL Threat Detection should be enabled at the SQL server level",
    "id": "/providers/Microsoft.Security/assessmentMetadata/207ea640-5acf-49ad-92b4-8df60e793fef",
    "implementationEffort": "Moderate",
    "name": "207ea640-5acf-49ad-92b4-8df60e793fef",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "It is recommended to enable SQL Threat Detection at the server level so that all activities on the server itself and the databases that belong to it are protected.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure SQL Database Auditing tracks database events and writes them to an audit log in your Azure storage account. Auditing helps you understand database activity and gain insight into discrepencies and anomalies that could indicate business concerns or suspected security violations, as well as helps you meet regulatory compliance.<br> For more information visit <a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-auditing'>here</a> .<br> This rule checks that auditing is enabled",
    "displayName": "Auditing should be enabled at the server level for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/de1a511e-6ccd-4bf0-8d08-49363b1a1085",
    "implementationEffort": "Moderate",
    "name": "de1a511e-6ccd-4bf0-8d08-49363b1a1085",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "It is recommended to enable SQL Database Auditing at the server level so that all activities on the server itself and the databases that belong to it are tracked.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Azure SQL Database-level firewall helps protect your data by preventing all access to your database until you specify which IP addresses have permission. Database-level firewall rules grant access to the specific database based on the originating IP address of each request.<br>Database-level firewall rules for master and user databases can only be created and managed through Transact-SQL (unlike server-level firewall rules which can also be created and managed using the Azure portal or PowerShell). For more details please visit <a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure'>here</a><br>This check verifies that each database-level firewall rule does not grant access to more than 255 IP addresses.",
    "displayName": "Database-level firewall rules should not grant excessive access for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2caca086-d941-413f-90ef-d8a593c8b900",
    "implementationEffort": "Moderate",
    "name": "2caca086-d941-413f-90ef-d8a593c8b900",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove database firewall rules that grant excessive access",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Azure SQL server-level firewall helps protect your server by preventing all access to your databases until you specify which IP addresses have permission. Server-level firewall rules grant access to all databases that belong to the server based on the originating IP address of each request.<br>Server-level firewall rules can only be created and managed through Transact-SQL as well as through the Azure portal or PowerShell. For more details please visit <a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure'>here</a><br>This check verifies that each server-level firewall rule does not grant access to more than 255 IP addresses.",
    "displayName": "Server-level firewall rules should not grant excessive access for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0412d153-1963-4d9d-866b-5fe0c61c2a05",
    "implementationEffort": "Moderate",
    "name": "0412d153-1963-4d9d-866b-5fe0c61c2a05",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove server firewall rules that grant excessive access",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Azure SQL Database-level firewall helps protect your data by preventing all access to your database until you specify which IP addresses have permission. Database-level firewall rules grant access to the specific database based on the originating IP address of each request.<br>Database-level firewall rules for master and user databases can only be created and managed through Transact-SQL (unlike server-level firewall rules which can also be created and managed using the Azure portal or PowerShell). For more details please visit <a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure'>here</a>.<br>This check enumerates all the database-level firewall rules so that any changes made to them can be identified and addressed.",
    "displayName": "Database-level firewall rules should be tracked and maintained at a strict minimum for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a0f95121-3aa8-40da-a803-d7dda3e53dee",
    "implementationEffort": "Moderate",
    "name": "a0f95121-3aa8-40da-a803-d7dda3e53dee",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Evaluate each of the database-level firewall rules. Remove any rules that grant unnecessary access and set the rest as a baseline. Deviations from the baseline will be identified and brought to your attention in subsequent scans.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Azure SQL server-level firewall helps protect your data by preventing all access to your databases until you specify which IP addresses have permission. Server-level firewall rules grant access to all databases that belong to the server based on the originating IP address of each request.<br>Server-level firewall rules can be created and managed through Transact-SQL as well as through the Azure portal or PowerShell. For more details please visit <a href='https://docs.microsoft.com/en-us/azure/sql-database/sql-database-firewall-configure'>here</a>.<br>This check enumerates all the server-level firewall rules so that any changes made to them can be identified and addressed.",
    "displayName": "Server-level firewall rules should be tracked and maintained at a strict minimum on SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8bde1a6b-a583-4a91-b1b5-0366e605cdf4",
    "implementationEffort": "Moderate",
    "name": "8bde1a6b-a583-4a91-b1b5-0366e605cdf4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Evaluate each of the server-level firewall rules. Remove any rules that grant unnecessary access and set the rest as a baseline. Deviations from the baseline will be identified and brought to your attention in subsequent scans.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Extended stored procedures are DLLs that an instance of SQL Server can dynamically load and run. SQL Server is packaged with many extended stored procedures that allow for interaction with the system DLLs. This rule checks that unnecessary execute permissions on extended stored procedures have been revoked.",
    "displayName": "Unnecessary execute permissions on extended stored procedures should be revoked for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0262e851-d99b-4299-bacc-136c92941541",
    "implementationEffort": "Moderate",
    "name": "0262e851-d99b-4299-bacc-136c92941541",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke unnecessary EXECUTE permission on extended stored procedure.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Database provides two restricted administrative roles in the master database to which user accounts can be added that grant permissions to either create databases or manage logins. This rules check that a minimal set of principals are members of these administrative roles.",
    "displayName": "Minimal set of principals should be members of fixed Azure SQL Database master database roles",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a4ca5495-f5ad-4d4d-807b-e8f62541ee34",
    "implementationEffort": "Moderate",
    "name": "a4ca5495-f5ad-4d4d-807b-e8f62541ee34",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove members who should not have access to the master database role",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server provides roles to help manage the permissions. Roles are security principals that group other principals. Database-level roles are database-wide in their permission scope. This rule checks that a minimal set of principals are members of the fixed database roles.",
    "displayName": "Minimal set of principals should be members of fixed high impact database roles in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7a0a58ed-8927-4e8d-80c3-59279fa44aa0",
    "implementationEffort": "Moderate",
    "name": "7a0a58ed-8927-4e8d-80c3-59279fa44aa0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove members who should not have access to the database role",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server provides roles to help manage the permissions. Roles are security principals that group other principals. Database-level roles are database-wide in their permission scope. This rule checks that a minimal set of principals are members of the fixed database roles.",
    "displayName": "Minimal set of principals should be members of fixed low impact database roles in SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/267df805-7fa4-415f-8b2e-08deefdb5e1b",
    "implementationEffort": "Moderate",
    "name": "267df805-7fa4-415f-8b2e-08deefdb5e1b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove members who should not have access to the database role",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Registry extended stored procedures allow Microsoft SQL Server to read, write, and enumerate values and keys in the registry. This rule enumerates principals with permission to execute registry extended stored procedures.",
    "displayName": "Execute permissions to access the registry should be restricted for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b66a88e5-8c46-47f2-9107-5ed84da7270f",
    "implementationEffort": "Moderate",
    "name": "b66a88e5-8c46-47f2-9107-5ed84da7270f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Review the list of principals that have permission to execute registry extended stored procedures. Revoke execute permissions for principals that should not have this permission. Set the remaining principals as a baseline and track that changes made to this list are desirable. Note that revoking execute permissions to xp_instance_regread and xp_regread will affect applications that use SMO library such as SSMS.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft SQL Server comes shipped with several sample databases. This rule checks whether the sample databases have been removed.",
    "displayName": "Sample databases should be removed for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aca36760-8cab-4b04-84d8-9826757bb3ca",
    "implementationEffort": "Moderate",
    "name": "aca36760-8cab-4b04-84d8-9826757bb3ca",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove the sample database.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Data Transformation Services (DTS), is a set of objects and utilities that allow the automation of extract, transform and load operations to or from a database. The objects are DTS packages and their components, and the utilities are called DTS tools. This rule checks that only the SSIS roles are granted permissions to use the DTS system stored procedures and the permissions for the PUBLIC role to use the DTS system stored procedures have been revoked.",
    "displayName": "Data Transformation Services (DTS) permissions should only be granted to SSIS roles in MSDB SQL database",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0d9a8166-01b2-434c-9791-c589b119eea8",
    "implementationEffort": "Moderate",
    "name": "0d9a8166-01b2-434c-9791-c589b119eea8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke DTS permission granted to principals other than SSIS roles.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server provides roles to help manage permissions. Roles are security principals that group other principals. Server-level roles are server-wide in their permission scope. This rule checks that a minimal set of principals are members of the fixed server roles.",
    "displayName": "Minimal set of principals should be members of fixed server roles for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d8cfa23e-9485-44a4-831e-757c71e48988",
    "implementationEffort": "Moderate",
    "name": "d8cfa23e-9485-44a4-831e-757c71e48988",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Remove members who should not have access to fixed server roles.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server is capable of providing a wide range of features and services. Some of the features and services, provided by default, may not be necessary, and enabling them could adversely affect the security of the system. This rules checks that these features are disabled.",
    "displayName": "Features that may affect security should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/611c613b-cb84-4e67-8bb3-1e9dc43d7783",
    "implementationEffort": "Moderate",
    "name": "611c613b-cb84-4e67-8bb3-1e9dc43d7783",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the features.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server is capable of providing a wide range of features and services. Some of the features and services, provided by default, may not be necessary, and enabling them could adversely affect the security of the system.<br>The OLE Automation Procedures option controls whether OLE Automation objects can be instantiated within Transact-SQL batches. These are extended stored procedures that allow SQL Server users to execute functions external to SQL Server.<br>Regardless of its benefits it can also be used for exploits, and is known as a popular mechanism to plant files on the target machines. It is advised to use Powershell as a replacement for this tool.<br>This rule checks that 'OLE Automation Procedures' feature is disabled.",
    "displayName": "'OLE Automation Procedures' feature should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eaafd365-6eb2-4e02-90b4-43e0f0a86638",
    "implementationEffort": "Moderate",
    "name": "eaafd365-6eb2-4e02-90b4-43e0f0a86638",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the feature 'OLE Automation Procedures'",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server is capable of providing a wide range of features and services. Some of the features and services, provided by default, may not be necessary, and enabling them could adversely affect the security of the system.<br>The user options option specifies global defaults for all users. A list of default query processing options is established for the duration of a user's work session. The user options option allows you to change the default values of the SET options (if the server's default settings are not appropriate).<br>This rules checks that 'user options' feature is disabled.",
    "displayName": "'User Options' feature should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/927e9d4f-3f7c-495c-9d69-05cd47ee0369",
    "implementationEffort": "Moderate",
    "name": "927e9d4f-3f7c-495c-9d69-05cd47ee0369",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the feature.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL Server provides a wide range of features and services. Some of the features and services, provided by default, may not be necessary, and enabling them could adversely affect the security of the system. This rule checks that configurations that allow extraction of data to an external data source and the execution of scripts with certain remote language extensions are disabled.",
    "displayName": "Extensibility-features that may affect security should be disabled if not needed for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/199a4141-7a0f-4d06-8eac-12431a6655ea",
    "implementationEffort": "Moderate",
    "name": "199a4141-7a0f-4d06-8eac-12431a6655ea",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable the features.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To run a Vulnerability Assessment scan on your SQL Server, the server needs to be upgraded to SQL Server 2012 or higher.SQL Server 2008 R2 and below are no longer supported by Microsoft. See <a href='https://www.microsoft.com/en-us/cloud-platform/windows-sql-server-2008'>here</a>",
    "displayName": "Vulnerability Assessment should be configured on SQL Server 2012 and higher only",
    "id": "/providers/Microsoft.Security/assessmentMetadata/82735d78-e25e-4dc1-bf02-11136003cd69",
    "implementationEffort": "Moderate",
    "name": "82735d78-e25e-4dc1-bf02-11136003cd69",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Upgrade your SQL Server version to 2012 or higher.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "You can sign a stored procedure, function or trigger with a certificate or an asymmetric key. This is designed for scenarios when permissions cannot be inherited through ownership chaining or when the ownership chain is broken, such as dynamic SQL. This rule checks for changes made to signed modules which could be an indication of malicious use.",
    "displayName": "Changes to signed modules should be authorized for SQL databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e058e189-97da-4c3b-8361-e7097a93131c",
    "implementationEffort": "Moderate",
    "name": "e058e189-97da-4c3b-8361-e7097a93131c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Baseline or remove the signature from the modules.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This check tracks all users with access to a database. Make sure that these users are authorized according to their current role in the organization. ",
    "displayName": "Track all users with access to the database for SQL Databases",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eeed5c32-daff-489c-8307-76035ee85274",
    "implementationEffort": "Moderate",
    "name": "eeed5c32-daff-489c-8307-76035ee85274",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Revoke unnecessary access granted to users. Add the rest to the baseline.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This rule checks the accounts with database owner permission for commonly used names. Assigning commonly used names to accounts with database owner permission increases the likelihood of successful brute force attacks.",
    "displayName": "SQL logins with commonly used names should be disabled for SQL Servers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/467115f4-5145-43a9-93a8-7dbfaa1eedc4",
    "implementationEffort": "Moderate",
    "name": "467115f4-5145-43a9-93a8-7dbfaa1eedc4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/01/2025"
    },
    "remediationDescription": "Disable or rename the accounts.",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of secrets in GitLab projects poses a significant security risk.<br> These secrets can be exploited by threat actors, potentially leading to the compromise of an application or service.<br>If left unresolved, this could lead to unauthorized access and potential data loss.<br>",
    "displayName": "GitLab projects should have secrets scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/867001c3-2d01-4db7-b513-5cb97638f23d",
    "implementationEffort": "Low",
    "name": "867001c3-2d01-4db7-b513-5cb97638f23d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "01/09/2023"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the secret found by the scan.<br>2. Select a finding to view details.<br>3. Invalidate the secret, tokens, and/or passwords.<br>4. Navigate to the project using the Project or Vulnerability URL.<br>5. Refactor your code to remove the secret.<br>6. Check-in the remediated project.<br>6. Review scan results for the repository to verify the secret no longer exists.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Potential security configuration issues were identified in the Infrastructure as Code (IaC) files in GitLab projects.<br> These issues could potentially compromise the security posture of the associated cloud resources.<br>If left unresolved, these issues could lead to vulnerabilities in the cloud infrastructure, making it susceptible to attacks.<br>",
    "displayName": "GitLab projects should have infrastructure as code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ec1bface-60ff-46b6-b1dc-67171a4882d5",
    "implementationEffort": "Low",
    "name": "ec1bface-60ff-46b6-b1dc-67171a4882d5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "01/09/2023"
    },
    "remediationDescription": "To resolve IaC misconfigurations:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a misconfiguration to view details.<br>3. Navigate to the file using the Project URL.<br>4. Remediate the IaC template using the instructions provided. Note: Refer to the specific Rule ID to research and understand how to remediate the finding.<br>5. Check-in the remediated IaC template.<br>6. Review scan results for the repository to verify the IaC misconfiguration no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Execution"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Dependency vulnerabilities have been detected in GitLab projects, which can pose a significant risk to the security of the code repositories.<br>\nThese vulnerabilities can be exploited by attackers to compromise the system or gain unauthorized access.<br>\nTo mitigate the risk of breaches and improve the security posture, update or patch the vulnerable dependencies.<br>",
    "displayName": "GitLab projects should have dependency vulnerability scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1bc53aae-c92e-406b-9693-d46caf3934fa",
    "implementationEffort": "Low",
    "name": "1bc53aae-c92e-406b-9693-d46caf3934fa",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "01/09/2023"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the repository using the Project URL.<br>4. Remediate the vulnerability using the instructions provided.<br>5. Check-in the remediated project.<br>6. Review scan results for the repository to verify the vulnerability no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Vulnerabilities detected in GitLab code projects pose a significant security risk.<br>\nThese vulnerabilities can be exploited by attackers to compromise the system or gain unauthorized access.<br>\nTo reduce the risk of breaches and improve the security posture of the projects, resolve these code scanning findings.<br>",
    "displayName": "GitLab projects should have code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cd3e4ff3-b1bc-4a42-b10d-e2f9f99e2991",
    "implementationEffort": "Low",
    "name": "cd3e4ff3-b1bc-4a42-b10d-e2f9f99e2991",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "01/09/2023"
    },
    "remediationDescription": "To resolve code findings:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the code file using the Project URL.<br>4. Remediate the finding from the finding description.<br>5. Check-in the remediated code file.<br>6. Review scan results for the project to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The security configuration issues detected in the GitHub repositories' infrastructure as code (IaC) templates need to be resolved.<br> These issues can potentially compromise the security posture of the related cloud resources.<br> If left unaddressed, they could lead to vulnerabilities in the infrastructure, making it susceptible to attacks.<br> Therefore, it's crucial to remediate these issues to enhance the overall security of the cloud resources.<br>",
    "displayName": "GitHub repositories should have infrastructure as code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d9be0ff8-3eb0-4348-82f6-c1e735f85983",
    "implementationEffort": "Moderate",
    "name": "d9be0ff8-3eb0-4348-82f6-c1e735f85983",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve IaC misconfigurations:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a misconfiguration to view details.<br>3. Navigate to the file using the Html URL.<br>4. Remediate the IaC template using the instructions provided.  Note: Refer to the specific Rule ID to research and understand how to remediate the finding.<br>5. Check-in the remediated IaC template.<br>6. Review scan results for the repository to verify the IaC misconfiguration no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Security configuration issues have been detected in the Infrastructure as Code (IaC) within Azure DevOps repositories.<br> These issues, found in template files, can potentially compromise the security posture of related cloud resources.<br> To enhance security, we recommend that you resolve these scanning findings.<br> If left unresolved, these issues could lead to vulnerabilities that may be exploited, compromising the integrity and security of the cloud resources.<br>",
    "displayName": "Azure DevOps repositories should have infrastructure as code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6588c4d4-fbbb-4fb8-be45-7c2de7dc1b3b",
    "implementationEffort": "Moderate",
    "name": "6588c4d4-fbbb-4fb8-be45-7c2de7dc1b3b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve IaC misconfigurations:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a misconfiguration to view details.<br>3. Navigate to the file using the Html URL.<br>4. Remediate the IaC template using the instructions provided.  Note: Refer to the specific Rule ID to research and understand how to remediate the finding.<br>5. Check-in the remediated IaC template.<br>6. Review scan results for the repository to verify the IaC misconfiguration no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of vulnerabilities in GitHub code repositories can pose a significant security risk.<br>\nThese vulnerabilities should be resolved to enhance the security posture of the repositories.<br>\nIf left unaddressed, these vulnerabilities could be exploited by malicious actors, leading to potential data breaches or system compromises.<br>\nTherefore, it is crucial to perform code scanning and remediate any findings to ensure the security of the repositories.<br>",
    "displayName": "GitHub repositories should have code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/18aa4e75-776a-4296-97f0-fe1cf10d679c",
    "implementationEffort": "Moderate",
    "name": "18aa4e75-776a-4296-97f0-fe1cf10d679c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve code findings:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the code file using the Html URL.<br>4. Remediate the finding from the finding description.<br>5. Check-in the remediated code file.<br>6. Review scan results for the repository to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Azure DevOps repositories contain vulnerabilities which can be exploited by attackers to compromise the system or gain unauthorized access.<br>To reduce the risk of security breaches and enhance the security posture, resolve these code scanning findings.<br>",
    "displayName": "Azure DevOps repositories should have code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/99232bb2-9b21-4bbb-8e3c-763673b9923d",
    "implementationEffort": "Moderate",
    "name": "99232bb2-9b21-4bbb-8e3c-763673b9923d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve code findings:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the code file using the Html URL.<br>4. Remediate the finding from the finding description.<br>5. Check-in the remediated code file.<br>6. Review scan results for the repository to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of secrets in GitHub repositories poses a significant security risk as they can be leaked or discovered by threat actors, leading to potential compromise of an application or service.<br> The Microsoft Security DevOps credential scanning tool for Azure DevOps only scans builds it's configured to run on, so the complete status of secrets in your repositories may not be fully reflected.<br> Immediate remediation is necessary to prevent a security breach.<br> Resolving secret scanning findings is crucial to maintain the integrity and security of your repositories.<br>",
    "displayName": "GitHub repositories should have secrets scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dd98425c-1407-40cc-8a2c-da5d0a2f80da",
    "implementationEffort": "Moderate",
    "name": "dd98425c-1407-40cc-8a2c-da5d0a2f80da",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve discovered secrets:<br>1. Review the secret found by the scan.<br>2. Select a finding to view details.<br>3. Invalidate the secret, tokens, and/or passwords.<br>4. Navigate to the repository using the Html URL or Build URL.<br>5. Refactor your code to remove the secret.<br>6. Check-in the remediated project.<br>7. Review scan results for the repository to verify the secret no longer exists.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of secrets in Azure DevOps repositories poses a significant security risk.<br> If these secrets are leaked or discovered by threat actors, it could lead to a compromise of the application or service.<br> The Microsoft Security DevOps credential scanning tool can help identify these secrets, but it only scans builds where it has been configured to run.<br> Therefore, it's crucial to resolve secret scanning findings to ensure the complete security of your repositories.<br>",
    "displayName": "Azure DevOps repositories should have secrets scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b5ef903f-8655-473b-9784-4f749eeb25c6",
    "implementationEffort": "Moderate",
    "name": "b5ef903f-8655-473b-9784-4f749eeb25c6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve discovered secrets:<br>1. Review the secret found by the scan.<br>2. Select a finding to view details.<br>3. Invalidate the secret, tokens, and/or passwords.<br>4. Navigate to the repository using the Html URL or Build URL.<br>5. Refactor your code to remove the secret.<br>6. Check-in the remediated project.<br>7. Review scan results for the repository to verify the secret no longer exists.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Dependency vulnerabilities in GitHub repositories pose a significant security risk.<br>\nThese vulnerabilities can be exploited by attackers to compromise the code, potentially leading to unauthorized access or data breaches.<br>\nResolving these findings through remediation strategies such as patching or updating the dependencies can significantly improve the security posture of the repositories.<br>\nFailure to do so may leave the repositories and the code they contain susceptible to attacks.<br>",
    "displayName": "GitHub repositories should have dependency vulnerability scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/945f7b1c-8def-4ab3-a44d-1416060104b3",
    "implementationEffort": "Moderate",
    "name": "945f7b1c-8def-4ab3-a44d-1416060104b3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the repository with the Html URL.<br>4. Remediate the vulnerability using the instructions provided.<br>5. Check-in the remediated project.<br>6. Review scan results for the repository to verify the vulnerability no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Azure DevOps repositories contain vulnerabilities which can be exploited by attackers to compromise the system or gain unauthorized access.<br>To reduce the risk of security breaches and enhance the security posture, resolve these code scanning findings.<br>",
    "displayName": "Azure Devops repositories should have dependency vulnerability scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2ea72208-8558-4011-8dcd-d93375a4003d",
    "implementationEffort": "Moderate",
    "name": "2ea72208-8558-4011-8dcd-d93375a4003d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the repository with the Html URL.<br>4. Remediate the vulnerability using the instructions provided.<br>5. Check-in the remediated project.<br>6. Review scan results for the repository to verify the vulnerability no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure DevOps security posture management findings are crucial for maintaining the security of your Azure DevOps (ADO) artifacts.<br> These artifacts include various organization/project settings, build/release configurations, service connections, agent pools, and more.<br> If these findings are not resolved, your ADO artifacts may be configured insecurely, potentially leading to vulnerabilities and breaches.<br>",
    "displayName": "Azure DevOps security posture management findings should be resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7b123b34-1f78-4902-abb6-3b813abe9866",
    "implementationEffort": "Low",
    "name": "7b123b34-1f78-4902-abb6-3b813abe9866",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/06/2023"
    },
    "remediationDescription": "The security posture checks found can lead to compliance violations and data breaches. It is recommended to improve the security posture by remediating and fixing these configuration findings to reduce the likelihood of a successful attack.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Initial Access",
      "Reconnaissance",
      "Exfiltration",
      "Impact",
      "Collection",
      "Credential Access"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Application Layer Protocol",
      "Compromise Infrastructure",
      "Exploitation for Client Execution",
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for DevOps security posture management checks are designed to ensure the secure configuration of GitHub artifacts, including repo settings, branch settings, alert configurations, and self-hosted runners.<br> If these findings are not resolved, it could lead to potential security vulnerabilities, such as unauthorized access or changes to your repositories.<br> Therefore, it's crucial to address these findings to maintain a secure GitHub environment.<br>",
    "displayName": "GitHub security posture management findings should be resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fd104c01-29d0-428d-bb62-2c936addd2cf",
    "implementationEffort": "Low",
    "name": "fd104c01-29d0-428d-bb62-2c936addd2cf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/06/2023"
    },
    "remediationDescription": "The security posture checks found can lead to compliance violations and data breaches. It is recommended to improve the security posture by remediating and fixing these configuration findings to reduce the likelihood of a successful attack.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Initial Access",
      "Reconnaissance",
      "Exfiltration",
      "Impact",
      "Collection",
      "Credential Access"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Application Layer Protocol",
      "Compromise Infrastructure",
      "Exploitation for Client Execution",
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The security configuration issues detected in the GitHub repositories' infrastructure as code (IaC) templates need to be resolved.<br> These issues can potentially compromise the security posture of the related cloud resources.<br> If left unaddressed, they could lead to vulnerabilities in the infrastructure, making it susceptible to attacks.<br> Therefore, it's crucial to remediate these issues to enhance the overall security of the cloud resources.<br>",
    "displayName": "GitHub repositories should have infrastructure as code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bce87bba-1391-4f02-8bff-d1a3a56656d4",
    "implementationEffort": "Moderate",
    "name": "bce87bba-1391-4f02-8bff-d1a3a56656d4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "To resolve IaC misconfigurations:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a misconfiguration to view details.<br>3. Navigate to the file using the Html URL.<br>4. Remediate the IaC template using the instructions provided.  Note: Refer to the specific Rule ID to research and understand how to remediate the finding.<br>5. Check-in the remediated IaC template.<br>6. Review scan results for the repository to verify the IaC misconfiguration no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Security configuration issues have been detected in the Infrastructure as Code (IaC) within Azure DevOps repositories.<br> These issues, found in template files, can potentially compromise the security posture of related cloud resources.<br> To enhance security, we recommend that you resolve these scanning findings.<br> If left unresolved, these issues could lead to vulnerabilities that may be exploited, compromising the integrity and security of the cloud resources.<br>",
    "displayName": "Azure DevOps repositories should have infrastructure as code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6099b0e4-57cd-488f-82bc-89e602d9a60e",
    "implementationEffort": "Moderate",
    "name": "6099b0e4-57cd-488f-82bc-89e602d9a60e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "To resolve IaC misconfigurations:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a misconfiguration to view details.<br>3. Navigate to the file using the Html URL.<br>4. Remediate the IaC template using the instructions provided.  Note: Refer to the specific Rule ID to research and understand how to remediate the finding.<br>5. Check-in the remediated IaC template.<br>6. Review scan results for the repository to verify the IaC misconfiguration no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of vulnerabilities in GitHub code repositories can pose a significant security risk.<br>\nThese vulnerabilities should be resolved to enhance the security posture of the repositories.<br>\nIf left unaddressed, these vulnerabilities could be exploited by malicious actors, leading to potential data breaches or system compromises.<br>\nTherefore, it is crucial to perform code scanning and remediate any findings to ensure the security of the repositories.<br>",
    "displayName": "GitHub repositories should have code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9d4a000c-168d-4289-abd9-3442b366bfcc",
    "implementationEffort": "Moderate",
    "name": "9d4a000c-168d-4289-abd9-3442b366bfcc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "To resolve code findings:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the code file using the Html URL.<br>4. Remediate the finding from the finding description.<br>5. Check-in the remediated code file.<br>6. Review scan results for the repository to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The Azure DevOps repositories contain vulnerabilities which can be exploited by attackers to compromise the system or gain unauthorized access.<br>To reduce the risk of security breaches and enhance the security posture, resolve these code scanning findings.<br><br>",
    "displayName": "Azure DevOps repositories should have code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ce11800c-9185-48dd-9df2-63605e65d797",
    "implementationEffort": "Moderate",
    "name": "ce11800c-9185-48dd-9df2-63605e65d797",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "To resolve code findings:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the code file using the Html URL.<br>4. Remediate the finding from the finding description.<br>5. Check-in the remediated code file.<br>6. Review scan results for the repository to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of secrets in GitHub repositories poses a significant security risk as they can be leaked or discovered by threat actors, leading to potential compromise of an application or service.<br> The Microsoft Security DevOps credential scanning tool for Azure DevOps only scans builds it's configured to run on, so the complete status of secrets in your repositories may not be fully reflected.<br> Immediate remediation is necessary to prevent a security breach.<br> Resolving secret scanning findings is crucial to maintain the integrity and security of your repositories.<br>",
    "displayName": "GitHub repositories should have secrets scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a6b0a56e-8f6c-4d0c-beb0-09dbe4910f41",
    "implementationEffort": "Moderate",
    "name": "a6b0a56e-8f6c-4d0c-beb0-09dbe4910f41",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "To resolve discovered secrets:<br>1. Review the secret found by the scan.<br>2. Select a finding to view details.<br>3. Invalidate the secret, tokens, and/or passwords.<br>4. Navigate to the repository using the Html URL or Build URL.<br>5. Refactor your code to remove the secret.<br>6. Check-in the remediated project.<br>7. Review scan results for the repository to verify the secret no longer exists.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of secrets in Azure DevOps repositories poses a significant security risk.<br> If these secrets are leaked or discovered by threat actors, it could lead to a compromise of the application or service.<br> The Microsoft Security DevOps credential scanning tool can help identify these secrets, but it only scans builds where it has been configured to run.<br> Therefore, it's crucial to resolve secret scanning findings to ensure the complete security of your repositories.<br>",
    "displayName": "Azure DevOps repositories should have secrets scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bf5679fb-c586-4a3b-bb42-215d59de2086",
    "implementationEffort": "Moderate",
    "name": "bf5679fb-c586-4a3b-bb42-215d59de2086",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "To resolve discovered secrets:<br>1. Review the secret found by the scan.<br>2. Select a finding to view details.<br>3. Invalidate the secret, tokens, and/or passwords.<br>4. Navigate to the repository using the Html URL or Build URL.<br>5. Refactor your code to remove the secret.<br>6. Check-in the remediated project.<br>7. Review scan results for the repository to verify the secret no longer exists.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Dependency vulnerabilities have been found in code repositories. To improve the security posture of the repositories, we recommend remediating these vulnerabilities.",
    "displayName": "GitHub repositories should have dependency vulnerability scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/eb5774a5-b116-45f8-9a56-e4627f130b16",
    "implementationEffort": "Moderate",
    "name": "eb5774a5-b116-45f8-9a56-e4627f130b16",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the repository with the Html URL.<br>4. Remediate the vulnerability using the instructions provided.<br>5. Check-in the remediated project.<br>6. Review scan results for the repository to verify the vulnerability no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure DevOps security posture management findings are crucial for maintaining the security of your Azure DevOps (ADO) artifacts.<br> These artifacts include various organization/project settings, build/release configurations, service connections, agent pools, and more.<br> If these findings are not resolved, your ADO artifacts may be configured insecurely, potentially leading to vulnerabilities and breaches.<br>",
    "displayName": "Azure DevOps security posture management findings should be resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/afccd1cd-4134-4969-8eda-170af45c1b2b",
    "implementationEffort": "Low",
    "name": "afccd1cd-4134-4969-8eda-170af45c1b2b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "The security posture checks found can lead to compliance violations and data breaches. It is recommended to improve the security posture by remediating and fixing these configuration findings to reduce the likelihood of a successful attack.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Initial Access",
      "Reconnaissance",
      "Exfiltration",
      "Impact",
      "Collection",
      "Credential Access"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Application Layer Protocol",
      "Compromise Infrastructure",
      "Exploitation for Client Execution",
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for DevOps security posture management checks are designed to ensure the secure configuration of GitHub artifacts, including repo settings, branch settings, alert configurations, and self-hosted runners.<br> If these findings are not resolved, it could lead to potential security vulnerabilities, such as unauthorized access or changes to your repositories.<br> Therefore, it's crucial to address these findings to maintain a secure GitHub environment.<br>",
    "displayName": "GitHub security posture management findings should be resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b68917c4-1d30-48f3-91e1-061a93324f1f",
    "implementationEffort": "Low",
    "name": "b68917c4-1d30-48f3-91e1-061a93324f1f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "The security posture checks found can lead to compliance violations and data breaches. It is recommended to improve the security posture by remediating and fixing these configuration findings to reduce the likelihood of a successful attack.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Initial Access",
      "Reconnaissance",
      "Exfiltration",
      "Impact",
      "Collection",
      "Credential Access"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Application Layer Protocol",
      "Compromise Infrastructure",
      "Exploitation for Client Execution",
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Security configuration issues have been detected in the infrastructure as code (IaC) within your repositories.<br> These issues, found in template files, can potentially compromise the security posture of your cloud resources.<br> To mitigate this risk, we recommend resolving these findings.<br> If left unresolved, these issues could lead to vulnerabilities in your infrastructure, making it susceptible to attacks.<br>",
    "displayName": "Code repositories should have infrastructure as code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2ebc815f-7bc7-4573-994d-e1cc46fb4a35",
    "implementationEffort": "Moderate",
    "name": "2ebc815f-7bc7-4573-994d-e1cc46fb4a35",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/19/2022"
    },
    "remediationDescription": "To resolve IaC misconfigurations:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a misconfiguration to view details.<br>3. Navigate to the file using the Html URL.<br>4. Remediate the IaC template using the instructions provided.  Note: Refer to the specific Rule ID to research and understand how to remediate the finding.<br>5. Check-in the remediated IaC template.<br>6. Review scan results for the repository to verify the IaC misconfiguration no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of vulnerabilities in code repositories can pose a significant security risk.<br>\nThese vulnerabilities can be exploited by malicious actors to compromise the integrity and security of the codebase.<br>\nTo mitigate this risk, we recommend that you resolve these code scanning findings.<br>\nFailure to do so could lead to potential breaches, data loss, or system compromise.<br>",
    "displayName": "Code repositories should have code scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c68a8c2a-6ed4-454b-9e37-4b7654f2165f",
    "implementationEffort": "Moderate",
    "name": "c68a8c2a-6ed4-454b-9e37-4b7654f2165f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/19/2022"
    },
    "remediationDescription": "To resolve code findings:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the code file using the Html URL.<br>4. Remediate the finding from the finding description.<br>5. Check-in the remediated code file.<br>6. Review scan results for the repository to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The presence of secrets in code repositories poses a significant security risk.<br> If these secrets are leaked or discovered by threat actors, it could lead to the compromise of an application or service.<br> The Microsoft Security DevOps credential scanning tool for Azure DevOps only scans builds it's configured to run on, so the current status may not reflect the complete status of secrets in your repositories.<br> It's crucial to resolve secret scanning findings promptly to prevent potential security breaches.<br>",
    "displayName": "Code repositories should have secrets scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27",
    "implementationEffort": "Moderate",
    "name": "4e07c7d0-e06c-47d7-a4a9-8c7b748d1b27",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/19/2022"
    },
    "remediationDescription": "To resolve discovered secrets:<br>1. Review the secret found by the scan.<br>2. Select a finding to view details.<br>3. Invalidate the secret, tokens, and/or passwords.<br>4. Navigate to the repository using the Html URL or Build URL.<br>5. Refactor your code to remove the secret.<br>6. Check-in the remediated project.<br>7. Review scan results for the repository to verify the secret no longer exists.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Dependency vulnerabilities in code repositories pose a significant security risk.<br>\nThese vulnerabilities can be exploited by attackers to compromise the system or gain unauthorized access.<br>\nResolving these findings through vulnerability scanning is crucial to improve the security posture of the repositories.<br>\nIf left unresolved, these vulnerabilities could lead to potential breaches and system compromises.<br>",
    "displayName": "Code repositories should have dependency vulnerability scanning findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/822425e3-827f-4f35-bc33-33749257f851",
    "implementationEffort": "Moderate",
    "name": "822425e3-827f-4f35-bc33-33749257f851",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/19/2022"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the failed security checks found by the scan, which are sorted from high to low risk.<br>2. Select a finding to view details.<br>3. Navigate to the repository with the Html URL.<br>4. Remediate the vulnerability using the instructions provided.<br>5. Check-in the remediated project.<br>6. Review scan results for the repository to verify the vulnerability no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure DevOps security posture management findings are crucial for maintaining the security of your Azure DevOps (ADO) artifacts.<br> These artifacts include various organization/project settings, build/release configurations, service connections, agent pools, and more.<br> If these findings are not resolved, your ADO artifacts may be configured insecurely, potentially leading to vulnerabilities and breaches.<br>",
    "displayName": "Azure DevOps security posture management findings should be resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9dbf49ec-ce06-476d-ab70-7bd612c4a52c",
    "implementationEffort": "Low",
    "name": "9dbf49ec-ce06-476d-ab70-7bd612c4a52c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "02/06/2023",
      "public": "10/01/2022"
    },
    "remediationDescription": "The security posture checks found can lead to compliance violations and data breaches. It is recommended to improve the security posture by remediating and fixing these configuration findings to reduce the likelihood of a successful attack.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Initial Access",
      "Reconnaissance",
      "Exfiltration",
      "Impact",
      "Collection",
      "Credential Access"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Application Layer Protocol",
      "Compromise Infrastructure",
      "Exploitation for Client Execution",
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for DevOps security posture management checks are designed to ensure the secure configuration of GitHub artifacts, including repo settings, branch settings, alert configurations, and self-hosted runners.<br> If these findings are not resolved, it could lead to potential security vulnerabilities, such as unauthorized access or changes to your repositories.<br> Therefore, it's crucial to address these findings to maintain a secure GitHub environment.<br>",
    "displayName": "GitHub security posture management findings should be resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3178ab5f-ee29-48a9-a886-e30aa6adf44f",
    "implementationEffort": "Low",
    "name": "3178ab5f-ee29-48a9-a886-e30aa6adf44f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/14/2023"
    },
    "remediationDescription": "The security posture checks found can lead to compliance violations and data breaches. It is recommended to improve the security posture by remediating and fixing these configuration findings to reduce the likelihood of a successful attack.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Initial Access",
      "Reconnaissance",
      "Exfiltration",
      "Impact",
      "Collection",
      "Credential Access"
    ],
    "techniques": [
      "Abuse Elevation Control Mechanism",
      "Application Layer Protocol",
      "Compromise Infrastructure",
      "Exploitation for Client Execution",
      "Exploitation for Credential Access"
    ],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Scanning your AWS registry container images for security vulnerabilities using tools like Trivy can significantly enhance your containers' security posture.<br> Detailed findings for each image can expose potential threats.<br> If these vulnerabilities are not resolved, your containers could be susceptible to attacks, compromising the security of your system.<br> Therefore, it is crucial to address these vulnerabilities promptly to protect your containers.<br>",
    "displayName": "[Deprecated] AWS registry container images should have vulnerabilities resolved (powered by Trivy)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/03587042-5d4b-44ff-af42-ae99e3c71c87",
    "implementationEffort": "Moderate",
    "name": "03587042-5d4b-44ff-af42-ae99e3c71c87",
    "partnerData": null,
    "plannedDeprecationDate": "02/2024",
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": "23/06/2022",
      "public": "23/06/2022"
    },
    "remediationDescription": "To resolve container image vulnerabilities:<br>1. Navigate to the relevant resource under the 'Unhealthy' section and select the container image you are looking to remediate.<br>2. Review the set of failed security checks found by the scan, which are sorted from high to low risk.<br>3. Select a vulnerability to view its details and explicit remediation instructions and scripts.<br>4. Remediate the vulnerability using the provided instructions described in the 'Remediation' field.<br>5. Upload the new remediated image to your registry. Review scan results for the new image to verify the vulnerability no longer exists.<br>6. Delete the old image with the vulnerability from your registry.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Resolving vulnerability findings on virtual machines is a recommended step in maintaining a secure environment.<br>\nThese findings, identified by vulnerability assessment solutions, highlight potential weaknesses that could be exploited by malicious actors.<br>\nIf these vulnerabilities are not addressed, they could lead to unauthorized access, data breaches, or even system failure.<br>\nTherefore, it is important to resolve these findings promptly to ensure the security and integrity of the virtual machines.<br>",
    "displayName": "Machines should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1195afff-c881-495e-9bc5-1486211ae03f",
    "implementationEffort": "Low",
    "name": "1195afff-c881-495e-9bc5-1486211ae03f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review and remediate vulnerabilities discovered by the vulnerability assessment solutions.",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Resolving vulnerability findings on virtual machine scale sets is a recommended step in maintaining a secure environment.<br>These findings, identified by vulnerability assessment solutions, highlight potential weaknesses that could be exploited by malicious actors.<br>If these vulnerabilities are not addressed, they could lead to unauthorized access, data breaches, or even system failure.<br>Therefore, it is important to resolve these findings promptly to ensure the security and integrity of the virtual machine scale sets.<br>",
    "displayName": "AKS nodes should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/24a15fbd-cfe4-4dff-b2be-1c367a6b2031",
    "implementationEffort": "Low",
    "name": "24a15fbd-cfe4-4dff-b2be-1c367a6b2031",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/501541f7-f7e7-4cd6-868c-4190fdad3ac9",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/01/2024"
    },
    "remediationDescription": "To remediate vulnerabilities found in the AKS hosts, upgrade the version of the related node pool to the latest version in Kubernetes Service. In case vulnerabilities are still found, we suggest to upgrade the Kubernetes cluster version as well.<br>As best practice ensure \"Node security channel\" and \"Automatic upgrade\" configurations are enabled. <a href='https://learn.microsoft.com/en-us/azure/aks/auto-upgrade-node-os-image'>Learn more</a>.",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Resolving vulnerability findings on AWS auto scaling groups is a recommended step in maintaining a secure environment.<br>These findings, identified by vulnerability assessment solutions, highlight potential weaknesses that could be exploited by malicious actors.<br>If these vulnerabilities are not addressed, they could lead to unauthorized access, data breaches, or even system failure.<br>Therefore, it is important to resolve these findings promptly to ensure the security and integrity of the AWS auto scaling groups.<br>",
    "displayName": "EKS nodes should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e192feb4-9796-4a41-9674-f2107edc68db",
    "implementationEffort": "Low",
    "name": "e192feb4-9796-4a41-9674-f2107edc68db",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/01/2024"
    },
    "remediationDescription": "Review and remediate vulnerabilities discovered by the vulnerability assessment solutions.",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Addressing the findings from vulnerability assessments on EC2 instances is crucial for maintaining a secure cloud environment.<br> These assessments identify potential weaknesses that could be exploited by malicious actors.<br> If these vulnerabilities are not resolved, the EC2 instances could be compromised, leading to potential data breaches or system disruptions.<br> To ensure the security of your EC2 instances, resolve the vulnerability findings.<br>",
    "displayName": "EC2 instances should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/77a4a140-e051-481a-84cc-d4bf2109bd65",
    "implementationEffort": "Low",
    "name": "77a4a140-e051-481a-84cc-d4bf2109bd65",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "08/14/2022"
    },
    "remediationDescription": "Review and remediate vulnerabilities discovered by the vulnerability assessment solutions.",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image. Remediating vulnerabilities in container images helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards.",
    "displayName": "[Preview] Container images in Docker Hub registry should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f064651f-2459-47f2-9731-0c5a782891d3",
    "implementationEffort": "Moderate",
    "name": "f064651f-2459-47f2-9731-0c5a782891d3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/07/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities:<br>1. Review the set of known vulnerabilities found by their severity.<br>2. Select a vulnerability to view its details and explicit remediation instructions.<br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field.<br>4. If a new image was created, upload the new remediated image to your registry.<br>5. Delete the old image with the vulnerabilities from your registry.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image. Remediating vulnerabilities in container images helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards.",
    "displayName": "[Preview] Container images in JFrog Artifactory registry should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/942c9df8-97d1-4db9-8428-5372b9655110",
    "implementationEffort": "Moderate",
    "name": "942c9df8-97d1-4db9-8428-5372b9655110",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "29/10/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities:<br>1. Review the set of known vulnerabilities found by their severity.<br>2. Select a vulnerability to view its details and explicit remediation instructions.<br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field.<br>4. If a new image was created, upload the new remediated image to your registry.<br>5. Delete the old image with the vulnerabilities from your registry.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Addressing the findings from vulnerability assessments on Google Cloud Platform (GCP) compute instances is important for maintaining a secure environment.<br> These assessments identify potential weaknesses that could be exploited by malicious actors.<br> If these vulnerabilities are not resolved, the compute instances could be compromised, leading to potential data breaches or system disruptions.<br> Therefore, it is crucial to resolve any identified vulnerability findings promptly.<br>",
    "displayName": "GCP compute instances should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0a03fa35-e381-4e2f-ace6-2b9913db3381",
    "implementationEffort": "Low",
    "name": "0a03fa35-e381-4e2f-ace6-2b9913db3381",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/15/2023"
    },
    "remediationDescription": "Review and remediate vulnerabilities discovered by the vulnerability assessment solutions.",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "It's important to address the findings from the vulnerability assessment solutions on servers that are onboarded with Microsoft Defender for Endpoint (MDE).<br>\nThese findings could indicate potential security weaknesses that could be exploited by malicious actors.<br>\nIf these vulnerabilities are not resolved, it could lead to unauthorized access, data breaches, or other security incidents.<br>\nTherefore, it's crucial to resolve these findings to maintain the security and integrity of the servers.<br>",
    "displayName": "Servers onboarded with MDE should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/44d12760-2cf2-4e6d-8613-8451c11c1abc",
    "implementationEffort": "Low",
    "name": "44d12760-2cf2-4e6d-8613-8451c11c1abc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/01/2023"
    },
    "remediationDescription": "Review and remediate vulnerabilities discovered by the vulnerability assessment solutions.",
    "severity": "Low",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Resolving secrets findings on virtual machines is a critical security measure.<br>\nSecret scanning solutions identify sensitive data such as passwords, API keys, or tokens that may be exposed.<br>\nIf these findings are not addressed, it could lead to unauthorized access or misuse of sensitive data.<br>\nTherefore, it is important to resolve these findings to protect the virtual machines from potential security threats.<br>",
    "displayName": "Machines should have secrets findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/17618b1a-ed14-49bb-b37f-9f8ba967be8b",
    "implementationEffort": "Moderate",
    "name": "17618b1a-ed14-49bb-b37f-9f8ba967be8b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/3ac7c827-eea2-4bde-acc7-9568cd320efa",
    "preview": null,
    "publishDates": {
      "ga": "26/11/2023",
      "public": "01/01/2023"
    },
    "remediationDescription": "Review and remediate secrets discovered by the secrets scanning engine.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Credential Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Valid Accounts",
      "Exploitation for Credential Access",
      "Exploitation of Remote Services"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Resolving secrets findings on EC2 instances is a critical security measure.<br> Secret scanning solutions identify sensitive data such as passwords or API keys that may be exposed.<br> If these findings are not addressed, it could lead to unauthorized access or data breaches.<br> Therefore, it is important to resolve these findings to maintain the security of your EC2 instances.<br>",
    "displayName": "EC2 instances should have secrets findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/490d3be5-0abd-485c-bcd7-b8d6c6f443c8",
    "implementationEffort": "Moderate",
    "name": "490d3be5-0abd-485c-bcd7-b8d6c6f443c8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "26/11/2023",
      "public": "01/01/2023"
    },
    "remediationDescription": "Review and remediate secrets discovered by the secrets scanning engine.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Credential Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Valid Accounts",
      "Exploitation for Credential Access",
      "Exploitation of Remote Services"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Resolving secrets findings on VM instances is a critical security measure.<br> Secret scanning solutions identify sensitive data that should not be exposed, such as API keys, passwords, and tokens.<br> If these findings are not addressed, it could lead to unauthorized access or misuse of sensitive data.<br> Therefore, it's important to resolve these findings to protect the VM instances from potential security threats.<br>",
    "displayName": "VM instances should have secrets findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/17b615fd-ce09-494b-a3fa-5937a137a571",
    "implementationEffort": "Moderate",
    "name": "17b615fd-ce09-494b-a3fa-5937a137a571",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "26/11/2023",
      "public": "01/01/2023"
    },
    "remediationDescription": "Review and remediate secrets discovered by the secrets scanning engine.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Credential Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Valid Accounts",
      "Exploitation for Credential Access",
      "Exploitation of Remote Services"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Secrets have been found in Azure Resource Manager deployments. This should be remediated immediately to prevent a security breach. Secrets found in deployments can be leaked or discovered by threat actors, leading to compromise of an application or service.",
    "displayName": "Azure Resource Manager deployments should have secrets findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/774dd8dd-234d-4581-8dcc-376a53e58a5d",
    "implementationEffort": "Moderate",
    "name": "774dd8dd-234d-4581-8dcc-376a53e58a5d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/01/2024"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the secrets found by the scan.<br>2. Select a finding to view its details.<br>3. Invalidate the secrets, tokens, and/or passwords.<br>4. Go to the Azure portal and delete the deployment. <a href='https://learn.microsoft.com/azure/azure-resource-manager/templates/deployment-history-deletions'>Learn more</a>.<br>5. For future deployments of the same template, modify the template so it will not expose the secrets. If a secret is a deployment parameter, set the parameter type to 'securestring'.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Credential Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Valid Accounts",
      "Exploitation for Credential Access",
      "Exploitation of Remote Services"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Secrets have been found in AWS CloudFormation stack deployments. This should be remediated immediately to prevent a security breach. Secrets found in deployments can be leaked or discovered by threat actors, leading to compromise of an application or service.",
    "displayName": "AWS CloudFormation stack should have secrets findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ca27f299-894b-4503-8656-3b620649c343",
    "implementationEffort": "Moderate",
    "name": "ca27f299-894b-4503-8656-3b620649c343",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/01/2024"
    },
    "remediationDescription": "To resolve vulnerabilities:<br>1. Review the secrets found by the scan.<br>2. Select a finding to view details.<br>3. Invalidate the secrets, tokens, and/or passwords.<br>4. Go to AWS console and remove the secrets by modifying the stack, <a href='https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-direct.html'>Learn more</a>.<br>5. If the secret is a parameter, make sure the parameter metadata is configured with 'NoEcho', <a href='https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-updating-stacks-direct.html'>Learn more</a>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Credential Access",
      "Lateral Movement"
    ],
    "techniques": [
      "Valid Accounts",
      "Exploitation for Credential Access",
      "Exploitation of Remote Services"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The SQL Vulnerability Assessment scanner identifies security vulnerabilities in databases. These vulnerabilitiess include misconfigurations, excessive permissions, and unprotected sensitive data.<br> If these vulnerabilities are not addressed, they could potentially be exploited, leading to unauthorized access or data breaches.<br>",
    "displayName": "SQL databases should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/82e20e14-edc5-4373-bfc4-f13121257c37",
    "implementationEffort": "Moderate",
    "name": "82e20e14-edc5-4373-bfc4-f13121257c37",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/feedbf84-6b99-488c-acc2-71c829aa5ffc",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To remediate SQL vulnerabilities and mitigate risks:<br>1. Navigate to a database in the Unhealthy databases list.<br>2. Review the set of Failed security checks found by the scan, which are sorted from high to low risk.<br>3. Select a vulnerability to view its details and explicit remediation instructions and scripts<br>4. Either remediate the vulnerability using the provided script, or set the result as an acceptable baseline for the check so that it will be considered passing in subsequent scans.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation",
      "Persistence",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Privilege Escalation",
      "Valid Accounts",
      "Modify Registry",
      "Server Software Component"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "SQL servers on machines should undergo vulnerability assessments to identify any security weaknesses, such as misconfigurations, excessive permissions, and unprotected sensitive data.<br> These assessments help to ensure adherence to best practices and improve the overall security posture of the database.<br> If these vulnerabilities are not resolved, the database could be at risk of unauthorized access or data breaches.<br> Therefore, it's crucial to address these findings promptly to maintain a secure environment.<br>",
    "displayName": "SQL servers on machines should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f97aa83c-9b63-4f9a-99f6-b22c4398f936",
    "implementationEffort": "Moderate",
    "name": "f97aa83c-9b63-4f9a-99f6-b22c4398f936",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/microsoft.authorization/policydefinitions/6ba6d016-e7c3-4842-b8f2-4992ebc0d72d",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To remediate SQL vulnerabilities and mitigate risks:<br>1. Navigate to a database in the Unhealthy databases list.<br>2. Review the set of Failed security checks found by the scan, which are sorted from high to low risk.<br>3. Select a vulnerability to view its details and explicit remediation instructions and scripts<br>4. Either remediate the vulnerability using the provided script, or set the result as an acceptable baseline for the check so that it will be considered passing in subsequent scans.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Privilege Escalation",
      "Persistence",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Privilege Escalation",
      "Valid Accounts",
      "Modify Registry",
      "Server Software Component"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Addressing vulnerabilities in the security configuration of Windows machines is important to safeguard them from potential attacks.<br> These vulnerabilities, if left unattended, could be exploited by attackers to gain unauthorized access or disrupt system operations.<br> Remediation, powered by Guest Configuration, helps to ensure the security and integrity of the system, thereby reducing the risk of compromise.<br>",
    "displayName": "Vulnerabilities in security configuration on your Windows machines should be remediated (powered by Guest Configuration)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8c3d9ad0-3639-4686-9cd2-2b2ab2609bda",
    "implementationEffort": "Moderate",
    "name": "8c3d9ad0-3639-4686-9cd2-2b2ab2609bda",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/72650e9f-97bc-4b2a-ab5f-9781a9fcecbc",
    "preview": null,
    "publishDates": {
      "ga": "09/01/2024",
      "public": "06/01/2021"
    },
    "remediationDescription": "1. Select any of the findings below.<br>2. On the right pane opened, follow the instructions under 'Remediation' if exist.",
    "severity": "Low",
    "tactics": [
      "Credential Access",
      "Defense Evasion",
      "Lateral Movement",
      "Execution",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Exploitation for Defense Evasion",
      "Exploitation of Remote Services",
      "Exploitation for Client Execution",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Remediate vulnerabilities in security configuration on your Linux machines to protect them from attacks.",
    "displayName": "Vulnerabilities in security configuration on your Linux machines should be remediated (powered by Guest Configuration)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1f655fb7-63ca-4980-91a3-56dbc2b715c6",
    "implementationEffort": "Moderate",
    "name": "1f655fb7-63ca-4980-91a3-56dbc2b715c6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/fc9b3da7-8347-4380-8e70-0a0361d8dedd",
    "preview": null,
    "publishDates": {
      "ga": "09/01/2024",
      "public": "06/01/2021"
    },
    "remediationDescription": "1. Select any of the findings below.<br>2. On the right pane opened, follow the instructions under 'Remediation' if exist.",
    "severity": "Low",
    "tactics": [
      "Credential Access",
      "Defense Evasion",
      "Lateral Movement",
      "Execution",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Exploitation for Defense Evasion",
      "Exploitation of Remote Services",
      "Exploitation for Client Execution",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "It's important to keep your machines updated by installing any missing security and critical OS updates.<br> These updates often contain crucial patches for security vulnerabilities, which, if left unpatched, can be exploited by threat actors.<br> Therefore, to secure your machines and prevent potential breaches,follow the remediation steps and install all outstanding patches provided by Azure Update Manager.<br>",
    "displayName": "System updates should be installed on your machines (powered by Azure Update Manager)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e1145ab1-eb4f-43d8-911b-36ddf771d13f",
    "implementationEffort": "Low",
    "name": "e1145ab1-eb4f-43d8-911b-36ddf771d13f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f85bf3e0-d513-442e-89c3-1784ad63382b",
    "preview": null,
    "publishDates": {
      "ga": "04/20/2023",
      "public": "06/01/2021"
    },
    "remediationDescription": "To install missing system updates on a selected machine: 1. From \"Affected resources\", select a virtual machine. 2. Select the \"Fix\" button. This will redirect you to Azure Update Manager. 3. Follow the instructions on Azure Update Manager portal to complete the process.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "All OS boot components on Linux machines, including the boot loader, kernel, and kernel drivers, should be signed by trusted publishers.<br> This is to protect the machines from potentially harmful components.<br> If untrusted components are identified, they should either be added to an allow list or removed.<br> If this is not done, the system could be exposed to malicious components, compromising the security and integrity of the Linux virtual machines.<br>",
    "displayName": "Linux virtual machines should use only signed and trusted boot components",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ad50b498-f90c-451f-886f-d0a169cc5002",
    "implementationEffort": "Low",
    "name": "ad50b498-f90c-451f-886f-d0a169cc5002",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/13a6c84f-49a5-410a-b5df-5b880c3fe009",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Investigate the untrusted boot components. If they are legitimate, add them to the allow list. Otherwise, remove them.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ElevationOfPrivilege",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Accounts with read permissions that have been provisioned outside of the Azure Active Directory tenant (different domain names), should be removed from your Azure resources.<br> These guest accounts are not managed to the same standards as enterprise tenant identities.<br> This makes them potential targets for threat actors looking to find ways to access your data without being noticed.<br> By removing these accounts, you can reduce the risk of unauthorized data access and potential breaches.<br>",
    "displayName": "Guest accounts with read permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/fde1c0c9-0fd2-4ecc-87b5-98956cbc1095",
    "implementationEffort": "Low",
    "name": "fde1c0c9-0fd2-4ecc-87b5-98956cbc1095",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e9ac8f8e-ce22-4355-8f04-99b911d6be52",
    "preview": null,
    "publishDates": {
      "ga": "05/01/2023",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review the list of guest accounts that require access removal on the Accounts section. Select an account to view its role definitions and locate source scope. If you accept the risk for a specific account, use the exempt capability to exclude it from evaluation.<br><ol><li>Go to the <strong>Azure portal</strong>.</li><li>Open <strong>Access control (IAM)</strong> at a scope, such as management group, subscription, resource group, or resource, where the guest user has a role assignment.</li><li>Click the <strong>Role assignments</strong> tab to view all the role assignments.</li><li>In the list of role assignments, add a checkmark next to the guest user with the role assignment you want to remove.</li><li>Click <strong>Remove</strong>. In the remove role assignment message that appears, click <strong>Yes</strong>.</li></ol>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Accounts with write permissions that have been provisioned outside of the Azure Active Directory tenant (different domain names), should be removed from your Azure resources.<br> These guest accounts are not managed to the same standards as enterprise tenant identities.<br> This makes them potential targets for threat actors looking to find ways to access your data without being noticed.<br> By removing these accounts, you can reduce the risk of unauthorized data access and potential breaches..<br>",
    "displayName": "Guest accounts with write permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0354476c-a12a-4fcc-a79d-f0ab7ffffdbb",
    "implementationEffort": "Low",
    "name": "0354476c-a12a-4fcc-a79d-f0ab7ffffdbb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/94e1c2ac-cbbe-4cac-a2b5-389c812dee87",
    "preview": null,
    "publishDates": {
      "ga": "05/01/2023",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review the list of guest accounts that require access removal on the Accounts section. Select an account to view its role definitions and locate source scope. If you accept the risk for a specific account, use the exempt capability to exclude it from evaluation.<br><ol><li>Go to the <strong>Azure portal</strong>.</li><li>Open <strong>Access control (IAM)</strong> at a scope, such as management group, subscription, resource group, or resource, where the guest user has a role assignment.</li><li>Click the <strong>Role assignments</strong> tab to view all the role assignments.</li><li>In the list of role assignments, add a checkmark next to the guest user with the role assignment you want to remove.</li><li>Click <strong>Remove</strong>. In the remove role assignment message that appears, click <strong>Yes</strong>.</li></ol>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Accounts with owner permissions that have been provisioned outside of the Azure Active Directory tenant (different domain names), should be removed from your Azure resources.<br> These guest accounts are not managed to the same standards as enterprise tenant identities.<br> This makes them potential targets for threat actors looking to find ways to access your data without being noticed.<br> By removing these accounts, you can reduce the risk of unauthorized data access and potential breaches.<br>",
    "displayName": "Guest accounts with owner permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/20606e75-05c4-48c0-9d97-add6daa2109a",
    "implementationEffort": "Low",
    "name": "20606e75-05c4-48c0-9d97-add6daa2109a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/339353f6-2387-4a45-abe4-7f529d121046",
    "preview": null,
    "publishDates": {
      "ga": "05/01/2023",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review the list of guest accounts that require access removal on the Accounts section. Select an account to view its role definitions and locate source scope. If you accept the risk for a specific account, use the exempt capability to exclude it from evaluation.<br><ol><li>Go to the <strong>Azure portal</strong>.</li><li>Open <strong>Access control (IAM)</strong> at a scope, such as management group, subscription, resource group, or resource, where the guest user has a role assignment.</li><li>Click the <strong>Role assignments</strong> tab to view all the role assignments.</li><li>In the list of role assignments, add a checkmark next to the guest user with the role assignment you want to remove.</li><li>Click <strong>Remove</strong>. In the remove role assignment message that appears, click <strong>Yes</strong>.</li></ol>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It's important to remove disabled accounts that have read and write permissions on Azure resources.<br> These accounts, although disabled from signing in on Active Directory, can still be targeted by attackers.<br> If exploited, these accounts could provide unauthorized access to your data, potentially leading to data breaches.<br> Therefore, to maintain a secure environment, we recommend removing these accounts from Azure resources.<br>",
    "displayName": "Disabled accounts with read and write permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1ff0b4c9-ed56-4de6-be9c-d7ab39645926",
    "implementationEffort": "Low",
    "name": "1ff0b4c9-ed56-4de6-be9c-d7ab39645926",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8d7e1fde-fe26-4b5f-8108-f8e432cbc2be",
    "preview": null,
    "publishDates": {
      "ga": "05/01/2023",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review the list of accounts that are disabled from signing in on the Accounts section. Select an account to view its role definitions and locate the source scope. If you accept the risk for specific account, use the exempt capability to exclude it from evaluation.<ol><li>Go to the <strong>Azure portal</strong>.</li><li>Open <strong>Access control (IAM)</strong> at a scope, such as management group, subscription, resource group, or resource, where the guest user has a role assignment.</li><li>Click the <strong>Role assignments</strong> tab to view all the role assignments.</li><li>In the list of role assignments, add a checkmark next to the disabled user with the role assignment you want to remove.</li><li>Click <strong>Remove</strong>. In the remove role assignment message that appears, click <strong>Yes</strong>.</li></ol>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It's important to remove accounts that have been disabled from signing in on Active Directory from your Azure resources.<br> These disabled accounts, especially those with owner permissions, can become targets for attackers.<br> If these accounts are compromised, attackers could gain unnoticed access to your data.<br> Therefore, to maintain a secure environment, we recommend removing these accounts from Azure resources..<br>",
    "displayName": "Disabled accounts with owner permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/050ac097-3dda-4d24-ab6d-82568e7a50cf",
    "implementationEffort": "Low",
    "name": "050ac097-3dda-4d24-ab6d-82568e7a50cf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0cfea604-3201-4e14-88fc-fae4c427a6c5",
    "preview": null,
    "publishDates": {
      "ga": "05/01/2023",
      "public": "06/01/2021"
    },
    "remediationDescription": "Review the list of accounts that are disabled from signing in on the Accounts section. Select an account to view its role definitions and locate the source scope. If you accept the risk for specific account, use the exempt capability to exclude it from evaluation.<ol><li>Go to the <strong>Azure portal</strong>.</li><li>Open <strong>Access control (IAM)</strong> at a scope, such as management group, subscription, resource group, or resource, where the guest user has a role assignment.</li><li>Click the <strong>Role assignments</strong> tab to view all the role assignments.</li><li>In the list of role assignments, add a checkmark next to the disabled user with the role assignment you want to remove.</li><li>Click <strong>Remove</strong>. In the remove role assignment message that appears, click <strong>Yes</strong>.</li></ol>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Exposed ports can be exploited by threat actors to damage, disable, overburden, or impair Microsoft servers or networks, which is against Azure's terms of use.<br> If these ports remain open, it could lead to security breaches and potential service disruption.<br> Therefore, it's crucial to close these ports to maintain security and compliance with Azure's terms.<br>",
    "displayName": "Machines should have ports closed that might expose attack vectors",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bbff27d2-73db-4c2d-8b1a-5f20b1f1da7e",
    "implementationEffort": "Low",
    "name": "bbff27d2-73db-4c2d-8b1a-5f20b1f1da7e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/af99038c-02fd-4a2f-ac24-386b62bf32de",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/04/2022"
    },
    "remediationDescription": "Review the findings and evaluate if any ports need to remain open for your service to function or if they can be closed to protect your resources. Please, opt out of the recommendation by using the exemption workflow for any ports that need to remain open.<br>For all other findings, remediate per instructions below:<br> &bull; Need to secure network traffic for a single VNet, please follow instruction to setup <a href='https://docs.microsoft.com/azure/virtual-network/manage-network-security-group'>Network Security Groups (NSG)</a>.<br> &bull; Need to secure network traffic for one or more peered VNet, please follow instruction to setup <a href='https://docs.microsoft.com/azure/firewall/tutorial-firewall-deploy-portal'>Azure Firewall</a>.<br>",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. This recommendation provides visibility to vulnerable images currently running in your Kubernetes clusters. Remediating vulnerabilities in container images that are currently running is key to improving your security posture, significantly reducing the attack surface for your containerized workloads.",
    "displayName": "Azure running container images should have vulnerabilities resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c609cf0f-71ab-41e9-a3c6-9a1f7fe1b8d5",
    "implementationEffort": "Moderate",
    "name": "c609cf0f-71ab-41e9-a3c6-9a1f7fe1b8d5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/17f4b1cc-c55c-4d94-b1f9-2978f6ac2957",
    "preview": null,
    "publishDates": {
      "ga": "04/01/2024",
      "public": "04/01/2023"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Navigate to the relevant resource under the 'Unhealthy' section and select the container image you are looking to remediate. <br>2. Review the set of vulnerabilities found by the scan, which are sorted from critical to no risk. <br>3. Select a vulnerability to view its full details and patch availability. <br>4. Create new images with newer version of the vulnerable packages. <br>5. Push the new remediated image to your registry. Review scan results for the new image to verify the vulnerability no longer exists. <br>6. Delete the old image with the vulnerability from your registry. <br>7. Use the new image across all workloads where it is currently being used.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Runtime vulnerability scanning is a crucial security measure for function apps.<br> It scans your apps for potential security vulnerabilities and provides detailed findings.<br> If these vulnerabilities are not resolved, your serverless applications could be at risk of attacks, compromising their security posture.<br> Therefore, it is important to address and resolve these findings to protect your applications from potential threats.<br>",
    "displayName": "Function apps should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/afd071f0-ebaa-422b-bb2f-8a772a31db75",
    "implementationEffort": "Low",
    "name": "afd071f0-ebaa-422b-bb2f-8a772a31db75",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/18/2022"
    },
    "remediationDescription": "To resolve function app vulnerabilities: <br>1. Select a vulnerability to view its details and explicit remediation instructions and scripts. <br>2. Remediate the vulnerability using the provided instructions described in the 'Remediation' field.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. Resolving vulnerabilities can greatly improve your security posture, ensuring images are safe to use prior to deployment.",
    "displayName": "Azure registry container images should have vulnerabilities resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c0b7cfc6-3172-465a-b378-53c7ff2cc0d5",
    "implementationEffort": "Moderate",
    "name": "c0b7cfc6-3172-465a-b378-53c7ff2cc0d5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/090c7b07-b4ed-4561-ad20-e9075f3ccaff",
    "preview": null,
    "publishDates": {
      "ga": "04/01/2024",
      "public": "04/01/2023"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Navigate to the relevant resource under the 'Unhealthy' section and select the container image you are looking to remediate. <br>2. Review the set of known vulnerabilities found by the scan by their severity. <br>3. Select a vulnerability to view its details and explicit remediation instructions. <br>4. Remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>5. Upload the new remediated image to your registry. Review scan results for the new image to verify the remediated vulnerabilities no longer exist. <br>6. Delete the old image with the vulnerabilities from your registry. <br>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "API security vulnerabilities detected in GitHub repositories pose a significant risk.<br> These vulnerabilities can be exploited by attackers to gain unauthorized access or disrupt services.<br> If not resolved, the security posture of the repositories will be compromised, potentially leading to data breaches or service disruptions.<br> Therefore, it is crucial to remediate these vulnerabilities to ensure the security and integrity of the repositories.<br>",
    "displayName": "GitHub repositories should have API security testing findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7ad00833-a0f0-47b9-b377-5665bd5d9074",
    "implementationEffort": "Low",
    "name": "7ad00833-a0f0-47b9-b377-5665bd5d9074",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/01/2023"
    },
    "remediationDescription": "To resolve API security scan findings: <br>1. Review the failed security checks found by the scan, which are sorted from high to low risk. <br>2. Select a finding to view details. <br>3. Navigate to the code file using the Html URL. <br>4. Remediate the finding from the finding description. <br>5. Check-in the remediated code file. <br>6. Review scan results for the repository to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "API security vulnerabilities detected in Azure DevOps repositories pose a significant risk.<br> These vulnerabilities can be exploited by attackers to gain unauthorized access or disrupt services.<br> Resolving these findings is crucial to improve the security posture of the repositories.<br> If left unresolved, these vulnerabilities could lead to potential data breaches or service disruptions.<br>",
    "displayName": "Azure DevOps repositories should have API security testing findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d42301a5-4d23-4457-97c8-f2f2e9eb979e",
    "implementationEffort": "Moderate",
    "name": "d42301a5-4d23-4457-97c8-f2f2e9eb979e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "12/11/2023"
    },
    "remediationDescription": "To resolve API security scan findings: <br>1. Review the failed security checks found by the scan, which are sorted from high to low risk. <br>2. Select a finding to view details. <br>3. Navigate to the code file using the Html URL. <br>4. Remediate the finding from the finding description. <br>5. Check-in the remediated code file. <br>6. Review scan results for the repository to verify the code finding no longer exists.",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "scans your AWS registries container images for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. Resolving vulnerabilities can greatly improve your security posture, ensuring images are safe to use prior to deployment.",
    "displayName": "AWS registry container images should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c27441ae-775c-45be-8ffa-655de37362ce",
    "implementationEffort": "Moderate",
    "name": "c27441ae-775c-45be-8ffa-655de37362ce",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "04/01/2024",
      "public": "13/08/2023"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Navigate to the relevant resource under the 'Unhealthy' section and select the container image you are looking to remediate. <br>2. Review the set of known vulnerabilities found by the scan by their severity. <br>3. Select a vulnerability to view its details and explicit remediation instructions. <br>4. Remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>5. Upload the new remediated image to your registry. Review scan results for the new image to verify the remediated vulnerabilities no longer exist. <br>6. Delete the old image with the vulnerabilities from your registry. <br>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. This recommendation provides visibility to vulnerable images currently running in your Elastic Kubernetes clusters. Remediating vulnerabilities in container images that are currently running is key to improving your security posture, significantly reducing the attack surface for your containerized workloads.",
    "displayName": "AWS running container images should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/682b2595-d045-4cff-b5aa-46624eb2dd8f",
    "implementationEffort": "Moderate",
    "name": "682b2595-d045-4cff-b5aa-46624eb2dd8f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "04/01/2024",
      "public": "20/11/2023"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Navigate to the relevant resource under the 'Unhealthy' section and select the container image you are looking to remediate. <br>2. Review the set of vulnerabilities found by the scan, which are sorted from critical to no risk. <br>3. Select a vulnerability to view its full details and patch availability. <br>4. Create new images with newer version of the vulnerable packages. <br>5. Push the new remediated image to your registry. Review scan results for the new image to verify the vulnerability no longer exists. <br>6. Delete the old image with the vulnerability from your registry. <br>7. Use the new image across all workloads where it is currently being used.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "scans your GCP registries container images for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. Resolving vulnerabilities can greatly improve your security posture, ensuring images are safe to use prior to deployment.",
    "displayName": "GCP registry container images should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5cc3a2c1-8397-456f-8792-fe9d0d4c9145",
    "implementationEffort": "Moderate",
    "name": "5cc3a2c1-8397-456f-8792-fe9d0d4c9145",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "04/01/2024",
      "public": "13/08/2023"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Navigate to the relevant resource under the 'Unhealthy' section and select the container image you are looking to remediate. <br>2. Review the set of known vulnerabilities found by the scan by their severity. <br>3. Select a vulnerability to view its details and explicit remediation instructions. <br>4. Remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>5. Upload the new remediated image to your registry. Review scan results for the new image to verify the remediated vulnerabilities no longer exist. <br>6. Delete the old image with the vulnerabilities from your registry. <br>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Container image vulnerability assessment scans your registry for commonly known vulnerabilities (CVEs) and provides a detailed vulnerability report for each image. This recommendation provides visibility to vulnerable images currently running in your Google Kubernetes Engine. Remediating vulnerabilities in container images that are currently running is key to improving your security posture, significantly reducing the attack surface for your containerized workloads.",
    "displayName": "GCP running container images should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e538731a-80c8-4317-a119-13075e002516",
    "implementationEffort": "Moderate",
    "name": "e538731a-80c8-4317-a119-13075e002516",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "04/01/2024",
      "public": "20/11/2023"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Navigate to the relevant resource under the 'Unhealthy' section and select the container image you are looking to remediate. <br>2. Review the set of vulnerabilities found by the scan, which are sorted from critical to no risk. <br>3. Select a vulnerability to view its full details and patch availability. <br>4. Create new images with newer version of the vulnerable packages. <br>5. Push the new remediated image to your registry. Review scan results for the new image to verify the vulnerability no longer exists. <br>6. Delete the old image with the vulnerability from your registry. <br>7. Use the new image across all workloads where it is currently being used.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Security baseline assessment helps your organization to seamlessly and continuously monitor the compliance of your virtual machines' operating system configuration, against industry security benchmarks, promptly identifying any changes, ensuring your organization's compliance.",
    "displayName": "Machines should be configured securely (powered by MDVM)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/463fd8bb-7606-4cc9-b2d8-5ed8e02ef22e",
    "implementationEffort": "Low",
    "name": "463fd8bb-7606-4cc9-b2d8-5ed8e02ef22e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "01/03/2024"
    },
    "remediationDescription": "Each discovered security check has its own remediation steps. 1. Select one of the configuration rules. 2. In the rules details plane, see the remediation description and follow the instructions.",
    "severity": "Low",
    "tactics": [
      "Credential Access",
      "Defense Evasion",
      "Lateral Movement",
      "Execution",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Exploitation for Defense Evasion",
      "Exploitation of Remote Services",
      "Exploitation for Client Execution",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Security baseline assessment helps your organization to continuous and seamless monitoring of your virtual machines' operating system configuration, which are onboarded with MDE. This process aligns with industry security benchmarks and promptly identifies any changes, ensuring your organization's compliance.",
    "displayName": "Servers onboarded with MDE should be configured securely (powered by MDVM)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/cb55d942-0981-45d7-8359-47bc77c24d2d",
    "implementationEffort": "Low",
    "name": "cb55d942-0981-45d7-8359-47bc77c24d2d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/17/2024"
    },
    "remediationDescription": "Each discovered security check has its own remediation steps. 1. Select one of the configuration rules. 2. In the rules details plane, see the remediation description and follow the instructions.",
    "severity": "Low",
    "tactics": [
      "Credential Access",
      "Defense Evasion",
      "Lateral Movement",
      "Execution",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Exploitation for Defense Evasion",
      "Exploitation of Remote Services",
      "Exploitation for Client Execution",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Security baseline assessments help your organization seamlessly and continuously monitor the compliance of your EC2 instances' operating system configuration against established security benchmarks. These benchmarks can help identify changes and meet compliance requirements.",
    "displayName": "EC2 instances should be configured securely (powered by MDVM)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ed551986-c6b2-440e-8ded-608b0cd7c1ca",
    "implementationEffort": "Low",
    "name": "ed551986-c6b2-440e-8ded-608b0cd7c1ca",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/17/2024"
    },
    "remediationDescription": "Each discovered security check has its own remediation steps. 1. Select one of the configuration rules. 2. In the rules details plane, see the remediation description and follow the instructions.",
    "severity": "Low",
    "tactics": [
      "Credential Access",
      "Defense Evasion",
      "Lateral Movement",
      "Execution",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Exploitation for Defense Evasion",
      "Exploitation of Remote Services",
      "Exploitation for Client Execution",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Security baseline assessments help your organization seamlessly and continuously monitor the compliance of your GCP compute instances' operating system configuration against established security benchmarks. These benchmarks can help identify changes and meet compliance requirements.",
    "displayName": "GCP compute instances should be configured securely (powered by MDVM)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f8b56854-26b0-4f80-9be4-2d061c17eb1c",
    "implementationEffort": "Low",
    "name": "f8b56854-26b0-4f80-9be4-2d061c17eb1c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "02/17/2024"
    },
    "remediationDescription": "Each discovered security check has its own remediation steps. 1. Select one of the configuration rules. 2. In the rules details plane, see the remediation description and follow the instructions.",
    "severity": "Low",
    "tactics": [
      "Credential Access",
      "Defense Evasion",
      "Lateral Movement",
      "Execution",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Credential Access",
      "Exploitation for Defense Evasion",
      "Exploitation of Remote Services",
      "Exploitation for Client Execution",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To protect virtual machines from the latest threats and vulnerabilities, resolve all identified configuration issues with the installed Endpoint Detection and Response (EDR) solution.<br><br>Note: Currently, this recommendation only applies to resources with Microsoft Defender for Endpoint (MDE) enabled.",
    "displayName": "EDR configuration issues should be resolved on virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dc5357d0-3858-4d17-a1a3-072840bff5be",
    "implementationEffort": "Moderate",
    "name": "dc5357d0-3858-4d17-a1a3-072840bff5be",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "07/03/2024",
      "public": "17/01/2024"
    },
    "remediationDescription": "1. Click on one of the affected resources to view its security findings.<br>2. Click on the security check to view the evaluated configurations.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To protect virtual machines from the latest threats and vulnerabilities, resolve all identified configuration issues with the installed Endpoint Detection and Response (EDR) solution.<br><br>Note: Currently, this recommendation only applies to resources with Microsoft Defender for Endpoint (MDE) enabled.",
    "displayName": "EDR configuration issues should be resolved on EC2s",
    "id": "/providers/Microsoft.Security/assessmentMetadata/695abd03-82bd-4d7f-a94c-140e8a17666c",
    "implementationEffort": "Moderate",
    "name": "695abd03-82bd-4d7f-a94c-140e8a17666c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "07/03/2024",
      "public": "17/01/2024"
    },
    "remediationDescription": "1. Click on one of the affected resources to view its security findings.<br>2. Click on the security check to view the evaluated configurations.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To protect virtual machines from the latest threats and vulnerabilities, resolve all identified configuration issues with the installed Endpoint Detection and Response (EDR) solution.<br><br>Note: Currently, this recommendation only applies to resources with Microsoft Defender for Endpoint (MDE) enabled.",
    "displayName": "EDR configuration issues should be resolved on GCP Virtual machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f36a15fb-61a6-428c-b719-6319538ecfbc",
    "implementationEffort": "Moderate",
    "name": "f36a15fb-61a6-428c-b719-6319538ecfbc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "07/03/2024",
      "public": "17/01/2024"
    },
    "remediationDescription": "1. Click on one of the affected resources to view its security findings.<br>2. Click on the security check to view the evaluated configurations.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image.<br> Scanning and remediating vulnerabilities for container images in the registry helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Container images in Azure registry should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/33422d8f-ab1e-42be-bc9a-38685bb567b9",
    "implementationEffort": "Moderate",
    "name": "33422d8f-ab1e-42be-bc9a-38685bb567b9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/03/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its details and explicit remediation instructions. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, upload the new remediated image to your registry. <br>5. Delete the old image with the vulnerabilities from your registry. <br>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provide vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images.<br> Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Containers running in Azure should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e9acaf48-d2cf-45a3-a6e7-3caa2ef769e0",
    "implementationEffort": "Moderate",
    "name": "e9acaf48-d2cf-45a3-a6e7-3caa2ef769e0",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/03/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its full details and patch availability. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, push the new remediated image to your registry. <br>5. Delete the old image with the vulnerability from your registry. <br>6. Update the Kubernetes workloads using this image to use the new image.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provide vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images.<br> Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Containers running in Azure should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c5045ea3-afc6-4006-ab8f-86c8574dbf3d",
    "implementationEffort": "Moderate",
    "name": "c5045ea3-afc6-4006-ab8f-86c8574dbf3d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/15/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its full details and patch availability. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, push the new remediated image to your registry. <br>5. Delete the old image with the vulnerability from your registry. <br>6. Update the Kubernetes workloads using this image to use the new image.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image.<br> Scanning and remediating vulnerabilities for container images in the registry helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Container images in GCP registry should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/24e37609-dcf5-4a3b-b2b0-b7d76f2e4e04",
    "implementationEffort": "Moderate",
    "name": "24e37609-dcf5-4a3b-b2b0-b7d76f2e4e04",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/03/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its details and explicit remediation instructions. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, upload the new remediated image to your registry. <br>5. Delete the old image with the vulnerabilities from your registry. <br>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provide vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images.<br> Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Containers running in GCP should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c7c1d31d-a604-4b86-96df-63448618e165",
    "implementationEffort": "Moderate",
    "name": "c7c1d31d-a604-4b86-96df-63448618e165",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/03/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its full details and patch availability. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, push the new remediated image to your registry. <br>5. Delete the old image with the vulnerability from your registry. <br>6. Update the Kubernetes workloads using this image to use the new image.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provide vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images.<br> Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Containers running in GCP should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1b3abfa4-9e53-46f1-9627-51f2957f8bba",
    "implementationEffort": "Moderate",
    "name": "1b3abfa4-9e53-46f1-9627-51f2957f8bba",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/15/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its full details and patch availability. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, push the new remediated image to your registry. <br>5. Delete the old image with the vulnerability from your registry. <br>6. Update the Kubernetes workloads using this image to use the new image.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud scans your registry images for known vulnerabilities (CVEs) and provides detailed findings for each scanned image.<br> Scanning and remediating vulnerabilities for container images in the registry helps maintain a secure and reliable software supply chain, reduces the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Container images in AWS registry should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2a139383-ec7e-462a-90ac-b1b60e87d576",
    "implementationEffort": "Moderate",
    "name": "2a139383-ec7e-462a-90ac-b1b60e87d576",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/03/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its details and explicit remediation instructions. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, upload the new remediated image to your registry. <br>5. Delete the old image with the vulnerabilities from your registry. <br>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "DataExfiltration",
      "DataSpillage",
      "AccountBreach",
      "ElevationOfPrivilege"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provide vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images.<br> Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Containers running in AWS should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d5d1e526-363a-4223-b860-f4b6e710859f",
    "implementationEffort": "Moderate",
    "name": "d5d1e526-363a-4223-b860-f4b6e710859f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/03/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its full details and patch availability. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, push the new remediated image to your registry. <br>5. Delete the old image with the vulnerability from your registry. <br>6. Update the Kubernetes workloads using this image to use the new image.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud creates an inventory of all container workloads currently running in your Kubernetes clusters and provide vulnerability reports for those workloads by matching the images being used and the vulnerability reports created for the registry images.<br> Scanning and remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards.<br>",
    "displayName": "[Preview] Containers running in AWS should have vulnerability findings resolved",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8749bb43-cd24-4cf9-848c-2a50f632043c",
    "implementationEffort": "Moderate",
    "name": "8749bb43-cd24-4cf9-848c-2a50f632043c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/15/2024"
    },
    "remediationDescription": "To resolve container image vulnerabilities: <br>1. Review the set of known vulnerabilities found by their severity. <br>2. Select a vulnerability to view its full details and patch availability. <br>3. Check if there is a newer version of the image in the registry that already resolves this vulnerability, if not, remediate the vulnerability using the provided instructions described in the 'Remediation' field. <br>4. If a new image was created, push the new remediated image to your registry. <br>5. Delete the old image with the vulnerability from your registry. <br>6. Update the Kubernetes workloads using this image to use the new image.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "AccountBreach",
      "DataExfiltration",
      "DataSpillage",
      "MaliciousInsider",
      "ElevationOfPrivilege",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Azure Policy add-on for Kubernetes extends <a target=\"_blank\" href=\"https://github.com/open-policy-agent/gatekeeper\">Gatekeeper</a> v3, an admission controller webhook for <a target=\"_blank\" href=\"https://www.openpolicyagent.org/\">Open Policy Agent</a> (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.<p>Defender for Cloud requires the Add-on to audit and enforce security capabilities and compliance inside your clusters. <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes\"> Learn more</a>.</p><p>Requires Kubernetes v1.14.0 or later.</p>",
    "displayName": "Azure Kubernetes Service clusters should have the Azure Policy add-on for Kubernetes installed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/08e628db-e2ed-4793-bc91-d13e684401c3",
    "implementationEffort": null,
    "name": "08e628db-e2ed-4793-bc91-d13e684401c3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0a15ec92-a229-4763-bb14-0ea34a568f8d",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To configure the Azure Policy Add-on for use with your Azure Kubernetes Service cluster, follow the instructions in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes#install-azure-policy-add-on-for-aks?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Install Azure Policy Add-on for AKS</a>.<br><br><u>Auto provisioning:</u><br>You can also auto deploy this add-on as explained in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/enable-data-collection#enable-auto-provisioning-of-the-log-analytics-agent-and-extensions-\">Enable auto provisioning of extensions</a>.<br>When auto provisioning for the add-on is set to <b>On</b>, the extension is enabled by default in all existing and future clusters (that meet the add-on installation requirements).",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Azure Policy extension for Kubernetes extends <a target=\"_blank\" href=\"https://github.com/open-policy-agent/gatekeeper\">Gatekeeper</a> v3, an admission controller webhook for <a target=\"_blank\" href=\"https://www.openpolicyagent.org/\">Open Policy Agent</a> (OPA), to apply at-scale enforcements and safeguards on your clusters in a centralized, consistent manner.",
    "displayName": "Azure Arc-enabled Kubernetes clusters should have the Azure Policy extension installed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/0642d770-b189-42ef-a2ce-9dcc3ec6c169",
    "implementationEffort": null,
    "name": "0642d770-b189-42ef-a2ce-9dcc3ec6c169",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/6b2122c1-8120-4ff5-801b-17625a355590",
    "preview": true,
    "publishDates": {
      "ga": "06/01/2022",
      "public": "06/01/2022"
    },
    "remediationDescription": "To configure the Azure Policy extension for use with your Azure Arc-enabled Kubernetes cluster, follow the instructions in <a href='https://docs.microsoft.com/azure/governance/policy/concepts/policy-for-kubernetes#install-azure-policy-extension-for-azure-arc-enabled-kubernetes'>#Install Azure Policy Extension for Azure Arc-enabled Kubernetes</a>.<br><br><u>Auto provisioning:</u><br>You can also auto deploy this extension as explained in <a target=\"_blank\" href=\"https://docs.microsoft.com/en-us/azure/security-center/security-center-enable-data-collection#enable-auto-provisioning-of-extensions\">Enable auto provisioning of extensions</a> .<br>When auto provisioning for the extension is set to \"on\", the extension is enabled by default in all existing and future clusters (that meet the extension installation requirements).",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Enforcing CPU and memory limits prevents resource exhaustion attacks (a form of denial of service attack).<p>We recommend setting limits for containers to ensure the runtime prevents the container from using more than the configured resource limit.</p>",
    "displayName": "Container CPU and memory limits should be enforced",
    "id": "/providers/Microsoft.Security/assessmentMetadata/405c9ae6-49f9-46c4-8873-a86690f27818",
    "implementationEffort": null,
    "name": "405c9ae6-49f9-46c4-8873-a86690f27818",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/e345eecc-fa47-480f-9e88-67dcc122b164",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "From the 'Unhealthy resources' tab, select the cluster. Defender for Cloud lists the pods without CPU and memory limits. To control a pod's limits, set quotas at the container level. Each container of a pod can specify one or both of the following:<ul><li>spec.containers[].resources.limits.cpu</li><li>spec.containers[].resources.limits.memory</li></ul><p>After making your changes, redeploy the pod with the new limits.</p><p>Note: Although requests and limits can only be specified on individual containers, it is convenient to talk about pod resource limits. A Pod resource limit is the sum of the resource limits for all the containers in the pod. <a href='https://kubernetes.io/docs/concepts/configuration/manage-resources-containers/#resource-requests-and-limits-of-pod-and-container'>Learn more</a>.</p>",
    "severity": "Medium",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Endpoint Denial of Service"
    ],
    "threats": [
      "DenialOfService",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "To prevent unrestricted host access, avoid privileged containers whenever possible.<p>Privileged containers have all of the root capabilities of a host machine. They can be used as entry points for attacks and to spread malicious code or malware to compromised applications, hosts and networks.</p>",
    "displayName": "Privileged containers should be avoided",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5d90913f-a1c5-4429-ad54-2c6c17fb3c73",
    "implementationEffort": null,
    "name": "5d90913f-a1c5-4429-ad54-2c6c17fb3c73",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/95edb821-ddaf-4404-9732-666045e056b4",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "From the 'Unhealthy resources' tab, select the cluster. Defender for Cloud lists the pods running privileged containers.<p>For these pods, set the privileged flag to 'false' or remove this property on the <a href='https://kubernetes.io/docs/tasks/configure-pod-container/security-context/'>security context</a> of the container's spec. After making your changes, redeploy the pod with the updated spec.</p>",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "ElevationOfPrivilege",
      "DataExfiltration",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Images running on your Kubernetes cluster should come from known and monitored container image registries. Trusted registries reduce your cluster's exposure risk by limiting the potential for the introduction of unknown vulnerabilities, security issues and malicious images.",
    "displayName": "Container images should be deployed from trusted registries only",
    "id": "/providers/Microsoft.Security/assessmentMetadata/8d244d29-fa00-4332-b935-c3a51d525417",
    "implementationEffort": null,
    "name": "8d244d29-fa00-4332-b935-c3a51d525417",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/febd0533-8e55-448f-b837-bd0e06f16469",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<ol><li> Ensure a regex, defining your organization private registries is configured, via the security policy parameter 'Allowed registry or registries regex'.</li><li>From the 'Unhealthy resources' tab, select the cluster. Defender for Cloud lists the pods running images from untrusted registries. If you see a pod running an unfamiliar image, remove it and report the incident to your security admin. Otherwise, move all images to a trusted private registry and redeploy the pods with the updated registry. </li></ol>",
    "severity": "High",
    "tactics": [
      "Persistence"
    ],
    "techniques": [
      "Implant Container Image"
    ],
    "threats": [
      "MaliciousInsider",
      "DataSpillage",
      "DataExfiltration",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "To reduce the attack surface of your Kubernetes cluster, restrict access to the cluster by limiting services access to the configured ports.",
    "displayName": "Services should listen on allowed ports only",
    "id": "/providers/Microsoft.Security/assessmentMetadata/add45209-73f6-4fa5-a5a5-74a451b07fbe",
    "implementationEffort": null,
    "name": "add45209-73f6-4fa5-a5a5-74a451b07fbe",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/233a2a17-77ca-4fb1-9b6b-69223d272a44",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<ol><li>Ensure a list of ports on which your services are allowed to listen, is configured, via the security policy parameter 'Allowed service ports list in Kubernetes cluster'.</li><li>From the 'Unhealthy resources' tab, select the cluster. Defender for Cloud lists the services which listen on ports outside the configured list.</li><li>Limit the services' ports. After making your changes, redeploy the services with the updated ports.</li></ol>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services",
      "Non-Standard Port",
      "Exploit Public-Facing Application"
    ],
    "threats": [
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "To reduce attack surface of your container, restrict Linux capabilities and grant specific privileges to containers without granting all the privileges of the root user. We recommend dropping all capabilities, then adding those that are required",
    "displayName": "Least privileged Linux capabilities should be enforced for containers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/11c95609-3553-430d-b788-fd41cde8b2db",
    "implementationEffort": null,
    "name": "11c95609-3553-430d-b788-fd41cde8b2db",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c26596ff-4d70-4e6a-9a30-c2506bd2f80c",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. Make sure lists of dropped capabilities and allowed capabilities are configured, via the security policy parameters. Recommend to set parameter 'Required drop capabilities' as [\"ALL\"] to enforce to drop all capabilities. The recommendation by default will only block to add capacities.<br>2. From the Unhealthy resources tab, select the cluster. Defender for Cloud lists the running containers with capabilities outside the configured list.<br>3. Limit the containers' Linux capabilities. To add or remove Linux capabilities for a container, include a capabilities section in the securityContext section of the container manifest with the relevant capabilities set e.g. Drop: ALL ; add: [\"NET_ADMIN\", \"SYS_TIME\"].<br>4. After making your changes, redeploy the pod with the updated capabilities.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "ElevationOfPrivilege",
      "DataExfiltration",
      "ThreatResistance",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Containers should run with a read only root file system in your Kubernetes cluster. Immutable filesystem protects containers from changes at run-time with malicious binaries being added to PATH.",
    "displayName": "Immutable (read-only) root filesystem should be enforced for containers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/27d6f0e9-b4d5-468b-ae7e-03d5473fd864",
    "implementationEffort": null,
    "name": "27d6f0e9-b4d5-468b-ae7e-03d5473fd864",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/df49d893-a74c-421d-bc95-c663042e5b80",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. From the Unhealthy resources tab, select the cluster. Defender for Cloud lists the pods running containers without read only root file system.<br>2. For these pods, set the readOnlyRootFilesystem flag to 'true' on the security context of the container's spec.<br>3. After making your changes, redeploy the pod with the updated spec.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Collection",
      "Lateral Movement",
      "Persistence",
      "Defense Evasion",
      "Impact",
      "Privilege Escalation",
      "Credential Access"
    ],
    "techniques": [
      "Scheduled Task/Job",
      "Data Staged",
      "Taint Shared Content",
      "Account Manipulation",
      "Create Account",
      "File and Directory Permissions Modification",
      "Data Destruction",
      "Data Encrypted for Impact",
      "Server Software Component",
      "Create or Modify System Process",
      "Event Triggered Execution",
      "Compromise Client Software Binary",
      "Modify Authentication Process",
      "Hide Artifacts",
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "We recommend limiting pod HostPath volume mounts in your Kubernetes cluster to the configured allowed host paths. If there's a compromise, the container node access from the containers should be restricted.",
    "displayName": "Usage of pod HostPath volume mounts should be restricted to a known list to restrict node access from compromised containers",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f0debc84-981c-4a0d-924d-aa4bd7d55fef",
    "implementationEffort": null,
    "name": "f0debc84-981c-4a0d-924d-aa4bd7d55fef",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/098fc59e-46c7-4d99-9b16-64990e543d75",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. Ensure a list of allowed host paths is configured, via the security policy parameter 'Allowed host paths for pod in Kubernetes cluster'.<br>2. From the Unhealthy resources tab, select the cluster. Defender for Cloud lists the pods running pods with hostPath volume violating the configured list.<br>3. Update hostPath and redeploy the pod with the updated spec.",
    "severity": "Medium",
    "tactics": [
      "Lateral Movement"
    ],
    "techniques": [
      "Taint Shared Content"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Containers should not run as root. Even inside a container, root access can lead to privilege escalation if other misconfigurations exist. Running as a non-root user reduces the impact of a potential compromise.",
    "displayName": "Running containers as root user should be avoided",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9b795646-9130-41a4-90b7-df9eae2437c8",
    "implementationEffort": null,
    "name": "9b795646-9130-41a4-90b7-df9eae2437c8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/f06ddb64-5fa3-4b77-b166-acb36f7f6042",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. In the <b>Unhealthy resources</b> tab, select the affected cluster to view non-compliant pods.<br>2. Set <code>securityContext.runAsNonRoot: true</code>, or define non-zero <code>runAsUser</code> and <code>runAsGroup</code> values in the pod or container spec.<br>3. Redeploy the workloads with the updated configuration.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Restrict pod access to the host network and the allowable host port range in a Kubernetes cluster. Pods created with the hostNetwork attribute enabled will share the node's network space. To avoid compromised container from sniffing network traffic, we recommend not putting your pods on the host network. If you need to expose a container port on the node's network, and using a Kubernetes Service node port does not meet your needs, another possibility is to specify a hostPort for the container in the pod spec.",
    "displayName": "Usage of host networking and ports should be restricted",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ebc68898-5c0f-4353-a426-4a5f1e737b12",
    "implementationEffort": null,
    "name": "ebc68898-5c0f-4353-a426-4a5f1e737b12",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/82985f06-dc18-4a48-bc1c-b9f4f0098cfe",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. Ensure the following are all configured in the security policy parameters: allow host network usage, and min and max host ports.<br>2. From the Unhealthy resources tab, select the cluster. Defender for Cloud lists the pods running containers with host networking violating the configured list.<br>3. Validate the host networking using the hostNetwork and hostPort attributes (when applicable) of the container's spec.<br>4. After making your changes, redeploy the pod with the updated spec.",
    "severity": "Medium",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "To protect against privilege escalation outside the container, avoid pod access to sensitive host namespaces (host process ID and host IPC) in a Kubernetes cluster.",
    "displayName": "Containers sharing sensitive host namespaces should be avoided",
    "id": "/providers/Microsoft.Security/assessmentMetadata/802c0637-5a8c-4c98-abd7-7c96d89d6010",
    "implementationEffort": null,
    "name": "802c0637-5a8c-4c98-abd7-7c96d89d6010",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/47a1ee2f-2a2a-4576-bf2a-e0e36709c2b8",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. From the Unhealthy resources tab, select the cluster. Defender for Cloud lists the pods sharing host process ID or host IPC.<br>2. Set the host process ID and host IPC to 'false' on the pod's spec.<br>3. After making your changes, redeploy the pod with the updated spec.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Containers shouldn't run with privilege escalation to root in your Kubernetes cluster.<br>The AllowPrivilegeEscalation attribute controls whether a process can gain more privileges than its parent process.",
    "displayName": "Container with privilege escalation should be avoided",
    "id": "/providers/Microsoft.Security/assessmentMetadata/43dc2a2e-ce69-4d42-923e-ab7d136f2cfe",
    "implementationEffort": null,
    "name": "43dc2a2e-ce69-4d42-923e-ab7d136f2cfe",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1c6e92c9-99f0-4e55-9cf2-0c234dc48f99",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. From the Unhealthy resources tab, select the cluster. Defender for Cloud lists the pods running containers with privilege escalation to root in your Kubernetes cluster.<br>2. For these pods, set the AllowPrivilegeEscalation flag to 'false' on the security context of the container's spec.<br>3. After making your changes, redeploy the pod with the updated spec.",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Containers running on Kubernetes clusters should be limited to allowed AppArmor profiles only.<br>;AppArmor (Application Armor) is a Linux security module that protects an operating system and its applications from security threats. To use it, a system administrator associates an AppArmor security profile with each program.",
    "displayName": "Containers should only use allowed AppArmor profiles",
    "id": "/providers/Microsoft.Security/assessmentMetadata/86f91051-9d6a-47c3-a07f-bd14cb214b45",
    "implementationEffort": null,
    "name": "86f91051-9d6a-47c3-a07f-bd14cb214b45",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/511f5417-5d12-434d-ab2e-816901e72a5e",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "<br>1. Ensure a list of AppArmor profiles containers are allowed to use is configured, via the security policy parameter 'Allowed AppArmor profiles'.<br>2. From the Unhealthy resources tab, select the cluster. Defender for Cloud lists the running pods with AppArmor profile violating the configured list.<br>3. Update AppArmor annotation in the Pod's metadata and redeploy the pod with the updated spec.",
    "severity": "High",
    "tactics": [
      "Defense Evasion",
      "Persistence"
    ],
    "techniques": [
      "Process Injection",
      "Modify Authentication Process"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "To ensure that only applications from allowed networks, machines, or subnets can access your cluster, restrict access to your Kubernetes API server. You can restrict access by defining authorized IP ranges, or by setting up your API servers as private clusters as explained in<a target=\"_blank\" href=\"https://docs.microsoft.com/azure/aks/private-clusters\">Create a private Azure Kubernetes Service cluster</a>.",
    "displayName": "Kubernetes API server should be configured with restricted access",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a2b5b4c-f80d-46e7-ac81-b51a9fb363de",
    "implementationEffort": "Low",
    "name": "1a2b5b4c-f80d-46e7-ac81-b51a9fb363de",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/0e246bcf-5f6f-4f87-bc6f-775d4712c7ea",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To manually configure authorized IP ranges, follow the steps in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/aks/api-server-authorized-ip-ranges?WT.mc_id=Portal-Microsoft_Azure_Security\">Secure access to the API server using authorized IP address ranges in Azure Kubernetes Service (AKS)</a>. If your existing cluster uses a Basic SKU Load Balancer, you'll need to redeploy or migrate to a new AKS cluster using the Standard SKU Load Balancer as explained in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/aks/load-balancer-standard#moving-from-a-basic-sku-load-balancer-to-standard-sku\">Moving from a basic SKU load balancer to standard SKU</a>. If you decide not to redeploy, and you want to move these clusters to the 'not applicable' tab, follow the steps in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/exempt-resource#define-an-exemption?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Define an exemption</a>.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Container and Resource Discovery"
    ],
    "threats": [
      "AccountBreach",
      "DenialOfService"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "To provide granular filtering on the actions that users can perform, use Role-Based Access Control (RBAC) to manage permissions in Kubernetes Service Clusters and configure relevant authorization policies. For more information, see <a target='_blank' href='https://docs.microsoft.com/azure/aks/concepts-identity#role-based-access-controls-rbac'>Azure role-based access control</a>.",
    "displayName": "Role-Based Access Control should be used on Kubernetes Services",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b0fdc63a-38e7-4bab-a7c4-2c2665abbaa9",
    "implementationEffort": "High",
    "name": "b0fdc63a-38e7-4bab-a7c4-2c2665abbaa9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/ac4a19c2-fa67-49b4-8ae5-0b2e78c49457",
    "preview": null,
    "publishDates": {
      "ga": "06/01/2021",
      "public": "06/01/2021"
    },
    "remediationDescription": "To Use Role-Based Access Control (RBAC) you must recreate your Kubernetes Service cluster and enable RBAC during the creation process. Creating a Kubernetes Service with RBAC enabled can be done via the portal as follows:<br>1. Go to <a target='_blank' href='https://ms.portal.azure.com/#blade/HubsExtension/BrowseResourceBlade/resourceType/Microsoft.ContainerService%2FmanagedClusters'>Azure Kubernetes Services</a>.<br>2. Select 'Add' and enter your cluster's configuration.<br>3. In the 'Authentication' tab, verify that the 'Enable RBAC' setting is set to 'Yes'.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": [
      "ElevationOfPrivilege",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Use of HTTPS ensures authentication and protects data in transit from network layer eavesdropping attacks. This capability is currently generally available for Kubernetes Service (AKS), and in preview for AKS Engine and Azure Arc-enabled Kubernetes. For more info, visit https://aka.ms/kubepolicydoc",
    "displayName": "Kubernetes clusters should be accessible only over HTTPS",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c6d87087-9ebe-b31f-b452-0bf3bbbaccd2",
    "implementationEffort": null,
    "name": "c6d87087-9ebe-b31f-b452-0bf3bbbaccd2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/1a5b4dca-0b6f-4cf5-907c-56316bc1bf3d",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "From the unhealthy resources tab, select the cluster. Defender for Cloud lists the ingress objects that are accessible without HTTPS. 1. If the ingress controlled by nginx ingress controller, must first set annotation \"nginx.ingress.kubernetes.io/force-ssl-redirect\"=true. 2. Add the Transport Layer Security (TLS) configuration to your ingress manifest. After making your changes, redeploy the updated ingress object.",
    "severity": "High",
    "tactics": [
      "Discovery"
    ],
    "techniques": [
      "Network Sniffing"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender's extension for Azure Arc provides threat protection for your Arc-enabled Kubernetes clusters. The extension collects data from all control plane (master) nodes in the cluster and sends it to the Microsoft Defender for Kubernetes backend in the cloud for further analysis. Learn more in https://docs.microsoft.com/azure/defender-for-cloud/defender-for-kubernetes-azure-arc?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation.",
    "displayName": "Azure Arc-enabled Kubernetes clusters should have the Defender extension installed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/3ef9848c-c2c8-4ff3-8b9c-4c8eb8ddfce6",
    "implementationEffort": null,
    "name": "3ef9848c-c2c8-4ff3-8b9c-4c8eb8ddfce6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8dfab9c4-fe7b-49ad-85e4-1e9be085358f",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "To install the Defender extension on your Arc-enabled Kubernetes clusters, select an unhealthy cluster and select <b>Remediate</b>.<br>To manually deploy the extension with Azure Resource Manager, Azure CLI, or the REST API, see the instructions in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/defender-for-kubernetes-azure-arc?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Microsoft Defender for Arc-enabled Kubernetes</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for Containers provides cloud-native Kubernetes security capabilities including environment hardening, workload protection, and run-time protection.<br> When you enable the SecurityProfile.AzureDefender profile on your Azure Kubernetes Service cluster, an agent is deployed to your cluster to collect security event data.<br>Learn more about [Microsoft Defender for Containers](https://docs.microsoft.com/azure/defender-for-cloud/defender-for-containers-introduction?tabs=defender-for-container-arch-aks#architecture-overview).",
    "displayName": "Azure Kubernetes Service clusters should have Defender profile enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/56a83a6e-c417-42ec-b567-1e6fcb3d09a9",
    "implementationEffort": null,
    "name": "56a83a6e-c417-42ec-b567-1e6fcb3d09a9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/a1840de2-8088-4ea8-b153-b4c723e9cb01",
    "preview": null,
    "publishDates": {
      "ga": "07/01/2022",
      "public": "12/01/2021"
    },
    "remediationDescription": "To enable the profile using Azure CLI, Azure Resource Manager, or the REST API, follow the instructions in <a target=\"_blank\" href=\"https://docs.microsoft.com/azure/defender-for-cloud/defender-for-kubernetes-introduction?wt.mc_id=defenderforcloud_inproduct_portal_recoremediation\">Enable the SecurityProfile.AzureDefender profile</a>.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Prevent usage of the default namespace in Kubernetes clusters to protect against unauthorized access for ConfigMap, Pod, Secret, Service, and ServiceAccount resource types. For more information, see https://aka.ms/kubepolicydoc.",
    "displayName": "Kubernetes clusters should not use the default namespace",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ff87e0b4-17df-d338-5b19-80e71e0dcc9d",
    "implementationEffort": null,
    "name": "ff87e0b4-17df-d338-5b19-80e71e0dcc9d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/9f061a12-e40d-4183-a00e-171812443373",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Defender for Cloud lists the components using the default namespace. <br>1. From the unhealthy resources tab, select a cluster.<br>2. Define a namespace for the components.<br>3. After making your changes, redeploy the components with the updated namespace. For more information, see https://kubernetes.io/docs/tasks/administer-cluster/namespaces/#creating-a-new-namespace",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Disable automounting API credentials to prevent a potentially compromised Pod resource to run API commands against Kubernetes clusters. For more information, see https://aka.ms/kubepolicydoc.",
    "displayName": "Kubernetes clusters should disable automounting API credentials",
    "id": "/providers/Microsoft.Security/assessmentMetadata/32060ac3-f17f-4848-db8e-e7cf2c9a53eb",
    "implementationEffort": null,
    "name": "32060ac3-f17f-4848-db8e-e7cf2c9a53eb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/423dd1ba-798e-40e4-9c4d-b6902674b423",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "From the unhealthy resources tab, select the cluster. Defender for Cloud lists the pods missing the automountServiceAccountToken: false flag. There are multiple ways to opt out of automounting API credentials for a service account. To opt out of automounting API credentials for a single pod, set automountServiceAccountToken: false in PodSpec. After making your changes, redeploy your updated pod or service account.",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "To reduce the attack surface of your containers, restrict CAP_SYS_ADMIN Linux capabilities. For more information, see https://aka.ms/kubepolicydoc.",
    "displayName": "Kubernetes clusters should not grant CAPSYSADMIN security capabilities",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aba14f78-27c5-af84-848e-9105d18dfd92",
    "implementationEffort": null,
    "name": "aba14f78-27c5-af84-848e-9105d18dfd92",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/d2e7ea85-6b44-4317-a0be-1b951587f626",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/01/2021"
    },
    "remediationDescription": "Defender for Cloud lists the pods running containers that have the CAP_SYS_ADMIN Linux security capability. To remove containers' CAP_SYS_ADMIN Linux security capabilities: 1. From the unhealthy resources tab, select the cluster. 2. Insert a capabilities section in the securityContext section of the container manifest with Drop: SYS_ADMIN. 3. After making your changes, redeploy the pod with the updated capabilities",
    "severity": "High",
    "tactics": null,
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Microsoft Defender for Containers provides cloud-native Kubernetes security capabilities including environment hardening, workload protection, and run-time protection. To ensure you the solution is provisioned properly, and the full set of capabilities are available, enable all advanced configuration settings.",
    "displayName": "Advanced configuration of Defender for Containers should be enabled on GCP connectors",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b7683ca3-3a11-49b6-b9d4-a112713edfa3",
    "implementationEffort": null,
    "name": "b7683ca3-3a11-49b6-b9d4-a112713edfa3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "03/02/2022"
    },
    "remediationDescription": "To enable advanced configuration of the Containers plan for a GCP account connected to Microsoft Defender for Cloud:<ol><li>From the Azure portal, open Microsoft Defender for Cloud.</li><li>Navigate to the \"Environment settings\" page, and select the relevant GCP account.</li><li>Navigate to \"Select plans\"&gt; \"Containers\" row, and select \"Configure &gt;\".</li><li>Enable the missing auto provision features and select Save.</li><li>Select \"Next: Configure access\" and follow the instructions.</li></ol>",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Microsoft Defender for Containers provides cloud-native Kubernetes security capabilities including environment hardening, workload protection, and run-time protection. Enable Containers plan on your GCP connector, to harden the security of Kubernetes clusters and remediate security issues. Learn more about Microsoft Defender for Containers.",
    "displayName": "Microsoft Defender for Containers should be enabled on GCP connectors",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d42ac63d-0592-43b2-8bfa-ff9199da595e",
    "implementationEffort": null,
    "name": "d42ac63d-0592-43b2-8bfa-ff9199da595e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "03/29/2022",
      "public": "03/02/2022"
    },
    "remediationDescription": "To enable Defender for Containers on all GKE clusters in an GCP project connected to Microsoft Defender for Cloud:<ol><li>From the Azure portal, open Microsoft Defender for Cloud.</li><li>Navigate to the \"Environment settings\" page, and select the relevant GCP account.</li><li>Navigate to \"Select plans\", and toggle \"Containers\" to \"On\".</li><li>Select \"Next: Configure access\" and follow the instructions.</li></ol>",
    "severity": "High",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "GitHub's code scanning feature is a powerful tool for identifying security vulnerabilities and errors in code.<br> It allows for the detection, triage, and prioritization of fixes for existing issues, and can help prevent the introduction of new ones.<br> Scans can be scheduled or triggered by specific repository events.<br> If a potential vulnerability is found, an alert is displayed in the repository.<br> Without this feature enabled, projects may be at risk of exploitation, potentially compromising the confidentiality, integrity, or availability of the project.<br>",
    "displayName": "GitHub repositories should have code scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6672df26-ff2e-4282-83c3-e2f20571bd11",
    "implementationEffort": "Low",
    "name": "6672df26-ff2e-4282-83c3-e2f20571bd11",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/02/2022"
    },
    "remediationDescription": "1. On GitHub.com, navigate to the main page of the repository.<br>2. Under your repository name, click  Security.<br>3. To the right of Code scanning alerts, click Set up code scanning. If code scanning is missing, you need to ask an organization owner or repository administrator to enable GitHub Advanced Security.<br>4. Under 'Get started with code scanning', click Set up this workflow on the CodeQL analysis workflow or on a third-party workflow.<br>5.To customize how code scanning scans your code, edit the workflow.<br>6. Use the Start commit drop-down, and type a commit message.<br>7. Click Commit new file or Propose new file",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Dependabot scanning in GitHub repositories is a crucial security feature that alerts users to vulnerabilities in code dependencies.<br> These vulnerabilities can compromise the confidentiality, integrity, or availability of the project or other projects that use its code.<br> If Dependabot scanning is not enabled, these vulnerabilities may go unnoticed, potentially leading to severe security breaches.<br> Therefore, it is highly recommend to enable Dependabot scanning to maintain a secure codebase.<br>",
    "displayName": "GitHub repositories should have Dependabot scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/92643c1f-1a95-4b68-bbd2-5117f92d6e35",
    "implementationEffort": "Low",
    "name": "92643c1f-1a95-4b68-bbd2-5117f92d6e35",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/02/2022"
    },
    "remediationDescription": "1. Browse to a GitHub repository.<br>2. Click on the Settings.<br>3. Click 'Security & analysis'.<br>4. Enable Dependabot alerts",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Secret scanning scans the entire Git history across all branches for any accidentally committed secrets, such as tokens and private keys used for authentication.<br> If these secrets are exposed in a repository, anyone with read access can potentially misuse them to access external services.<br> Therefore, we recommend enabling secret scanning and storing secrets in a secure location outside the project repository to prevent unauthorized access and potential fraudulent activities.<br>",
    "displayName": "GitHub repositories should have secret scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1a600c61-6443-4ab4-bd28-7a6b6fb4691d",
    "implementationEffort": "Low",
    "name": "1a600c61-6443-4ab4-bd28-7a6b6fb4691d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/02/2022"
    },
    "remediationDescription": "1. On GitHub.com, navigate to the main page of the repository.<br>2. Under your repository name, click  Settings.<br>3.In the left sidebar, click Security and analysis.<br>4. If Advanced Security is not already enabled for the repository, to the right of GitHub Advanced Security, click Enable.<br>5. Review the impact of enabling Advanced Security, then click Enable GitHub Advanced Security for this repository.<br>6. When you enable Advanced Security, secret scanning may automatically be enabled for the repository due to the organization's settings. If Secret scanning is shown with an Enable button, you still need to enable secret scanning by clicking Enable. If you see a Disable button, secret scanning is already enabled",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "GitHub's code scanning feature is a powerful tool for identifying security vulnerabilities and errors in code.<br> It allows for the detection, triage, and prioritization of fixes for existing issues, and can help prevent the introduction of new ones.<br> Scans can be scheduled or triggered by specific repository events.<br> If a potential vulnerability is found, an alert is displayed in the repository.<br> Without this feature enabled, projects may be at risk of exploitation, potentially compromising the confidentiality, integrity, or availability of the project.<br>",
    "displayName": "GitHub repositories should have code scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f4bb6c3f-781d-4311-a320-6d04465e3f2b",
    "implementationEffort": "Low",
    "name": "f4bb6c3f-781d-4311-a320-6d04465e3f2b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "1. On GitHub.com, navigate to the main page of the repository.<br>2. Under your repository name, click  Security.<br>3. To the right of Code scanning alerts, click Set up code scanning. If code scanning is missing, you need to ask an organization owner or repository administrator to enable GitHub Advanced Security.<br>4. Under 'Get started with code scanning', click Set up this workflow on the CodeQL analysis workflow or on a third-party workflow.<br>5.To customize how code scanning scans your code, edit the workflow.<br>6. Use the Start commit drop-down, and type a commit message.<br>7. Click Commit new file or Propose new file",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Dependabot scanning in GitHub repositories is a crucial security feature that alerts users to vulnerabilities in code dependencies.<br> These vulnerabilities can compromise the confidentiality, integrity, or availability of the project or other projects that use its code.<br> If Dependabot scanning is not enabled, these vulnerabilities may go unnoticed, potentially leading to severe security breaches.<br> Therefore, it is highly recommend to enable Dependabot scanning to maintain a secure codebase.<br>",
    "displayName": "GitHub repositories should have Dependabot scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/401f9e0b-56f1-4750-bc90-ed8ae093529d",
    "implementationEffort": "Low",
    "name": "401f9e0b-56f1-4750-bc90-ed8ae093529d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "1. Browse to a GitHub repository.<br>2. Click on the Settings.<br>3. Click 'Security & analysis'.<br>4. Enable Dependabot alerts",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Secret scanning scans the entire Git history across all branches for any accidentally committed secrets, such as tokens and private keys used for authentication.<br> If these secrets are exposed in a repository, anyone with read access can potentially misuse them to access external services.<br> Therefore, we recommend enabling secret scanning and storing secrets in a secure location outside the project repository to prevent unauthorized access and potential fraudulent activities.<br>",
    "displayName": "GitHub repositories should have secret scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d9c8a59d-da37-494b-81fa-235f0855cee9",
    "implementationEffort": "Low",
    "name": "d9c8a59d-da37-494b-81fa-235f0855cee9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/05/2023"
    },
    "remediationDescription": "1. On GitHub.com, navigate to the main page of the repository.<br>2. Under your repository name, click  Settings.<br>3.In the left sidebar, click Security and analysis.<br>4. If Advanced Security is not already enabled for the repository, to the right of GitHub Advanced Security, click Enable.<br>5. Review the impact of enabling Advanced Security, then click Enable GitHub Advanced Security for this repository.<br>6. When you enable Advanced Security, secret scanning may automatically be enabled for the repository due to the organization's settings. If Secret scanning is shown with an Enable button, you still need to enable secret scanning by clicking Enable. If you see a Disable button, secret scanning is already enabled",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "GitHub's code scanning feature is a powerful tool for identifying security vulnerabilities and errors in code.<br> It allows for the detection, triage, and prioritization of fixes for existing issues, and can help prevent the introduction of new ones.<br> Scans can be scheduled or triggered by specific repository events.<br> If a potential vulnerability is found, an alert is displayed in the repository.<br> Without this feature enabled, projects may be at risk of exploitation, potentially compromising the confidentiality, integrity, or availability of the project.<br>",
    "displayName": "GitHub repositories should have code scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5a2b692f-9ccc-4519-b6bd-47125dd51884",
    "implementationEffort": "Low",
    "name": "5a2b692f-9ccc-4519-b6bd-47125dd51884",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "1. On GitHub.com, navigate to the main page of the repository.<br>2. Under your repository name, click  Security.<br>3. To the right of Code scanning alerts, click Set up code scanning. If code scanning is missing, you need to ask an organization owner or repository administrator to enable GitHub Advanced Security.<br>4. Under 'Get started with code scanning', click Set up this workflow on the CodeQL analysis workflow or on a third-party workflow.<br>5.To customize how code scanning scans your code, edit the workflow.<br>6. Use the Start commit drop-down, and type a commit message.<br>7. Click Commit new file or Propose new file",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Dependabot scanning in GitHub repositories is a crucial security feature that alerts users to vulnerabilities in code dependencies.<br> These vulnerabilities can compromise the confidentiality, integrity, or availability of the project or other projects that use its code.<br> If Dependabot scanning is not enabled, these vulnerabilities may go unnoticed, potentially leading to severe security breaches.<br> Therefore, it is highly recommend to enable Dependabot scanning to maintain a secure codebase.<br>",
    "displayName": "GitHub repositories should have Dependabot scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c64e7cfb-6d64-4227-8c23-b4fa5c72957b",
    "implementationEffort": "Low",
    "name": "c64e7cfb-6d64-4227-8c23-b4fa5c72957b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "1. Browse to a GitHub repository.<br>2. Click on the Settings.<br>3. Click 'Security & analysis'.<br>4. Enable Dependabot alerts",
    "severity": "Medium",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Secret scanning scans the entire Git history across all branches for any accidentally committed secrets, such as tokens and private keys used for authentication.<br> If these secrets are exposed in a repository, anyone with read access can potentially misuse them to access external services.<br> Therefore, we recommend enabling secret scanning and storing secrets in a secure location outside the project repository to prevent unauthorized access and potential fraudulent activities.<br>",
    "displayName": "GitHub repositories should have secret scanning enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b6ad173c-0cc6-4d44-b954-8217c8837a8e",
    "implementationEffort": "Low",
    "name": "b6ad173c-0cc6-4d44-b954-8217c8837a8e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "19/06/2023"
    },
    "remediationDescription": "1. On GitHub.com, navigate to the main page of the repository.<br>2. Under your repository name, click  Settings.<br>3.In the left sidebar, click Security and analysis.<br>4. If Advanced Security is not already enabled for the repository, to the right of GitHub Advanced Security, click Enable.<br>5. Review the impact of enabling Advanced Security, then click Enable GitHub Advanced Security for this repository.<br>6. When you enable Advanced Security, secret scanning may automatically be enabled for the repository due to the organization's settings. If Secret scanning is shown with an Enable button, you still need to enable secret scanning by clicking Enable. If you see a Disable button, secret scanning is already enabled",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure Pipelines should be configured to prevent access to build pipeline secrets during builds of forked repositories.<br> This is to prevent unauthorized individuals from gaining access to sensitive information.<br> If this setting is not properly configured, individuals outside the organization could potentially create forks, run builds, and gain access to internal secrets, posing a significant security risk.<br>",
    "displayName": "Azure Pipelines should not have secrets available to builds of forks",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d5711372-9b5f-4926-a711-13dcf51565a6",
    "implementationEffort": "Low",
    "name": "d5711372-9b5f-4926-a711-13dcf51565a6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "Follow the steps below to disable making secrets available to builds of forked repositories: <br>1. Navigate to the identified pipeline that provides secrets to fork builds.<br>2. On the landing page for the pipeline, click 'Edit' to open at the pipeline configuration.<br>3. On the configuration page, navigate to 'Triggers'.<br>4. Under 'Pull request validation', uncheck the option 'Make secrets available to builds of forks'.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Credential Access"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enabling GitHub Advanced Security for Azure DevOps (GHAzDO) in Azure DevOps repositories is a crucial step in securing applications and resources.<br> This feature provides insights about secrets, dependencies, and code vulnerabilities in your repositories, which are then surfaced in Microsoft Defender for Cloud.<br> Without this, potential vulnerabilities may go unnoticed, leading to potential security breaches.<br> Therefore, it is highly recommend to enable GHAzDO for a more secure and robust defense system.<br>",
    "displayName": " Azure DevOps repositories should have GitHub Advanced Security for Azure DevOps (GHAzDO) enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c7a934bf-7be6-407a-84d9-4f20e6e49592",
    "implementationEffort": "Low",
    "name": "c7a934bf-7be6-407a-84d9-4f20e6e49592",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "08/17/2023"
    },
    "remediationDescription": "Manual remediation: To enable this plan on all Azure DevOps resources: <br>1. Go to your Project settings for your Azure DevOps project. <br>2. Select Repos > Repositories.<br>3. Select the repository you want to enable Advanced Security for.<br>4. Select Enable and Begin billing to activate Advanced Security. A shield icon now appears in the repository view for any repository with Advanced Security enabled.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Defense Evasion"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "MissingCoverage",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Secure files in Azure DevOps, typically used to store sensitive information like signing certificates and SSH keys, should not be accessible to all pipelines.<br>\nGranting universal access can lead to potential security risks, as an unauthorized user could build a YAML pipeline to access and steal information from these secure files.<br>\nTo prevent this, we recommend to restrict access to secure files to only those pipelines that require it, thereby reducing the risk of unauthorized access and information theft.<br>",
    "displayName": "Azure DevOps secure files should not grant access to all pipelines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6855e9b1-c493-4a43-a6d1-74f30e72c5af",
    "implementationEffort": "Low",
    "name": "6855e9b1-c493-4a43-a6d1-74f30e72c5af",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the secure file.<br>2. Click 'Pipeline Permissions'.<br>3. Click 'Restrict Permission' and explicitly add YAML pipelines that need access.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Service connections in Azure DevOps are used to link Azure Pipelines to external and remote systems, allowing tasks to be executed within a job.<br> However, it's not advisable to allow these service connections access to all YAML pipelines.<br> This is because if a threat actor gains access to a pipeline, they could easily move laterally to the connected service.<br> To prevent this, follow the principle of least privilege and limit the pipelines that can access a service connection.<br>",
    "displayName": "Azure DevOps service connections should not grant access to all pipelines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9245366d-393f-49c5-b8e6-258b1b1c2daa",
    "implementationEffort": "Low",
    "name": "9245366d-393f-49c5-b8e6-258b1b1c2daa",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "Follow the steps below to remove all pipeline access to a Service Connection and limit it to only the pipelines that need access.<br>1. Navigate to the service connections settings page for your project.<br>2. Select your service connection from the list.<br>3. Click on the overflow menu (three dots on the top right-hand side of the page) for additional options.<br>4. Click Security <br>5. Under 'Pipeline Permissions', click 'Restrict Permission' to avoid granting access to all YAML pipelines and add only those YAML pipelines that need explicit access on service connection.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To access subscriptions, use Azure Resource Manager (ARM) service connections instead of Azure Classic service connections.<br> The ARM model provides several security enhancements such as stronger access control, improved auditing, ARM-based deployment/governance, access to managed identities and key vault for secrets, Entra ID-based authentication, and support for tags and resource groups.<br> If the Azure Classic service connection is not replaced, it could lead to weaker access control and auditing.<br> The only way to implement this recommendation is to delete the existing Azure Classic service connection, which will then no longer be assessed by Defender for Cloud.<br>",
    "displayName": "Azure DevOps Classic Azure service connections should not be used to access a subscription",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a887e860-40ff-4b57-9ef9-5177a11091ac",
    "implementationEffort": "Low",
    "name": "a887e860-40ff-4b57-9ef9-5177a11091ac",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Create New service connection, select the type 'Azure Resource Manager' service connection (do not use the Azure Classic service connection type as it is deprecated).<br>2. Choose an authentication method (Workload Identity federation is recommended).<br>3. Enter the parameters for the service connection. The list of parameters differs for each type of Service Connection.<br>4. Review the 'Security' section of the existing Azure Classic Service Connection and if required, replicate the 'User permissions', 'Pipeline permissions', and 'Project permissions' on the new service connection. Ensure explicit access is provisioned to avoid granting access to all pipelines.<br>5. Review the existing Azure Classic service connection usage history and ensure the pipeline users are notified of the new service connection.<br>6. After informing users of the new Service Connection with a set date for end of life and updating all pipelines with the latest service connection, delete the Azure Classic service connection.",
    "severity": "Medium",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Variable groups in Azure DevOps, which store sensitive information, should not grant access to all pipelines.<br> These groups are used to pass sensitive data into a YAML pipeline or make it available across multiple pipelines.<br> If access is granted to all pipelines, an attacker could potentially exploit the secret variables by creating a new pipeline.<br> This could lead to unauthorized access to sensitive data.<br> Therefore, it's crucial to restrict access to these variable groups to prevent potential security breaches.<br>",
    "displayName": "Azure DevOps variable groups with secret variables should not grant access to all pipelines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2c2c801e-6279-4d88-a419-af73f0eff4fb",
    "implementationEffort": "Low",
    "name": "2c2c801e-6279-4d88-a419-af73f0eff4fb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the variable group.<br>2. Click on 'Pipeline permissions'.<br>3. Click on 'Restrict permission' and explicitly add YAML pipelines that need access.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Implementing protection policies for the default branch in GitHub repositories is important to prevent unintended or malicious changes from being directly committed.<br> These policies act as safeguards, ensuring that changes are reviewed and approved before they are merged.<br> Without such protections, the repository is at risk of unauthorized modifications, which could lead to system instability or security vulnerabilities.<br> Therefore, it's crucial to enable these policies for enhanced security and control over code changes.<br>",
    "displayName": "GitHub repositories should have protection policies for default branch enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/17f3ad34-4f87-4463-a11d-6c6d7a84c486",
    "implementationEffort": "Low",
    "name": "17f3ad34-4f87-4463-a11d-6c6d7a84c486",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the unhealthy Repository.<br>2. Select 'Settings'.<br>3. Open 'Branches' from the Settings page.<br>4. Select 'Add branch protection rule' and add the default branch to the 'Branch name pattern' field.<br>5. Configure protection settings as required by organizational requirements.",
    "severity": "High",
    "tactics": [
      "Execution",
      "Impact"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "The default branch in GitHub repositories is often used for deployment and other privileged activities, making it a critical component.<br> Enabling force pushes can lead to unintended or even malicious changes to this branch.<br> Therefore, we recommend disabling force pushes to the default branch to prevent potential disruptions or compromises in the repository's integrity and security.<br>",
    "displayName": "GitHub repositories should have force pushes to default branch disabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/909d299a-1736-456d-aef5-63688b230bfd",
    "implementationEffort": "Low",
    "name": "909d299a-1736-456d-aef5-63688b230bfd",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the unhealthy Repository.<br>2. Select 'Settings'.<br>3. Open 'Branches' from the Settings page.<br>4. Open the configured branch protection rule.<br>5. Within the branch protection rule settings, deselect 'Allow force pushes' within the 'Rules applied to everyone including administrators' section.",
    "severity": "Medium",
    "tactics": [
      "Execution",
      "Impact"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Secret scanning push protection in GitHub organizations is a security measure that prevents the accidental exposure of secrets by blocking commits containing them.<br> If this feature is not enabled, there's a risk of credential exposure which could lead to unauthorized access or data breaches.<br> Therefore, we recommend to automatically enable push protection for every repository where secret scanning is enabled to maintain a secure coding environment.<br>",
    "displayName": "GitHub organizations should have secret scanning push protection enabled",
    "id": "/providers/Microsoft.Security/assessmentMetadata/90901cb2-c497-4389-b63a-d3a562e15847",
    "implementationEffort": "Low",
    "name": "90901cb2-c497-4389-b63a-d3a562e15847",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the unhealthy Organization.<br>2. Select 'Settings'.<br>3. Click on 'Code security and analysis'.<br>4. If secret scanning is not enabled, select 'Enable all'.<br>5. Under Push protection, select 'Automatically enable for repositories added to secret scanning'.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation",
      "Credential Access"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Self-Hosted Runners on GitHub pose a security risk as they do not operate in ephemeral clean virtual machines and can be persistently compromised by untrusted code in a workflow.<br>\nThis means that if they are used for action workflows, they could potentially be exploited by malicious actors, leading to unauthorized access or data breaches.<br>\nTherefore, we recommend to avoid using Self-Hosted Runners for GitHub repositories to maintain a secure environment.<br>",
    "displayName": "GitHub repositories should not use self hosted runners",
    "id": "/providers/Microsoft.Security/assessmentMetadata/bd041c7b-95db-4aaf-8bc4-fd9875ecdddf",
    "implementationEffort": "Low",
    "name": "bd041c7b-95db-4aaf-8bc4-fd9875ecdddf",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the unhealthy Repository.<br>2. Select 'Settings'.<br>3. Click on 'Actions'.<br>4. Open 'Runners' from the dropdown menu.<br>5. Remove the self-hosted runners.",
    "severity": "High",
    "tactics": [
      "Execution",
      "Impact"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "This is to prevent potential exploitation by malicious users who could take advantage of over-permissioned workflows to access and tamper with resources.<br> If this is not done, it could lead to unauthorized access and potential manipulation of your resources, compromising the integrity and security of your organization's data and systems.<br>",
    "displayName": "GitHub organizations should have actions workflow permissions set to read-only",
    "id": "/providers/Microsoft.Security/assessmentMetadata/48f93272-e99c-47be-8087-091c71be9897",
    "implementationEffort": "Low",
    "name": "48f93272-e99c-47be-8087-091c71be9897",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the unhealthy Organization.<br>2. Select 'Settings'.<br>3. Click on 'Actions'.<br>4. Open 'General' from the dropdown menu.<br>5. Under Workflow permissions, choose 'Read repository contents and package permissions' and click 'Save'.",
    "severity": "High",
    "tactics": [
      "Execution",
      "Lateral Movement"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To reduce the risk of losing admin access and ensure continuity in case of emergencies, we recommend having more than one person with administrator permissions in GitHub organizations.<br> Such break-glass accounts can help avoid potential disruptions in access and operations, especially in critical situations where immediate admin intervention is required.<br>",
    "displayName": "GitHub organizations should have more than one person with administrator permissions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2815b95f-f872-4d51-9709-54c1c7133d7b",
    "implementationEffort": "Low",
    "name": "2815b95f-f872-4d51-9709-54c1c7133d7b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Go to Organization <br>2. Go to People tab <br>3. In the left pane, choose 'Members' under 'Organization permissions' <br>4.  Ensure that there are atleast 2 users with 'owner' role assigned.",
    "severity": "High",
    "tactics": [],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "We recommend setting base permissions to none or read for GitHub organizations.<br> This is in accordance with the principle of least privilege which dictates restricting access rights for users to the bare minimum needed to perform their work.<br> If base permissions are not properly set, it could lead to unnecessary access, potentially resulting in unauthorized changes or data breaches.<br>",
    "displayName": "GitHub organizations should have base permissions set to no permissions or read",
    "id": "/providers/Microsoft.Security/assessmentMetadata/497e771e-d309-4e36-9bbd-353defd2658a",
    "implementationEffort": "Low",
    "name": "497e771e-d309-4e36-9bbd-353defd2658a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/15/2023",
      "public": "09/12/2023"
    },
    "remediationDescription": "1. Navigate to the unhealthy Organization.<br>2. Select 'Settings'.<br>3. Open 'Member privileges'.<br>4. Under Base permissions, set organization member permissions to 'No permission' or 'Read'.<br>5. Save the changes.",
    "severity": "High",
    "tactics": [
      "Lateral Movement",
      "Impact"
    ],
    "techniques": [],
    "threats": [
      "DataExfiltration",
      "MissingCoverage",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "For secrets used in GitHub Action workflows that are stored at the GitHub organization-level, you can use access policies to control which repositories can use organization secrets. Organization-level secrets let you share secrets between multiple repositories, which reduces the need for creating duplicate secrets. However, once a secret is made accessible to a repository, anyone with write access on repository can access the secret from any branch in a workflow. To reduce the attack surface, ensure that the secret is accessible from selected repositories only.<br>",
    "displayName": "GitHub organizations should not make action secrets accessible to all repositories",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6331fad3-a7a2-497d-b616-52672057e0f3",
    "implementationEffort": "Low",
    "name": "6331fad3-a7a2-497d-b616-52672057e0f3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/26/2024"
    },
    "remediationDescription": "1. In GitHub, navigate to the affected Organization.<br>2. Select Settings.<br>3. Under the Security section within the navigation menu, expand Secrets and variables and click Actions.<br>4. For each Organization secret, ensure that the visibility is set to Selected repositories",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To prevent unintended or malicious changes from being directly committed, it's important to implement protection policies for the default branch in Azure DevOps repositories. We recommend requiring at least two code reviewers to approve pull requests before the code is merged with the default branch. By requiring approval from a minimum number of two reviewers, you can reduce the risk of unauthorized modifications, which could lead to system instability or security vulnerabilities.<br>",
    "displayName": "Azure DevOps repositories should require minimum two-reviewer approval for code pushes",
    "id": "/providers/Microsoft.Security/assessmentMetadata/470742ea-324a-406c-b91f-fc1da6a27c0c",
    "implementationEffort": "Low",
    "name": "470742ea-324a-406c-b91f-fc1da6a27c0c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "05/26/2024"
    },
    "remediationDescription": "1. In Azure DevOps, navigate to 'Project settings' at the bottom left of the page.<br>2. In Project Settings, select 'Repositories' under 'Repos'.<br>3. Choose the repository you want to apply the policy to.<br>4. Scrool down to 'Branch Policies'.<br>5. Find the default branch (often 'main' or 'master') and click on the ellipsis (...) next to it, then select 'Branch policies'.<br>6. In the branch policies section, find and click on 'Add policy' or locate the 'Minimum number of reviewers' setting if it's already there.<br>7. Toggle 'Require a minimum number of reviewers' to On.<br>8. Enter a value of 2 or more in the 'Minimum number of reviewers' field.",
    "severity": "High",
    "tactics": [
      "Execution"
    ],
    "techniques": [
      "Scheduled Task/Job"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To prevent unintended or malicious changes from being directly committed, it's important to implement protection policies for the default branch in Azure DevOps repositories. We recommend prohibiting pull request creators from approving their own submissions to ensure that every change undergoes objective review by someone other than the author. By doing this, you can reduce the risk of unauthorized modifications, which could lead to system instability or security vulnerabilities.<br>",
    "displayName": "Azure DevOps repositories should not allow requestors to approve their own Pull Requests",
    "id": "/providers/Microsoft.Security/assessmentMetadata/98b5895a-0ad8-4ed9-8c9d-d654f5bda816",
    "implementationEffort": "Low",
    "name": "98b5895a-0ad8-4ed9-8c9d-d654f5bda816",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/26/2024"
    },
    "remediationDescription": "1. In Azure DevOps, navigate to 'Project settings' at the bottom left of the page.<br>2. In Project Settings, select 'Repositories' under 'Repos'.<br>3. Choose the repository you want to apply the policy to.<br>4. Scroll down to 'Branch Policies'.<br>5. Select the default branch (often 'main' or 'master').<br>6. If \"Require a minimum number of reviewers\" is not enabled, toggle it to On.<br>7. If \"Require a minimum number of reviewers\" is enabled, unselect \"Allow requestors to approve their own changes\" to block a Pull Request's creator to vote on its approval.",
    "severity": "High",
    "tactics": [
      "Execution"
    ],
    "techniques": [
      "Scheduled Task/Job"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Disabling the creation of classic build and release pipelines prevents a security concern that stems from YAML and classic pipelines sharing the same resources, for example the same service connections. Potential attackers can leverage classic pipelines to create processes that evade typical defense mechanisms set up around modern YAML pipelines.",
    "displayName": "Azure DevOps projects should have creation of classic pipelines disabled.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9f4a17ee-7a02-4978-b968-8c36b74ac8e3",
    "implementationEffort": "Low",
    "name": "9f4a17ee-7a02-4978-b968-8c36b74ac8e3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "07/15/2024"
    },
    "remediationDescription": "1. In Azure DevOps, navigate to \"Project settings\" at the bottom left of the page.<br>2. In Project Settings, select \"Settings\" under \"Pipelines\".<br>3. Under General, toggle \"Disable creation of classic build pipelines\" and \"Disable creation of classic release pipelines\" to off. ",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enabling GitHub Copilot's filter to block code suggestions matching public code on GitHub enhances security and legal compliance. It prevents the unintentional incorporation of public or open-source code, reducing the risk of legal issues and ensuring adherence to licensing terms. Additionally, it helps avoid introducing potential vulnerabilities from public code into the organization's projects, thereby maintaining higher code quality and security. When the filter is enabled, GitHub Copilot checks code suggestions with their surrounding code of about 150 characters against public code on GitHub. If there is a match or near match, the suggestion will not be shown.",
    "displayName": "GitHub organizations should block Copilot suggestions that match public code.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/98e858ed-6e88-4698-b538-f51b31ad57f6",
    "implementationEffort": "Low",
    "name": "98e858ed-6e88-4698-b538-f51b31ad57f6",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "07/15/2024"
    },
    "remediationDescription": "1. In the affected GitHub organization, navigate to \"Settings\" <br> 2. In the \"Code, planning, and automation\" section, expand \"Copilot\" and select \"Policies\" <br>3. Next to \"Suggestions matching public code,\" click the dropdown menu and select \"Blocked\"",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Persistence"
    ],
    "techniques": [
      "Supply Chain Compromise",
      "Process Injection"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Enforcing multifactor authentication for outside collaborators in a GitHub organization is a security measure that requires collaborators to use an additional form of identification besides their password to access the organization's repositories and resources. This enhances security by protecting against unauthorized access, even if a password is compromised, and helps ensure compliance with industry standards. It involves informing collaborators about the requirement and providing support for the transition, ultimately reducing the risk of data breaches.",
    "displayName": "GitHub organizations should enforce multifactor authentication for outside collaborators",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a9621d26-9d8c-4cd6-8ad0-84501eb88f17",
    "implementationEffort": "Low",
    "name": "a9621d26-9d8c-4cd6-8ad0-84501eb88f17",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "07/15/2024"
    },
    "remediationDescription": "1. In the affected GitHub organization, navigate to \"People\" <br>2.Under \"Organization permissions\", select \"Outside collaborators\" from the left menu. <br>3. Enter the following filter in the \"Find a collaborator...\" search bar: two-factor:disabled. <br>4. Ask the users filtered to enable 2FA or remove them from the organization.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Credential Access"
    ],
    "techniques": [
      "Valid Accounts",
      "Brute Force"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "To prevent unintended or malicious changes from being directly committed, it's important to implement protection policies for the default branch in Github repositories. We recommend requiring at least two code reviewers to approve pull requests before the code is merged with the default branch. By requiring approval from a minimum number of two reviewers, you can reduce the risk of unauthorized modifications, which could lead to system instability or security vulnerabilities.",
    "displayName": "GitHub repositories should require minimum two-reviewer approval for code pushes.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/20be7df7-9ebb-4fb4-95a9-3ae19b78b80a",
    "implementationEffort": "Low",
    "name": "20be7df7-9ebb-4fb4-95a9-3ae19b78b80a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "07/15/2024"
    },
    "remediationDescription": "1. In the affected GitHub repository, navigate to \"Settings\" <br>2. Select \"Branches\" under the \"Code and automatic\" category in the left menu. <br>3. Create a new branch ruleset or edit an existing one. <br>4. Ensure that the setting called \"Require a pull request before merging\" is enabled. <br>5. Set the number of required approvers to two or more.",
    "severity": "High",
    "tactics": [
      "Execution"
    ],
    "techniques": [
      "Scheduled Task/Job"
    ],
    "threats": [],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud identified that an Azure DevOps organization in your environment is not connected to Defender for Cloud. Without this connection, critical security insights and automated risk assessments cannot be performed on your Azure DevOps resources. This poses a risk of undetected vulnerabilities, misconfigurations, and insecure DevOps practices, which could lead to compromised applications and infrastructure. Connecting your Azure DevOps organization to Defender for Cloud enables proactive monitoring and secure development workflows.",
    "displayName": "Azure DevOps organizations that deploy cloud resources should be onboarded to Defender for Cloud",
    "id": "/providers/Microsoft.Security/assessmentMetadata/83071a7c-5053-46b4-9b96-26a8b6d5c6dc",
    "implementationEffort": "Low",
    "name": "83071a7c-5053-46b4-9b96-26a8b6d5c6dc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/01/2025"
    },
    "remediationDescription": "To connect your Azure DevOps organization to Defender for Cloud: \n1. Within Defender for Cloud, navigate to \"Environment settings\".\n2. Click \"Add environment\" and select \"Azure DevOps\" in the dropdown. 3. Follow the prompts to grant Defender for Cloud the required access to your Azure DevOps organization. 4. Once the connection is established, ensure the necessary security recommendations are reviewed and implemented.",
    "severity": "Medium",
    "tactics": [
      "Execution"
    ],
    "techniques": [
      "Scheduled Task/Job"
    ],
    "threats": [
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud identified that a GitHub organization in your environment is not connected to Defender for Cloud. Without this connection, critical security insights and automated risk assessments cannot be performed on your GitHub resources. This poses a risk of undetected vulnerabilities, misconfigurations, and insecure DevOps practices, which could lead to compromised applications and infrastructure. Connecting your GitHub organization to Defender for Cloud enables proactive monitoring and secure development workflows",
    "displayName": "GitHub organizations that deploy cloud resources should be onboarded to Defender for Cloud",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6911f39c-8ede-4034-ba8c-2696c4efdbec",
    "implementationEffort": "Low",
    "name": "6911f39c-8ede-4034-ba8c-2696c4efdbec",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "09/01/2025"
    },
    "remediationDescription": "To connect your Azure DevOps organization to Defender for Cloud: 1. Within Defender for Cloud, navigate to \"Environment settings\". 2. Click \"Add environment\" and select \"Azure DevOps\" in the dropdown. 3. Follow the prompts to grant Defender for Cloud the required access to your Azure DevOps organization. 4. Once the connection is established, ensure the necessary security recommendations are reviewed and implemented. ",
    "severity": "Medium",
    "tactics": [
      "Execution"
    ],
    "techniques": [
      "Scheduled Task/Job"
    ],
    "threats": [
      "MaliciousInsider",
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "High"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Amazon Bedrock VPC endpoint powered by AWS PrivateLink, allows you to establish a private connection between the VPC in your account and the Amazon Bedrock service account. AWS PrivateLink enables VPC instances to communicate with Bedrock service resources, without the need for public IP addresses, reducing the risks associated with exposing data to the public internet and thereby helping with your compliance requirements.",
    "displayName": "AWS Bedrock should use AWS PrivateLink",
    "id": "/providers/Microsoft.Security/assessmentMetadata/dd55620f-09f2-4d4b-9d6b-adcee7479a64",
    "implementationEffort": "Low",
    "name": "dd55620f-09f2-4d4b-9d6b-adcee7479a64",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "30/06/2024"
    },
    "remediationDescription": "To secure communications with AWS PrivateLink, follow the instructions here: <a href=\"https://aws.amazon.com/blogs/machine-learning/use-aws-privatelink-to-set-up-private-access-to-amazon-bedrock/\" target=\"_blank\">https://aws.amazon.com/blogs/machine-learning/use-aws-privatelink-to-set-up-private-access-to-amazon-bedrock/</a>",
    "severity": "Medium",
    "tactics": [
      "Discovery",
      "Initial Access"
    ],
    "techniques": [
      "Network Sniffing",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Guardrails for Amazon Bedrock enhance the safety of generative AI applications by evaluating both user inputs and model-generated responses. These guardrails include content filters, which help detect and filter harmful content. Specifically, the \"Prompt Attacks\" category that includes safeguards on user prompts to prevent jailbreaks and prompt injections. Learn more at: <a href='https://aws.amazon.com/bedrock/guardrails/' target=\"_blank\">Content filters - Amazon Bedrock</a>.",
    "displayName": "AWS Bedrock agents should use guardrails when allowing access to generative AI applications",
    "id": "/providers/Microsoft.Security/assessmentMetadata/7c0c3e91-b674-40d1-8fc4-1bc3c70533e4",
    "implementationEffort": "Low",
    "name": "7c0c3e91-b674-40d1-8fc4-1bc3c70533e4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": null,
      "public": "07/08/2024"
    },
    "remediationDescription": "Manual Remediation: to enable and attach a guardrail to your AWS Bedrock agent: <br> <ol> <li>Step 1- Create a guardrail: <ol> <li>You can create a new guardrail either via Amazon API, or the AWS console. <ol> <li>Option 1- Via AWS Bedrock console: <ol> <li>From the left side bar click \"Guardrails\", and select \"Create guardrail\".</li> <li>Provide your guardrail details, and under \"Configure content filter\", toggle \"Enable filters for prompts\" and set \"Prompt attacks\" to high.</li> <li>Save your guardrail.</li> </ol> </li> <li>Option 2- Via Amazon API: <ol> <li>Follow the steps described here: <a href='https://docs.aws.amazon.com/bedrock/latest/APIReference/API_CreateGuardrail' target=\"_blank\">Create a guardrail - Amazon Bedrock</a></li> <li>Make sure to enable Prompt attack content filter to High.</li> </ol> </li> </ol> </li> </ol> </li> <li>Step 2- Attach the guardrail to your agent: <ol> <li>You can attach the guardrail to your agent either via AWS Bedrock console or Amazon API. <ol> <li>Option 1- Via AWS Bedrock console: <ol> <li>From your AWS account, open Amazon Bedrock Service.</li> <li>From the upper right bar, select the relevant region.</li> <li>From the left side bar, select \"Agents\", choose the agent you used for your generative AI app and click \"Edit in Agent Builder\".</li> <li>Select \"Guardrail details\" and click Edit.</li> <li>Choose the guardrail you created in Step 1 and save your changes.</li> </ol> </li> <li>Option 2- Via Amazon API: <ol> <li>Follow the instructions detailed here: <a href='https://docs.aws.amazon.com/bedrock/latest/userguide/guardrails-use' target=\"_blank\">Use a guardrail to filter and block content - Amazon Bedrock</a></li> </ol> </li> </ol> </li> </ol> </li> </ol>",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud identified that Application insights is not configured in Azure AI Foundry. The AI Foundry uses Azure Application Insights to store monitoring information about your deployed models. This poses a risk of delayed threat detection and ineffective incident response.",
    "displayName": "Application Insights should be used on Azure AI Foundry",
    "id": "/providers/Microsoft.Security/assessmentMetadata/44879142-bf14-47b1-aeb1-484c7d2b7ff3",
    "implementationEffort": "Low",
    "name": "44879142-bf14-47b1-aeb1-484c7d2b7ff3",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/03/2025"
    },
    "remediationDescription": "To configure Azure Application Insights in AI Foundry hub:<br><br> 1. In the Azure portal, navigate to your AI Foundry hub. <br>2. From the menu open the <b>\"Properties\"</b> page. <br>3. Under Application insights select <b>\"Change Application Insights\"</b>.<br><br>Learn more at: <a href=\"https://aka.ms/AI-hub/update-application-insights\" rel=\"noopener noreferrer\" target=\"_blank\" aria-label=\"https://aka.ms/AI-hub/update-application-insights (Opens in new window or tab)\">https://aka.ms/AI-hub/update-application-insights</a>.",
    "severity": "Medium",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud identified that Microsoft-managed keys are used to encrypt data in Azure AI Foundry. This poses a risk of not complying with regulations for organizations with related compliance requirements. Using customer-managed keys (CMK) to encrypt data at rest provides more control over the key lifecycle, including rotation and management, and is often required to meet compliance standards. This is not assessed by default and should only be applied when required by compliance or restrictive policy requirements. If not enabled, the data will be encrypted using Microsoft-managed keys. To implement this recommendation, update the 'Effect' parameter in the Security Policy for the applicable scope.",
    "displayName": "[Enable if required] Customer-managed keys should be used to encrypt data on Azure AI Foundry",
    "id": "/providers/Microsoft.Security/assessmentMetadata/300c35c8-65ef-413a-b2ab-e79e14028157",
    "implementationEffort": "Low",
    "name": "300c35c8-65ef-413a-b2ab-e79e14028157",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/03/2025"
    },
    "remediationDescription": "To enable customer-managed keys on an Azure AI Foundry hub, create an encryption key in Azure Key Vault then pass the key identifier when creating the AI foundry hub. For details, see <a href=\"https://aka.ms/AI-hub/CMK\" rel=\"noopener noreferrer\" target=\"_blank\" aria-label=\"https://aka.ms/AI-hub/CMK (Opens in new window or tab)\">https://aka.ms/AI-hub/CMK</a>.",
    "severity": "Medium",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud identified Credential-based access when connecting to the default storage account in Azure AI Foundry. This poses a risk of unauthorized access. To reduce the risk of unauthorized access, you should disable key-based authorization, and instead use Microsoft Entra ID.",
    "displayName": "Microsoft Entra ID should be used when connecting Azure AI Foundry to default storage account",
    "id": "/providers/Microsoft.Security/assessmentMetadata/25b585f2-7690-4f62-af6b-106a9cf9dae4",
    "implementationEffort": "Low",
    "name": "25b585f2-7690-4f62-af6b-106a9cf9dae4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/03/2025"
    },
    "remediationDescription": "To configure identity-based access when connecting to the default storage account:<br><br> 1. In the Azure portal, navigate to your AI Foundry hub. <br>2. From the menu open the <b>\"Properties\"</b> page. <br>3. Under Storage account access select <b>\"Identity-based access\"</b><br><br>Learn more at: <a href=\"https://aka.ms/AI-Hub/disable-shared-key-access\" rel=\"noopener noreferrer\" target=\"_blank\" aria-label=\"https://aka.ms/AI-Hub/disable-shared-key-access (Opens in new window or tab)\">https://aka.ms/AI-Hub/disable-shared-key-access</a>.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud identified Credential-based access when connecting to the storage account in Azure AI Foundry project. This poses a risk of unauthorized access. To reduce the risk of unauthorized access, you should disable key-based authorization, and instead use Microsoft Entra ID.",
    "displayName": "Microsoft Entra ID should be used when connecting to data stores on Azure AI Foundry project",
    "id": "/providers/Microsoft.Security/assessmentMetadata/c497a383-1bb2-4867-b43f-bce09a86655a",
    "implementationEffort": "Low",
    "name": "c497a383-1bb2-4867-b43f-bce09a86655a",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/03/2025"
    },
    "remediationDescription": "To configure identity-based access when connecting to data stores in AI Foundry project: <br><br>1. In the Azure portal, navigate to your AI Foundry project. <br>2. From the menu open the <b>\"Overview\"</b> page. <br>3. Under \"Start building in Azure AI Foundry\" select <b>\"Launch studio\"</b>. <br>4. From the \"Overview\" page under \"Manage project settings\" select <b>\"Open in management center\"</b>. <br>5. From the \"Connected resources\" page select connected data resources that the authentication type is Credential based. <br>6. From the \"Access details\" click on the <b>edit</b> icon. <br>7. From the \"Update custom shared connection\" page change the Authentication method to <b>\"Microsoft Entra ID based\"</b> <br><br>Learn more at: <a href=\"https://aka.ms/AI-Hub/add-data-connection\" rel=\"noopener noreferrer\" target=\"_blank\" aria-label=\"https://aka.ms/AI-Hub/add-data-connection (Opens in new window or tab)\">https://aka.ms/AI-Hub/add-data-connection</a>.",
    "severity": "High",
    "tactics": [
      "Credential Access"
    ],
    "techniques": [
      "Unsecured Credentials"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud identified public network access enabled for all networks in Azure AI Foundry. This poses a risk of exposure to external threats and can result in unauthorized access and data breaches. By restricting network access, you can ensure that only allowed networks can access the service.",
    "displayName": "Network connections should be limited on Azure AI Foundry",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f6405440-5b60-46a7-bcbf-dfdd43d27289",
    "implementationEffort": "Low",
    "name": "f6405440-5b60-46a7-bcbf-dfdd43d27289",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "19/03/2025"
    },
    "remediationDescription": "To disable public network access in Azure AI Foundry hub: <br><br>1. In the Azure portal, navigate to your AI Foundry hub. <br>2. From the menu open the <b>\"Networking\"</b> page. <br>3. Under \"public access\" configure Public Network access to be <b>\"Disabled\"</b><br><br>Learn more at: <a href=\"https://aka.ms/AI-Hub/create-secure-ai-hub\" rel=\"noopener noreferrer\" target=\"_blank\" aria-label=\"https://aka.ms/AI-Hub/create-secure-ai-hub (Opens in new window or tab)\">https://aka.ms/AI-Hub/create-secure-ai-hub</a>.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Exploit Public-Facing Application"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud has identified that Cloud Monitoring is not enabled on the GCP Workbench instance.<br><br>Enabling Cloud Monitoring for Google Cloud Vertex AI notebook instances is essential for tracking performance metrics, detecting issues early, and ensuring optimal operation through proactive monitoring and alerts",
    "displayName": "Cloud Monitoring should be used on GCP Workbench instance",
    "id": "/providers/Microsoft.Security/assessmentMetadata/2253e0d7-428e-452e-844d-452ecaea46bb",
    "implementationEffort": "Low",
    "name": "2253e0d7-428e-452e-844d-452ecaea46bb",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/04/2025"
    },
    "remediationDescription": "To enable Cloud Monitoring for Workbench Instances, follow these detailed steps to ensure a secure and efficient setup:<ul><b>Enable Cloud Monitoring:</b><ul><li>To enable Cloud Monitoring, you will need to install the Cloud Monitoring agent when you create your notebook instance.</li><li>In the Google Cloud Console, navigate to the Vertex AI section, and re-create the instance with 'Install Cloud Monitoring' enabled (under advanced settings, system health)</li></ul>  </ul>By following these steps, you can successfully enable Cloud Monitoring for your Google Cloud Vertex AI notebook instances, ensuring a more secure and efficient environment.",
    "severity": "Low",
    "tactics": [
      "Defense Evasion"
    ],
    "techniques": [
      "Impair Defenses"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud has identified that a Private Service endpoint is not configured on Vertex AI Online endpoints.<br><br>Private endpoint connections enforce secure communication by enabling private connectivity to the Online predictions endpoint. Configure a private endpoint connection to enable access to traffic coming only from known networks and prevent access from all other IP addresses.",
    "displayName": "A Private Service endpoint should be used for Vertex AI Online endpoints",
    "id": "/providers/Microsoft.Security/assessmentMetadata/46b3246b-99e3-4708-9c71-0a796f1fdb8e",
    "implementationEffort": "Low",
    "name": "46b3246b-99e3-4708-9c71-0a796f1fdb8e",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/04/2025"
    },
    "remediationDescription": "To enable a Private Service endpoint in Vertex AI Online endpoints, you must re-create your instances with a private endpoint. This involves adding the --network flag when you create an endpoint using the Google Cloud CLI.</p><p>Here's a step-by-step guide to help you through the process:</p><b>Re-create Instances with Private Endpoint:</b><br>To enable a Private Service endpoint, you need to re-create your existing instances with the private endpoint configuration. This ensures that your instances are set up to use the private network.</p><ol><li><b>Use the \"--network\" Flag: </b><ul><li>When creating an endpoint using the Google Cloud CLI, you need to specify the --network flag. This flag allows you to define the network configuration for your endpoint, ensuring that it uses the private network.</li></ul></li><p><b>Example Command: </b><ul><li>Here is an example command to create an online endpoint with a private endpoint using the Google Cloud CLI: gcloud ai endpoints create --display-name=YOUR_ENDPOINT_NAME --network=YOUR_NETWORK_NAME</li><li>Replace YOUR_ENDPOINT_NAME with the name of your endpoint and YOUR_NETWORK_NAME with the name of your private network.</li></ul></p><li><b>Remove the previous online endpoint</b></li></ol><p>By following these steps, you can successfully enable a Private Service endpoint for your Vertex AI Online endpoints, ensuring a secure and efficient setup.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud has identified that root access is not disabled on the GCP Workbench instance.<br><br>To reduce the risk of accidental or malicious system damage, it is essential to disable root access on your Google Cloud Vertex AI notebook instances. This measure limits administrative privileges within the instances, ensuring a more secure environment.",
    "displayName": "Root access should be disabled on Workbench instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/07e819ae-ed4a-439d-867f-4f8c0609dfea",
    "implementationEffort": "Low",
    "name": "07e819ae-ed4a-439d-867f-4f8c0609dfea",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/04/2025"
    },
    "remediationDescription": "To disable Root Access for Workbench Instances follow these detailed instructions to ensure a secure and efficient setup:</p><ol><li><b>Disable Root Access:</b><ul><li>To disable root access, you will need to modify the instance configuration. This can be done by editing the instance settings in the Google Cloud Console or by using the Google Cloud CLI.</li><li>In the Google Cloud Console, navigate to the Vertex AI section, select the notebook instance, and modify the access settings to disable root access.</li></ul></li><li><b>Verify Changes:</b><ul><li>After disabling root access, verify that the changes have been applied correctly. You can do this by attempting to access the instance with root privileges. If root access is disabled, you should not be able to gain root access.</li></ul></li></ol><p>By following these steps, you can successfully disable root access for your Google Cloud Vertex AI notebook instances, ensuring a more secure environment",
    "severity": "Medium",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Networking"
    ],
    "description": "Defender for Cloud has identified that external IP addresses have been configured on the GCP Workbench instance.<br><br>To reduce your attack surface, Workbench instances shouldn't have public IP addresses. Instead, instances should be configured behind load balancers to minimize the instance's exposure to the internet",
    "displayName": "Public IP addresses should be disabled on Workbench instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/716aced6-7cc3-4bcc-bff4-00a270778a42",
    "implementationEffort": "Low",
    "name": "716aced6-7cc3-4bcc-bff4-00a270778a42",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/04/2025"
    },
    "remediationDescription": "To prevent assigning external IPs to Workbench instances, you must re-create your instances without External IP address</p><p>Here's a step-by-step guide to help you through the process:</p><ol><li><b>Re-Create instances without external IP address</b><ul><li>When creating the new workbench instance, click on Advanced options, and under Networking, uncheck 'Assign external IP address'</li></ul></li><li><b>Verify Changes:</b><ul><li>After removing external IP addresses, verify that the changes have been applied correctly. You can do this by attempting to access the instances from the public internet. If the configuration is correct, the instances should not be accessible.</li></ul></li></ol><p>By following these steps, you can successfully prevent assigning external IPs to your Google Cloud Vertex AI notebook instances, ensuring a more secure environment.",
    "severity": "Medium",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud has identified that customer-managed keys are not being used on Vertex AI DataSets.</p><p>Using customer-managed keys to encrypt data at rest provides more control over the key lifecycle, including rotation and management. This is particularly relevant for organizations with related compliance requirements.</p><p>By using customer-managed keys, you can ensure that your data is encrypted with keys that you control, giving you the ability to manage and rotate these keys as needed. This added control can help meet compliance requirements and enhance the security of your data.",
    "displayName": "[Enable if required] Customer-managed keys should be used to encrypt data at rest in Vertex AI DataSets",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e7d7cfa9-d515-4877-8331-8d3750c84105",
    "implementationEffort": "Low",
    "name": "e7d7cfa9-d515-4877-8331-8d3750c84105",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/04/2025"
    },
    "remediationDescription": "To ensure the security of your data, it is crucial to use customer-managed keys to encrypt data at rest in Vertex AI DataSets. Follow these detailed remediation steps to achieve this:</p><ol><li><b>Create or Select Customer-Managed Keys:</b><ul><li>If you do not already have customer-managed keys, you will need to create them. This can be done using the Google Cloud Console. If you already have customer-managed keys, select the appropriate key when re-creating the DataSets.</li></ul></li><li><b>Verify Changes:</b><ul><li>After encrypting the DataSets with customer-managed keys, verify that the changes have been applied correctly. You can do this by checking the DataSet settings in the Google Cloud Console.</li></ul></li></ol><p>By following these steps, you can successfully use customer-managed keys to encrypt data at rest in Vertex AI DataSets, ensuring a more secure environment.",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [
      "Data Manipulation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Unknown"
    ],
    "description": "Defender for Cloud has identified that content filtering is disabled in the model deployed in Azure AI Foundry. This poses a significant risk to the AI model as it may allow inappropriate or harmful content to be processed and generated by the model. Without content filtering, the model is vulnerable to generating outputs that could be offensive, misleading, or harmful, which can lead to reputational damage, legal liabilities, and a loss of user trust. It is crucial to enable content filtering to ensure that the AI model adheres to ethical standards and produces safe and reliable outputs.",
    "displayName": "Content filtering should be used on model deployed in Azure AI Foundry ",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5c07e753-220b-4fd7-a7a4-c5c4f5db9ab9",
    "implementationEffort": "Low",
    "name": "5c07e753-220b-4fd7-a7a4-c5c4f5db9ab9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "15/04/2025"
    },
    "remediationDescription": "To ensure the security and integrity of your models deployed in Azure AI Foundry, it is crucial to implement content filtering. Here are the detailed steps to enable content filtering for your models:<ol><li>In the Azure AI Foundry Portal, navigate to the <strong>Models + endpoint</strong> section.</li><li>Select the model and click <strong>Edit</strong>.</li><li>Under <strong>content filter</strong>, select the content filter setting.</li></ol>By following these steps, you can successfully enable content filtering for your models deployed in Azure AI Foundry, ensuring a more secure and efficient environment.",
    "severity": "Low",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Defender for Cloud continuously scans AI models registered in Azure Machine Learning Registries for security risks, including serialization exploit vulnerabilities and malware. These assessments help identify models that may be misconfigured or contain malicious content. Addressing these findings is critical to maintaining a secure and trustworthy AI development lifecycle, reducing the risk of data breaches, and ensuring compliance with security best practices.",
    "displayName": "Security findings should be resolved on models within Azure Machine Learning Registries",
    "id": "/providers/Microsoft.Security/assessmentMetadata/377f8811-e598-43e1-b73a-df37acb74900",
    "implementationEffort": "Low",
    "name": "377f8811-e598-43e1-b73a-df37acb74900",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "25/04/2025"
    },
    "remediationDescription": "To resolve security findings on AI models, follow these steps:<ol><li>Review the list of vulnerabilities identified by model serialization and antivirus assessments, prioritizing them by severity.</li><li>For each finding, examine the details and recommended remediation steps.</li><li>If the model contains malicious or vulnerable content, prepare a clean version of the model that addresses the issue.</li><li>Disable or unpublish the affected model version from the Azure Machine Learning Registry to prevent further use.</li><li>Register and deploy the remediated model version to the registry.</li><li>Update any downstream pipelines or services to reference the new, secure model version.</li></ol>",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud has identified that idle shutdown is not configured on the GCP Workbench instance.<br><br>To optimize costs and enhance security, ensure that the Idle Shutdown feature is enabled for your Google Cloud Vertex AI notebook instances.",
    "displayName": "Idle shutdown should be enabled on Workbench instances",
    "id": "/providers/Microsoft.Security/assessmentMetadata/abeebd67-f81a-4658-97bc-4dc5c194f25f",
    "implementationEffort": "Low",
    "name": "abeebd67-f81a-4658-97bc-4dc5c194f25f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/04/2025"
    },
    "remediationDescription": "To enable Idle Shutdown for Workbench instances, follow these detailed remediation steps to ensure a secure and efficient setup:</p><ol><li><b>Enable Idle Shutdown:</b><ul><li>To enable Idle Shutdown, you will need to modify the instance configuration. This can be done by editing the instance settings in the Google Cloud Console</li><li>In the Google Cloud Console, navigate to the Vertex AI section, select the notebook instance, and modify the settings to enable Idle Shutdown under 'Software and security'.</li></ul></li><li><b>Verify Changes:</b><ul><li>After enabling Idle Shutdown, verify that the changes have been applied correctly. You can do this by checking the instance settings in the Google Cloud Console or by using the Google Cloud CLI.</li></ul></li></ol><p>By following these steps, you can successfully enable Idle Shutdown for your Google Cloud Vertex AI notebook instances, ensuring a more secure and efficient environment.",
    "severity": "Low",
    "tactics": [
      "Impact"
    ],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Azure AI Agents that are not configured with clear operational instructions may behave unpredictably or inconsistently. Without defined guidance, this Agent could inadvertently access, process, or expose data, respond to prompts inappropriately, or fail to comply with organizational security and compliance requirements. This lack of control increases the risk of data leakage, unauthorized actions, and misalignment with enterprise governance policies.",
    "displayName": "Azure AI Agent should be configured with operational instructions",
    "id": "/providers/Microsoft.Security/assessmentMetadata/e061d9a4-60cc-4f93-80c7-751ea322b3e8",
    "implementationEffort": "Low",
    "name": "e061d9a4-60cc-4f93-80c7-751ea322b3e8",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "05/26/2025"
    },
    "remediationDescription": "To mitigate this issue, configure your Azure AI Agent with clear and comprehensive operational instructions. This ensures the agent behaves consistently, securely, and in alignment with organizational policies. For detailed guidance on how to define and manage agent instructions, refer to the official Microsoft documentation: https://learn.microsoft.com/en-us/microsoft-365-copilot/extensibility/declarative-agent-instructions",
    "severity": "Medium",
    "tactics": [],
    "techniques": [],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "Defender for Cloud identified unused API endpoints in Azure Functions, Logic Apps or Web App resources. As a security best practice, API endpoints that haven't received traffic for 30 days are considered unused and should be removed from the cloud environment. Keeping unused API endpoints might pose a security risk. These might be APIs that should have been deprecated but have accidentally been left active. Such APIs typically do not receive the most up-to-date security coverage.",
    "displayName": "Unused discovered API endpoints should be disabled and removed from Azure App Services.",
    "id": "/providers/Microsoft.Security/assessmentMetadata/721eb938-70f0-4499-bdb9-50eb1a18e7d2",
    "implementationEffort": "Low",
    "name": "721eb938-70f0-4499-bdb9-50eb1a18e7d2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/31/2025"
    },
    "remediationDescription": "Note: Manually verify that the API endpoint is unused and consider any potential impact this may cause before removing the API endpoint from the App Services environment.<br><br>Function App<br>1.Navigate to the relevant Function App within the Azure Portal.<br>2.In the side panel, select \"Functions\" to locate the unhealthy resource.<br>3.Select the HTTP trigger Function that represents the unused API endpoint.<br>4.Select \"Disable\"<br>5.Select \"Delete\" to remove the unused API endpoint.<br><br>Logic App<br>1.Navigate to the relevant Logic App within the Azure Portal.<br>2.In the side panel, select \"Workflows\" to locate the unhealthy resource.<br>3.Select the HTTP Workflow that represents the unused API endpoint.<br>4.Select \"Disable\"<br>5.Select \"Delete\" to remove the unused API endpoint.<br><br>Web App<br>1.Manually verify that the Web App hosting the unused API endpoint does not support any other functionality in use. Consider potential impact this may cause before deleting the hosting Web App or consider only removing the web app component hosting the unused API endpoint.<br>",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "API endpoints that have not received traffic for 30 days are considered unused and pose a potential security risk. These endpoints may have been left active accidentally when they should have been deprecated. Often, unused API endpoints lack the latest security updates, making them vulnerable. To prevent potential security breaches, we recommend disabling and removing these HTTP-triggered endpoints from Azure Function Apps.",
    "displayName": "Unused API endpoints should be disabled and removed from Function Apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4cf2ce2c-760a-42d1-8f21-2ce7c58791f9",
    "implementationEffort": "Low",
    "name": "4cf2ce2c-760a-42d1-8f21-2ce7c58791f9",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/31/2025"
    },
    "remediationDescription": "Note: Manually verify that the API endpoint is unused and consider any potential impact this may cause before removing the API endpoint from the Azure Function App.<br>1. Navigate to the Azure Function App in the Azure portal.<br>2. Go to the Functions section within the Function App Overview page.<br>3. Select the HTTP-triggered function you want to disable or remove.<br>4. Choose Disable to disable the function or Delete to remove it.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "AppServices"
    ],
    "description": "API endpoints that have not received traffic for 30 days are considered unused and pose a potential security risk. These endpoints may have been left active accidentally when they should have been deprecated. Often, unused API endpoints lack the latest security updates, making them vulnerable. To prevent potential security breaches, we recommend disabling and removing these endpoints from Azure Logic Apps.",
    "displayName": "Unused API endpoints should be disabled and removed from Logic Apps",
    "id": "/providers/Microsoft.Security/assessmentMetadata/65138392-cee5-4391-a181-3566740148b2",
    "implementationEffort": "Low",
    "name": "65138392-cee5-4391-a181-3566740148b2",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "04/31/2025"
    },
    "remediationDescription": "Note: Manually verify that the API endpoint is unused and consider any potential impact this may cause before removing the API endpoint from the Azure Logic App<br>1. Navigate to the relevant Logic App within the Azure Portal.<br>2. In the side panel, select Workflows to locate the workflow containing the unused API endpoint.<br>3. Select the HTTP-triggered Workflow that contains the unused API endpoint.<br>4. Choose Disable to disable the workflow or Delete to remove it.",
    "severity": "Low",
    "tactics": null,
    "techniques": null,
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "Microsoft Defender for APIs protects your APIs from attacks and security misconfigurations.<br>Defender for APIs may increase the compute, memory, and network utilization of your Azure API Management service.<br> Therefore, we recommend gradually onboard APIs, especially if your service is running at high utilization, while monitoring the capacity, and scaling out as needed.<br>",
    "displayName": "Azure API Management APIs should be onboarded to Defender for APIs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/1c0ba94f-e732-43c7-bf3a-05e80f45d642",
    "implementationEffort": "Low",
    "name": "1c0ba94f-e732-43c7-bf3a-05e80f45d642",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "11/14/2023",
      "public": "08/20/2022"
    },
    "remediationDescription": "First, select the APIs in the list below that you would like to onboard for security coverage, then click \"Fix\" and confirm to complete the onboarding.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Credential Access",
      "Privilege Escalation",
      "Execution",
      "Defense Evasion",
      "Exfiltration",
      "Discovery",
      "Command and Control",
      "Initial Access",
      "Lateral Movement",
      "Impact"
    ],
    "techniques": [
      "Hijack Execution Flow",
      "Modify Authentication Process",
      "Boot or Logon Initialization Scripts",
      "Scheduled Task/Job",
      "Account Manipulation",
      "Office Application Startup",
      "OS Credential Dumping",
      "Obfuscated Files or Information",
      "Exfiltration Over Alternative Protocol",
      "Process Injection",
      "Command and Scripting Interpreter",
      "Exploitation for Privilege Escalation",
      "Indicator Removal on Host",
      "Valid Accounts",
      "System Information Discovery",
      "Account Discovery",
      "Ingress Tool Transfer",
      "Modify Registry",
      "Create Account",
      "Deobfuscate/Decode Files or Information",
      "Drive-by Compromise",
      "Indirect Command Execution",
      "Exploitation for Client Execution",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Signed Binary Proxy Execution",
      "File and Directory Permissions Modification",
      "Service Stop",
      "Create or Modify System Process",
      "Event Triggered Execution",
      "Boot or Logon Autostart Execution",
      "Abuse Elevation Control Mechanism",
      "Steal or Forge Kerberos Tickets",
      "Impair Defenses",
      "Remote Service Session Hijacking",
      "Hide Artifacts",
      "Exploit Public-Facing Application",
      "External Remote Services",
      "Brute Force",
      "Masquerading",
      "User Execution",
      "Subvert Trust Controls",
      "Compromise Client Software Binary"
    ],
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "API endpoints that have not received traffic for 30 days are deemed unused and pose a potential security risk.<br> They may have been left active accidentally when they should have been deprecated.<br> These unused APIs often lack the latest security updates, making them vulnerable.<br> We recommend disabling and removing these endpoints from the Azure API Management service to prevent potential security breaches.<br><b>Related OWASP API Security Top 10 Risks: </b><a href=\"https://owasp.org/API-Security/editions/2023/en/0xa8-security-misconfiguration/\" target=\"_blank\" rel=\"noreferrer noopener\">(API8:2023)</a> Security Misconfiguration",
    "displayName": "API endpoints that are unused should be disabled and removed from the Azure API Management service",
    "id": "/providers/Microsoft.Security/assessmentMetadata/4e8c00a2-e8bc-42a8-9e12-99584a51ad10",
    "implementationEffort": "Low",
    "name": "4e8c00a2-e8bc-42a8-9e12-99584a51ad10",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/c8acafaf-3d23-44d1-9624-978ef0f8652c",
    "preview": null,
    "publishDates": {
      "ga": "11/14/2023",
      "public": "08/20/2022"
    },
    "remediationDescription": "Note: Manually verify that the API endpoint is unused and consider any potential impact this may cause before removing the API endpoint from the Azure API Management service. <br>1. Navigate to the Azure API Management service to locate the unhealthy resources within the Azure Portal. <br>2. In the left pane, select APIs. <br>3. Select the API with the associated API collection name that is hosting the affected API endpoint (in Azure API Management, known as \"API operation\"). <br>4. Select the ellipses (...) next to the endpoint and select \"Delete\" to remove the unused API endpoint.",
    "severity": "Low",
    "tactics": [
      "Initial Access"
    ],
    "techniques": null,
    "threats": [
      "MissingCoverage"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Data"
    ],
    "description": "API endpoints in Azure API Management need to enforce authentication to minimize security risks.<br> Incorrect or missing authentication mechanisms can lead to implementation flaws, which attackers can exploit to access data.<br> Ensuring proper authentication for API endpoints is crucial to prevent unauthorized access and potential data breaches.<br> Failing to do so could expose sensitive data and compromise the security of the system.<br> To understand the potential threats and mitigation strategies, we recommend reviewing the OWASP API Threat for Broken User Authentication.<br><b>Related OWASP API Security Top 10 Risks: </b><a href=\"https://owasp.org/API-Security/editions/2023/en/0xa2-broken-authentication\" target=\"_blank\" rel=\"noreferrer noopener\">(API2:2023)</a> Broken Authentication",
    "displayName": "API endpoints in Azure API Management should be authenticated",
    "id": "/providers/Microsoft.Security/assessmentMetadata/91af2040-7874-4659-abf0-578e1f8d07dc",
    "implementationEffort": "Low",
    "name": "91af2040-7874-4659-abf0-578e1f8d07dc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/8ac833bd-f505-48d5-887e-c993a1d3eea0",
    "preview": null,
    "publishDates": {
      "ga": "11/14/2023",
      "public": "08/20/2022"
    },
    "remediationDescription": "1. Verify the configuration of the authentication on the API endpoint. For APIs published in Azure API Management, this recommendation assesses authentication though verifying the presence of Azure API Management subscription keys for APIs or products where subscription is required, and the execution of policies for <a href=\"https://learn.microsoft.com/azure/api-management/validate-jwt-policy\" target=\"_blank\">validating JWT</a>, <a href=\"https://learn.microsoft.com/azure/api-management/validate-client-certificate-policy\" target=\"_blank\">client certificates</a>, and <a href=\"https://learn.microsoft.com/azure/api-management/validate-azure-ad-token-policy\" target=\"_blank\">Microsoft Entra tokens</a>. If none of these authentication mechanisms are executed during the API call, the API endpoint will be non-compliant and display as Unhealthy in the Defender for Cloud security recommendation. <br>2. After your verification, if the API is missing or the API has incorrectly configured authentication, enable and ensure the proper configuration of authentication for the API endpoint. See <a href=\"https://learn.microsoft.com/azure/api-management/api-management-authentication-policies\" target=\"_blank\">API Management authentication policies</a>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": null,
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Installing an Endpoint Detection and Response (EDR) solution on virtual machines is important for protection against advanced threats.<br> EDRs aid in preventing, detecting, investigating, and responding to these threats.<br> Microsoft Defender for Servers can be used to deploy Microsoft Defender for Endpoint.<br> If a resource is classified as \"Unhealthy\", it indicates the absence of a <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/endpoint-detection-response#supported-solutions-and-platforms\">supported EDR solution</a>.<br> If an EDR solution is installed but not discoverable by this recommendation, it can be exempted.<br> Without an EDR solution, the virtual machines are at risk of advanced threats.<br>",
    "displayName": "EDR solution should be installed on Virtual Machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/06e3a6db-6c0c-4ad9-943f-31d9d73ecf6c",
    "implementationEffort": "Moderate",
    "name": "06e3a6db-6c0c-4ad9-943f-31d9d73ecf6c",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "07/03/2024",
      "public": "01/12/2023"
    },
    "remediationDescription": "To manually resolve this issue:<br>1. Confirm that your solution is on the list of <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/endpoint-detection-response#supported-solutions-and-platforms\">tools supported by Defender for Cloud</a>.<br>2. Install a supported EDR solution. <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/integration-defender-for-endpoint\">Learn more</a> about enabling Microsoft Defender for Endpoint (MDE) integration as part of Defender for Servers.<br><br>We recommend to follow the \"recommended action\" according to your resource status, and remediate the issue by using the \"Fix\" experience in Azure portal:<br><br><strong>Enable Defender for Endpoint integration-</strong> the fix will enable the integration with Microsoft Defender for Endpoint (MDE) on your subscription and will apply to all resources in it (Windows and Linux servers).<br>MDE is included with both Defender for Servers Plan 1 and Plan 2. So, for resources in subscriptions already protected by either of those plans, this fix will not result in additional charges.<br><br><strong>Turn on a plan-</strong> For resources in subscriptions that are not protected with any of those plans, applying the fix will enable Defender for Servers according to your choice. [<a href=\"https://azure.microsoft.com/en-us/pricing/details/defender-for-cloud/\">Learn</a> about the pricing for Defender for Servers].<br><br><strong>Troubleshoot Defender for Endpoint onboarding-</strong> In case resources are part of a subscription that has Microsoft Defender for Endpoint (MDE) integration enabled, and no EDR has been discovered, troubleshoot is required to better understand and remediate the issue. [Learn about troubleshooting Microsoft Defender for Endpoint onboarding issues in <a href=\"https://learn.microsoft.com/microsoft-365/security/defender-endpoint/troubleshoot-onboarding?view=o365-worldwide&WT.mc_id=Portal-Microsoft_Azure_Security\">Windows machines</a>, and in <a href=\"https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-linux?view=o365-worldwide&WT.mc_id=Portal-Microsoft_Azure_Security\">Linux machines</a>]",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Installing an Endpoint Detection and Response (EDR) solution on EC2s is important for advanced threat protection.<br> EDRs aid in preventing, detecting, investigating, and responding to sophisticated threats.<br> Microsoft Defender for Servers can be used to deploy Microsoft Defender for Endpoint.<br> If an EC2 is classified as \"Unhealthy\", it indicates the absence of a <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/endpoint-detection-response#supported-solutions-and-platforms\">supported EDR solution</a>.<br> If an EDR solution is installed but not discoverable by this recommendation, it can be exempted.<br> Without an EDR solution, the EC2s are at risk of advanced threats.<br>",
    "displayName": "EDR solution should be installed on EC2s",
    "id": "/providers/Microsoft.Security/assessmentMetadata/77d09952-2bc2-4495-8795-cc8391452f85",
    "implementationEffort": "Moderate",
    "name": "77d09952-2bc2-4495-8795-cc8391452f85",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "07/03/2024",
      "public": "01/12/2023"
    },
    "remediationDescription": "To manually resolve this issue:<br>1. Confirm that your solution is on the list of <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/endpoint-detection-response#supported-solutions-and-platforms\">tools supported by Defender for Cloud</a>.<br>2. Install a supported EDR solution. <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/integration-defender-for-endpoint\">Learn more</a> about enabling Microsoft Defender for Endpoint (MDE) integration as part of Defender for Servers.<br><br>We recommend to follow the \"recommended action\" according to your resource status, and remediate the issue by using the \"Fix\" experience in Azure portal:<br><br><strong>Enable Defender for Endpoint integration-</strong> the fix will enable the integration with Microsoft Defender for Endpoint (MDE) on your connector and will apply to all resources in it (Windows and Linux servers).<br>MDE is included with both Defender for Servers Plan 1 and Plan 2. So, for resources in connectors already protected by either of those plans, this fix will not result in additional charges.<br><br><strong>Turn on a plan-</strong> For resources in connectors that are not protected with any of those plans, applying the fix will enable Defender for Servers according to your choice. [<a href=\"https://azure.microsoft.com/en-us/pricing/details/defender-for-cloud/\">Learn</a> about the pricing for Defender for Servers].<br><br><strong>Troubleshoot Defender for Endpoint onboarding-</strong> In case resources are part of a connector that has Microsoft Defender for Endpoint (MDE) integration enabled, and no EDR has been discovered, troubleshoot is required to better understand and remediate the issue. [Learn about troubleshooting Microsoft Defender for Endpoint onboarding issues in <a href=\"https://learn.microsoft.com/microsoft-365/security/defender-endpoint/troubleshoot-onboarding?view=o365-worldwide&WT.mc_id=Portal-Microsoft_Azure_Security\">Windows machines</a>, and in <a href=\"https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-linux?view=o365-worldwide&WT.mc_id=Portal-Microsoft_Azure_Security\">Linux machines</a>]",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Installing an Endpoint Detection and Response (EDR) solution on Google Cloud Platform (GCP) Virtual Machines is important for protection against advanced threats.<br> EDRs aid in preventing, detecting, investigating, and responding to these threats.<br> Microsoft Defender for Servers can be used to deploy Microsoft Defender for Endpoint.<br> If a resource is classified as \"Unhealthy\", it indicates the absence of a <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/endpoint-detection-response#supported-solutions-and-platforms\">supported EDR solution</a>.<br> If an EDR solution is already installed but isn't discoverable by this recommendation, it can be exempted.<br> Without an EDR, the virtual machines are at risk of advanced threats.<br>",
    "displayName": "EDR solution should be installed on GCP Virtual Machines",
    "id": "/providers/Microsoft.Security/assessmentMetadata/68e595c1-a031-4354-b37c-4bdf679732f1",
    "implementationEffort": "Moderate",
    "name": "68e595c1-a031-4354-b37c-4bdf679732f1",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": null,
    "publishDates": {
      "ga": "07/03/2024",
      "public": "01/12/2023"
    },
    "remediationDescription": "To manually resolve this issue:<br>1. Confirm that your solution is on the list of <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/endpoint-detection-response#supported-solutions-and-platforms\">tools supported by Defender for Cloud</a>.<br>2. Install a supported EDR solution. <a href=\"https://learn.microsoft.com/en-us/azure/defender-for-cloud/integration-defender-for-endpoint\">Learn more</a> about enabling Microsoft Defender for Endpoint (MDE) integration as part of Defender for Servers.<br><br>We recommend to follow the \"recommended action\" according to your resource status, and remediate the issue by using the \"Fix\" experience in Azure portal:<br><br><strong>Enable Defender for Endpoint integration-</strong> the fix will enable the integration with Microsoft Defender for Endpoint (MDE) on your connector and will apply to all resources in it (Windows and Linux servers).<br>MDE is included with both Defender for Servers Plan 1 and Plan 2. So, for resources in connectors already protected by either of those plans, this fix will not result in additional charges.<br><br><strong>Turn on a plan-</strong> For resources in connectors that are not protected with any of those plans, applying the fix will enable Defender for Servers according to your choice. [<a href=\"https://azure.microsoft.com/en-us/pricing/details/defender-for-cloud/\">Learn</a> about the pricing for Defender for Servers].<br><br><strong>Troubleshoot Defender for Endpoint onboarding-</strong> In case resources are part of a connector that has Microsoft Defender for Endpoint (MDE) integration enabled, and no EDR has been discovered, troubleshoot is required to better understand and remediate the issue. [Learn about troubleshooting Microsoft Defender for Endpoint onboarding issues in <a href=\"https://learn.microsoft.com/microsoft-365/security/defender-endpoint/troubleshoot-onboarding?view=o365-worldwide&WT.mc_id=Portal-Microsoft_Azure_Security\">Windows machines</a>, and in <a href=\"https://learn.microsoft.com/microsoft-365/security/defender-endpoint/microsoft-defender-endpoint-linux?view=o365-worldwide&WT.mc_id=Portal-Microsoft_Azure_Security\">Linux machines</a>]",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To protect virtual machines from the latest threats and vulnerabilities, resolve all identified configuration issues with the installed Endpoint Detection and Response (EDR) solution.<br><br>Regular scans are crucial for detecting and removing malware that may have infiltrated your system. If scans are not performed frequently, malware can remain undetected and cause significant damage. Resource will be classified as unhealthy if both quick and full scans are out of 7 days.<br><br>Note: Currently, this recommendation only applies to resources with Microsoft Defender for Endpoint (MDE) enabled.",
    "displayName": "Anti-Virus scans of your EDR are out of 7 days",
    "id": "/providers/Microsoft.Security/assessmentMetadata/d44de051-1862-48f8-8476-192aee854699",
    "implementationEffort": "Moderate",
    "name": "d44de051-1862-48f8-8476-192aee854699",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "11/02/2025"
    },
    "remediationDescription": "1. Review the evaluated configurations - the dates of the last quick scan and last full scan.<br>2. initiate a quick scan and a full scan manually to ensure scans are performed and malware does not remain un-detected.<br>3. Ensure that automatic scanning is enabled to prevent future lapses.<br>4. For detailed instructions on how to initiate quick or full scans, refer <a href=\"https://learn.microsoft.com/en-us/defender-endpoint/schedule-antivirus-scans\">here</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To protect virtual machines from the latest threats and vulnerabilities, resolve all identified configuration issues with the installed Endpoint Detection and Response (EDR) solution.<br><br>Real-time protection is vital for detecting and blocking malware as soon as it attempts to execute.<br>Resource will be classified as unhealthy if one of the following conditions are met:<br>1. AntiVirusEnabled = Disabled<br>2. RealTimeModeEnabled = Disabled<br>3. PassiveModeEnabled = Enabled<br>Note: Currently, this recommendation only applies to resources with Microsoft Defender for Endpoint (MDE) enabled.",
    "displayName": "Anti-Virus component in your EDR is off or partially configured",
    "id": "/providers/Microsoft.Security/assessmentMetadata/506d18a1-d571-4341-aad5-a7d363c5bbd4",
    "implementationEffort": "Moderate",
    "name": "506d18a1-d571-4341-aad5-a7d363c5bbd4",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "11/02/2025"
    },
    "remediationDescription": "1. Review the evaluated configurations - the AV mode, Passive mode, and Real-time mode settings.<br>2. If the antivirus component is off or partially configured, enable real-time protection and ensure that the antivirus is fully configured.<br>3. For detailed instructions on how to configure real-time protection and change the passive mode configuration, refer <a href=\"https://learn.microsoft.com/en-us/defender-endpoint/configure-real-time-protection-microsoft-defender-antivirus\">here</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "To protect virtual machines from the latest threats and vulnerabilities, resolve all identified configuration issues with the installed Endpoint Detection and Response (EDR) solution.<br><br>Up-to-date antivirus signatures are essential for identifying and blocking new and emerging threats. Outdated signatures can leave your system vulnerable to malware that has been recently developed. Resource will be classified as unhealthy if the EDR's signatures haven't been updated in the last 7 days.<br><br>Note: Currently, this recommendation only applies to resources with Microsoft Defender for Endpoint (MDE) enabled.",
    "displayName": "Anti-Virus component of your EDR uses outdated signatures",
    "id": "/providers/Microsoft.Security/assessmentMetadata/aafa7d27-01ae-40c6-a56c-1d0ef04b1d71",
    "implementationEffort": "Moderate",
    "name": "aafa7d27-01ae-40c6-a56c-1d0ef04b1d71",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "11/02/2025"
    },
    "remediationDescription": "1. Review the evaluated configurations - the date of the last signature update date.<br>2. Update the antivirus signatures, by following the instructions in <a href=\"https://learn.microsoft.com/en-us/defender-endpoint/manage-outdated-endpoints-microsoft-defender-antivirus#set-up-catch-up-protection-updates-for-endpoints-that-havent-updated-for-a-while\">here</a>.<br>3. Ensure that automatic updates are enabled to keep the signatures up to date.<br>4. For detailed instructions, refer <a href=\"https://learn.microsoft.com/en-us/defender-endpoint/manage-outdated-endpoints-microsoft-defender-antivirus\">here</a>.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Command and Control"
    ],
    "techniques": [
      "Ingress Tool Transfer",
      "User Execution",
      "Exploitation for Client Execution"
    ],
    "threats": [
      "ThreatResistance"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud has identified that code signing is not enabled on Lambda, which poses a risk of unauthorized modifications to the Lambda function code. Enabling code signing ensures the integrity and authenticity of the code, preventing such modifications.",
    "displayName": "Code Signing should be enabled on Lambda",
    "id": "/providers/Microsoft.Security/assessmentMetadata/77400824-9e1f-4101-a943-b27dd12fff1d",
    "implementationEffort": null,
    "name": "77400824-9e1f-4101-a943-b27dd12fff1d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/29/2025"
    },
    "remediationDescription": "In the Lambda console, go to the Functions page and select your function.<br>Open the Configuration tab, scroll down to Code signing, and choose Edit.<br>Select the code signing configuration you created and save the changes.",
    "severity": "Medium",
    "tactics": [
      "Persistence",
      "Defense Evasion",
      "Impact"
    ],
    "techniques": [
      "Supply Chain Compromise",
      "Subvert Trust Controls",
      "Masquerading"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud has identified that authentication is not enabled for public-facing Lambda functions. This poses a risk of unauthorized access and potential abuse of the function endpoints. Enforcing authentication can help mitigate these risks.",
    "displayName": "Authentication should be enabled on Lambda",
    "id": "/providers/Microsoft.Security/assessmentMetadata/ce2b254c-0404-41db-b70b-25e3ed03a881",
    "implementationEffort": null,
    "name": "ce2b254c-0404-41db-b70b-25e3ed03a881",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/29/2025"
    },
    "remediationDescription": "For API Gateways without authorizers:<br>1. Go to API Gateway in AWS Console<br>2. Select the API that needs an authorizer<br>3. Add an appropriate authorizer:<br>&nbsp;&nbsp;&nbsp;* For REST APIs: Use the Authorizers section<br>&nbsp;&nbsp;&nbsp;* For HTTP APIs: Use the Authorization section<br>4. Configure a Cognito, Lambda, or IAM authorizer based on your authentication needs<br>5. Apply the authorizer to the relevant routes/methods<br>6. Deploy your API changes after adding authorizers",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Defense Evasion",
      "Impact",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Supply Chain Compromise",
      "Subvert Trust Controls",
      "Masquerading",
      "Valid Accounts",
      "Exploit Public-Facing Application",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud has identified that authentication is not enabled for one or more Lambda Function URLs. Publicly accessible Lambda Function URLs without authentication pose a risk of unauthorized access and potential abuse. Enforcing AWS IAM authentication on Lambda Function URLs helps mitigate these risks.",
    "displayName": "Authentication should be enabled on Lambda Function URLs",
    "id": "/providers/Microsoft.Security/assessmentMetadata/b7e2c1a2-5e3a-4b8e-9c2a-7f8e2d1c3a4b",
    "implementationEffort": null,
    "name": "b7e2c1a2-5e3a-4b8e-9c2a-7f8e2d1c3a4b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/29/2025"
    },
    "remediationDescription": "To enable authentication on Lambda Function URLs:<br>1. Go to the Lambda service in the AWS Console.<br>2. Select the function with a Function URL.<br>3. Choose the Configuration tab.<br>4. Choose Function URL.<br>5. Set the Auth type to AWS_IAM.<br>6. Save your changes.<br>7. Ensure only authorized IAM principals can invoke the function URL.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Defense Evasion",
      "Impact",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Supply Chain Compromise",
      "Subvert Trust Controls",
      "Masquerading",
      "Valid Accounts",
      "Exploit Public-Facing Application",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Compute"
    ],
    "description": "Defender for Cloud identified that the Function App, Web App or Logic App managed identity or service principal has overly permissive access policies (privileged administrator roles with wide scope) to other resources in the environment. This poses a risk of significant security exposure by potentially allowing unauthorized access and actions across various resources. In most cases, a function app, web app or logic app does not require such high permissions, as this can enable lateral movement within the environment.",
    "displayName": "Overly permissive permissions should not be configured on Function App, Web App or Logic App",
    "id": "/providers/Microsoft.Security/assessmentMetadata/6dfe6f68-f507-4c6d-915b-cda75e243798",
    "implementationEffort": null,
    "name": "6dfe6f68-f507-4c6d-915b-cda75e243798",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/29/2025"
    },
    "remediationDescription": "To remediate overly permissive managed identities:<br>1. Navigate to your Function App, Web App or Logic App in Azure Portal.<br>2. Select 'Identity' under Settings.<br>3. Review both System-assigned and User-assigned identities.<br>4. Click 'Azure role assignments' for each identity.<br>5. Replace high-privilege roles with more specific roles that follow least privilege principles.",
    "severity": "High",
    "tactics": [
      "Persistence",
      "Defense Evasion",
      "Impact",
      "Initial Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Supply Chain Compromise",
      "Subvert Trust Controls",
      "Masquerading",
      "Valid Accounts",
      "Exploit Public-Facing Application",
      "External Remote Services"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Accounts with read permissions that have been provisioned outside of the Azure Active Directory tenant (different domain names), should be removed from your Azure resources.<br> These guest accounts are not managed to the same standards as enterprise tenant identities.<br> This makes them potential targets for threat actors looking to find ways to access your data without being noticed.<br> By removing these accounts, you can reduce the risk of unauthorized data access and potential breaches.<br>",
    "displayName": "Guest accounts with read permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/422107c6-5b9a-46a6-bb1d-26ef1cc52d65",
    "implementationEffort": "Low",
    "name": "422107c6-5b9a-46a6-bb1d-26ef1cc52d65",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "12/04/2024"
    },
    "remediationDescription": "Guest accounts with read permissions on Azure resources should be removed.<br><br> <b>Review the list of guest accounts</b> that require access removal in the Accounts section.<br> <b>Select an account</b> to view its role definitions and locate the source scope.<br> If you accept the risk for a specific account, use the <b>exempt capability</b> to exclude it from evaluation.<br><br> 1. <b>Go to the Azure portal.</b><br> 2. Open <b>Access control (IAM)</b> at a scope, such as a management group, subscription, resource group, or resource, where the guest user has a role assignment.<br> 3. Click the <b>Role assignments</b> tab to view all the role assignments.<br> 4. In the list of role assignments, <b>add a checkmark</b> next to the guest user with the role assignment you want to remove.<br> 5. If the role is inherited from a group, identify the group by checking the <b>Scope</b> column and clicking the link next to <b>(Inherited)</b>.<br> 6. Navigate to the group's <b>Access control (IAM)</b> settings.<br> 7. In the group's <b>Role assignments</b> tab, <b>add a checkmark</b> next to the role assignment you want to remove.<br> 8. Click <b>Remove</b>. In the remove role assignment message that appears, click <b>Yes</b>.<br> 9. <b>Navigate to Microsoft Entra ID</b>.<br> 10. Under the <b>Manage</b> menu item, go to <b>All groups</b> and select the group from which you want to remove the guest user.<br> 11. In the group's settings, under the <b>Manage</b> menu item, go to the <b>Members</b> tab.<br> 12. <b>Find the guest user in the list of members, add a checkmark next to their name, and click Remove</b>.<br>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Accounts with write permissions that have been provisioned outside of the Azure Active Directory tenant (different domain names), should be removed from your Azure resources.<br> These guest accounts are not managed to the same standards as enterprise tenant identities.<br> This makes them potential targets for threat actors looking to find ways to access your data without being noticed.<br> By removing these accounts, you can reduce the risk of unauthorized data access and potential breaches..<br>",
    "displayName": "Guest accounts with write permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/009678ce-adce-4c94-9cc8-cfc2bd0c6a06",
    "implementationEffort": "Low",
    "name": "009678ce-adce-4c94-9cc8-cfc2bd0c6a06",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "12/04/2024"
    },
    "remediationDescription": "Guest accounts with write permissions on Azure resources should be removed.<br><br> <b>Review the list of guest accounts</b> that require access removal in the Accounts section.<br> <b>Select an account</b> to view its role definitions and locate the source scope.<br> If you accept the risk for a specific account, use the <b>exempt capability</b> to exclude it from evaluation.<br><br> 1. <b>Go to the Azure portal.</b><br> 2. Open <b>Access control (IAM)</b> at a scope, such as a management group, subscription, resource group, or resource, where the guest user has a role assignment.<br> 3. Click the <b>Role assignments</b> tab to view all the role assignments.<br> 4. In the list of role assignments, <b>add a checkmark</b> next to the guest user with the role assignment you want to remove.<br> 5. If the role is inherited from a group, identify the group by checking the <b>Scope</b> column and clicking the link next to <b>(Inherited)</b>.<br> 6. Navigate to the group's <b>Access control (IAM)</b> settings.<br> 7. In the group's <b>Role assignments</b> tab, <b>add a checkmark</b> next to the role assignment you want to remove.<br> 8. Click <b>Remove</b>. In the remove role assignment message that appears, click <b>Yes</b>.<br> 9. <b>Navigate to Microsoft Entra ID</b>.<br> 10. Under the <b>Manage</b> menu item, go to <b>All groups</b> and select the group from which you want to remove the guest user.<br> 11. In the group's settings, under the <b>Manage</b> menu item, go to the <b>Members</b> tab.<br> 12. <b>Find the guest user in the list of members, add a checkmark next to their name, and click Remove</b>.<br>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "Accounts with owner permissions that have been provisioned outside of the Azure Active Directory tenant (different domain names), should be removed from your Azure resources.<br> These guest accounts are not managed to the same standards as enterprise tenant identities.<br> This makes them potential targets for threat actors looking to find ways to access your data without being noticed.<br> By removing these accounts, you can reduce the risk of unauthorized data access and potential breaches.<br>",
    "displayName": "Guest accounts with owner permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/f2864482-b329-4310-8c06-3cf74fe880c5",
    "implementationEffort": "Low",
    "name": "f2864482-b329-4310-8c06-3cf74fe880c5",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "12/04/2024"
    },
    "remediationDescription": "Guest accounts with owner permissions on Azure resources should be removed.<br><br> <b>Review the list of guest accounts</b> that require access removal in the Accounts section.<br> <b>Select an account</b> to view its role definitions and locate the source scope.<br> If you accept the risk for a specific account, use the <b>exempt capability</b> to exclude it from evaluation.<br><br> 1. <b>Go to the Azure portal.</b><br> 2. Open <b>Access control (IAM)</b> at a scope, such as a management group, subscription, resource group, or resource, where the guest user has a role assignment.<br> 3. Click the <b>Role assignments</b> tab to view all the role assignments.<br> 4. In the list of role assignments, <b>add a checkmark</b> next to the guest user with the role assignment you want to remove.<br> 5. If the role is inherited from a group, identify the group by checking the <b>Scope</b> column and clicking the link next to <b>(Inherited)</b>.<br> 6. Navigate to the group's <b>Access control (IAM)</b> settings.<br> 7. In the group's <b>Role assignments</b> tab, <b>add a checkmark</b> next to the role assignment you want to remove.<br> 8. Click <b>Remove</b>. In the remove role assignment message that appears, click <b>Yes</b>.<br> 9. <b>Navigate to Microsoft Entra ID</b>.<br> 10. Under the <b>Manage</b> menu item, go to <b>All groups</b> and select the group from which you want to remove the guest user.<br> 11. In the group's settings, under the <b>Manage</b> menu item, go to the <b>Members</b> tab.<br> 12. <b>Find the guest user in the list of members, add a checkmark next to their name, and click Remove</b>.<br>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Moderate"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It's important to remove disabled accounts that have read and write permissions on Azure resources.<br> These accounts, although disabled from signing in on Active Directory, can still be targeted by attackers.<br> If exploited, these accounts could provide unauthorized access to your data, potentially leading to data breaches.<br> Therefore, to maintain a secure environment, we recommend removing these accounts from Azure resources.<br>",
    "displayName": "Disabled accounts with read and write permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/9b4f4dd4-24fc-42ba-9978-2a1cf575d36d",
    "implementationEffort": "Low",
    "name": "9b4f4dd4-24fc-42ba-9978-2a1cf575d36d",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "12/04/2024"
    },
    "remediationDescription": "Disabled accounts with read and write permissions on Azure resources should be removed.<br><br> 1. <b>Go to the Azure portal.</b><br> 2. Open <b>Access control (IAM)</b> at a scope, such as a management group, subscription, resource group, or resource, where the disabled user has a role assignment.<br> 3. Click the <b>Role assignments</b> tab to view all the role assignments.<br> 4. In the list of role assignments, <b>add a checkmark</b> next to the disabled user with the role assignment you want to remove.<br> 5. If the role is inherited from a group, identify the group by checking the <b>Scope</b> column and clicking the link next to <b>(Inherited)</b>.<br> 6. Navigate to the group's <b>Access control (IAM)</b> settings.<br> 7. In the group's <b>Role assignments</b> tab, <b>add a checkmark</b> next to the role assignment you want to remove.<br> 8. Click <b>Remove</b>. In the remove role assignment message that appears, click <b>Yes</b>.<br> 9. <b>Navigate to Microsoft Entra ID.</b><br> 10. Under the <b>Manage</b> menu item, go to <b>All groups</b> and select the group from which you want to remove the disabled user.<br> 11. In the group's settings, under the <b>Manage</b> menu item, go to the <b>Members</b> tab.<br> 12. <b>Find the disabled user in the list of members, add a checkmark next to their name, and click Remove</b>.<br>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "It's important to remove accounts that have been disabled from signing in on Active Directory from your Azure resources.<br> These disabled accounts, especially those with owner permissions, can become targets for attackers.<br> If these accounts are compromised, attackers could gain unnoticed access to your data.<br> Therefore, to maintain a secure environment, we recommend removing these accounts from Azure resources..<br>",
    "displayName": "Disabled accounts with owner permissions on Azure resources should be removed",
    "id": "/providers/Microsoft.Security/assessmentMetadata/a4899b81-b689-4e0d-aa29-45983ab8b7fc",
    "implementationEffort": "Low",
    "name": "a4899b81-b689-4e0d-aa29-45983ab8b7fc",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "12/04/2024"
    },
    "remediationDescription": "Disabled accounts with owner permissions on Azure resources should be removed.<br><br> 1. <b>Go to the Azure portal.</b><br> 2. Open <b>Access control (IAM)</b> at a scope, such as a management group, subscription, resource group, or resource, where the disabled user has a role assignment.<br> 3. Click the <b>Role assignments</b> tab to view all the role assignments.<br> 4. In the list of role assignments, <b>add a checkmark</b> next to the disabled user with the role assignment you want to remove.<br> 5. If the role is inherited from a group, identify the group by checking the <b>Scope</b> column and clicking the link next to <b>(Inherited)</b>.<br> 6. Navigate to the group's <b>Access control (IAM)</b> settings.<br> 7. In the group's <b>Role assignments</b> tab, <b>add a checkmark</b> next to the role assignment you want to remove.<br> 8. Click <b>Remove</b>. In the remove role assignment message that appears, click <b>Yes</b>.<br> 9. <b>Navigate to Microsoft Entra ID.</b><br> 10. Under the <b>Manage</b> menu item, go to <b>All groups</b> and select the group from which you want to remove the disabled user.<br> 11. In the group's settings, under the <b>Manage</b> menu item, go to the <b>Members</b> tab.<br> 12. <b>Find the disabled user in the list of members, add a checkmark next to their name, and click Remove</b>.<br>",
    "severity": "High",
    "tactics": [
      "Initial Access"
    ],
    "techniques": [
      "Valid Accounts"
    ],
    "threats": [
      "AccountBreach",
      "MaliciousInsider"
    ],
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": "Low"
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "Container"
    ],
    "description": "Defender for cloud scans through all running containers in your cluster, including system pods that are originated from the managed Kubernetes service.</br>Remediating vulnerabilities of container workloads is critical to ensure a robust and secure software supply chain, reduce the risk of security incidents, and ensures compliance with industry standards.",
    "displayName": "[Preview] Vulnerable Azure Kubernetes Service should be updated to resolve vulnerability findings",
    "id": "/providers/Microsoft.Security/assessmentMetadata/5409cb02-6884-4de3-870d-c17b98bbe04f",
    "implementationEffort": null,
    "name": "5409cb02-6884-4de3-870d-c17b98bbe04f",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "03/21/2025"
    },
    "remediationDescription": "Azure Kubernetes Service (AKS) patches discovered CVEs in its supported versions components regularly, based on the cluster's configured maintenance window.<br> To make sure security fixes are rolled out to your cluster once available:<br> <br>1. Configure the cluster for auto updates.<br>2. Use supported AKS versions for your clusters. <br><br><b>Next steps:</b><br><a href=\"https://learn.microsoft.com/en-us/azure/aks/concepts-vulnerability-management#security-reporting\" target=\"_blank\">Learn more</a> about vulnerability management for AKS. <br><br> <a href=\"https://learn.microsoft.com/en-us/azure/aks/supported-kubernetes-versions?tabs=azure-cli\" target=\"_blank\">Learn more</a> about AKS supported versions and timeline.",
    "severity": "High",
    "tactics": [
      "Initial Access",
      "Execution",
      "Lateral Movement",
      "Defense Evasion",
      "Credential Access",
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploit Public-Facing Application",
      "Exploitation for Client Execution",
      "Drive-by Compromise",
      "Exploitation of Remote Services",
      "Exploitation for Defense Evasion",
      "Exploitation for Credential Access",
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  },
  {
    "assessmentType": "BuiltIn",
    "categories": [
      "IdentityAndAccess"
    ],
    "description": "To provide granular filtering on the actions that users can perform, use Role-Based Access Control (RBAC) to manage permissions against Keyvault and configure relevant authorization policies. For more information, see <a target='_blank' href='https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-guide?tabs=azure-cli'>Azure role-based access control</a>.",
    "displayName": "Role-Based Access Control should be used on Azure Keyvault Services (AKV)",
    "id": "/providers/Microsoft.Security/assessmentMetadata/55ed2823-a834-42bd-96ec-d3d5c97d9c6b",
    "implementationEffort": null,
    "name": "55ed2823-a834-42bd-96ec-d3d5c97d9c6b",
    "partnerData": null,
    "plannedDeprecationDate": null,
    "policyDefinitionId": "/providers/Microsoft.Authorization/policyDefinitions/12d4fa5e-1f9f-4c21-97a9-b99b3c6611b5",
    "preview": true,
    "publishDates": {
      "ga": null,
      "public": "06/30/2025"
    },
    "remediationDescription": "To Use Role-Based Access Control (RBAC) you can follow migration guide, see <a target='_blank' href=' https://learn.microsoft.com/en-us/azure/key-vault/general/rbac-migration'>Azure access policies migration to role-based access control</a>.",
    "severity": "High",
    "tactics": [
      "Privilege Escalation"
    ],
    "techniques": [
      "Exploitation for Privilege Escalation"
    ],
    "threats": null,
    "type": "Microsoft.Security/assessmentMetadata",
    "userImpact": null
  }
]
