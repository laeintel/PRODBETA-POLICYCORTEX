<!DOCTYPE html>
<html>
<head>
    <title>Clear PolicyCortex Auth Cache</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 600px;
            margin: 50px auto;
            padding: 20px;
        }
        button {
            background-color: #4CAF50;
            color: white;
            padding: 14px 20px;
            margin: 8px 0;
            border: none;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            opacity: 0.8;
        }
        .log {
            background-color: #f1f1f1;
            padding: 10px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 14px;
        }
    </style>
</head>
<body>
    <h1>Clear PolicyCortex Authentication Cache</h1>
    <p>This will clear all MSAL authentication data from your browser.</p>
    
    <button onclick="clearAllAuth()">Clear All Authentication Data</button>
    
    <div id="log" class="log"></div>

    <script>
        function log(message) {
            const logDiv = document.getElementById('log');
            logDiv.innerHTML += message + '<br>';
        }

        function clearAllAuth() {
            log('Starting authentication cache cleanup...');
            
            // Clear localStorage
            const keysToRemove = [];
            for (let i = 0; i < localStorage.length; i++) {
                const key = localStorage.key(i);
                if (key && (key.includes('msal') || key.includes('login-hint'))) {
                    keysToRemove.push(key);
                }
            }
            
            keysToRemove.forEach(key => {
                localStorage.removeItem(key);
                log(`Removed localStorage: ${key}`);
            });
            
            // Clear sessionStorage
            const sessionKeysToRemove = [];
            for (let i = 0; i < sessionStorage.length; i++) {
                const key = sessionStorage.key(i);
                if (key && (key.includes('msal') || key.includes('login-hint'))) {
                    sessionKeysToRemove.push(key);
                }
            }
            
            sessionKeysToRemove.forEach(key => {
                sessionStorage.removeItem(key);
                log(`Removed sessionStorage: ${key}`);
            });
            
            // Clear cookies for localhost
            document.cookie.split(";").forEach(function(c) { 
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
            });
            
            log('');
            log('âœ… All authentication data cleared!');
            log('');
            log('Next steps:');
            log('1. Close all browser tabs');
            log('2. Open a new incognito/private window');
            log('3. Navigate to http://localhost:3000');
            log('4. Try logging in again');
        }
    </script>
</body>
</html>