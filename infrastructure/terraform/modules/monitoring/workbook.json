{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# ${project_name} Analytics Workbook - ${environment}\n\nComprehensive analytics and monitoring for PolicyCortex platform"
      },
      "name": "title"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "requests\n| where timestamp > ago(1d)\n| summarize RequestCount = count(), AvgDuration = avg(duration), SuccessRate = (count() - countif(success == false)) * 100.0 / count() by bin(timestamp, 1h)\n| order by timestamp asc",
        "size": 0,
        "title": "Request Performance Overview",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "crossComponentResources": [
          "${application_insights_id}"
        ],
        "visualization": "timechart"
      },
      "name": "requestPerformance"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "exceptions\n| where timestamp > ago(1d)\n| summarize ExceptionCount = count() by bin(timestamp, 1h), type\n| order by timestamp asc",
        "size": 0,
        "title": "Exception Trends",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "crossComponentResources": [
          "${application_insights_id}"
        ],
        "visualization": "areachart"
      },
      "name": "exceptionTrends"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "AppTraces\n| where TimeGenerated > ago(1d)\n| where SeverityLevel >= 2\n| summarize LogCount = count() by bin(TimeGenerated, 1h), SeverityLevel\n| order by TimeGenerated asc",
        "size": 0,
        "title": "Application Logs by Severity",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "${log_analytics_workspace_id}"
        ],
        "visualization": "columnchart"
      },
      "name": "applicationLogs"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "dependencies\n| where timestamp > ago(1d)\n| summarize AvgDuration = avg(duration), CallCount = count(), SuccessRate = (count() - countif(success == false)) * 100.0 / count() by name, type\n| order by CallCount desc",
        "size": 0,
        "title": "Dependency Performance",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "crossComponentResources": [
          "${application_insights_id}"
        ],
        "visualization": "table"
      },
      "name": "dependencyPerformance"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customEvents\n| where timestamp > ago(1d)\n| where name in ('PolicyEvaluated', 'ComplianceCheck', 'CostAnalysis', 'UserAction')\n| summarize EventCount = count() by bin(timestamp, 1h), name\n| order by timestamp asc",
        "size": 0,
        "title": "Business Events",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "crossComponentResources": [
          "${application_insights_id}"
        ],
        "visualization": "areachart"
      },
      "name": "businessEvents"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "customMetrics\n| where timestamp > ago(1d)\n| where name in ('ActiveUsers', 'PoliciesEvaluated', 'CostSavings', 'ComplianceScore')\n| summarize AvgValue = avg(value) by bin(timestamp, 1h), name\n| order by timestamp asc",
        "size": 0,
        "title": "Key Performance Indicators",
        "timeContext": {
          "durationMs": 86400000
        },
        "queryType": 0,
        "resourceType": "microsoft.insights/components",
        "crossComponentResources": [
          "${application_insights_id}"
        ],
        "visualization": "linechart"
      },
      "name": "kpis"
    }
  ],
  "fallbackResourceIds": [
    "${application_insights_id}"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}